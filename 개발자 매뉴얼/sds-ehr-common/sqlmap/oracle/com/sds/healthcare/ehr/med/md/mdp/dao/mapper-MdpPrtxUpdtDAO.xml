<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_MdpPrtxUpdtDAO_sql.xml 
    Description :                                      처방전수정DAO
                  -->
<mapper namespace="MdpPrtxUpdtDAO">


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnPrtxUpdtDual-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="afiDrbnNoStr" column="AFI_DRBN_NO_STR"/>
		<result property="inptVl" column="INPT_VL"/>
		<result property="inptVl1" column="INPT_VL_1"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnPrtxUpdtDual (DVO Parameter 를 유지하기 위한 DUAL SELECT) 
        Description :                                           DVO Parameter 를 유지하기 위한 DUAL SELECT.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnPrtxUpdtDual-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnPrtxUpdtDual"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnPrtxUpdtDual-result" useCache="true" flushCache="false">
		select /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnPrtxUpdtDual */
		           '' as AFI_DRBN_NO_STR
		        ,  '' as INPT_VL
		        ,  '' as INPT_VL_1
		  from  dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtDrugSameBndlNoList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="drbnNo" column="DRBN_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtDrugSameBndlNoList (처방전 수정 약주사 동일묶음번호 처방조회) 
        Description :                                           같은 날 내려진 처방 중 동일한 묶음번호인 약주사처방을 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtDrugSameBndlNoList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtDrugSameBndlNoList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtDrugSameBndlNoList-result" useCache="true" flushCache="false">
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtDrugSameBndlNoList */
		          PTNO as PTNO
		       ,  to_char(ORDR_YMD, 'yyyymmdd') as ORDR_YMD
		       ,  ORDR_SNO as ORDR_SNO
		       ,  DRBN_NO as DRBN_NO
		       ,  ORDR_CD as ORDR_CD
		  from  MDMEDORDT
		where  PTNO = #{ptno}
		   and  ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		   and  DRBN_NO  = #{drbnNo}
		   and  DC_DVSN_CD = 'N'
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listEqptFdnoMdprInfmList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="mcteEqptYn" column="MCTE_EQPT_YN"/>
		<result property="drbnNo" column="DRBN_NO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listEqptFdnoMdprInfmList (비품 정수 약품 정보 조회) 
        Description :                                           환자에게 내려진 약주사처방이 비품/정수 약품 정보를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listEqptFdnoMdprInfmList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listEqptFdnoMdprInfmList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listEqptFdnoMdprInfmList-result" useCache="true" flushCache="false">
		<![CDATA[
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listEqptFdnoMdprInfmList */
		           a.MDPR_CD as ORDR_CD  /*  처방코드 */
		        ,  b.ORDR_NM as ORDR_NM  /*  처방명 */
		        ,  decode(max(a.EQPT_FDNO_DVSN_CD), '2', 'Y', 'N') as MCTE_EQPT_YN  /*  정수약품여부 */
		        ,  c.DRBN_NO as DRBN_NO  /*  약묶음번호 */
		  from  MDMEDORDT c
		        ,  SDJFIXQTT a
		        ,  MDORDRCMT b
		where  c.PTNO     = #{ptno}
		   and  c.ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		   and  c.ORDR_SNO = #{ordrSno}
		   and  a.DPRT_CD =  #{dprtCd}
		   and  a.MDPR_CD =  c.ORDR_CD
		   and  b.ORDR_CD =  a.MDPR_CD
		group
		     by  a.MDPR_CD, b.ORDR_NM, c.DRBN_NO
		 union all
		 select
		           a.MDPR_CD  /*  처방코드 */
		        ,  b.ORDR_NM  /*  처방명 */
		        ,  decode(max(a.EQPT_FDNO_DVSN_CD), '2', 'Y', 'N')  /*  정수약품여부 */
		        ,  c.DRBN_NO  /*  약묶음번호 */
		  from  MDMEDORDT c
		        ,  SDJFIXQTT a
		        ,  MDORDRCMT b
		where  c.PTNO     = #{ptno}
		   and  c.ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		   and  c.ORDR_SNO <> #{ordrSno}
		   and  c.DRBN_NO = (select  t.DRBN_NO
		                                 from  MDMEDORDT t
		                               where  t.PTNO     = #{ptno}
		                                  and  t.ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		                                  and  t.ORDR_SNO = #{ordrSno})
		   and  a.DPRT_CD = #{dprtCd}
		   and  a.MDPR_CD = c.ORDR_CD
		   and  b.ORDR_CD = a.MDPR_CD
		group
		     by  a.MDPR_CD, b.ORDR_NM, c.DRBN_NO
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstDrugList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="vatTrgtYn" column="VAT_TRGT_YN"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="sdpfExreCd" column="SDPF_EXRE_CD"/>
		<result property="injcPrrnYmd" column="INJC_PRRN_YMD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="drbnNo" column="DRBN_NO"/>
		<result property="sngnBndlYn" column="SNGN_BNDL_YN"/>
		<result property="mixKindCd" column="MIX_KIND_CD"/>
		<result property="erFrnsYn" column="ER_FRNS_YN"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="ihohDvsnCd" column="IHOH_DVSN_CD"/>
		<result property="ststDvsnCd" column="STST_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="oddrNm" column="ODDR_NM"/>
		<result property="oddrMcdpCd" column="ODDR_MCDP_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="drusCd" column="DRUS_CD"/>
		<result property="ntm" column="NTM"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="sbdpDprtCd" column="SBDP_DPRT_CD"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="drugOrdrPrssCd" column="DRUG_ORDR_PRSS_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="drugOrdrPrssNm" column="DRUG_ORDR_PRSS_NM"/>
		<result property="afiRcstNm" column="AFI_RCST_NM"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="careWardCd" column="CARE_WARD_CD"/>
		<result property="ptadPtgoCd" column="PTAD_PTGO_CD"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="vatTrgtCd" column="VAT_TRGT_CD"/>
		<result property="mdprClsfCd" column="MDPR_CLSF_CD"/>
		<result property="ddcn" column="DDCN"/>
		<result property="inptVl" column="INPT_VL"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstDrugList (처방전 수정요청 내역조회(약/주사)) 
        Description :                                           환자에게 내려진 약주사 처방에 대해 처방전 수정요청된 목록을 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstDrugList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstDrugList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstDrugList-result" useCache="true" flushCache="false">
		<![CDATA[
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstDrugList */
		         a.PTNO as PTNO  /* 환자번호 */
		      ,  to_char(a.ORDR_YMD,'YYYYMMDD') as ORDR_YMD  /* 처방일자 */
		      ,  a.ORDR_SNO as ORDR_SNO  /* 처방일련번호 */
		      ,  a.MDRP_NO as MDRP_NO  /* 진료접수번호 */
		      ,  a.ORDR_CD as ORDR_CD  /* 처방코드 */
		      ,  a.VAT_TRGT_YN as VAT_TRGT_YN  /* 부가세대상여부 */
		      ,  a.ORDR_IPDV_CD as ORDR_IPDV_CD  /* (처방급여구분코드)  보험급여구분(AI041) */
		      ,  a.SDPF_EXRE_CD as SDPF_EXRE_CD  /* 의약분업예외사유코드 */
		      ,  to_char(a.INJC_PRRN_YMD,'YYYYMMDD') as INJC_PRRN_YMD  /* 주사예정일자 */
		      ,  a.FRNS_DPRT_CD as FRNS_DPRT_CD  /* 불출부서코드 */
		      ,  a.DRBN_NO as DRBN_NO  /* 약묶음번호 */
		      ,  a.SNGN_BNDL_YN as SNGN_BNDL_YN  /* 단독묶음여부 */
		      ,  a.MIX_KIND_CD as MIX_KIND_CD  /* 혼합종류코드 */
		      ,  a.ER_FRNS_YN as ER_FRNS_YN  /* 응급불출여부 */
		      ,  a.ORFR_CD as ORFR_CD  /* 처방형태코드 */
		      ,  a.CLRS_PRJC_CD as CLRS_PRJC_CD  /* 임상연구과제코드 */
		      ,  a.ORDR_CLTY_CD as ORDR_CLTY_CD
		      ,  a.IHOH_DVSN_CD as IHOH_DVSN_CD  /* 원내원외구분코드 */
		      ,  b.STST_DVSN_CD as STST_DVSN_CD  /* 통계구분코드 */
		      ,  a.CRTF_DVSN_CD as CRTF_DVSN_CD
		      ,  a.CODV_CD as CODV_CD
		      ,  a.ODDR_ID as ODDR_ID
		      ,  c.USER_NM as ODDR_NM
		      ,  c.MDCR_DPRT_CD as ODDR_MCDP_CD
		      ,  b.ORDR_NM as ORDR_NM
		      ,  p.ISTY_CD as ISTY_CD
		      ,  p.ISTY_ASST_CD as ISTY_ASST_CD
		      ,  a.MCDP_CD as MCDP_CD
		      ,  a.ORCL_CD as ORCL_CD
		      ,  a.ODKI_CD as ODKI_CD
		      ,  a.DRUS_CD as DRUS_CD
		      ,  a.NTM as NTM
		      ,  a.PTAD_CODV_CD as PTAD_CODV_CD
		      ,  a.WARD_CD as WARD_CD
		      ,  a.DC_DVSN_CD as DC_DVSN_CD
		      ,  a.TMPR_ORDR_YN as TMPR_ORDR_YN
		      ,  a.OROC_DPRT_CD as OROC_DPRT_CD
		      ,  ( select  t.HRAF_PRAP_DPRT_CD
		            from  CCUSRDPHT t
		          where  t.USER_ID = a.ODDR_ID) as SBDP_DPRT_CD
		      ,  a.GNDR_ID as GNDR_ID
		      ,  to_char(p.MDCR_DT, 'yyyymmddhh24miss') as MDCR_DT
		      ,  a.HSLC_DVSN_CD as HSLC_DVSN_CD
		      ,  nvl(a.DRUG_ORDR_PRSS_CD, '0') as DRUG_ORDR_PRSS_CD
		       ,  nvl( a.RCST_CD , 'N') as RCST_CD
		      ,  ( select  c.DETL_CD_NM
		            from  CCCMCDDMT c
		          where  c.COMN_GRP_CD  = 'SD011'
		             and  c.COMN_DTLS_CD = nvl(a.DRUG_ORDR_PRSS_CD, '0')
		         ) as DRUG_ORDR_PRSS_NM
		      ,  ( select  d.DETL_CD_NM
		            from  CCCMCDDMT d
		          where  d.COMN_GRP_CD  = 'ACA_037'
		             and d.COMN_DTLS_CD = nvl( a.RCST_CD , 'N' )
		         ) as AFI_RCST_NM
		      ,  a.CHDR_ID as CHDR_ID
		      ,  a.MCCN_CD as MCCN_CD
		      ,  p.CARE_WARD_CD as CARE_WARD_CD
		      ,  a.PTAD_PTGO_CD as PTAD_PTGO_CD
		      ,  a.ORDR_CRTN_DVSN_CD as ORDR_CRTN_DVSN_CD
		      ,  p.VAT_TRGT_CD as VAT_TRGT_CD
		      ,  b.MDPR_CLSF_CD as MDPR_CLSF_CD
		      ,  a.DDCN as DDCN
		      ,  nvl(a.PHDP_PRIN_YN, 'N') as INPT_VL
		  from  MDMEDORDT a
		     ,  MDORDRCMT b
		     ,  CCUSRDPHT c
		     ,  APRCRPTNT p /*  진료접수 */
		     ,  SDDDGCDMT s /*  약품코드 */
		 where  a.PTNO = #{ptno}
		   and  a.ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		   and  a.ORDR_SNO = #{ordrSno}
		   and  a.DC_DVSN_CD = 'N'
		   and  b.ORDR_CD = a.ORDR_CD
		   and  c.USER_ID(+) = a.ODDR_ID
		   and  p.MDRP_NO = a.MDRP_NO
		   and  s.MDPR_CD(+) = a.ORDR_CD
		   and  rownum < 2
		 order
		    by  a.ORDR_SNO
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstAprvList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ordrUpdtSttsCd" column="ORDR_UPDT_STTS_CD"/>
		<result property="detlCdNm" column="DETL_CD_NM"/>
		<result property="ptno" column="PTNO"/>
		<result property="ptntNm" column="PTNT_NM"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="abrvDprtCd" column="ABRV_DPRT_CD"/>
		<result property="kornDprtNm" column="KORN_DPRT_NM"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="ordrUpdtOrdvCd" column="ORDR_UPDT_ORDV_CD"/>
		<result property="ordrUpdtClmnNm" column="ORDR_UPDT_CLMN_NM"/>
		<result property="clmnNm" column="CLMN_NM"/>
		<result property="ordrUpdtBefrClmnVl" column="ORDR_UPDT_BEFR_CLMN_VL"/>
		<result property="ordrUpdtAftrClmnVl" column="ORDR_UPDT_AFTR_CLMN_VL"/>
		<result property="ordrUpdtBefrClmnVl1" column="ORDR_UPDT_BEFR_CLMN_VL_1"/>
		<result property="ordrUpdtAftrClmnVl1" column="ORDR_UPDT_AFTR_CLMN_VL_1"/>
		<result property="ordrUpdtTypeCd" column="ORDR_UPDT_TYPE_CD"/>
		<result property="updtRqstResnCtn" column="UPDT_RQST_RESN_CTN"/>
		<result property="aprvBfafPtntInftDvsnCd" column="APRV_BFAF_PTNT_INFT_DVSN_CD"/>
		<result property="comnDtlsCtrlCdNm" column="COMN_DTLS_CTRL_CD_NM"/>
		<result property="ptntInftExlrId" column="PTNT_INFT_EXLR_ID"/>
		<result property="afiPtntInftExlrNm" column="AFI_PTNT_INFT_EXLR_NM"/>
		<result property="ordrUpdtSno" column="ORDR_UPDT_SNO"/>
		<result property="ptntInftDscrTgprNm" column="PTNT_INFT_DSCR_TGPR_NM"/>
		<result property="ptntInftDscrYmd" column="PTNT_INFT_DSCR_YMD"/>
		<result property="readFinsYn" column="READ_FINS_YN"/>
		<result property="ohprReHndvFinsYn" column="OHPR_RE_HNDV_FINS_YN"/>
		<result property="frstRgstDt" column="FRST_RGST_DT"/>
		<result property="frstRgsrId" column="FRST_RGSR_ID"/>
		<result property="mdcrCtrlChrcVl1" column="MDCR_CTRL_CHRC_VL_1"/>
		<result property="mdcrCtrlChrcVl2" column="MDCR_CTRL_CHRC_VL_2"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="ptntInftDscrTrgtDvsnCd" column="PTNT_INFT_DSCR_TRGT_DVSN_CD"/>
		<result property="rqprNm" column="RQPR_NM"/>
		<result property="rqprDprtCd" column="RQPR_DPRT_CD"/>
		<result property="abrvDprtCd1" column="ABRV_DPRT_CD_1"/>
		<result property="kornDprtNm1" column="KORN_DPRT_NM_1"/>
		<result property="lastUpdrId" column="LAST_UPDR_ID"/>
		<result property="lastUpdtDt" column="LAST_UPDT_DT"/>
		<result property="lastUpdrNm" column="LAST_UPDR_NM"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="gndrNm" column="GNDR_NM"/>
		<result property="aprvDrId" column="APRV_DR_ID"/>
		<result property="drNm" column="DR_NM"/>
		<result property="aprvRqprId" column="APRV_RQPR_ID"/>
		<result property="drNm1" column="DR_NM_1"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="codvCd" column="CODV_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstAprvList (처방전 수정 요청 승인 목록 조회) 
        Description :                                           처방전 수정요청된 요청목록을 조회한다.(약주사, 검사, 처치, 마취, 수혈, 재활)
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstAprvList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstAprvList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstAprvList-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-listPrtxUpdtRqstAprvList */
		           t.ORDR_UPDT_STTS_CD as ORDR_UPDT_STTS_CD
		        ,  t.DETL_CD_NM as DETL_CD_NM
		        ,  t.PTNO as PTNO
		        ,  t.PTNT_NM as PTNT_NM
		        ,  t.MCDP_CD as MCDP_CD
		        ,  t.ABRV_DPRT_CD as ABRV_DPRT_CD
		        ,  t.KORM_DPRT_NM as KORN_DPRT_NM
		        ,  t.ORDR_YMD as ORDR_YMD
		        ,  t.ORDR_SNO as ORDR_SNO
		        ,  t.ORDR_CD as ORDR_CD
		        ,  t.ORDR_NM as ORDR_NM
		        ,  t.ORDR_UPDT_ORDV_CD as ORDR_UPDT_ORDV_CD
		        ,  t.ORDR_UPDT_CLMN_NM as ORDR_UPDT_CLMN_NM
		        ,  t.CLMN_NM as CLMN_NM
		        ,  t.ORDR_UPDT_BEFR_CLMN_VL as ORDR_UPDT_BEFR_CLMN_VL
		        ,  t.ORDR_UPDT_AFTR_CLMN_VL as ORDR_UPDT_AFTR_CLMN_VL
		        ,  t.ORDR_UPDT_BEFR_CLMN_VL_1 as ORDR_UPDT_BEFR_CLMN_VL_1
		        ,  t.ORDR_UPDT_AFTR_CLMN_VL_1 as ORDR_UPDT_AFTR_CLMN_VL_1
		        ,  t.ORDR_UPDT_TYPE_CD as ORDR_UPDT_TYPE_CD
		        ,  t.UPDT_RQST_RESN_CTN as UPDT_RQST_RESN_CTN
		        ,  t.APRV_BFAF_PTNT_INFT_DVSN_CD as APRV_BFAF_PTNT_INFT_DVSN_CD
		        ,  t.PTNT_INFT_DSCR_TRGT_DVSN_NM as COMN_DTLS_CTRL_CD_NM
		        ,  t.PTNT_INFT_EXLR_ID as PTNT_INFT_EXLR_ID
		        ,  t.AFI_PTNT_INFT_EXLR_NM as AFI_PTNT_INFT_EXLR_NM
		        ,  t.ORDR_UPDT_SNO as ORDR_UPDT_SNO
		        ,  t.PTNT_INFT_DSCR_TGPR_NM as PTNT_INFT_DSCR_TGPR_NM
		        ,  to_char(t.PTNT_INFT_DSCR_YMD, 'yyyymmdd') as PTNT_INFT_DSCR_YMD
		        ,  t.READ_FINS_YN as READ_FINS_YN
		        ,  t.OHPR_RE_HNDV_FINS_YN as OHPR_RE_HNDV_FINS_YN
		        ,  t.FRST_RGST_DT as FRST_RGST_DT
		        ,  t.FRST_RGSR_ID as FRST_RGSR_ID
		        ,  t.MDCR_CTRL_CHRC_VL1 as MDCR_CTRL_CHRC_VL_1
		        ,  t.MDCR_CTRL_CHRC_VL2 as MDCR_CTRL_CHRC_VL_2
		        ,  t.CRTF_DVSN_CD as CRTF_DVSN_CD
		        ,  t.PTNT_INFT_DSCR_TRGT_DVSN_CD as PTNT_INFT_DSCR_TRGT_DVSN_CD
		        ,  t.USER_NM as RQPR_NM
		        ,  t.MDCR_DPRT_CD as RQPR_DPRT_CD
		        ,  t.ABRV_DPRT_CD_1 as ABRV_DPRT_CD_1
		        ,  t.KORN_DPRT_NM_1 as KORN_DPRT_NM_1
		        ,  t.LAST_UPDR_ID as LAST_UPDR_ID
		        ,  t.LAST_UPDT_DT as LAST_UPDT_DT
		        ,  t.LAST_UPDR_NM as LAST_UPDR_NM
		        ,  t.GNDR_ID as GNDR_ID
		        ,  (select USER_NM
		                from CCUSRDPHT
		               where USER_ID = t.GNDR_ID) as GNDR_NM
		        ,  t.APRV_DR_ID as APRV_DR_ID
		        ,  (select USER_NM
		                from CCUSRDPHT
		               where USER_ID = t.APRV_DR_ID) as DR_NM
		        ,  t.APRV_RQPR_ID as APRV_RQPR_ID
		        ,  (select USER_NM
		                from CCUSRDPHT
		               where USER_ID = t.APRV_RQPR_ID) as DR_NM_1
		        ,  t.MDRP_NO as MDRP_NO
		        ,  t.CODV_CD as CODV_CD
		     from
		        (
		           select  /*+ NO_EXPAND LEADING(A, B) USE_NL(B, C, F, H, I, Z, T) mdd_ordupbt_l01$S01_처방전_수정_승인_목록_조회_DAM */
		                   a.ORDR_UPDT_STTS_CD                                              as ORDR_UPDT_STTS_CD
		                ,  f.DETL_CD_NM                                                     as DETL_CD_NM
		                ,  a.PTNO                                                           as PTNO
		                ,  (select p.PTNT_NM
		                      from APPTPTNTT p
		                     where p.PTNO = a.PTNO)                                         as PTNT_NM
		                ,  b.MCDP_CD                                                        as MCDP_CD
		                ,  h.ABRV_DPRT_CD                                                   as ABRV_DPRT_CD
		                ,  h.KORN_DPRT_NM                                                   as KORM_DPRT_NM
		                ,  to_char(a.ORDR_YMD, 'yyyymmdd')                                  as ORDR_YMD
		                ,  a.ORDR_SNO                                                       as ORDR_SNO
		                ,  b.ORDR_CD                                                        as ORDR_CD
		                ,  c.ORDR_NM                                                        as ORDR_NM
		                ,  a.ORDR_UPDT_ORDV_CD                                              as ORDR_UPDT_ORDV_CD
		                ,  a.ORDR_UPDT_CLMN_NM                                              as ORDR_UPDT_CLMN_NM
		                ,  (select COMMENTS
		                      from ALL_COL_COMMENTS
		                     where OWNER = 'SEHRMGR'
		                       and TABLE_NAME = case a.ORDR_UPDT_ORDV_CD when '1' then 'MDMEDORDT'
		                                                                 when '2' then 'MDEXMORDT' end
		                       and COLUMN_NAME = a.ORDR_UPDT_CLMN_NM )                      as CLMN_NM
		                ,  a.ORDR_UPDT_BEFR_CLMN_VL                                         as ORDR_UPDT_BEFR_CLMN_VL
		                ,  a.ORDR_UPDT_AFTR_CLMN_VL                                         as ORDR_UPDT_AFTR_CLMN_VL
		                ,  decode(a.ORDR_UPDT_BEFR_CLMN_VL, 'NULL', '-',
		                   nvl((case a.ORDR_UPDT_CLMN_NM when 'FRNS_DPRT_CD' then (select ABRV_DPRT_CD                /*  불출부서 */
		                                                                            from HZDEPTMMT
		                                                                           where DPRT_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                                when 'INJC_PRRN_YMD' then substr(a.ORDR_UPDT_BEFR_CLMN_VL, 1, 4)||'-'||
		                                                                          substr(a.ORDR_UPDT_BEFR_CLMN_VL, 5, 2)||'-'||
		                                                                          substr(a.ORDR_UPDT_BEFR_CLMN_VL, 7, 2)
		                                                when 'IHOH_DVSN_CD'  then decode(a.ORDR_UPDT_BEFR_CLMN_VL, 'I', '원내', 'O', '원외', '-')
		                                                when 'MIX_KIND_CD'   then (select DETL_CD_NM
		                                                                             from CCCMCDDMT
		                                                                            where COMN_GRP_CD = 'MM301'
		                                                                              and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                                when 'ORFR_CD'       then (select DETL_CD_NM
		                                                                             from CCCMCDDMT
		                                                                            where COMN_GRP_CD = 'MM186'
		                                                                              and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                                when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                             from CCCMCDDMT
		                                                                            where COMN_GRP_CD = 'AI041'
		                                                                              and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                               when 'SDPF_EXRE_CD'       then a.ORDR_UPDT_BEFR_CLMN_VL||(select DETL_CD_NM
		                                                                             from CCCMCDDMT
		                                                                            where COMN_GRP_CD = 'SD029'
		                                                                              and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                                else a.ORDR_UPDT_BEFR_CLMN_VL end ) , '-')) as ORDR_UPDT_BEFR_CLMN_VL_1
		                , decode(a.ORDR_UPDT_AFTR_CLMN_VL, 'NULL', '-',
		                  nvl((case a.ORDR_UPDT_CLMN_NM when 'FRNS_DPRT_CD' then (select ABRV_DPRT_CD                /*  불출부서 */
		                                                                           from HZDEPTMMT
		                                                                          where DPRT_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                               when 'INJC_PRRN_YMD' then substr(a.ORDR_UPDT_AFTR_CLMN_VL, 1, 4)||'-'||
		                                                                          substr(a.ORDR_UPDT_AFTR_CLMN_VL, 5, 2)||'-'||
		                                                                          substr(a.ORDR_UPDT_AFTR_CLMN_VL, 7, 2)
		                                               when 'IHOH_DVSN_CD'  then decode(a.ORDR_UPDT_AFTR_CLMN_VL, 'I', '원내', 'O', '원외', '-')
		                                               when 'MIX_KIND_CD'   then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'MM301'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                               when 'ORFR_CD'       then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'MM186'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                               when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'AI041'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                               when 'SDPF_EXRE_CD'       then a.ORDR_UPDT_AFTR_CLMN_VL||(select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                            where COMN_GRP_CD = 'SD029'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                               else a.ORDR_UPDT_AFTR_CLMN_VL end ) , '-')) as ORDR_UPDT_AFTR_CLMN_VL_1
		                ,  a.ORDR_UPDT_TYPE_CD                                                       as ORDR_UPDT_TYPE_CD
		                ,  a.UPDT_RQST_RESN_CTN                                                      as UPDT_RQST_RESN_CTN
		                ,  a.APRV_BFAF_PTNT_INFT_DVSN_CD                                             as APRV_BFAF_PTNT_INFT_DVSN_CD
		                ,  a.PTNT_INFT_EXLR_ID                                                       as PTNT_INFT_EXLR_ID
		                ,  (select USER_NM
		                      from CCUSRDPHT
		                     where USER_ID = a.PTNT_INFT_EXLR_ID)                                    as AFI_PTNT_INFT_EXLR_NM
		                ,  a.ORDR_UPDT_SNO                                                           as ORDR_UPDT_SNO
		                ,  a.PTNT_INFT_DSCR_TGPR_NM                                                  as PTNT_INFT_DSCR_TGPR_NM
		                ,  a.PTNT_INFT_DSCR_YMD                                                      as PTNT_INFT_DSCR_YMD
		                ,  a.READ_FINS_YN                                                            as READ_FINS_YN
		                ,  a.OHPR_RE_HNDV_FINS_YN                                                    as OHPR_RE_HNDV_FINS_YN
		                ,  to_char(a.FRST_RGST_DT, 'yyyymmddhh24miss')                               as FRST_RGST_DT
		                ,  a.FRST_RGSR_ID                                                            as FRST_RGSR_ID
		                ,  z.MDCR_CTRL_CHRC_VL1                                                      as MDCR_CTRL_CHRC_VL1
		                ,  z.MDCR_CTRL_CHRC_VL2                                                      as MDCR_CTRL_CHRC_VL2
		                ,  b.CRTF_DVSN_CD                                                            as CRTF_DVSN_CD
		                ,  a.PTNT_INFT_DSCR_TRGT_DVSN_CD                                             as PTNT_INFT_DSCR_TRGT_DVSN_CD
		                ,  (select MDCR_DTLS_CTRL_NM
		                      from MZCTRLMMT
		                     where MDCR_CTRL_CD = 'MDX_105'
		                       and MDCR_DTLS_CTRL_CD = a.PTNT_INFT_DSCR_TRGT_DVSN_CD)                as PTNT_INFT_DSCR_TRGT_DVSN_NM
		                ,  t.USER_NM                                                                 as USER_NM
		                ,  t.MDCR_DPRT_CD                                                            as MDCR_DPRT_CD
		                ,  i.ABRV_DPRT_CD                                                            as ABRV_DPRT_CD_1
		                ,  i.KORN_DPRT_NM                                                            as KORN_DPRT_NM_1
		                ,  a.LAST_UPDR_ID                                                            as LAST_UPDR_ID
		                ,  to_char(a.APRV_DT, 'yyyymmddhh24miss')                               as LAST_UPDT_DT
		                ,  (select USER_NM
		                      from CCUSRDPHT
		                     where USER_ID = a.LAST_UPDR_ID)                                           as LAST_UPDR_NM
		                ,  nvl(b.GNDR_ID, b.CHDR_ID)                                                                 as GNDR_ID
		                ,  a.APRV_DR_ID                                                              as APRV_DR_ID
		                ,  a.APRV_RQPR_ID                                                            as APRV_RQPR_ID
		                ,  b.MDRP_NO                                                                 as MDRP_NO
		                ,  b.CODV_CD                                                                 as CODV_CD
		             from  /*  MDORDUPBT a */
		                   (
		                   select /*+ INDEX(A (PTNO)) */
		                          a.PTNO
		                        , a.ORDR_YMD
		                        , a.ORDR_SNO
		                        , a.ORDR_UPDT_SNO
		                        , a.ORDR_UPDT_ORDV_CD
		                        , a.ORDR_UPDT_CLMN_NM
		                        , a.ORDR_UPDT_BEFR_CLMN_VL
		                        , a.ORDR_UPDT_AFTR_CLMN_VL
		                        , a.ORDR_UPDT_STTS_CD
		                        , a.ORDR_UPDT_TYPE_CD
		                        , a.UPDT_RQST_RESN_CTN
		                        , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                        , a.PTNT_INFT_EXLR_ID
		                        , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                        , a.PTNT_INFT_DSCR_TGPR_NM
		                        , a.PTNT_INFT_DSCR_YMD
		                        , a.APRV_DR_ID
		                        , a.APRV_RQPR_ID
		                        , a.APRV_DT
		                        , a.READ_FINS_YN
		                        , a.OHPR_RE_HNDV_FINS_YN
		                        , a.FRST_RGST_DT
		                        , a.FRST_RGSR_ID
		                        , a.LAST_UPDT_DT
		                        , a.LAST_UPDR_ID
		                     from MDORDUPBT a
		                    where #{ptno} is not null
		                      and a.PTNO     = #{ptno}
		                    union all
		                   select /*+ NO_EXPAND FULL(A) */
		                          a.PTNO
		                        , a.ORDR_YMD
		                        , a.ORDR_SNO
		                        , a.ORDR_UPDT_SNO
		                        , a.ORDR_UPDT_ORDV_CD
		                        , a.ORDR_UPDT_CLMN_NM
		                        , a.ORDR_UPDT_BEFR_CLMN_VL
		                        , a.ORDR_UPDT_AFTR_CLMN_VL
		                        , a.ORDR_UPDT_STTS_CD
		                        , a.ORDR_UPDT_TYPE_CD
		                        , a.UPDT_RQST_RESN_CTN
		                        , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                        , a.PTNT_INFT_EXLR_ID
		                        , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                        , a.PTNT_INFT_DSCR_TGPR_NM
		                        , a.PTNT_INFT_DSCR_YMD
		                        , a.APRV_DR_ID
		                        , a.APRV_RQPR_ID
		                        , a.APRV_DT
		                        , a.READ_FINS_YN
		                        , a.OHPR_RE_HNDV_FINS_YN
		                        , a.FRST_RGST_DT
		                        , a.FRST_RGSR_ID
		                        , a.LAST_UPDT_DT
		                        , a.LAST_UPDR_ID
		                     from MDORDUPBT a
		                    where #{ptno} is null
		                   )                a
		                ,  MDMEDORDT b
		                ,  MDORDRCMT c
		                ,  CCCMCDDMT f
		                ,  HZDEPTMMT h
		                ,  HZDEPTMMT i
		                ,  MZCTRLMMT z
		                ,  CCUSRDPHT t
		            where  1 = 1
		              and  nvl(#{ordrUpdtOrdvCd} , a.ORDR_UPDT_ORDV_CD) = '1'
		              and  a.PTNO     = nvl(#{ptno} , a.PTNO)
		              and  a.ORDR_YMD = decode(#{ordrYmd}, '', a.ORDR_YMD, to_date( #{ordrYmd}, 'yyyymmdd'))
		              and  a.ORDR_SNO = nvl(#{afiOrdrSnoStr}, a.ORDR_SNO)
		              and  a.ORDR_UPDT_SNO = nvl(#{afiOrdrUpdtSnoStr} , a.ORDR_UPDT_SNO)
		              and  ((#{strtYmd} is null) or
		                  ((#{strtYmd} is not null) and (a.FRST_RGST_DT between to_date(#{strtYmd}, 'yyyymmdd')
		                                                                                              and to_date(#{fnshYmd}, 'yyyymmdd') + 0.99999)))
		              and  a.ORDR_UPDT_CLMN_NM = nvl(#{ordrUpdtClmnNm}, a.ORDR_UPDT_CLMN_NM)
		              and  b.PTNO = a.PTNO
		              and  b.ORDR_YMD = a.ORDR_YMD
		              and  b.ORDR_SNO = a.ORDR_SNO
		              and  b.ODDR_ID  = nvl(#{oddrId}, b.ODDR_ID)
		              and  b.DC_DVSN_CD = 'N'
		              and  c.ORDR_CD  = b.ORDR_CD
		              and  f.COMN_GRP_CD = 'MDP_050' /*  처방전수정요청상태구분 */
		              and  f.COMN_DTLS_CD = a.ORDR_UPDT_STTS_CD
		              and  h.DPRT_CD = b.MCDP_CD
		              and  z.MDCR_CTRL_CD = 'MDP_205'
		              and  z.MDCR_DTLS_CTRL_CD = a.ORDR_UPDT_CLMN_NM
		              and  t.USER_ID = a.FRST_RGSR_ID
		              and  i.DPRT_CD = t.MDCR_DPRT_CD
		            union
		              all
		           select  /*+ NO_EXPAND LEADING(A, B) USE_NL(B, C, F, H, I, Z, T) mdd_ordupbt_l01$S01_처방전_수정_승인_목록_조회_DAM */
		                   a.ORDR_UPDT_STTS_CD                                              as ORDR_UPDT_STTS_CD
		                ,  f.DETL_CD_NM                                                     as DETL_CD_NM
		                ,  a.PTNO                                                           as PTNO
		                ,  (select p.PTNT_NM
		                      from APPTPTNTT p
		                     where p.PTNO = a.PTNO)                                         as PTNT_NM
		                ,  b.MCDP_CD                                                        as MCDP_CD
		                ,  h.ABRV_DPRT_CD                                                   as ABRV_DPRT_CD
		                ,  h.KORN_DPRT_NM                                                   as KORM_DPRT_NM
		                ,  to_char(a.ORDR_YMD, 'yyyymmdd')                                  as ORDR_YMD
		                ,  a.ORDR_SNO                                                       as ORDR_SNO
		                ,  b.ORDR_CD                                                        as ORDR_CD
		                ,  c.ORDR_NM                                                        as ORDR_NM
		                ,  a.ORDR_UPDT_ORDV_CD                                              as ORDR_UPDT_ORDV_CD
		                ,  a.ORDR_UPDT_CLMN_NM                                              as ORDR_UPDT_CLMN_NM
		                ,  (select COMMENTS
		                      from ALL_COL_COMMENTS
		                     where OWNER = 'SEHRMGR'
		                       and TABLE_NAME = case a.ORDR_UPDT_ORDV_CD when '1' then 'MDMEDORDT'
		                                                                 when '2' then 'MDEXMORDT' end
		                       and COLUMN_NAME = a.ORDR_UPDT_CLMN_NM )                      as CLMN_NM
		                ,  a.ORDR_UPDT_BEFR_CLMN_VL                                         as ORDR_UPDT_BEFR_CLMN_VL
		                ,  a.ORDR_UPDT_AFTR_CLMN_VL                                         as ORDR_UPDT_AFTR_CLMN_VL
		                , decode(a.ORDR_UPDT_BEFR_CLMN_VL, 'NULL', '-',
		                  nvl((case a.ORDR_UPDT_CLMN_NM when 'WNTD_DT' then substr(a.ORDR_UPDT_BEFR_CLMN_VL, 1, 4)||'-'||
		                                                                    substr(a.ORDR_UPDT_BEFR_CLMN_VL, 5, 2)||'-'||
		                                                                    substr(a.ORDR_UPDT_BEFR_CLMN_VL, 7, 2)||' '||
		                                                                    substr(a.ORDR_UPDT_BEFR_CLMN_VL, 9, 2)||':'||
		                                                                    substr(a.ORDR_UPDT_BEFR_CLMN_VL, 11, 2)||':'||
		                                                                    substr(a.ORDR_UPDT_BEFR_CLMN_VL, 13, 2)
		                                               when 'EXMN_WNTD_DR_ID' then (select USER_NM
		                                                                              from CCUSRDPHT
		                                                                             where USER_ID = a.ORDR_UPDT_BEFR_CLMN_VL
		                                                                               and rownum < 2)
		                                               when 'IHOH_DVSN_CD'  then decode(a.ORDR_UPDT_BEFR_CLMN_VL, 'I', '원내', 'O', '원외', '-')
		                                               when 'MIX_KIND_CD'   then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'MM301'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                               when 'ORFR_CD'       then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'MM186'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                               when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'AI041'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                               else a.ORDR_UPDT_BEFR_CLMN_VL end ) , '-'))
		                , decode(a.ORDR_UPDT_AFTR_CLMN_VL, 'NULL', '-',
		                  nvl((case a.ORDR_UPDT_CLMN_NM when 'WNTD_DT' then substr(a.ORDR_UPDT_AFTR_CLMN_VL, 1, 4)||'-'||
		                                                                    substr(a.ORDR_UPDT_AFTR_CLMN_VL, 5, 2)||'-'||
		                                                                    substr(a.ORDR_UPDT_AFTR_CLMN_VL, 7, 2)||' '||
		                                                                    substr(a.ORDR_UPDT_AFTR_CLMN_VL, 9, 2)||':'||
		                                                                    substr(a.ORDR_UPDT_AFTR_CLMN_VL, 11, 2)||':'||
		                                                                    substr(a.ORDR_UPDT_AFTR_CLMN_VL, 13, 2)
		                                               when 'EXMN_WNTD_DR_ID' then (select USER_NM
		                                                                              from CCUSRDPHT
		                                                                             where USER_ID = a.ORDR_UPDT_AFTR_CLMN_VL
		                                                                               and rownum < 2)
		                                               when 'IHOH_DVSN_CD'  then decode(a.ORDR_UPDT_AFTR_CLMN_VL, 'I', '원내', 'O', '원외', '-')
		                                               when 'MIX_KIND_CD'   then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'MM301'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                               when 'ORFR_CD'       then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'MM186'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                               when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                            from CCCMCDDMT
		                                                                           where COMN_GRP_CD = 'AI041'
		                                                                             and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                               else a.ORDR_UPDT_AFTR_CLMN_VL end ) , '-')) as ORDR_UPDT_AFTR_CLMN_VL_1
		                ,  a.ORDR_UPDT_TYPE_CD                                                       as ORDR_UPDT_TYPE_CD
		                ,  a.UPDT_RQST_RESN_CTN                                                      as UPDT_RQST_RESN_CTN
		                ,  a.APRV_BFAF_PTNT_INFT_DVSN_CD                                             as APRV_BFAF_PTNT_INFT_DVSN_CD
		                ,  a.PTNT_INFT_EXLR_ID                                                       as PTNT_INFT_EXLR_ID
		                ,  (select USER_NM
		                      from CCUSRDPHT
		                     where USER_ID = a.PTNT_INFT_EXLR_ID)                                    as AFI_PTNT_INFT_EXLR_NM
		                ,  a.ORDR_UPDT_SNO                                                           as ORDR_UPDT_SNO
		                ,  a.PTNT_INFT_DSCR_TGPR_NM                                                  as PTNT_INFT_DSCR_TGPR_NM
		                ,  a.PTNT_INFT_DSCR_YMD                                                      as PTNT_INFT_DSCR_YMD
		                ,  a.READ_FINS_YN                                                            as READ_FINS_YN
		                ,  a.OHPR_RE_HNDV_FINS_YN                                                    as OHPR_RE_HNDV_FINS_YN
		                ,  to_char(a.FRST_RGST_DT, 'yyyymmddhh24miss')                               as FRST_RGST_DT
		                ,  a.FRST_RGSR_ID                                                            as FRST_RGSR_ID
		                ,  z.MDCR_CTRL_CHRC_VL1                                                      as MDCR_CTRL_CHRC_VL1
		                ,  z.MDCR_CTRL_CHRC_VL2                                                      as MDCR_CTRL_CHRC_VL2
		                ,  b.CRTF_DVSN_CD                                                            as CRTF_DVSN_CD
		                ,  a.PTNT_INFT_DSCR_TRGT_DVSN_CD                                             as PTNT_INFT_DSCR_TRGT_DVSN_CD
		                ,  (select MDCR_DTLS_CTRL_NM
		                      from MZCTRLMMT
		                     where MDCR_CTRL_CD = 'MDX_105'
		                       and MDCR_DTLS_CTRL_CD = a.PTNT_INFT_DSCR_TRGT_DVSN_CD)                as PTNT_INFT_DSCR_TRGT_DVSN_NM
		                ,  t.USER_NM                                                                 as USER_NM
		                ,  t.MDCR_DPRT_CD                                                            as MDCR_DPRT_CD
		                ,  i.ABRV_DPRT_CD                                                            as ABRV_DPRT_CD_1
		                ,  i.KORN_DPRT_NM                                                            as KORN_DPRT_NM_1
		                ,  a.LAST_UPDR_ID                                                            as LAST_UPDR_ID
		                ,  to_char(a.APRV_DT, 'yyyymmddhh24miss')                               as LAST_UPDT_DT
		                ,  (select USER_NM
		                      from CCUSRDPHT
		                     where USER_ID = a.LAST_UPDR_ID)                                         as LAST_UPDR_NM
		                ,  nvl(b.GNDR_ID, b.CHDR_ID)                                                                 as GNDR_ID
		                ,  a.APRV_DR_ID                                                              as APRV_DR_ID
		                ,  a.APRV_RQPR_ID                                                            as APRV_RQPR_ID
		                ,  b.MDRP_NO                                                                 as MDRP_NO
		                ,  b.CODV_CD                                                                 as CODV_CD
		             from  /* MDORDUPBT a */
		                   (
		                   select /*+ INDEX(A (PTNO)) */
		                          a.PTNO
		                        , a.ORDR_YMD
		                        , a.ORDR_SNO
		                        , a.ORDR_UPDT_SNO
		                        , a.ORDR_UPDT_ORDV_CD
		                        , a.ORDR_UPDT_CLMN_NM
		                        , a.ORDR_UPDT_BEFR_CLMN_VL
		                        , a.ORDR_UPDT_AFTR_CLMN_VL
		                        , a.ORDR_UPDT_STTS_CD
		                        , a.ORDR_UPDT_TYPE_CD
		                        , a.UPDT_RQST_RESN_CTN
		                        , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                        , a.PTNT_INFT_EXLR_ID
		                        , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                        , a.PTNT_INFT_DSCR_TGPR_NM
		                        , a.PTNT_INFT_DSCR_YMD
		                        , a.APRV_DR_ID
		                        , a.APRV_RQPR_ID
		                        , a.APRV_DT
		                        , a.READ_FINS_YN
		                        , a.OHPR_RE_HNDV_FINS_YN
		                        , a.FRST_RGST_DT
		                        , a.FRST_RGSR_ID
		                        , a.LAST_UPDT_DT
		                        , a.LAST_UPDR_ID
		                     from MDORDUPBT a
		                    where #{ptno} is not null
		                      and a.PTNO     = #{ptno}
		                    union all
		                   select /*+ NO_EXPAND FULL(A) */
		                          a.PTNO
		                        , a.ORDR_YMD
		                        , a.ORDR_SNO
		                        , a.ORDR_UPDT_SNO
		                        , a.ORDR_UPDT_ORDV_CD
		                        , a.ORDR_UPDT_CLMN_NM
		                        , a.ORDR_UPDT_BEFR_CLMN_VL
		                        , a.ORDR_UPDT_AFTR_CLMN_VL
		                        , a.ORDR_UPDT_STTS_CD
		                        , a.ORDR_UPDT_TYPE_CD
		                        , a.UPDT_RQST_RESN_CTN
		                        , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                        , a.PTNT_INFT_EXLR_ID
		                        , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                        , a.PTNT_INFT_DSCR_TGPR_NM
		                        , a.PTNT_INFT_DSCR_YMD
		                        , a.APRV_DR_ID
		                        , a.APRV_RQPR_ID
		                        , a.APRV_DT
		                        , a.READ_FINS_YN
		                        , a.OHPR_RE_HNDV_FINS_YN
		                        , a.FRST_RGST_DT
		                        , a.FRST_RGSR_ID
		                        , a.LAST_UPDT_DT
		                        , a.LAST_UPDR_ID
		                     from MDORDUPBT a
		                    where #{ptno} is null
		                   )                a
		                ,  MDEXMORDT b
		                ,  MDORDRCMT c
		                ,  CCCMCDDMT f
		                ,  HZDEPTMMT h
		                ,  HZDEPTMMT i
		                ,  MZCTRLMMT z
		                ,  CCUSRDPHT t
		            where  1 = 1
		              and  nvl(#{ordrUpdtOrdvCd} , a.ORDR_UPDT_ORDV_CD) = '2'
		              and  a.PTNO     = nvl(#{ptno} , a.PTNO)
		              and  a.ORDR_YMD = decode(#{ordrYmd}, '', a.ORDR_YMD, to_date( #{ordrYmd}, 'yyyymmdd'))
		              and  a.ORDR_SNO = nvl(#{afiOrdrSnoStr}, a.ORDR_SNO)
		              and  a.ORDR_UPDT_SNO = nvl(#{afiOrdrUpdtSnoStr} , a.ORDR_UPDT_SNO)
		              and  ((#{strtYmd} is null) or
		                    ((#{strtYmd} is not null) and (a.FRST_RGST_DT between to_date(#{strtYmd}, 'yyyymmdd')
		                                                             and to_date(#{fnshYmd}, 'yyyymmdd') + 0.99999)))
		              and  a.ORDR_UPDT_CLMN_NM = nvl(#{ordrUpdtClmnNm}, a.ORDR_UPDT_CLMN_NM)
		              and  a.ORDR_UPDT_ORDV_CD = '2' /*  검사처방만 */
		              and  b.PTNO = a.PTNO
		              and  b.ORDR_YMD = a.ORDR_YMD
		              and  b.ORDR_SNO = a.ORDR_SNO
		              and  b.ODDR_ID  = nvl(#{oddrId}, b.ODDR_ID)
		              and  b.DC_DVSN_CD = 'N'
		              and  c.ORDR_CD  = b.ORDR_CD
		              and  f.COMN_GRP_CD = 'MDP_050' /*  처방전수정요청상태구분 */
		              and  f.COMN_DTLS_CD = a.ORDR_UPDT_STTS_CD
		              and  h.DPRT_CD = b.MCDP_CD
		              and  z.MDCR_CTRL_CD = 'MDP_206'
		              and  z.MDCR_DTLS_CTRL_CD = a.ORDR_UPDT_CLMN_NM
		              and  t.USER_ID = a.FRST_RGSR_ID
		              and  i.DPRT_CD = t.MDCR_DPRT_CD
		            union
		              all
		          select  /*+ NO_EXPAND LEADING(A, B) USE_NL(B, C, F, H, I, Z, T) mdd_ordupbt_l01$S01_처방전_수정_승인_목록_조회_DAM */
		                  a.ORDR_UPDT_STTS_CD                                              as ORDR_UPDT_STTS_CD
		               ,  f.DETL_CD_NM                                                     as DETL_CD_NM
		               ,  a.PTNO                                                           as PTNO
		               ,  (select p.PTNT_NM
		                     from APPTPTNTT p
		                    where p.PTNO = a.PTNO)                                         as PTNT_NM
		               ,  b.MCDP_CD                                                        as MCDP_CD
		               ,  h.ABRV_DPRT_CD                                                   as ABRV_DPRT_CD
		               ,  h.KORN_DPRT_NM                                                   as KORM_DPRT_NM
		               ,  to_char(a.ORDR_YMD, 'yyyymmdd')                                  as ORDR_YMD
		               ,  a.ORDR_SNO                                                       as ORDR_SNO
		               ,  b.ORDR_CD                                                        as ORDR_CD
		               ,  c.ORDR_NM                                                        as ORDR_NM
		               ,  a.ORDR_UPDT_ORDV_CD                                              as ORDR_UPDT_ORDV_CD
		               ,  a.ORDR_UPDT_CLMN_NM                                              as ORDR_UPDT_CLMN_NM
		               ,  (select COMMENTS
		                     from ALL_COL_COMMENTS
		                    where OWNER = 'SEHRMGR'
		                      and TABLE_NAME = case a.ORDR_UPDT_ORDV_CD when '3' then 'MDTRTORDT'
		                                                                when '4' then 'MDTRTORDT' end
		                      and COLUMN_NAME = a.ORDR_UPDT_CLMN_NM )                      as CLMN_NM
		               ,  a.ORDR_UPDT_BEFR_CLMN_VL                                         as ORDR_UPDT_BEFR_CLMN_VL
		               ,  a.ORDR_UPDT_AFTR_CLMN_VL                                         as ORDR_UPDT_AFTR_CLMN_VL
		               , decode(a.ORDR_UPDT_BEFR_CLMN_VL, 'NULL', '-',
		                 nvl((case a.ORDR_UPDT_CLMN_NM when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                           from CCCMCDDMT
		                                                                          where COMN_GRP_CD = 'AI041'
		                                                                            and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                              else a.ORDR_UPDT_BEFR_CLMN_VL end ) , '-'))
		               , decode(a.ORDR_UPDT_AFTR_CLMN_VL, 'NULL', '-',
		                 nvl((case a.ORDR_UPDT_CLMN_NM when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                           from CCCMCDDMT
		                                                                          where COMN_GRP_CD = 'AI041'
		                                                                            and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                              else a.ORDR_UPDT_AFTR_CLMN_VL end ) , '-')) as ORDR_UPDT_AFTR_CLMN_VL_1
		               ,  a.ORDR_UPDT_TYPE_CD                                                       as ORDR_UPDT_TYPE_CD
		               ,  a.UPDT_RQST_RESN_CTN                                                      as UPDT_RQST_RESN_CTN
		               ,  a.APRV_BFAF_PTNT_INFT_DVSN_CD                                             as APRV_BFAF_PTNT_INFT_DVSN_CD
		               ,  a.PTNT_INFT_EXLR_ID                                                       as PTNT_INFT_EXLR_ID
		               ,  (select USER_NM
		                     from CCUSRDPHT
		                    where USER_ID = a.PTNT_INFT_EXLR_ID)                                    as AFI_PTNT_INFT_EXLR_NM
		               ,  a.ORDR_UPDT_SNO                                                           as ORDR_UPDT_SNO
		               ,  a.PTNT_INFT_DSCR_TGPR_NM                                                  as PTNT_INFT_DSCR_TGPR_NM
		               ,  a.PTNT_INFT_DSCR_YMD                                                      as PTNT_INFT_DSCR_YMD
		               ,  a.READ_FINS_YN                                                            as READ_FINS_YN
		               ,  a.OHPR_RE_HNDV_FINS_YN                                                    as OHPR_RE_HNDV_FINS_YN
		               ,  to_char(a.FRST_RGST_DT, 'yyyymmddhh24miss')                               as FRST_RGST_DT
		               ,  a.FRST_RGSR_ID                                                            as FRST_RGSR_ID
		               ,  z.MDCR_CTRL_CHRC_VL1                                                      as MDCR_CTRL_CHRC_VL1
		               ,  z.MDCR_CTRL_CHRC_VL2                                                      as MDCR_CTRL_CHRC_VL2
		               ,  b.CRTF_DVSN_CD                                                            as CRTF_DVSN_CD
		               ,  a.PTNT_INFT_DSCR_TRGT_DVSN_CD                                             as PTNT_INFT_DSCR_TRGT_DVSN_CD
		               ,  (select MDCR_DTLS_CTRL_NM
		                     from MZCTRLMMT
		                    where MDCR_CTRL_CD = 'MDX_105'
		                      and MDCR_DTLS_CTRL_CD = a.PTNT_INFT_DSCR_TRGT_DVSN_CD)                as PTNT_INFT_DSCR_TRGT_DVSN_NM
		               ,  t.USER_NM                                                                 as USER_NM
		               ,  t.MDCR_DPRT_CD                                                            as MDCR_DPRT_CD
		               ,  i.ABRV_DPRT_CD                                                            as ABRV_DPRT_CD_1
		               ,  i.KORN_DPRT_NM                                                            as KORN_DPRT_NM_1
		               ,  a.LAST_UPDR_ID                                                            as LAST_UPDR_ID
		               ,  to_char(a.APRV_DT, 'yyyymmddhh24miss')                               as LAST_UPDT_DT
		               ,  (select USER_NM
		                     from CCUSRDPHT
		                    where USER_ID = a.LAST_UPDR_ID)                                         as LAST_UPDR_NM
		               ,  nvl(b.GNDR_ID, b.CHDR_ID)                                                                 as GNDR_ID
		               ,  a.APRV_DR_ID                                                              as APRV_DR_ID
		               ,  a.APRV_RQPR_ID                                                            as APRV_RQPR_ID
		               ,  b.MDRP_NO                                                                 as MDRP_NO
		               ,  b.CODV_CD                                                                 as CODV_CD
		            from  /*  MDORDUPBT a */
		                  (
		                  select /*+ INDEX(A (PTNO)) */
		                          a.PTNO
		                        , a.ORDR_YMD
		                        , a.ORDR_SNO
		                        , a.ORDR_UPDT_SNO
		                        , a.ORDR_UPDT_ORDV_CD
		                        , a.ORDR_UPDT_CLMN_NM
		                        , a.ORDR_UPDT_BEFR_CLMN_VL
		                        , a.ORDR_UPDT_AFTR_CLMN_VL
		                        , a.ORDR_UPDT_STTS_CD
		                        , a.ORDR_UPDT_TYPE_CD
		                        , a.UPDT_RQST_RESN_CTN
		                        , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                        , a.PTNT_INFT_EXLR_ID
		                        , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                        , a.PTNT_INFT_DSCR_TGPR_NM
		                        , a.PTNT_INFT_DSCR_YMD
		                        , a.APRV_DR_ID
		                        , a.APRV_RQPR_ID
		                        , a.APRV_DT
		                        , a.READ_FINS_YN
		                        , a.OHPR_RE_HNDV_FINS_YN
		                        , a.FRST_RGST_DT
		                        , a.FRST_RGSR_ID
		                        , a.LAST_UPDT_DT
		                        , a.LAST_UPDR_ID
		                    from MDORDUPBT a
		                   where #{ptno} is not null
		                     and a.PTNO     = #{ptno}
		                   union all
		                  select /*+ NO_EXPAND FULL(A) */
		                          a.PTNO
		                        , a.ORDR_YMD
		                        , a.ORDR_SNO
		                        , a.ORDR_UPDT_SNO
		                        , a.ORDR_UPDT_ORDV_CD
		                        , a.ORDR_UPDT_CLMN_NM
		                        , a.ORDR_UPDT_BEFR_CLMN_VL
		                        , a.ORDR_UPDT_AFTR_CLMN_VL
		                        , a.ORDR_UPDT_STTS_CD
		                        , a.ORDR_UPDT_TYPE_CD
		                        , a.UPDT_RQST_RESN_CTN
		                        , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                        , a.PTNT_INFT_EXLR_ID
		                        , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                        , a.PTNT_INFT_DSCR_TGPR_NM
		                        , a.PTNT_INFT_DSCR_YMD
		                        , a.APRV_DR_ID
		                        , a.APRV_RQPR_ID
		                        , a.APRV_DT
		                        , a.READ_FINS_YN
		                        , a.OHPR_RE_HNDV_FINS_YN
		                        , a.FRST_RGST_DT
		                        , a.FRST_RGSR_ID
		                        , a.LAST_UPDT_DT
		                        , a.LAST_UPDR_ID
		                    from MDORDUPBT a
		                   where #{ptno} is null
		                  )                a
		               ,  MDTRTORDT b
		               ,  MDORDRCMT c
		               ,  CCCMCDDMT f
		               ,  HZDEPTMMT h
		               ,  HZDEPTMMT i
		               ,  MZCTRLMMT z
		               ,  CCUSRDPHT t
		           where  1 = 1
		             and  nvl(#{ordrUpdtOrdvCd} , a.ORDR_UPDT_ORDV_CD) in ('3', '4')
		             and  a.PTNO     = nvl(#{ptno} , a.PTNO)
		             and  a.ORDR_YMD = decode(#{ordrYmd}, '', a.ORDR_YMD, to_date( #{ordrYmd}, 'yyyymmdd'))
		             and  a.ORDR_SNO = nvl(#{afiOrdrSnoStr}, a.ORDR_SNO)
		             and  a.ORDR_UPDT_SNO = nvl(#{afiOrdrUpdtSnoStr} , a.ORDR_UPDT_SNO)
		             and  ((#{strtYmd} is null) or
		                   ((#{strtYmd} is not null) and (a.FRST_RGST_DT between to_date(#{strtYmd}, 'yyyymmdd')
		                                                            and to_date(#{fnshYmd}, 'yyyymmdd') + 0.99999)))
		             and  a.ORDR_UPDT_CLMN_NM = nvl(#{ordrUpdtClmnNm}, a.ORDR_UPDT_CLMN_NM)
		             and  b.PTNO = a.PTNO
		             and  b.ORDR_YMD = a.ORDR_YMD
		             and  b.ORDR_SNO = a.ORDR_SNO
		             and  b.ODDR_ID  = nvl(#{oddrId}, b.ODDR_ID)
		             and  b.DC_DVSN_CD = 'N'
		             and  c.ORDR_CD  = b.ORDR_CD
		             and  f.COMN_GRP_CD = 'MDP_050' /*  처방전수정요청상태구분 */
		             and  f.COMN_DTLS_CD = a.ORDR_UPDT_STTS_CD
		             and  h.DPRT_CD = b.MCDP_CD
		             and  z.MDCR_CTRL_CD = 'MDP_207'
		             and  z.MDCR_DTLS_CTRL_CD = a.ORDR_UPDT_CLMN_NM
		             and  t.USER_ID = a.FRST_RGSR_ID
		             and  i.DPRT_CD = t.MDCR_DPRT_CD
		         union
		           all
		       select  /*+ NO_EXPAND LEADING(A, B) USE_NL(B, C, F, H, I, Z, T) mdd_ordupbt_l01$S01_처방전_수정_승인_목록_조회_DAM */
		               a.ORDR_UPDT_STTS_CD                                              as ORDR_UPDT_STTS_CD
		            ,  f.DETL_CD_NM                                                     as DETL_CD_NM
		            ,  a.PTNO                                                           as PTNO
		            ,  (select p.PTNT_NM
		                  from APPTPTNTT p
		                 where p.PTNO = a.PTNO)                                         as PTNT_NM
		            ,  b.MCDP_CD                                                        as MCDP_CD
		            ,  h.ABRV_DPRT_CD                                                   as ABRV_DPRT_CD
		            ,  h.KORN_DPRT_NM                                                   as KORM_DPRT_NM
		            ,  to_char(a.ORDR_YMD, 'yyyymmdd')                                  as ORDR_YMD
		            ,  a.ORDR_SNO                                                       as ORDR_SNO
		            ,  b.ORDR_CD                                                        as ORDR_CD
		            ,  c.ORDR_NM                                                        as ORDR_NM
		            ,  a.ORDR_UPDT_ORDV_CD                                              as ORDR_UPDT_ORDV_CD
		            ,  a.ORDR_UPDT_CLMN_NM                                              as ORDR_UPDT_CLMN_NM
		            ,  (select COMMENTS
		                  from ALL_COL_COMMENTS
		                 where OWNER = 'SEHRMGR'
		                   and TABLE_NAME = case a.ORDR_UPDT_ORDV_CD when '5' then 'MDBLDORDT' end
		                   and COLUMN_NAME = a.ORDR_UPDT_CLMN_NM )                      as CLMN_NM
		            ,  a.ORDR_UPDT_BEFR_CLMN_VL                                         as ORDR_UPDT_BEFR_CLMN_VL
		            ,  a.ORDR_UPDT_AFTR_CLMN_VL                                         as ORDR_UPDT_AFTR_CLMN_VL
		            , decode(a.ORDR_UPDT_BEFR_CLMN_VL, 'NULL', '-',
		              nvl((case a.ORDR_UPDT_CLMN_NM when 'FRNS_DPRT_CD' then (select ABRV_DPRT_CD                /*  불출부서 */
		                                                                        from HZDEPTMMT
		                                                                       where DPRT_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                           when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                        from CCCMCDDMT
		                                                                       where COMN_GRP_CD = 'AI041'
		                                                                         and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                           else a.ORDR_UPDT_BEFR_CLMN_VL end ) , '-'))
		            , decode(a.ORDR_UPDT_AFTR_CLMN_VL, 'NULL', '-',
		              nvl((case a.ORDR_UPDT_CLMN_NM when 'FRNS_DPRT_CD' then (select ABRV_DPRT_CD                /*  불출부서 */
		                                                                        from HZDEPTMMT
		                                                                       where DPRT_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                           when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                        from CCCMCDDMT
		                                                                       where COMN_GRP_CD = 'AI041'
		                                                                         and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                           else a.ORDR_UPDT_AFTR_CLMN_VL end ) , '-')) as ORDR_UPDT_AFTR_CLMN_VL_1
		            ,  a.ORDR_UPDT_TYPE_CD                                                       as ORDR_UPDT_TYPE_CD
		            ,  a.UPDT_RQST_RESN_CTN                                                      as UPDT_RQST_RESN_CTN
		            ,  a.APRV_BFAF_PTNT_INFT_DVSN_CD                                             as APRV_BFAF_PTNT_INFT_DVSN_CD
		            ,  a.PTNT_INFT_EXLR_ID                                                       as PTNT_INFT_EXLR_ID
		            ,  (select USER_NM
		                  from CCUSRDPHT
		                 where USER_ID = a.PTNT_INFT_EXLR_ID)                                    as AFI_PTNT_INFT_EXLR_NM
		            ,  a.ORDR_UPDT_SNO                                                           as ORDR_UPDT_SNO
		            ,  a.PTNT_INFT_DSCR_TGPR_NM                                                  as PTNT_INFT_DSCR_TGPR_NM
		            ,  a.PTNT_INFT_DSCR_YMD                                                      as PTNT_INFT_DSCR_YMD
		            ,  a.READ_FINS_YN                                                            as READ_FINS_YN
		            ,  a.OHPR_RE_HNDV_FINS_YN                                                    as OHPR_RE_HNDV_FINS_YN
		            ,  to_char(a.FRST_RGST_DT, 'yyyymmddhh24miss')                               as FRST_RGST_DT
		            ,  a.FRST_RGSR_ID                                                            as FRST_RGSR_ID
		            ,  z.MDCR_CTRL_CHRC_VL1                                                      as MDCR_CTRL_CHRC_VL1
		            ,  z.MDCR_CTRL_CHRC_VL2                                                      as MDCR_CTRL_CHRC_VL2
		            ,  b.CRTF_DVSN_CD                                                            as CRTF_DVSN_CD
		            ,  a.PTNT_INFT_DSCR_TRGT_DVSN_CD                                             as PTNT_INFT_DSCR_TRGT_DVSN_CD
		            ,  (select MDCR_DTLS_CTRL_NM
		                  from MZCTRLMMT
		                 where MDCR_CTRL_CD = 'MDX_105'
		                   and MDCR_DTLS_CTRL_CD = a.PTNT_INFT_DSCR_TRGT_DVSN_CD)                as PTNT_INFT_DSCR_TRGT_DVSN_NM
		            ,  t.USER_NM                                                                 as USER_NM
		            ,  t.MDCR_DPRT_CD                                                            as MDCR_DPRT_CD
		            ,  i.ABRV_DPRT_CD                                                            as ABRV_DPRT_CD_1
		            ,  i.KORN_DPRT_NM                                                            as KORN_DPRT_NM_1
		            ,  a.LAST_UPDR_ID                                                            as LAST_UPDR_ID
		            ,  to_char(a.APRV_DT, 'yyyymmddhh24miss')                               as LAST_UPDT_DT
		            ,  (select USER_NM
		                  from CCUSRDPHT
		                 where USER_ID = a.LAST_UPDR_ID)                                         as LAST_UPDR_NM
		            ,  nvl(b.GNDR_ID, b.CHDR_ID)                                                                 as GNDR_ID
		            ,  a.APRV_DR_ID                                                              as APRV_DR_ID
		            ,  a.APRV_RQPR_ID                                                            as APRV_RQPR_ID
		            ,  b.MDRP_NO                                                                 as MDRP_NO
		            ,  b.CODV_CD                                                                 as CODV_CD
		         from  /*  MDORDUPBT a */
		               (
		               select /*+ INDEX(A (PTNO)) */
		                       a.PTNO
		                     , a.ORDR_YMD
		                     , a.ORDR_SNO
		                     , a.ORDR_UPDT_SNO
		                     , a.ORDR_UPDT_ORDV_CD
		                     , a.ORDR_UPDT_CLMN_NM
		                     , a.ORDR_UPDT_BEFR_CLMN_VL
		                     , a.ORDR_UPDT_AFTR_CLMN_VL
		                     , a.ORDR_UPDT_STTS_CD
		                     , a.ORDR_UPDT_TYPE_CD
		                     , a.UPDT_RQST_RESN_CTN
		                     , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                     , a.PTNT_INFT_EXLR_ID
		                     , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                     , a.PTNT_INFT_DSCR_TGPR_NM
		                     , a.PTNT_INFT_DSCR_YMD
		                     , a.APRV_DR_ID
		                     , a.APRV_RQPR_ID
		                     , a.APRV_DT
		                     , a.READ_FINS_YN
		                     , a.OHPR_RE_HNDV_FINS_YN
		                     , a.FRST_RGST_DT
		                     , a.FRST_RGSR_ID
		                     , a.LAST_UPDT_DT
		                     , a.LAST_UPDR_ID
		                 from MDORDUPBT a
		                where #{ptno} is not null
		                  and a.PTNO     = #{ptno}
		                union all
		               select /*+ NO_EXPAND FULL(A) */
		                       a.PTNO
		                     , a.ORDR_YMD
		                     , a.ORDR_SNO
		                     , a.ORDR_UPDT_SNO
		                     , a.ORDR_UPDT_ORDV_CD
		                     , a.ORDR_UPDT_CLMN_NM
		                     , a.ORDR_UPDT_BEFR_CLMN_VL
		                     , a.ORDR_UPDT_AFTR_CLMN_VL
		                     , a.ORDR_UPDT_STTS_CD
		                     , a.ORDR_UPDT_TYPE_CD
		                     , a.UPDT_RQST_RESN_CTN
		                     , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                     , a.PTNT_INFT_EXLR_ID
		                     , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                     , a.PTNT_INFT_DSCR_TGPR_NM
		                     , a.PTNT_INFT_DSCR_YMD
		                     , a.APRV_DR_ID
		                     , a.APRV_RQPR_ID
		                     , a.APRV_DT
		                     , a.READ_FINS_YN
		                     , a.OHPR_RE_HNDV_FINS_YN
		                     , a.FRST_RGST_DT
		                     , a.FRST_RGSR_ID
		                     , a.LAST_UPDT_DT
		                     , a.LAST_UPDR_ID
		                 from MDORDUPBT a
		                where #{ptno} is null
		               )                a
		            ,  MDBLDORDT b
		            ,  MDORDRCMT c
		            ,  CCCMCDDMT f
		            ,  HZDEPTMMT h
		            ,  HZDEPTMMT i
		            ,  MZCTRLMMT z
		            ,  CCUSRDPHT t
		        where  1 = 1
		          and  nvl(#{ordrUpdtOrdvCd} , a.ORDR_UPDT_ORDV_CD) = '5'
		          and  a.PTNO     = nvl(#{ptno} , a.PTNO)
		          and  a.ORDR_YMD = decode(#{ordrYmd}, '', a.ORDR_YMD, to_date( #{ordrYmd}, 'yyyymmdd'))
		          and  a.ORDR_SNO = nvl(#{afiOrdrSnoStr}, a.ORDR_SNO)
		          and  a.ORDR_UPDT_SNO = nvl(#{afiOrdrUpdtSnoStr} , a.ORDR_UPDT_SNO)
		          and  ((#{strtYmd} is null) or
		                ((#{strtYmd} is not null) and (a.FRST_RGST_DT between to_date(#{strtYmd}, 'yyyymmdd')
		                                                         and to_date(#{fnshYmd}, 'yyyymmdd') + 0.99999)))
		          and  a.ORDR_UPDT_CLMN_NM = nvl(#{ordrUpdtClmnNm}, a.ORDR_UPDT_CLMN_NM)
		          and  b.PTNO = a.PTNO
		          and  b.ORDR_YMD = a.ORDR_YMD
		          and  b.ORDR_SNO = a.ORDR_SNO
		          and  b.ODDR_ID  = nvl(#{oddrId}, b.ODDR_ID)
		          and  b.DC_DVSN_CD = 'N'
		          and  c.ORDR_CD  = b.ORDR_CD
		          and  f.COMN_GRP_CD = 'MDP_050' /*  처방전수정요청상태구분 */
		          and  f.COMN_DTLS_CD = a.ORDR_UPDT_STTS_CD
		          and  h.DPRT_CD = b.MCDP_CD
		          and  z.MDCR_CTRL_CD = 'MDP_207'
		          and  z.MDCR_DTLS_CTRL_CD = a.ORDR_UPDT_CLMN_NM
		          and  t.USER_ID = a.FRST_RGSR_ID
		          and  i.DPRT_CD = t.MDCR_DPRT_CD
		          union
		            all
		        select  /*+ NO_EXPAND LEADING(A, B) USE_NL(B, C, F, H, I, Z, T) mdd_ordupbt_l01$S01_처방전_수정_승인_목록_조회_DAM */
		                a.ORDR_UPDT_STTS_CD                                              as ORDR_UPDT_STTS_CD
		             ,  f.DETL_CD_NM                                                     as DETL_CD_NM
		             ,  a.PTNO                                                           as PTNO
		             ,  (select p.PTNT_NM
		                   from APPTPTNTT p
		                  where p.PTNO = a.PTNO)                                         as PTNT_NM
		             ,  b.MCDP_CD                                                        as MCDP_CD
		             ,  h.ABRV_DPRT_CD                                                   as ABRV_DPRT_CD
		             ,  h.KORN_DPRT_NM                                                   as KORM_DPRT_NM
		             ,  to_char(a.ORDR_YMD, 'yyyymmdd')                                  as ORDR_YMD
		             ,  a.ORDR_SNO                                                       as ORDR_SNO
		             ,  b.ORDR_CD                                                        as ORDR_CD
		             ,  c.ORDR_NM                                                        as ORDR_NM
		             ,  a.ORDR_UPDT_ORDV_CD                                              as ORDR_UPDT_ORDV_CD
		             ,  a.ORDR_UPDT_CLMN_NM                                              as ORDR_UPDT_CLMN_NM
		             ,  (select COMMENTS
		                   from ALL_COL_COMMENTS
		                  where OWNER = 'SEHRMGR'
		                    and TABLE_NAME = case a.ORDR_UPDT_ORDV_CD when '1' then 'MDMEDORDT'
		                                                              when '2' then 'MDEXMORDT' end
		                    and COLUMN_NAME = a.ORDR_UPDT_CLMN_NM )                      as CLMN_NM
		             ,  a.ORDR_UPDT_BEFR_CLMN_VL                                         as ORDR_UPDT_BEFR_CLMN_VL
		             ,  a.ORDR_UPDT_AFTR_CLMN_VL                                         as ORDR_UPDT_AFTR_CLMN_VL
		             , decode(a.ORDR_UPDT_BEFR_CLMN_VL, 'NULL', '-',
		               nvl((case a.ORDR_UPDT_CLMN_NM when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                         from CCCMCDDMT
		                                                                        where COMN_GRP_CD = 'AI041'
		                                                                          and COMN_DTLS_CD = a.ORDR_UPDT_BEFR_CLMN_VL)
		                                            else a.ORDR_UPDT_BEFR_CLMN_VL end ) , '-'))
		             , decode(a.ORDR_UPDT_AFTR_CLMN_VL, 'NULL', '-',
		               nvl((case a.ORDR_UPDT_CLMN_NM when 'ORDR_IPDV_CD'       then (select DETL_CD_NM
		                                                                         from CCCMCDDMT
		                                                                        where COMN_GRP_CD = 'AI041'
		                                                                          and COMN_DTLS_CD = a.ORDR_UPDT_AFTR_CLMN_VL)
		                                            else a.ORDR_UPDT_AFTR_CLMN_VL end ) , '-')) as ORDR_UPDT_AFTR_CLMN_VL_1
		             ,  a.ORDR_UPDT_TYPE_CD                                                       as ORDR_UPDT_TYPE_CD
		             ,  a.UPDT_RQST_RESN_CTN                                                      as UPDT_RQST_RESN_CTN
		             ,  a.APRV_BFAF_PTNT_INFT_DVSN_CD                                             as APRV_BFAF_PTNT_INFT_DVSN_CD
		             ,  a.PTNT_INFT_EXLR_ID                                                       as PTNT_INFT_EXLR_ID
		             ,  (select USER_NM
		                   from CCUSRDPHT
		                  where USER_ID = a.PTNT_INFT_EXLR_ID)                                    as AFI_PTNT_INFT_EXLR_NM
		             ,  a.ORDR_UPDT_SNO                                                           as ORDR_UPDT_SNO
		             ,  a.PTNT_INFT_DSCR_TGPR_NM                                                  as PTNT_INFT_DSCR_TGPR_NM
		             ,  a.PTNT_INFT_DSCR_YMD                                                      as PTNT_INFT_DSCR_YMD
		             ,  a.READ_FINS_YN                                                            as READ_FINS_YN
		             ,  a.OHPR_RE_HNDV_FINS_YN                                                    as OHPR_RE_HNDV_FINS_YN
		             ,  to_char(a.FRST_RGST_DT, 'yyyymmddhh24miss')                               as FRST_RGST_DT
		             ,  a.FRST_RGSR_ID                                                            as FRST_RGSR_ID
		             ,  z.MDCR_CTRL_CHRC_VL1                                                      as MDCR_CTRL_CHRC_VL1
		             ,  z.MDCR_CTRL_CHRC_VL2                                                      as MDCR_CTRL_CHRC_VL2
		             ,  b.CRTF_DVSN_CD                                                            as CRTF_DVSN_CD
		             ,  a.PTNT_INFT_DSCR_TRGT_DVSN_CD                                             as PTNT_INFT_DSCR_TRGT_DVSN_CD
		             ,  (select MDCR_DTLS_CTRL_NM
		                   from MZCTRLMMT
		                  where MDCR_CTRL_CD = 'MDX_105'
		                    and MDCR_DTLS_CTRL_CD = a.PTNT_INFT_DSCR_TRGT_DVSN_CD)                as PTNT_INFT_DSCR_TRGT_DVSN_NM
		             ,  t.USER_NM                                                                 as USER_NM
		             ,  t.MDCR_DPRT_CD                                                            as MDCR_DPRT_CD
		             ,  i.ABRV_DPRT_CD                                                            as ABRV_DPRT_CD_1
		             ,  i.KORN_DPRT_NM                                                            as KORN_DPRT_NM_1
		             ,  a.LAST_UPDR_ID                                                            as LAST_UPDR_ID
		             ,  to_char(a.APRV_DT, 'yyyymmddhh24miss')                               as LAST_UPDT_DT
		             ,  (select USER_NM
		                   from CCUSRDPHT
		                  where USER_ID = a.LAST_UPDR_ID)                                         as LAST_UPDR_NM
		             ,  nvl(b.GNDR_ID, b.CHDR_ID)                                                                 as GNDR_ID
		             ,  a.APRV_DR_ID                                                              as APRV_DR_ID
		             ,  a.APRV_RQPR_ID                                                            as APRV_RQPR_ID
		             ,  b.MDRP_NO                                                                 as MDRP_NO
		             ,  b.CODV_CD                                                                 as CODV_CD
		          from  /*  MDORDUPBT a */
		                (
		                select /*+ INDEX(A (PTNO)) */
		                        a.PTNO
		                      , a.ORDR_YMD
		                      , a.ORDR_SNO
		                      , a.ORDR_UPDT_SNO
		                      , a.ORDR_UPDT_ORDV_CD
		                      , a.ORDR_UPDT_CLMN_NM
		                      , a.ORDR_UPDT_BEFR_CLMN_VL
		                      , a.ORDR_UPDT_AFTR_CLMN_VL
		                      , a.ORDR_UPDT_STTS_CD
		                      , a.ORDR_UPDT_TYPE_CD
		                      , a.UPDT_RQST_RESN_CTN
		                      , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                      , a.PTNT_INFT_EXLR_ID
		                      , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                      , a.PTNT_INFT_DSCR_TGPR_NM
		                      , a.PTNT_INFT_DSCR_YMD
		                      , a.APRV_DR_ID
		                      , a.APRV_RQPR_ID
		                      , a.APRV_DT
		                      , a.READ_FINS_YN
		                      , a.OHPR_RE_HNDV_FINS_YN
		                      , a.FRST_RGST_DT
		                      , a.FRST_RGSR_ID
		                      , a.LAST_UPDT_DT
		                      , a.LAST_UPDR_ID
		                  from MDORDUPBT a
		                 where #{ptno} is not null
		                   and a.PTNO     = #{ptno}
		                 union all
		                select /*+ NO_EXPAND FULL(A) */
		                        a.PTNO
		                      , a.ORDR_YMD
		                      , a.ORDR_SNO
		                      , a.ORDR_UPDT_SNO
		                      , a.ORDR_UPDT_ORDV_CD
		                      , a.ORDR_UPDT_CLMN_NM
		                      , a.ORDR_UPDT_BEFR_CLMN_VL
		                      , a.ORDR_UPDT_AFTR_CLMN_VL
		                      , a.ORDR_UPDT_STTS_CD
		                      , a.ORDR_UPDT_TYPE_CD
		                      , a.UPDT_RQST_RESN_CTN
		                      , a.APRV_BFAF_PTNT_INFT_DVSN_CD
		                      , a.PTNT_INFT_EXLR_ID
		                      , a.PTNT_INFT_DSCR_TRGT_DVSN_CD
		                      , a.PTNT_INFT_DSCR_TGPR_NM
		                      , a.PTNT_INFT_DSCR_YMD
		                      , a.APRV_DR_ID
		                      , a.APRV_RQPR_ID
		                      , a.APRV_DT
		                      , a.READ_FINS_YN
		                      , a.OHPR_RE_HNDV_FINS_YN
		                      , a.FRST_RGST_DT
		                      , a.FRST_RGSR_ID
		                      , a.LAST_UPDT_DT
		                      , a.LAST_UPDR_ID
		                  from MDORDUPBT a
		                 where #{ptno} is null
		                )                a
		             ,  MDREHORDT b
		             ,  MDORDRCMT c
		             ,  CCCMCDDMT f
		             ,  HZDEPTMMT h
		             ,  HZDEPTMMT i
		             ,  MZCTRLMMT z
		             ,  CCUSRDPHT t
		         where  1 = 1
		           and  nvl(#{ordrUpdtOrdvCd} , a.ORDR_UPDT_ORDV_CD) = '6'
		           and  a.PTNO     = nvl(#{ptno} , a.PTNO)
		           and  a.ORDR_YMD = decode(#{ordrYmd}, '', a.ORDR_YMD, to_date( #{ordrYmd}, 'yyyymmdd'))
		           and  a.ORDR_SNO = nvl(#{afiOrdrSnoStr}, a.ORDR_SNO)
		           and  a.ORDR_UPDT_SNO = nvl(#{afiOrdrUpdtSnoStr} , a.ORDR_UPDT_SNO)
		           and  ((#{strtYmd} is null) or
		                 ((#{strtYmd} is not null) and (a.FRST_RGST_DT between to_date(#{strtYmd}, 'yyyymmdd')
		                                                          and to_date(#{fnshYmd}, 'yyyymmdd') + 0.99999)))
		           and  a.ORDR_UPDT_CLMN_NM = nvl(#{ordrUpdtClmnNm}, a.ORDR_UPDT_CLMN_NM)
		           and  b.PTNO = a.PTNO
		           and  b.ORDR_YMD = a.ORDR_YMD
		           and  b.ORDR_SNO = a.ORDR_SNO
		           and  b.ODDR_ID  = nvl(#{oddrId}, b.ODDR_ID)
		           and  b.DC_DVSN_CD = 'N'
		           and  c.ORDR_CD  = b.ORDR_CD
		           and  f.COMN_GRP_CD = 'MDP_050' /*  처방전수정요청상태구분 */
		           and  f.COMN_DTLS_CD = a.ORDR_UPDT_STTS_CD
		           and  h.DPRT_CD = b.MCDP_CD
		           and  z.MDCR_CTRL_CD = 'MDP_207'
		           and  z.MDCR_DTLS_CTRL_CD = a.ORDR_UPDT_CLMN_NM
		           and  t.USER_ID = a.FRST_RGSR_ID
		           and  i.DPRT_CD = t.MDCR_DPRT_CD
		        ) t
		    where
		            (  (     (#{inptVl} is not null )
		                 and (t.PTNT_INFT_EXLR_ID is null   ))
		            or
		               (#{inptVl} is null)
		            )
		       and  (
		              (#{ordrUpdtSttsCd} ||#{ordrUpdtSttsCd1}||
		               #{ordrUpdtSttsCd2}||#{ordrUpdtSttsCd3}||
		               #{ordrUpdtSttsCd4}||#{ordrUpdtSttsCd5} is null
		              )
		              or
		              (t.ORDR_UPDT_STTS_CD in (#{ordrUpdtSttsCd}, #{ordrUpdtSttsCd1}, #{ordrUpdtSttsCd2},
		                                       #{ordrUpdtSttsCd3}, #{ordrUpdtSttsCd4}, #{ordrUpdtSttsCd5})
		              )
		            )
		    order
		       by  t.ORDR_UPDT_STTS_CD
		        ,  t.ORDR_UPDT_ORDV_CD
		        ,  t.FRST_RGST_DT
		        ,  t.PTNO
		        ,  t.ORDR_YMD
		        ,  t.ORDR_SNO
		    ]]>
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-insertPrtxUpdtRqstInfm () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
    -->	
	<insert id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-insertPrtxUpdtRqstInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  >
		insert  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-insertPrtxUpdtRqstInfm */
		   into  MDORDUPBT
		     (
		         PTNO  /*  환자번호 */
		      ,  ORDR_YMD  /*  처방일자 */
		      ,  ORDR_SNO  /*  처방일련번호 */
		      ,  ORDR_UPDT_SNO  /*  처방수정일련번호 */
		      ,  ORDR_UPDT_ORDV_CD  /*  처방수정처방구분코드 */
		      ,  ORDR_UPDT_CLMN_NM  /*  처방수정컬럼명 */
		      ,  ORDR_UPDT_BEFR_CLMN_VL  /*  처방수정이전컬럼값 */
		      ,  ORDR_UPDT_AFTR_CLMN_VL  /*  처방수정이후컬럼값 */
		      ,  ORDR_UPDT_STTS_CD  /*  처방수정상태코드 */
		      ,  ORDR_UPDT_TYPE_CD  /*  처방수정유형코드 */
		      ,  UPDT_RQST_RESN_CTN  /*  수정요청사유내용 */
		      ,  APRV_BFAF_PTNT_INFT_DVSN_CD /*  승인전후환자안내구분코드 */
		      ,  PTNT_INFT_EXLR_ID  /*  환자안내설명자ID */
		      ,  PTNT_INFT_DSCR_TRGT_DVSN_CD /*  환자안내설명대상구분코드 */
		      ,  PTNT_INFT_DSCR_TGPR_NM  /*  환자안내설명대상자명 */
		      ,  PTNT_INFT_DSCR_YMD  /*  환자안내설명일자 */
		      ,  READ_FINS_YN  /*  재정산완료여부 */
		      ,  OHPR_RE_HNDV_FINS_YN  /*  원외처방전재교부완료여부 */
		      ,  APRV_RQPR_ID
		      ,  APRV_DR_ID
		      ,  APRV_DT
		      ,  FRST_RGSR_ID
		      ,  FRST_RGST_IP
		      ,  FRST_RGST_DT
		      ,  FRST_RGST_CLNT_PRGM_ID
		      ,  FRST_RGST_SRVR_PRGM_ID
		      ,  LAST_UPDR_ID
		      ,  LAST_UPDT_IP
		      ,  LAST_UPDT_DT
		      ,  LAST_UPDT_CLNT_PRGM_ID
		      ,  LAST_UPDT_SRVR_PRGM_ID
		     )
		    values
		    (
		         #{ptno}  /*  환자번호 */
		      ,  to_date(#{ordrYmd},'yyyymmdd')  /*  처방일자 */
		      ,  #{ordrSno}  /*  처방일련번호 */
		      ,  (select nvl(max(ordr_updt_sno)+1, 1)
		            from MDORDUPBT
		           where PTNO = #{ptno}
		             and ORDR_YMD = to_date(#{ordrYmd},'yyyymmdd')
		             and ORDR_SNO = #{ordrSno} )  /*  처방수정일련번호 */
		      ,  #{ordrUpdtOrdvCd}  /*  처방수정처방구분코드(not null) */
		      ,  #{ordrUpdtClmnNm}  /*  처방수정컬럼명 (not null)*/
		      ,  #{ordrUpdtBefrClmnVl}  /*  처방수정이전컬럼값 (not null)*/
		      ,  #{ordrUpdtAftrClmnVl}  /*  처방수정이후컬럼값 (not null)*/
		      ,  #{ordrUpdtSttsCd}  /*  처방수정상태코드 (not null)*/
		      ,  #{ordrUpdtTypeCd}  /*  처방수정유형코드 (not null)*/
		      ,  #{updtRqstResnCtn}  /*  수정요청사유내용 (not null)*/
		      ,  #{aprvBfafPtntInftDvsnCd}  /*  승인전후환자안내구분코드 */
		      ,  #{ptntInftExlrId}  /*  환자안내설명자ID */
		      ,  #{ptntInftDscrTrgtDvsnCd}  /*  환자안내설명대상구분코드 */
		      ,  #{ptntInftDscrTgprNm}  /*  환자안내설명대상자명 */
		      ,  to_date(#{ptntInftDscrYmd}, 'YYYYMMDD' )  /*  환자안내설명일자 */
		      ,  #{readFinsYn}  /*  재정산완료여부 */
		      ,  #{ohprReHndvFinsYn}  /*  원외처방전재교부완료여부 */
		      ,  #{afcSrcUserId}
		      ,  case when #{ordrUpdtSttsCd} = '0' then null
		              when #{ordrUpdtSttsCd} = '1' then null
		              when #{ordrUpdtSttsCd} = '2' then #{afcSrcUserId}
		              else null
		          end
		      ,  case when #{ordrUpdtSttsCd} = '0' then null
		              when #{ordrUpdtSttsCd} = '1' then null
		              when #{ordrUpdtSttsCd} = '2' then sysdate
		              else null
		          end
		      ,  #{gvUserId}  /*  최초등록자ID */
		      ,  #{gvUserIp}  /*  최초등록IP */
		      ,  sysdate  /*  최초등록일시 */
		      ,  #{gvClntPrgmId}  /*  최초등록SMC클라이언트프로그램ID */
		      ,  #{gvSrvrPrgmId}  /*  최초등록SMC서버프로그램ID */
		      ,  #{gvUserId}  /*  최종수정자ID */
		      ,  #{gvUserIp}  /*  최종수정IP */
		      ,  sysdate  /*  최종수정일시 */
		      ,  #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		      ,  #{gvSrvrPrgmId}  /*  최종수정SMC서버프로그램ID */
		      )
	</insert>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtDrugBndl (처방전 수정 약주사 묶음번호 수정) 
        Description :                                           처방전 수정을 통해 묶음번호 수정요청한 정보를 기존 약주사처방에 저장한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtDrugBndl"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  >
		update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtDrugBndl */
		            MDMEDORDT
		      set  DRBN_NO  = decode(#{drbnNo}, 0, null, #{drbnNo})
		          ,  ORDR_UPDT_DT = sysdate          /*  처방수정일시*/
		          ,  ORDR_UPDR_ID = #{gvUserId}      /*  처방수정자ID*/
		          ,  LAST_UPDR_ID = #{gvUserId}       /*  최종수정자ID */
		          ,  LAST_UPDT_IP = #{gvUserIp}        /*  최종수정IP */
		          ,  LAST_UPDT_DT = sysdate           /*  최종수정일시 */
		          ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		          ,  LAST_UPDT_SRVR_PRGM_ID  = #{gvSrvrPrgmId} /*  최종수정SMC서버프로그램ID */
		 where  PTNO = #{ptno}
		    and  ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
			and  ORDR_SNO = #{ordrSno}
	</update>


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstDrug-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="vatTrgtYn" column="VAT_TRGT_YN"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="sdpfExreCd" column="SDPF_EXRE_CD"/>
		<result property="injcPrrnYmd" column="INJC_PRRN_YMD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="drbnNo" column="DRBN_NO"/>
		<result property="sngnBndlYn" column="SNGN_BNDL_YN"/>
		<result property="mixKindCd" column="MIX_KIND_CD"/>
		<result property="erFrnsYn" column="ER_FRNS_YN"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="ihohDvsnCd" column="IHOH_DVSN_CD"/>
		<result property="ststDvsnCd" column="STST_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="oddrNm" column="ODDR_NM"/>
		<result property="oddrMcdpCd" column="ODDR_MCDP_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="drusCd" column="DRUS_CD"/>
		<result property="ntm" column="NTM"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="sbdpDprtCd" column="SBDP_DPRT_CD"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="drugOrdrPrssCd" column="DRUG_ORDR_PRSS_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="drugOrdrPrssNm" column="DRUG_ORDR_PRSS_NM"/>
		<result property="afiRcstNm" column="AFI_RCST_NM"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="careWardCd" column="CARE_WARD_CD"/>
		<result property="ptadPtgoCd" column="PTAD_PTGO_CD"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="vatTrgtCd" column="VAT_TRGT_CD"/>
		<result property="mdprClsfCd" column="MDPR_CLSF_CD"/>
		<result property="ddcn" column="DDCN"/>
		<result property="inptVl" column="INPT_VL"/>
		<result property="ptadMdrpNo" column="PTAD_MDRP_NO"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
		<result property="ptadClbaYmd" column="PTAD_CLBA_YMD"/>
		<result property="subTypeCd" column="SUB_TYPE_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstDrug () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstDrug-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstDrug"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstDrug-result" useCache="true" flushCache="false">
		<![CDATA[
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstDrug */
		         a.PTNO as PTNO  /* 환자번호 */
		      ,  to_char(a.ORDR_YMD,'YYYYMMDD') as ORDR_YMD  /* 처방일자 */
		      ,  a.ORDR_SNO as ORDR_SNO  /* 처방일련번호 */
		      ,  a.MDRP_NO as MDRP_NO  /* 진료접수번호 */
		      ,  a.ORDR_CD as ORDR_CD  /* 처방코드 */
		      ,  a.VAT_TRGT_YN as VAT_TRGT_YN  /* 부가세대상여부 */
		      ,  a.ORDR_IPDV_CD as ORDR_IPDV_CD  /* (처방급여구분코드)  보험급여구분(AI041) */
		      ,  a.SDPF_EXRE_CD as SDPF_EXRE_CD  /* 의약분업예외사유코드 */
		      ,  to_char(a.INJC_PRRN_YMD,'YYYYMMDD') as INJC_PRRN_YMD  /* 주사예정일자 */
		      ,  a.FRNS_DPRT_CD as FRNS_DPRT_CD  /* 불출부서코드 */
		      ,  a.DRBN_NO as DRBN_NO  /* 약묶음번호 */
		      ,  a.SNGN_BNDL_YN as SNGN_BNDL_YN  /* 단독묶음여부 */
		      ,  a.MIX_KIND_CD as MIX_KIND_CD  /* 혼합종류코드 */
		      ,  a.ER_FRNS_YN as ER_FRNS_YN  /* 응급불출여부 */
		      ,  a.ORFR_CD as ORFR_CD  /* 처방형태코드 */
		      ,  a.CLRS_PRJC_CD as CLRS_PRJC_CD  /* 임상연구과제코드 */
		      ,  a.ORDR_CLTY_CD as ORDR_CLTY_CD
		      ,  a.IHOH_DVSN_CD as IHOH_DVSN_CD  /* 원내원외구분코드 */
		      ,  b.STST_DVSN_CD as STST_DVSN_CD  /* 통계구분코드 */
		      ,  a.CRTF_DVSN_CD as CRTF_DVSN_CD
		      ,  a.CODV_CD as CODV_CD
		      ,  a.ODDR_ID as ODDR_ID
		      ,  c.USER_NM as ODDR_NM
		      ,  c.MDCR_DPRT_CD as ODDR_MCDP_CD
		      ,  b.ORDR_NM as ORDR_NM
		      ,  p.ISTY_CD as ISTY_CD
		      ,  p.ISTY_ASST_CD as ISTY_ASST_CD
		      ,  a.MCDP_CD as MCDP_CD
		      ,  a.ORCL_CD as ORCL_CD
		      ,  a.ODKI_CD as ODKI_CD
		      ,  a.DRUS_CD as DRUS_CD
		      ,  a.NTM as NTM
		      ,  a.PTAD_CODV_CD as PTAD_CODV_CD
		      ,  a.WARD_CD as WARD_CD
		      ,  a.DC_DVSN_CD as DC_DVSN_CD
		      ,  a.TMPR_ORDR_YN as TMPR_ORDR_YN
		      ,  a.OROC_DPRT_CD as OROC_DPRT_CD
		      ,  ( select  t.HRAF_PRAP_DPRT_CD
		            from  CCUSRDPHT t
		          where  t.USER_ID = a.ODDR_ID) as SBDP_DPRT_CD
		      ,  a.GNDR_ID as GNDR_ID
		      ,  to_char(p.MDCR_DT, 'yyyymmddhh24miss') as MDCR_DT
		      ,  a.HSLC_DVSN_CD as HSLC_DVSN_CD
		      ,  nvl(a.DRUG_ORDR_PRSS_CD, '0') as DRUG_ORDR_PRSS_CD
		       ,  nvl( a.RCST_CD , 'N') as RCST_CD
		      ,  ( select  c.DETL_CD_NM
		            from  CCCMCDDMT c
		          where  c.COMN_GRP_CD  = 'SD011'
		             and  c.COMN_DTLS_CD = nvl(a.DRUG_ORDR_PRSS_CD, '0')
		         ) as DRUG_ORDR_PRSS_NM
		      ,  ( select  d.DETL_CD_NM
		            from  CCCMCDDMT d
		          where  d.COMN_GRP_CD  = 'ACA_037'
		             and d.COMN_DTLS_CD = nvl( a.RCST_CD , 'N' )
		         ) as AFI_RCST_NM
		      ,  a.CHDR_ID as CHDR_ID
		      ,  a.MCCN_CD as MCCN_CD
		      ,  p.CARE_WARD_CD as CARE_WARD_CD
		      ,  a.PTAD_PTGO_CD as PTAD_PTGO_CD
		      ,  a.ORDR_CRTN_DVSN_CD as ORDR_CRTN_DVSN_CD
		      ,  p.VAT_TRGT_CD as VAT_TRGT_CD
		      ,  b.MDPR_CLSF_CD as MDPR_CLSF_CD
		      ,  a.DDCN as DDCN
		      ,  nvl(a.PHDP_PRIN_YN, 'N') as INPT_VL
		      ,  PTAD_MDRP_NO as PTAD_MDRP_NO
		      ,  PTAD_CODV_CD as PTAD_CODV_CD
		      ,  PTAD_CLBA_YMD as PTAD_CLBA_YMD
		      ,  a.SUB_TYPE_CD as SUB_TYPE_CD
		  from  MDMEDORDT a
		     ,  MDORDRCMT b
		     ,  CCUSRDPHT c
		     ,  APRCRPTNT p /*  진료접수 */
		     ,  SDDDGCDMT s /*  약품코드 */
		 where  a.PTNO = #{ptno}
		   and  a.ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		   and  a.ORDR_SNO = #{ordrSno}
		   and  a.DC_DVSN_CD = 'N'
		   and  b.ORDR_CD = a.ORDR_CD
		   and  c.USER_ID(+) = a.ODDR_ID
		   and  p.MDRP_NO = a.MDRP_NO
		   and  s.MDPR_CD(+) = a.ORDR_CD
		   and  rownum < 2
		 order
		    by  a.ORDR_SNO
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstExmn-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="vatTrgtYn" column="VAT_TRGT_YN"/>
		<result property="mdcrBeexYn" column="MDCR_BEEX_YN"/>
		<result property="wntdDt" column="WNTD_DT"/>
		<result property="exmnWntdDrId" column="EXMN_WNTD_DR_ID"/>
		<result property="afiExmnWntdDrNm" column="AFI_EXMN_WNTD_DR_NM"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="ststDvsnCd" column="STST_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="oddrNm" column="ODDR_NM"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="vatTrgtCd" column="VAT_TRGT_CD"/>
		<result property="nnmtExmnYn" column="NNMT_EXMN_YN"/>
		<result property="nnmtExmnNtfcYmd" column="NNMT_EXMN_NTFC_YMD"/>
		<result property="exorPrssCd" column="EXOR_PRSS_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="exorPrssNm" column="EXOR_PRSS_NM"/>
		<result property="afiRcstNm" column="AFI_RCST_NM"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="oddrMcdpCd" column="ODDR_MCDP_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="excfCd" column="EXCF_CD"/>
		<result property="ptadMdrpNo" column="PTAD_MDRP_NO"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
		<result property="erExmnPsblYn" column="ER_EXMN_PSBL_YN"/>
		<result property="mvmnDvsnCd" column="MVMN_DVSN_CD"/>
		<result property="prtbYn" column="PRTB_YN"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstExmn (처방전 수정요청 내역조회 검사) 
        Description :                                           내려진 검사처방에 대해 처방전 수정을 요청한 목록을 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstExmn-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstExmn"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstExmn-result" useCache="true" flushCache="false">
		<![CDATA[
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstExmn */
		           a.PTNO as PTNO  /*  환자번호 */
		        ,  to_char(a.ORDR_YMD, 'yyyymmdd') as ORDR_YMD  /*  처방일자 */
		        ,  a.ORDR_SNO as ORDR_SNO  /*  처방순 */
		        ,  a.MDRP_NO as MDRP_NO  /*  진료접수번호 */
		        ,  a.ORDR_CD as ORDR_CD  /*  처방코드 */
		        ,  a.ORFR_CD as ORFR_CD  /*  처방타입 */
		        ,  a.ORDR_IPDV_CD as ORDR_IPDV_CD  /*  급여구분 */
		        ,  a.VAT_TRGT_YN as VAT_TRGT_YN  /*  VAT */
		        ,  a.MDCR_BEEX_YN as MDCR_BEEX_YN  /*  진료이전검사여부번 */
		        ,  to_char(a.WNTD_DT, 'yyyymmddhh24miss') as WNTD_DT  /*  희망일시 */
		        ,  a.EXMN_WNTD_DR_ID as EXMN_WNTD_DR_ID  /*  검사희망의사ID */
		        ,  ( select  USER_NM
		              from  CCUSRDPHT
		            where  USER_ID = a.EXMN_WNTD_DR_ID) as AFI_EXMN_WNTD_DR_NM  /*  검사희망의사명 */
		        ,  a.CLRS_PRJC_CD as CLRS_PRJC_CD   /*  임상연구과제코드 */
		        ,  b.STST_DVSN_CD as STST_DVSN_CD   /*  통계구분코드 */
		        ,  a.CRTF_DVSN_CD as CRTF_DVSN_CD
		        ,  a.CODV_CD as CODV_CD
		        ,  a.ODDR_ID as ODDR_ID
		        ,  d.USER_NM as ODDR_NM
		        ,  b.ORDR_NM as ORDR_NM
		        ,  c.ISTY_CD as ISTY_CD
		        ,  c.ISTY_ASST_CD as ISTY_ASST_CD
		        ,  a.MCDP_CD as MCDP_CD
		        ,  a.ORCL_CD as ORCL_CD
		        ,  a.ODKI_CD as ODKI_CD
		        ,  c.VAT_TRGT_CD as VAT_TRGT_CD
		        ,  a.NNMT_EXMN_YN as NNMT_EXMN_YN
		        ,  to_char(a.NNMT_EXMN_NTFC_YMD, 'yyyymmdd') as NNMT_EXMN_NTFC_YMD
		        ,  nvl(a.EXOR_PRSS_CD, '0') as EXOR_PRSS_CD
		         ,  nvl ( RCST_CD , 'N') as RCST_CD
		        ,  ( select  c.DETL_CD_NM
		              from  CCCMCDDMT c
		            where  c.COMN_GRP_CD  = 'ST005'
		               and  c.COMN_DTLS_CD = nvl(a.EXOR_PRSS_CD, '0')
		           ) as EXOR_PRSS_NM
		        ,  (select  d.DETL_CD_NM
		              from  CCCMCDDMT d
		            where  d.COMN_GRP_CD  = 'ACA_037'
		               and  d.COMN_DTLS_CD = nvl( a.RCST_CD , 'N' )
		           ) as AFI_RCST_NM
		        ,  a.CHDR_ID as CHDR_ID
		        ,  a.GNDR_ID as GNDR_ID
		        ,  d.MDCR_DPRT_CD as ODDR_MCDP_CD
		        ,  a.ORDR_CLTY_CD as ORDR_CLTY_CD
		        ,  a.EXCF_CD as EXCF_CD
		        ,  a.PTAD_MDRP_NO as PTAD_MDRP_NO
		        ,  a.PTAD_CODV_CD as PTAD_CODV_CD
		        ,  b.ER_EXMN_PSBL_YN as ER_EXMN_PSBL_YN
		        ,  b.MVMN_DVSN_CD    as MVMN_DVSN_CD
		        ,  a.PRTB_YN         as PRTB_YN
		        ,  a.MCCN_CD         as MCCN_CD
		        ,  a.HSLC_DVSN_CD    as HSLC_DVSN_CD
		  from  MDEXMORDT a
		        ,  MDORDRCMT b
		        ,  APRCRPTNT c
		        ,  CCUSRDPHT d
		where  a.PTNO = #{ptno}
		   and  a.ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		   and  a.ORDR_SNO = #{ordrSno}
		   and  a.DC_DVSN_CD = 'N'
		   and  b.ORDR_CD = a.ORDR_CD
		   and  c.MDRP_NO = a.MDRP_NO
		   and  d.USER_ID(+) = a.ODDR_ID
		   and  rownum < 2
		 order
		     by  a.ORDR_SNO
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstBlodInfm-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="oddrNm" column="ODDR_NM"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="afiFrnsDprtNm" column="AFI_FRNS_DPRT_NM"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="sbdpDprtCd" column="SBDP_DPRT_CD"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="oddrMcdpCd" column="ODDR_MCDP_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="afiRcstNm" column="AFI_RCST_NM"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstBlodInfm (처방전 수정요청 내역조회 혈액) 
        Description :                                           내려진 혈액처방에 대해 처방전 수정을 요청한 목록을 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstBlodInfm-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstBlodInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstBlodInfm-result" useCache="true" flushCache="false">
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstBlodInfm */
		          a.PTNO as PTNO  /*  환자번호 */
		       ,  to_char(a.ORDR_YMD, 'yyyymmdd') as ORDR_YMD /*  처방일자 */
		       ,  a.ORDR_SNO as ORDR_SNO  /*  처방일련번호 */
		       ,  a.CODV_CD as CODV_CD  /*  내원구분코드 */
		       ,  a.MDRP_NO as MDRP_NO  /*  진료접수번호 */
		       ,  a.ORDR_IPDV_CD as ORDR_IPDV_CD  /*  처방급여구분코드 */
		       ,  a.CRTF_DVSN_CD as CRTF_DVSN_CD  /*  인증구분코드 */
		       ,  a.ODDR_ID as ODDR_ID  /*  처방의사ID */
		       ,  c.USER_NM as ODDR_NM  /*  처방의사명 */
		       ,  p.ISTY_CD as ISTY_CD  /*  보험유형코드 */
		       ,  p.isty_asst_cd as ISTY_ASST_CD  /*  보험유형보조코드 */
		       ,  a.MCDP_CD as MCDP_CD  /*  진료과코드 */
		       ,  b.ORDR_NM as ORDR_NM  /*  처방명 */
		       ,  '' as PTPT_CD  /*  환자가야할장소코드 */
		       ,  a.FRNS_DPRT_CD as FRNS_DPRT_CD  /*  불출부서코드 */
		       ,  ( select  KORN_DPRT_NM
		             from  HZDEPTMMT
		           where  DPRT_CD = a.FRNS_DPRT_CD) as AFI_FRNS_DPRT_NM /*  AFI불출부서명 */
		       ,  a.ORDR_CD as ORDR_CD
		       ,  a.ODKI_CD as ODKI_CD
		       ,  a.OROC_DPRT_CD as OROC_DPRT_CD
		       ,  ( select  t.HRAF_PRAP_DPRT_CD
		             from  CCUSRDPHT t
		           where  t.USER_ID = a.ODDR_ID) as SBDP_DPRT_CD
		       ,  a.GNDR_ID as GNDR_ID
		       ,  to_char(p.MDCR_DT, 'yyyymmddhh24miss') as MDCR_DT
		       ,  a.HSLC_DVSN_CD as HSLC_DVSN_CD
		       ,  c.MDCR_DPRT_CD as ODDR_MCDP_CD
		       ,  nvl(a.RCST_CD, 'N') as RCST_CD
		       ,  ( select  d.DETL_CD_NM
		             from  CCCMCDDMT d
		           where  d.COMN_GRP_CD  = 'ACA_037'
		              and  d.COMN_DTLS_CD = nvl( a.RCST_CD , 'N' )
		          ) as AFI_RCST_NM
		        ,  a.CHDR_ID as CHDR_ID
		        ,  a.ORFR_CD as ORFR_CD
		        ,  a.PTAD_CODV_CD as PTAD_CODV_CD
		   from  MDBLDORDT a
		        ,   MDORDRCMT b
		        ,   CCUSRDPHT c
		        ,   APRCRPTNT p /*  진료접수 */
		  where
		         a.PTNO = #{ptno}
		    and  a.ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		    and  a.ORDR_SNO = #{ordrSno}
		    and  a.DC_DVSN_CD = 'N'
		    and  b.ORDR_CD  = a.ORDR_CD
		    and  c.USER_ID(+) = a.ODDR_ID
		    and  p.MDRP_NO = a.MDRP_NO
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstOrdrFeeInfm-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="oddrNm" column="ODDR_NM"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="afiFrnsDprtNm" column="AFI_FRNS_DPRT_NM"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="sbdpDprtCd" column="SBDP_DPRT_CD"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="oddrMcdpCd" column="ODDR_MCDP_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="afiRcstNm" column="AFI_RCST_NM"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="ptadMdrpNo" column="PTAD_MDRP_NO"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstOrdrFeeInfm (처방전 처방료 처방 조회) 
        Description :                                           환자에게 내려진 처방료처방정보를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstOrdrFeeInfm-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstOrdrFeeInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstOrdrFeeInfm-result" useCache="true" flushCache="false">
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstOrdrFeeInfm */
		           a.PTNO as PTNO  /*  환자번호 */
		        ,  to_char(a.ORDR_YMD, 'yyyymmdd') as ORDR_YMD  /*  처방일자 */
		        ,  a.ORDR_SNO as ORDR_SNO  /*  처방일련번호 */
		        ,  a.CODV_CD as CODV_CD  /*  내원구분코드 */
		        ,  a.MDRP_NO as MDRP_NO  /*  진료접수번호 */
		        ,  a.ORDR_IPDV_CD as ORDR_IPDV_CD  /*  처방급여구분코드 */
		        ,  a.CRTF_DVSN_CD as CRTF_DVSN_CD  /*  인증구분코드 */
		        ,  a.ODDR_ID as ODDR_ID  /*  처방의사ID */
		        ,  c.USER_NM as ODDR_NM  /*  처방의사명 */
		        ,  p.ISTY_CD as ISTY_CD  /*  보험유형코드 */
		        ,  p.ISTY_ASST_CD as ISTY_ASST_CD  /*  보험유형보조코드 */
		        ,  a.MCDP_CD as MCDP_CD  /*  진료과코드 */
		        ,  b.ORDR_NM as ORDR_NM  /*  처방명 */
		        ,  '' as PTPT_CD  /*  환자가야할장소코드 */
		        ,  a.FRNS_DPRT_CD as FRNS_DPRT_CD  /*  불출부서코드 */
		        ,  '' as AFI_FRNS_DPRT_NM  /*  AFI불출부서명 */
		        ,  a.ORDR_CD as ORDR_CD
		        ,  a.ODKI_CD as ODKI_CD
		        ,  a.OROC_DPRT_CD as OROC_DPRT_CD
		        ,  (select t.HRAF_PRAP_DPRT_CD
		              from CCUSRDPHT t
		             where t.USER_ID = a.ODDR_ID) as SBDP_DPRT_CD
		        ,  a.GNDR_ID as GNDR_ID
		        ,  to_char(p.MDCR_DT, 'yyyymmddhh24miss') as MDCR_DT
		        ,  a.HSLC_DVSN_CD as HSLC_DVSN_CD
		        ,  c.MDCR_DPRT_CD as ODDR_MCDP_CD
		        ,  nvl(a.RCST_CD, 'N') as RCST_CD
		        ,  (select d.DETL_CD_NM
		              from CCCMCDDMT d
		             where d.COMN_GRP_CD  = 'ACA_037'
		               and d.COMN_DTLS_CD = nvl( a.RCST_CD , 'N' )
		           ) as AFI_RCST_NM
		        ,  a.CHDR_ID as CHDR_ID
		        ,  a.ORFR_CD as ORFR_CD
		        ,  a.PTAD_MDRP_NO as PTAD_MDRP_NO
		        ,  a.PTAD_CODV_CD as PTAD_CODV_CD
		   from  MDTRTORDT a
		        ,  MDORDRCMT b
		        ,  CCUSRDPHT c
		        ,  APRCRPTNT p /*  진료접수 */
		 where
		            a.PTNO = #{ptno}
		    and  a.ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		    and  a.ORDR_SNO = #{ordrSno}
		    and  a.DC_DVSN_CD = 'N'
		    and  b.ORDR_CD  = a.ORDR_CD
		    and  c.USER_ID(+) = a.ODDR_ID
		    and  p.MDRP_NO = a.MDRP_NO
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstRhblInfm-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="oddrNm" column="ODDR_NM"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="afiFrnsDprtNm" column="AFI_FRNS_DPRT_NM"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="sbdpDprtCd" column="SBDP_DPRT_CD"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="oddrMcdpCd" column="ODDR_MCDP_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="afiRcstNm" column="AFI_RCST_NM"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="orfrCd" column="ORFR_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstRhblInfm (처방전 재활처방 조회) 
        Description :                                           환자에게 내려진 재활처방 정보를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstRhblInfm-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstRhblInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstRhblInfm-result" useCache="true" flushCache="false">
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtRqstRhblInfm */
		           a.PTNO as PTNO  /*  환자번호 */
		        ,  to_char(a.ORDR_YMD, 'yyyymmdd') as ORDR_YMD  /*  처방일자 */
		        ,  a.ORDR_SNO as ORDR_SNO  /*  처방일련번호 */
		        ,  a.CODV_CD as CODV_CD  /*  내원구분코드 */
		        ,  a.MDRP_NO as MDRP_NO  /*  진료접수번호 */
		        ,  a.ORDR_IPDV_CD as ORDR_IPDV_CD  /*  처방급여구분코드 */
		        ,  a.CRTF_DVSN_CD as CRTF_DVSN_CD  /*  인증구분코드 */
		        ,  a.ODDR_ID as ODDR_ID  /*  처방의사ID */
		        ,  c.USER_NM as ODDR_NM  /*  처방의사명 */
		        ,  p.ISTY_CD as ISTY_CD  /*  보험유형코드 */
		        ,  p.ISTY_ASST_CD as ISTY_ASST_CD  /*  보험유형보조코드 */
		        ,  a.MCDP_CD as MCDP_CD  /*  진료과코드 */
		        ,  b.ORDR_NM as ORDR_NM  /*  처방명 */
		        ,  '' as PTPT_CD  /*  환자가야할장소코드 */
		        ,  '' as FRNS_DPRT_CD  /*  불출부서코드 */
		        ,  '' as AFI_FRNS_DPRT_NM  /*  AFI불출부서명 */
		        ,  a.ORDR_CD as ORDR_CD
		        ,  a.ODKI_CD as ODKI_CD
		        ,  a.OROC_DPRT_CD as OROC_DPRT_CD
		        ,  (select t.HRAF_PRAP_DPRT_CD
		              from CCUSRDPHT t
		             where t.USER_ID = a.ODDR_ID) as SBDP_DPRT_CD
		        ,  a.GNDR_ID as GNDR_ID
		        ,  to_char(p.MDCR_DT, 'yyyymmddhh24miss') as MDCR_DT
		        ,  a.HSLC_DVSN_CD as HSLC_DVSN_CD
		        ,  c.MDCR_DPRT_CD as ODDR_MCDP_CD
		        ,  (  select  nvl(max(s.RCST_CD), 'N')
		                from  SHREHTDMT s
		               where  s.PTNO = a.PTNO
		                 and  s.ORDR_YMD = a.ORDR_YMD
		                 and  s.ORDR_SNO = a.ORDR_SNO
		           ) as RCST_CD
		        ,  (select d.DETL_CD_NM
		              from CCCMCDDMT d
		             where d.COMN_GRP_CD  = 'ACA_037'
		               and d.COMN_DTLS_CD = (  select  nvl(max(s.RCST_CD), 'N')
		                                         from  SHREHTDMT s
		                                        where  s.PTNO = a.PTNO
		                                          and  s.ORDR_YMD = a.ORDR_YMD
		                                          and  s.ORDR_SNO = a.ORDR_SNO
		                                     )
		           ) as AFI_RCST_NM
		         ,  a.CHDR_ID as CHDR_ID
		         ,  '' as ORFR_CD
		   from  MDREHORDT a
		         ,  MDORDRCMT b
		         ,  CCUSRDPHT c
		         ,  APRCRPTNT p /*  진료접수 */
		  where
		            a.PTNO = #{ptno}
		    and  a.ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		    and  a.ORDR_SNO = #{ordrSno}
		    and  a.DC_DVSN_CD = 'N'
		    and  b.ORDR_CD  = a.ORDR_CD
		    and  c.USER_ID(+) = a.ODDR_ID
		    and  p.MDRP_NO = a.MDRP_NO
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtExmnOrdrPrgrStts-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO">
	
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="ordrSttsCd" column="ORDR_STTS_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="careSttsCd" column="CARE_STTS_CD"/>
		<result property="apntDt" column="APNT_DT"/>
		<result property="afiDlysPtntOrcnYn" column="AFI_DLYS_PTNT_ORCN_YN"/>
		<result property="afiCmtxImplYn" column="AFI_CMTX_IMPL_YN"/>
		<result property="excfCd" column="EXCF_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtExmnOrdrPrgrStts (검사처방 상태조회) 
        Description :                                           검사처방의 진행상태를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtExmnOrdrPrgrStts-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtExmnOrdrPrgrStts"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtExmnOrdrPrgrStts-result" useCache="true" flushCache="false">
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-selectOnePrtxUpdtExmnOrdrPrgrStts */
		           DC_DVSN_CD as DC_DVSN_CD  /*  DC구분코드       */
		        ,  EXOR_PRSS_CD as ORDR_STTS_CD  /*  검사처방진행상태코드   */
		        ,  nvl( RCST_CD, 'N') as RCST_CD  /*  수납상태코드     */
		        ,  CARE_STTS_CD as CARE_STTS_CD  /*  간호상태코드     */
		        ,  APNT_DT as APNT_DT  /*  예약일시 */
		        ,  '' AFI_DLYS_PTNT_ORCN_YN  /*  투석환자처방 간호확인여부*/
		        ,  ''  as AFI_CMTX_IMPL_YN
		        ,  EXCF_CD as EXCF_CD
		  from  MDEXMORDT
		where
		           PTNO = #{ptno}  /*  환자번호 */
		   and  ORDR_YMD = to_date( #{ordrYmd}, 'yyyymmdd' )  /*  처방일자 */
		   and  ORDR_SNO = #{ordrSno}  /*  처방순번 */
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtDrugInfm (처방전 수정요청 내역 수정 (약/주사)) 
        Description :                                           처방전 수정요청정보를 기존에 내려진 약주사처방정보에 저장한다.(수정)
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtDrugInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  >
		<![CDATA[
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtDrugInfm */
		             MDMEDORDT m
		       set
		             /*  묶음끼리 독립된 항목 */
		              RCST_CD           = case when RCST_CD = 'Y' and PTAD_CODV_CD = 'I' and 'ORDR_IPDV_CD' = #{ordrUpdtClmnNm}
		                                               then 'N'
		                                               else RCST_CD end /* 급여 수정시 이미 수납된 입원처방 재계산 처리를 위해 N 으로 변경 */
		           ,  ORDR_IPDV_CD   = case when nvl(#{inptVl}, 'N') = 'Y' and nvl(#{drbnNo}, 0) > 0
		                                    then ORDR_IPDV_CD
		                                    else #{ordrIpdvCd}
		                                end
		          ,  PTAD_IPDV_CD  =  case when nvl(#{inptVl}, 'N') = 'Y' and nvl(#{drbnNo}, 0) > 0
		                                   then PTAD_IPDV_CD
		                                   else #{ordrIpdvCd}
		                               end
		          ,  SNGN_BNDL_YN  =  case when nvl(#{inptVl}, 'N') = 'Y' and nvl(#{drbnNo}, 0) > 0
		                                   then SNGN_BNDL_YN
		                                   else #{sngnBndlYn}
		                               end  /* 단독묶음여부 */
		          /*  묶음끼리 같아야 하는 항목 */
		          ,  SDPF_EXRE_CD  = #{sdpfExreCd}  /* 의약분업예외사유코드 */
		          ,  INJC_PRRN_YMD  = to_date ( #{injcPrrnYmd}, 'YYYYMMDD' )  /* 주사예정일자 */
		          ,  MDTN_STRT_YMD  = to_date ( #{injcPrrnYmd}, 'YYYYMMDD' )  /* 주사예정일자 */
		]]>          
				<if test='ptadMdrpNo != null and ptadMdrpNo != 0'>
				  ,  PTAD_MDRP_NO   = #{ptadMdrpNo}
		        </if>
		        <if test='ptadClbaYmd != null and ptadClbaYmd != ""'>
				  ,  PTAD_CLBA_YMD  = to_date(#{ptadClbaYmd}, 'yyyymmdd')
		        </if>
		          ,  MIX_KIND_CD  = #{mixKindCd}  /* 혼합종류코드 */
		        <if test='erFrnsYn != null and erFrnsYn != ""'>
		          ,  ER_FRNS_YN  = #{erFrnsYn}  /* 응급불출여부 */
		          ,  FRNS_YN           = case when #{erFrnsYn} = 'Y' and m.FRNS_CTRL_DVSN_CD  is not null then 'Y' else 'N' end
		   		  ,  FRNS_RQPR_ID      = case when #{erFrnsYn} = 'Y' and m.FRNS_CTRL_DVSN_CD  is not null then #{gvUserId} else null end
				  ,  FRNS_RQPR_IP      = case when #{erFrnsYn} = 'Y' and m.FRNS_CTRL_DVSN_CD  is not null then #{gvUserIp} else null end
				  ,  FRNS_RQST_DT      = case when #{erFrnsYn} = 'Y' and m.FRNS_CTRL_DVSN_CD  is not null then sysdate     else null end
				  ,  FRNS_RQPR_TYPE_CD = case when #{erFrnsYn} = 'Y' and m.FRNS_CTRL_DVSN_CD  is not null then '2'         else null end
		        </if>
		<![CDATA[
		          ,  FRNS_DPRT_CD  = #{frnsDprtCd}  /* 불출부서코드 */
		          ,  OSLF_ADMN_DRUG_YN = case when #{frnsDprtCd} = FN_CC_GET_DPRT_CD('DPRT_OSI')
		                                      then 'Y'
		                                      else null
		                                  end	/* 불출부서 자가자사로 변경할 때 자가주사칼럼 입력값 udpate되도록 추가함. 2020.10.13 obh */
		          ,  ORFR_CD  = #{orfrCd}  /* 처방형태코드 */
		          ,  TMPR_ORDR_YN  = case when nvl(#{orfrCd}, 'X') = 'F' then 'Y'
		                                               when nvl(#{orfrCd}, 'X') = 'P' then 'Y'
		                                               when nvl(#{orfrCd}, 'X') = 'S' then 'Y' else 'N' end /*  F 1차 P PRN S 지참 인 경우, 임시처방여부 세팅 */
		          ,  CLRS_PRJC_CD   = case /*  정보지원팀 인 경우, 처방급여구분코드를 수납상태에 상관없이 수정가능하도록 예외처리 요청 */
		                                       when #{oddrMcdpCd} = fn_cc_get_dprt_cd('DPRT_IT')    then #{clrsPrjcCd}
		                                       when RCST_CD <> 'N' and RCST_CD <> 'W'              then CLRS_PRJC_CD
		                                       else #{clrsPrjcCd}
		                                       end  /* 임상연구과제코드 */
		           ,  CLRS_PRJC_DR_ID = case when #{clrsPrjcCd} is not null then ODDR_ID
		                                          else ''
		                                          end
		           ,  IHOH_DVSN_CD   = #{ihohDvsnCd}  /* 원내원외구분코드 */
		           ,  CRTF_DVSN_CD   = #{crtfDvsnCd}
		           ,  DRUG_ORDR_PRSS_CD = case when (select  count(a.ptno)
		                                               from  SDPORDDET a
		                                              where  a.ptno     = #{ptno}
		                                                and  a.ordr_ymd = to_date(#{ordrYmd} , 'yyyymmdd' )
		                                                and  a.ordr_sno = #{ordrSno}
		                                                and  a.cmmd_stts_cd <  '2'
		                                                and 0 < ( select  count(1)
		                                                               from  SDPORDDET t
		                                                              where  t.ordr_ymd = a.ordr_ymd
		                                                                 and  t.mdtn_lcdv_cd = a.mdtn_lcdv_cd
		                                                                 and  t.MDTN_NO_DVSN_CD = a.MDTN_NO_DVSN_CD
		                                                                 and  t.MDTN_NO = a.MDTN_NO
		                                                                 and  t.ordr_sno <> a.ordr_sno
		                                                                 and  t.CMMD_STTS_CD >= '2'
		                                                                 and  t.CMMD_STTS_CD <  '6'
		                                                             ) +
		                                             /*  해당 투약번호내에 mdmedordt의 phdp_prin_yn 이 'Y' 인 갯수와 전체 처방갯수가 같으면 update 해야함 -> mdmedordt의 phdp_prin_yn 대신 sdporddet 의 rcpc_yn을 봄*/
		                                            (select  case when s.RCPC_YN = 'Y' then 1
		                                                               else 0
		                                                               end
		                                              from  SDPORDBAT s
		                                            where  s.ORDR_YMD        = a.ORDR_YMD
		                                               and  s.MDTN_LCDV_CD    = a.MDTN_LCDV_CD
		                                               and  s.MDTN_NO_DVSN_CD = a.MDTN_NO_DVSN_CD
		                                               and  s.MDTN_NO         = a.MDTN_NO
		                                              ) ) > 0 
		                                       then DRUG_ORDR_PRSS_CD
		                                       when #{drugOrdrPrssCd} = 'X' 
		                                       then DRUG_ORDR_PRSS_CD
		                                       else nvl(#{drugOrdrPrssCd}, '0')
		                                   end
		          ,  PTAD_PTGO_CD = nvl(#{ptadPtgoCd}, PTAD_PTGO_CD)
		          ,  VAT_TRGT_YN = case when RCST_CD <> 'N' and RCST_CD <> 'W' then VAT_TRGT_YN
		                                          else #{vatTrgtYn}
		                                          end  /* 부가세대상여부 */
		          ,  ORDR_UPDT_DT = sysdate  /*  처방수정일시*/
		          ,  ORDR_UPDR_ID = #{gvUserId}  /*  처방수정자ID*/
		          ,  LAST_UPDR_ID = #{gvUserId}  /*  최종수정자ID */
		          ,  LAST_UPDT_IP = #{gvUserIp}  /*  최종수정IP */
		          ,  LAST_UPDT_DT = sysdate  /*  최종수정일시 */
		          ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		          ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}  /*  최종수정SMC서버프로그램ID */
		   where  PTNO    = #{ptno}  /*  환자번호             */
		     and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		     and  DC_DVSN_CD = 'N'
		     and  ((
		               nvl(#{inptVl}, 'N')  <> 'Y'
		           and ORDR_SNO = #{ordrSno})
		          or
		          (    nvl(#{inptVl}, 'N')  = 'Y'
		           and #{drbnNo} > 0
		           and DRBN_NO    = #{drbnNo}
		           )
		          )
		]]>
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtExmnInfm (처방전 수정요청 내역 수정 검사) 
        Description :                                           처방전 수정요청정보를 기존에 내려진 검사처방정보에 저장한다.(수정)
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtExmnInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  >
		<![CDATA[
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtExmnInfm */
		             MDEXMORDT
		      set
		             RCST_CD           = case when RCST_CD = 'Y' and PTAD_CODV_CD = 'I' and 'ORDR_IPDV_CD' = #{ordrUpdtClmnNm}
		                                        then 'N'
		                                        else RCST_CD end /* 급여 수정시 이미 수납된 입원처방 재계산 처리를 위해 N 으로 변경 */
		          ,  ORFR_CD = #{orfrCd}
		          ,  TMPR_ORDR_YN = case when 'ORFR_CD' = #{ordrUpdtClmnNm}
		                                 then  decode(#{orfrCd}, 'P', 'Y', 'N')
		                                 else TMPR_ORDR_YN
		                             end
		          ,  PACL_YMD = decode ( #{orfrCd},'D',to_date( #{ordrYmd},'YYYYMMDD' ), PACL_YMD ) /*  원무계산일자:Done검사일때 계산일자에 처방일자 넣어줌 */
		          ,  ORDR_IPDV_CD = #{ordrIpdvCd}
		          ,  PTAD_IPDV_CD = #{ordrIpdvCd}
		          ,  VAT_TRGT_YN = case when RCST_CD <> 'N' and RCST_CD <> 'W' then VAT_TRGT_YN
		                                          else #{vatTrgtYn}
		                                          end
		          ,  MDCR_BEEX_YN = #{mdcrBeexYn}
		          ,  WNTD_DT = to_date(#{wntdDt}, 'yyyymmddhh24miss')
		]]>          
				<if test='ptadMdrpNo != null and ptadMdrpNo != 0'>
				  ,  PTAD_MDRP_NO   = #{ptadMdrpNo}
		        </if>
		        <if test='ptadClbaYmd != null and ptadClbaYmd != ""'>
				  ,  PTAD_CLBA_YMD  = to_date(#{ptadClbaYmd}, 'yyyymmdd')
		        </if>
		<![CDATA[ 
		          ,  EXMN_WNTD_DR_ID = #{exmnWntdDrId}
		          ,  CLRS_PRJC_CD =  case  /* 정보지원팀 인 경우, 처방급여구분코드를 수납상태에 상관없이 수정가능하도록 예외처리 요청 */
		                                             when #{oddrMcdpCd} = fn_cc_get_dprt_cd('DPRT_IT') then #{clrsPrjcCd}
		                                             when RCST_CD <> 'N' and RCST_CD <> 'W' then CLRS_PRJC_CD
		                                             else #{clrsPrjcCd}
		                                             end
		          ,  CLRS_PRJC_DR_ID = case when #{clrsPrjcCd} is not null then ODDR_ID
		                                                else ''
		                                                end
		          ,  CRTF_DVSN_CD = #{crtfDvsnCd}
		          ,  NNMT_EXMN_YN = #{nnmtExmnYn}
		          ,  NNMT_EXMN_NTFC_YMD = to_date(#{nnmtExmnNtfcYmd}, 'yyyymmdd')
		          ,  PRTB_YN      = #{prtbYn}	/* portable여부 */
		          ,  ORDR_UPDT_DT = sysdate  /*  처방수정일시*/
		          ,  ORDR_UPDR_ID = #{gvUserId}  /*  처방수정자ID*/
		          ,  LAST_UPDR_ID = #{gvUserId}  /*  최종수정자ID */
		          ,  LAST_UPDT_IP = #{gvUserIp}  /*  최종수정IP */
		          ,  LAST_UPDT_DT = sysdate  /*  최종수정일시 */
		          ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		          ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}  /*  최종수정SMC서버프로그램ID */
		  where  PTNO    = #{ptno}                           /*  환자번호             */
		    and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		    and  ORDR_CD  = #{ordrCd}
		    and  ORDR_SNO = #{ordrSno}
		]]>
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtBlodInfm (처방전 수혈처방 수정) 
        Description :                                           환자에게 내려진 수혈처방 상세정보를 수정한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtBlodInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  >
		<![CDATA[
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtBlodInfm */
		             MDBLDORDT
		      set
		             RCST_CD           = case when RCST_CD = 'Y' and ORDR_IPDV_CD = 'I' and 'ORDR_IPDV_CD' = #{ordrUpdtClmnNm}
		                                        then 'N'
		                                        else RCST_CD end /* 급여 수정시 이미 수납된 입원처방 재계산 처리를 위해 N 으로 변경 */
		         ,  ORDR_IPDV_CD =  #{ordrIpdvCd}
		         ,  FRNS_DPRT_CD = #{frnsDprtCd}
		         ,  CRTF_DVSN_CD = #{crtfDvsnCd}
		         ,  ORDR_UPDT_DT = sysdate  /*  처방수정일시*/
		         ,  ORDR_UPDR_ID = #{gvUserId}  /*  처방수정자ID*/
		         ,  LAST_UPDR_ID = #{gvUserId}  /*  최종수정자ID */
		         ,  LAST_UPDT_IP = #{gvUserIp}  /*  최종수정IP */
		         ,  LAST_UPDT_DT = sysdate  /*  최종수정일시 */
		         ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		         ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}  /*  최종수정SMC서버프로그램ID */
		  where  PTNO    = #{ptno}  /*  환자번호             */
		    and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		    and  ORDR_SNO = #{ordrSno}
		]]>
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtOrdrFeeInfm (처방전 처방료 처방 수정) 
        Description :                                           처방전 수정요청정보로 처방료처방정보를 수정한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtOrdrFeeInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  >
		<![CDATA[
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtOrdrFeeInfm */
		             MDTRTORDT
		      set
		             RCST_CD           = case when RCST_CD = 'Y' and PTAD_CODV_CD = 'I' and 'ORDR_IPDV_CD' = #{ordrUpdtClmnNm}
		                                        then 'N'
		                                        else RCST_CD end /* 급여 수정시 이미 수납된 입원처방 재계산 처리를 위해 N 으로 변경 */
		          ,  ORDR_IPDV_CD =  #{ordrIpdvCd}
		          ,  PTAD_IPDV_CD =  #{ordrIpdvCd}
		          ,  FRNS_DPRT_CD = #{frnsDprtCd}
		          ,  CRTF_DVSN_CD = #{crtfDvsnCd}
		          ,  ORDR_UPDT_DT = sysdate  /*  처방수정일시*/
		          ,  ORDR_UPDR_ID = #{gvUserId}  /*  처방수정자ID*/
		          ,  LAST_UPDR_ID = #{gvUserId}  /*  최종수정자ID */
		          ,  LAST_UPDT_IP = #{gvUserIp}  /*  최종수정IP */
		          ,  LAST_UPDT_DT = sysdate  /*  최종수정일시 */
		          ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		          ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}  /*  최종수정SMC서버프로그램ID */
		 where  PTNO    = #{ptno} /*  환자번호 */
		    and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		    and  ORDR_SNO = #{ordrSno}
		]]>
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtRhblInfm (처방전 재활처방 수정) 
        Description :                                           처방전 수정요청정보로 기존 재활처방정보를 수정한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtRhblInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  >
		<![CDATA[
		  update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtRhblInfm */
		              MDREHORDT
		       set
		             ORDR_IPDV_CD = #{ordrIpdvCd}
		          ,  CRTF_DVSN_CD = #{crtfDvsnCd}
		          ,  ORDR_UPDT_DT = sysdate  /*  처방수정일시*/
		          ,  ORDR_UPDR_ID = #{gvUserId}  /*  처방수정자ID*/
		          ,  LAST_UPDR_ID = #{gvUserId}  /*  최종수정자ID */
		          ,  LAST_UPDT_IP = #{gvUserIp}  /*  최종수정IP */
		          ,  LAST_UPDT_DT = sysdate  /*  최종수정일시 */
		          ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		          ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}  /*  최종수정SMC서버프로그램ID */
		    where  PTNO    = #{ptno}                           /*  환자번호             */
		      and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		      and  ORDR_SNO = #{ordrSno}
		]]>
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtPrgrStts (처방전 수정 승인 상태수정) 
        Description :                                           처방전 수정요청 건의 진행상태를 수정한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtPrgrStts"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpPrtxUpdtDVO"  >
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpPrtxUpdtDAO-updatePrtxUpdtPrgrStts */
		             MDORDUPBT
		      set  ORDR_UPDT_STTS_CD = #{ordrUpdtSttsCd}             /*  처방수정상태코드 */
		          ,  APRV_DT = case #{ordrUpdtSttsCd} when '1' then sysdate
		                                                              when '2' then sysdate
		                                                              when '3' then sysdate
		                                                              else null end
		          ,  APRV_DR_ID   = #{gvUserId}
		          ,  LAST_UPDR_ID = #{gvUserId}  /*  최종수정자ID */
		          ,  LAST_UPDT_IP = #{gvUserIp}  /*  최종수정IP */
		          ,  LAST_UPDT_DT = sysdate  /*  최종수정일시 */
		          ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		          ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}  /*  최종수정SMC서버프로그램ID */
		  where  PTNO = #{ptno}
		    and  ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		    and  ORDR_SNO = #{ordrSno}
		    and  ORDR_UPDT_SNO = #{ordrUpdtSno}
		    and  ((#{ordrUpdtSttsCd} = '2') and ((ORDR_UPDT_STTS_CD = '0') or (ORDR_UPDT_STTS_CD = '1'))
		          or ((#{ordrUpdtSttsCd} = '3') and (ORDR_UPDT_STTS_CD = '0'))
		          or ((#{ordrUpdtSttsCd} = '0') or (#{ordrUpdtSttsCd} = '1')))
	</update>

</mapper>