<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_AcbEmplRdexMngmDAO_sql.xml 
    Description :                                      직원감면정보관리 DAO
                  -->
<mapper namespace="AcbEmplRdexMngmDAO">




    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdex (직원감면대상 입력) 
        Description :                                           직원감면대상 입력
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
    -->	
	<insert id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdex"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdex */
		insert
		  into  ACCNERTPT
		        (
		        EMPL_RDEX_TGPR_SNO
		     ,  APST_YMD
		     ,  APFN_YMD
		     ,  EMPL_ID
		     ,  EMPL_NM
		     ,  EMFM_SNO
		     ,  PTNO
		     ,  ONSL_FMLY_DVSN_CD
		     ,  RDEX_RLTN_CD
		     ,  RDEX_TGPR_NM
		     ,  RDEX_TGPR_BTDT
		     ,  GEND_CD
		     ,  RDEX_TGPR_FRRN
		     ,  RDEX_TGPR_BRRN
		     ,  RDEX_ALCM_CD
		     ,  DPRT_NM
		     ,  OCFM_NM
		     ,  OCPS_NM
		     ,  BSIS_RDEX_CD
		     ,  RMRK_CTN
		     ,  FRST_RGSR_ID
		     ,  FRST_RGST_IP
		     ,  FRST_RGST_DT
		     ,  FRST_RGST_CLNT_PRGM_ID
		     ,  FRST_RGST_SRVR_PRGM_ID
		     ,  LAST_UPDR_ID
		     ,  LAST_UPDT_IP
		     ,  LAST_UPDT_DT
		     ,  LAST_UPDT_CLNT_PRGM_ID
		     ,  LAST_UPDT_SRVR_PRGM_ID
		        )
		values  (
		        #{emplRdexTgprSno}
		     ,  to_date(#{apstYmd}, 'yyyymmdd')
		     ,  to_date(#{apfnYmd}, 'yyyymmdd')
		     ,  #{emplId}
		     ,  #{emplNm}
		     ,  #{emfmSno}
		     ,  #{ptno}
		     ,  #{onslFmlyDvsnCd}
		     ,  #{rdexRltnCd}
		     ,  #{rdexTgprNm}
		     ,  to_date(#{rdexTgprBtdt}, 'yyyymmdd')
		     ,  #{gendCd}
		     ,  #{rdexTgprFrrn}
		     ,  #{rdexTgprBrrn}
		     ,  #{rdexAlcmCd}
		     ,  #{dprtNm}
		     ,  #{ocfmNm}
		     ,  #{ocpsNm}
		     ,  #{bsisRdexCd}
		     ,  #{rmrkCtn}
		     ,  #{gvUserId}
		     ,  #{gvUserIp}
		     ,  sysdate
		     ,  #{gvClntPrgmId}
		     ,  #{gvSrvrPrgmId}
		     ,  #{gvUserId}
		     ,  #{gvUserIp}
		     ,  sysdate
		     ,  #{gvClntPrgmId}
		     ,  #{gvSrvrPrgmId}
		        )
	</insert>




    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdexInrf (직원감면 인터페이스정보 입력) 
        Description :                                           직원감면 인터페이스정보 입력
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
    -->	
	<insert id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdexInrf"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdexInrf */
		insert
		  into  SEHRCOM.ACCNRRIFT
		        (
		        RDEX_ALCM_CD
		     ,  EMPL_ID
		     ,  EMFM_SNO
		     ,  EMPL_NM
		     ,  APST_YMD
		     ,  APFN_YMD
		     ,  EMPL_CLSF_CD
		     ,  OCFM_NM
		     ,  OCPS_NM
		     ,  ALCM_DPRT_CD
		     ,  ALCM_DPRT_NM
		     ,  ONSL_FMLY_DVSN_CD
		     ,  FMLY_RLTN_CD
		     ,  FMLY_RLTN_NM
		     ,  RDEX_TGPR_NM
		     ,  RDEX_TGPR_BTDT
		     ,  RDEX_TGPR_FRRN
		     ,  RDEX_TGPR_BRRN
		     ,  GEND_CD
		     ,  WORK_TRGT_YN
		     ,  FRST_RGSR_ID
		     ,  FRST_RGST_IP
		     ,  FRST_RGST_DT
		     ,  FRST_RGST_CLNT_PRGM_ID
		     ,  FRST_RGST_SRVR_PRGM_ID
		     ,  LAST_UPDR_ID
		     ,  LAST_UPDT_IP
		     ,  LAST_UPDT_DT
		     ,  LAST_UPDT_CLNT_PRGM_ID
		     ,  LAST_UPDT_SRVR_PRGM_ID
		        )
		values  (
		        #{rdexAlcmCd}
		     ,  #{emplId}
		     ,  #{emfmSno}
		     ,  #{emplNm}
		     ,  to_date(#{apstYmd}, 'yyyymmdd')
		     ,  to_date(#{apfnYmd}, 'yyyymmdd')
		     ,  #{emplClsfCd}
		     ,  #{ocfmNm}
		     ,  #{ocpsNm}
		     ,  #{alcmDprtCd}
		     ,  #{alcmDprtNm}
		     ,  #{onslFmlyDvsnCd}
		     ,  #{fmlyRltnCd}
		     ,  #{fmlyRltnNm}
		     ,  #{rdexTgprNm}
		     ,  to_date(#{rdexTgprBtdt}, 'yyyymmdd')
		     ,  #{rdexTgprFrrn}
		     ,  #{rdexTgprBrrn}
		     ,  #{gendCd}
		     ,  #{workTrgtYn}
		     ,  #{gvUserId}
		     ,  #{gvUserIp}
		     ,  sysdate
		     ,  #{gvClntPrgmId}
		     ,  #{gvSrvrPrgmId}
		     ,  #{gvUserId}
		     ,  #{gvUserIp}
		     ,  sysdate
		     ,  #{gvClntPrgmId}
		     ,  #{gvSrvrPrgmId}
		        )
	</insert>




    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdexWork (직원감면 병원별 작업대상 데이터 입력) 
        Description :                                           직원감면 병원별 작업대상 데이터 입력
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
    -->	
	<insert id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdexWork"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-insertEmplRdexWork */
		insert
		  into  SEHRCOM.ACCNRRWKT
		        (
		        HSPT_CD
		     ,  RDEX_ALCM_CD
		     ,  EMPL_ID
		     ,  EMFM_SNO
		     ,  MDFC_HX_SNO
		     ,  WORK_TRGT_YN
		     ,  FRST_RGSR_ID
		     ,  FRST_RGST_IP
		     ,  FRST_RGST_DT
		     ,  FRST_RGST_CLNT_PRGM_ID
		     ,  FRST_RGST_SRVR_PRGM_ID
		     ,  LAST_UPDR_ID
		     ,  LAST_UPDT_IP
		     ,  LAST_UPDT_DT
		     ,  LAST_UPDT_CLNT_PRGM_ID
		     ,  LAST_UPDT_SRVR_PRGM_ID
		        )
		values  (
		        #{hsptCd}
		     ,  #{rdexAlcmCd}
		     ,  #{emplId}
		     ,  #{emfmSno}
		     ,  (   select  nvl(max(MDFC_HX_SNO), 0) + 1
		              from  SEHRCOM.ACCNRRWKT
		             where  HSPT_CD         =   #{hsptCd}
		               and  RDEX_ALCM_CD    =   #{rdexAlcmCd}
		               and  EMPL_ID         =   #{emplId}
		               and  EMFM_SNO        =   #{emfmSno}
		        )
		     ,  #{workTrgtYn}
		     ,  #{gvUserId}
		     ,  #{gvUserIp}
		     ,  sysdate
		     ,  #{gvClntPrgmId}
		     ,  #{gvSrvrPrgmId}
		     ,  #{gvUserId}
		     ,  #{gvUserIp}
		     ,  sysdate
		     ,  #{gvClntPrgmId}
		     ,  #{gvSrvrPrgmId}
		        )
	</insert>




    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-updateEmplRdex (직원감면대상 변경) 
        Description :                                           직원감면대상 변경
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-updateEmplRdex"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-updateEmplRdex */
		update  ACCNERTPT
		   set  LAST_UPDR_ID                =   #{gvUserId}
		     ,  LAST_UPDT_IP                =   #{gvUserIp}
		     ,  LAST_UPDT_DT                =   sysdate
		     ,  LAST_UPDT_CLNT_PRGM_ID      =   #{gvClntPrgmId}
		     ,  LAST_UPDT_SRVR_PRGM_ID      =   #{gvSrvrPrgmId}
		 <if test="apstYmd != null">
		     ,  APST_YMD                    =   to_date(#{apstYmd}, 'yyyymmdd')
		 </if>
		 <if test="apfnYmd != null">
		     ,  APFN_YMD                    =   to_date(#{apfnYmd}, 'yyyymmdd')
		 </if>
		 <if test="emplNm != null">
		     ,  EMPL_NM                     =   #{emplNm}
		 </if>
		 <if test="emfmSno != null">
		     ,  EMFM_SNO                    =   #{emfmSno}
		 </if>
		 <if test="ptno != null">
		     ,  PTNO                        =   #{ptno}
		 </if>
		 <if test="onslFmlyDvsnCd != null">
		     ,  ONSL_FMLY_DVSN_CD           =   #{onslFmlyDvsnCd}
		 </if>
		 <if test="rdexRltnCd != null">
		     ,  RDEX_RLTN_CD                =   #{rdexRltnCd}
		 </if>
		 <if test="rdexTgprNm != null">
		     ,  RDEX_TGPR_NM                =   #{rdexTgprNm}
		 </if>
		 <if test="rdexTgprBtdt != null">
		     ,  RDEX_TGPR_BTDT              =   to_date(#{rdexTgprBtdt}, 'yyyymmdd')
		 </if>
		 <if test="gendCd != null">
		     ,  GEND_CD                     =   #{gendCd}
		 </if>
		 <if test="rdexTgprFrrn != null">
		     ,  RDEX_TGPR_FRRN              =   #{rdexTgprFrrn}
		 </if>
		 <if test="rdexTgprBrrn != null">
		     ,  RDEX_TGPR_BRRN              =   #{rdexTgprBrrn}
		 </if>
		 <if test="rdexAlcmCd != null">
		     ,  RDEX_ALCM_CD                =   #{rdexAlcmCd}
		 </if>
		 <if test="dprtNm != null">
		     ,  DPRT_NM                     =   #{dprtNm}
		 </if>
		 <if test="ocfmNm != null">
		     ,  OCFM_NM                     =   #{ocfmNm}
		 </if>
		 <if test="ocpsNm != null">
		     ,  OCPS_NM                     =   #{ocpsNm}
		 </if>
		 <if test="bsisRdexCd != null">
		     ,  BSIS_RDEX_CD                =   #{bsisRdexCd}
		 </if>
		 <if test="rmrkCtn != null">
		     ,  RMRK_CTN                    =   #{rmrkCtn}
		 </if>
		 where  EMPL_RDEX_TGPR_SNO          =   #{emplRdexTgprSno}
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-updateEmplRdexInrf (직원감면 인터페이스정보 수정) 
        Description :                                           직원감면 인터페이스정보 수정
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-updateEmplRdexInrf"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-updateEmplRdexInrf */
		update  SEHRCOM.ACCNRRIFT
		   set  LAST_UPDR_ID            =   #{gvUserId}
		     ,  LAST_UPDT_IP            =   #{gvUserIp}
		     ,  LAST_UPDT_DT            =   sysdate
		     ,  LAST_UPDT_CLNT_PRGM_ID  =   #{gvClntPrgmId}
		     ,  LAST_UPDT_SRVR_PRGM_ID  =   #{gvSrvrPrgmId}
		 <if test="emplNm != null">
		     ,  EMPL_NM                 =   #{emplNm}
		 </if>
		 <if test="apstYmd != null">
		     ,  APST_YMD                =   to_date(#{apstYmd}, 'yyyymmdd')
		 </if>
		 <if test="apfnYmd != null">
		     ,  APFN_YMD                =   to_date(#{apfnYmd}, 'yyyymmdd')
		 </if>
		 <if test="emplClsfCd != null">
		     ,  EMPL_CLSF_CD            =   #{emplClsfCd}
		 </if>
		 <if test="ocfmNm != null">
		     ,  OCFM_NM                 =   #{ocfmNm}
		 </if>
		 <if test="ocpsNm != null">
		     ,  OCPS_NM                 =   #{ocpsNm}
		 </if>
		 <if test="alcmDprtCd != null">
		     ,  ALCM_DPRT_CD            =   #{alcmDprtCd}
		 </if>
		 <if test="alcmDprtNm != null">
		     ,  ALCM_DPRT_NM            =   #{alcmDprtNm}
		 </if>
		 <if test="onslFmlyDvsnCd != null">
		     ,  ONSL_FMLY_DVSN_CD       =   #{onslFmlyDvsnCd}
		 </if>
		 <if test="fmlyRltnCd != null">
		     ,  FMLY_RLTN_CD            =   #{fmlyRltnCd}
		 </if>
		 <if test="fmlyRltnNm != null">
		     ,  FMLY_RLTN_NM            =   #{fmlyRltnNm}
		 </if>
		 <if test="rdexTgprNm != null">
		     ,  RDEX_TGPR_NM            =   #{rdexTgprNm}
		 </if>
		 <if test="rdexTgprBtdt != null">
		     ,  RDEX_TGPR_BTDT          =   to_date(#{rdexTgprBtdt}, 'yyyymmdd')
		 </if>
		 <if test="rdexTgprFrrn != null">
		     ,  RDEX_TGPR_FRRN          =   #{rdexTgprFrrn}
		 </if>
		 <if test="rdexTgprBrrn != null">
		     ,  RDEX_TGPR_BRRN          =   #{rdexTgprBrrn}
		 </if>
		 <if test="gendCd != null">
		     ,  GEND_CD                 =   #{gendCd}
		 </if>
		 where  RDEX_ALCM_CD            =   #{rdexAlcmCd}
		   and  EMPL_ID                 =   #{emplId}
		   and  EMFM_SNO                =   #{emfmSno}
	</update>


	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplFmlySrch-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="rdexAlcmCd" column="RDEX_ALCM_CD"/>
		<result property="rdexAlcmNm" column="RDEX_ALCM_NM"/>
		<result property="dprtCd" column="DPRT_CD"/>
		<result property="dprtNm" column="DPRT_NM"/>
		<result property="emplId" column="EMPL_ID"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="ocfmCd" column="OCFM_CD"/>
		<result property="ocfmNm" column="OCFM_NM"/>
		<result property="ocpsCd" column="OCPS_CD"/>
		<result property="ocpsNm" column="OCPS_NM"/>
		<result property="hlofSttsCd" column="HLOF_STTS_CD"/>
		<result property="hlofSttsNm" column="HLOF_STTS_NM"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="rdexTgprNm" column="RDEX_TGPR_NM"/>
		<result property="gendCd" column="GEND_CD"/>
		<result property="rdexTgprBtdt" column="RDEX_TGPR_BTDT"/>
		<result property="rdexTgprFrrn" column="RDEX_TGPR_FRRN"/>
		<result property="rdexTgprBrrn" column="RDEX_TGPR_BRRN"/>
		<result property="onslFmlyDvsnCd" column="ONSL_FMLY_DVSN_CD"/>
		<result property="rdexRltnCd" column="RDEX_RLTN_CD"/>
		<result property="fmlyRltnCd" column="FMLY_RLTN_CD"/>
		<result property="fmlyRltnNm" column="FMLY_RLTN_NM"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplFmlySrch (직원가족정보 조회 (의료원, 본교)) 
        Description :                                           직원가족정보 조회 (의료원, 본교)
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplFmlySrch-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplFmlySrch"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplFmlySrch-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplFmlySrch */
		with
		    LIST_EMPL as
		    (   -- 의료원 인사정보
		        select  a.*
		          from  HZUSERMMT a
		         where  a.EMNO  in  (   select  EMNO
		                                  from  HZUSERMMT
		                                 where  1 = 1
		                                 <choose>
		                                   <!-- #{srwrDvsnCd} A : 직원ID/명, B : 주민번호 -->
		                                   <when test='srwrDvsnCd != null and srwrDvsnCd == "B"'>
		                                   and  EMPL_FRRN like substr(#{srwrVl}, 1, 6) || '%'
		                                   and  EMPL_BRRN like substr(#{srwrVl}, 7, 7) || '%'
		                                   </when>
		                                   <otherwise>
		                                   and  (   EMNO        =   #{srwrVl}
		                                        or  EMPY_NM     =   #{srwrVl}
		                                        )
		                                   </otherwise>
		                                 </choose>
		                            )
		         <!-- #{valdYn} Y : 유효한 건만 조회 (퇴직, 졸업 제외) -->
		         <if test='valdYn != null and valdYn == "Y"'>
		           and  trunc(sysdate)  between nvl(a.ENCM_YMD, trunc(sysdate))
		                                    and nvl(a.RTRM_PRAP_DD, trunc(sysdate))
		         </if>
		    )
		,   LIST_KU as
		    (   -- 본교 인사정보
		        select  'KU'                        as RDEX_ALCM_CD
		             ,  case
		                    when a.EMPL_DVSN_CD in ('4', '5', '6', '7')
		                        then    'UNIV'  -- 대학
		                    else        'EMPL'  -- 교직원
		                    end                     as EMPL_DVSN_VL
		             ,  (   select  DETL_CD_NM
		                      from  CCCMCDDMT
		                     where  COMN_GRP_CD     =   'ACB_033'
		                       and  COMN_DTLS_CD    =   a.EMPL_DVSN_CD
		                )                           as EMPL_DVSN_NM
		             ,  case
		                    when a.EMPL_RSRN = a.FMLY_RSRN then '01'
		                    else '02'
		                    end                     as ONSL_FMLY_DVSN_CD
		             ,  substr(a.FMLY_RSRN, 1, 6)   as RDEX_TGPR_FRRN
		             ,  substr(a.FMLY_RSRN, 7, 7)   as RDEX_TGPR_BRRN
		             ,  a.*
		          from  ACETKUEFT a
		         where  1 = 1
		           and  a.DLTN_DT is null
		         <choose>
		           <!-- #{srwrDvsnCd} A : 직원ID/명, B : 주민번호 -->
		           <when test='srwrDvsnCd != null and srwrDvsnCd == "B"'>
		           and  a.EMPL_RSRN like #{srwrVl} || '%'
		           </when>
		           <otherwise>
		           and  (   EMPL_ID     =   #{srwrVl}
		                or  EMPL_NM     =   #{srwrVl}
		                )
		           </otherwise>
		         </choose>
		         <!-- #{valdYn} Y : 유효한 건만 조회 (퇴직, 졸업 제외) -->
		         <if test='valdYn != null and valdYn == "Y"'>
		           and  a.EMPL_DVSN_CD not in ('6', '7')
		           and  (   (       a.APST_YMD is null
		                       and  a.APFN_YMD is null
		                    )
		                or  trunc(sysdate)  between nvl(a.APST_YMD, trunc(sysdate))
		                                        and nvl(a.APFN_YMD, trunc(sysdate))
		                )
		         </if>
		    )
		-- 의료원 직원/가족
		select  h.BSPL_CD                                           as RDEX_ALCM_CD
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'AC034'
		               and  COMN_DTLS_CD    =   h.BSPL_CD
		        )                                                   as RDEX_ALCM_NM
		     ,  h.DPRT_CD                                           as DPRT_CD
		     ,  nvl (   (   select  KORN_DPRT_NM
		                      from  HZDEPTMMT
		                     where  DPRT_CD     =   h.DPRT_CD
		                )
		            ,   nvl(h.DPRT_CD, '*')
		            )                                               as DPRT_NM
		     ,  h.EMNO                                              as EMPL_ID
		     ,  h.EMPY_NM                                           as EMPL_NM
		     ,  h.OCFM_CD                                           as OCFM_CD              -- 직종코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'GP006'
		               and  MIS_COMN_CD     =   h.OCFM_CD
		        )                                                   as OCFM_NM
		     ,  h.OCPS_CD                                           as OCPS_CD              -- 직위코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'GP008'
		               and  MIS_COMN_CD     =   h.OCPS_CD
		        )                                                   as OCPS_NM
		     ,  h.HLOF_STTS_CD                                      as HLOF_STTS_CD         -- 재직상태코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'HHZ_001'
		               and  MIS_COMN_CD     =   h.HLOF_STTS_CD
		        )                                                   as HLOF_STTS_NM
		     ,  to_char(h.ENCM_YMD, 'yyyymmdd')                     as APST_YMD
		     ,  to_char(h.RTRM_PRAP_DD, 'yyyymmdd')                 as APFN_YMD
		     ,  i.RDEX_TGPR_NM                                      as RDEX_TGPR_NM
		     ,  i.GEND_CD                                           as GEND_CD
		     ,  to_char(i.RDEX_TGPR_BTDT, 'yyyymmdd')               as RDEX_TGPR_BTDT
		     ,  i.RDEX_TGPR_FRRN                                    as RDEX_TGPR_FRRN
		     ,  i.RDEX_TGPR_BRRN                                    as RDEX_TGPR_BRRN
		     ,  i.ONSL_FMLY_DVSN_CD                                 as ONSL_FMLY_DVSN_CD
		     ,  i.RDEX_RLTN_CD                                      as RDEX_RLTN_CD
		     ,  i.FMLY_RLTN_CD                                      as FMLY_RLTN_CD
		     ,  case
		            when i.ONSL_FMLY_DVSN_CD = '01' then '본인'
		            else    (   select  COMN_CD_NM
		                          from  HZMICOCDT
		                         where  COMN_GRP_CD     =   'GP058'
		                           and  MIS_COMN_CD     =   i.FMLY_RLTN_CD
		                    )
		            end                                             as FMLY_RLTN_NM
		  from  LIST_EMPL h
		     ,  (   -- 직원본인
		            select  a.EMNO                  as EMPL_ID
		                 ,  a.EMPY_NM               as RDEX_TGPR_NM
		                 ,  a.GEND_CD               as GEND_CD
		                 ,  a.BTDT                  as RDEX_TGPR_BTDT
		                 ,  a.EMPL_FRRN             as RDEX_TGPR_FRRN
		                 ,  a.EMPL_BRRN             as RDEX_TGPR_BRRN
		                 ,  '01'                    as ONSL_FMLY_DVSN_CD    -- ACB_028 / 01 : 본인
		                 ,  '01'                    as RDEX_RLTN_CD         -- AC009 / 01 : 직원 본인
		                 ,  ''                      as FMLY_RLTN_CD         -- 가족관계코드
		              from  LIST_EMPL a
		            -- 직원가족
		            union all
		            select  b.EMNO                  as EMPL_ID
		                 ,  b.FMLY_NM               as RDEX_TGPR_NM
		                 ,  b.GEND_CD               as GEND_CD
		                 ,  b.BTDT                  as RDEX_TGPR_BTDT
		                 ,  b.FMLY_FRRN             as RDEX_TGPR_FRRN
		                 ,  b.FMLY_BRRN             as RDEX_TGPR_BRRN
		                 ,  '02'                    as ONSL_FMLY_DVSN_CD    -- ACB_028 / 01 : 본인
		                 ,  ''                      as RDEX_RLTN_CD         -- AC009 / 06 : 직원 가족
		                 ,  b.FMLY_RLTN_CD          as FMLY_RLTN_CD         -- 가족관계코드
		              from  LIST_EMPL a
		                 ,  HHFAMILYT b
		             where  b.EMNO      =   a.EMNO
		        ) i
		 where  i.EMPL_ID   =   h.EMNO
		-- 본교 직원/가족
		union all
		select  a.RDEX_ALCM_CD                                  as RDEX_ALCM_CD
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'AC034'
		               and  COMN_DTLS_CD    =   a.RDEX_ALCM_CD
		        )                                               as RDEX_ALCM_NM
		     ,  a.EMPL_DVSN_VL || a.EMPL_DVSN_CD                as DPRT_CD
		     ,  '고려대학교 '
		        ||  case
		                when a.EMPL_DVSN_VL = 'UNIV' then a.EMPL_DVSN_NM
		                else '교직원'
		                end                                     as DPRT_NM
		     ,  a.EMPL_ID                                       as EMPL_ID
		     ,  a.EMPL_NM                                       as EMPL_NM
		     ,  ''                                              as OCFM_CD              -- 직종코드
		     ,  a.OCFM_NM                                       as OCFM_NM
		     ,  ''                                              as OCPS_CD              -- 직위코드
		     ,  case
		            when a.EMPL_DVSN_VL = 'UNIV' then a.FMLY_NM     -- 대학은 가족명에 과정보가 들어옴
		            else a.EMPL_DVSN_NM
		            end                                         as OCPS_NM
		     ,  a.HLOF_STTS_CD                                  as HLOF_STTS_CD         -- 재직상태코드
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'ACB_035'
		               and  COMN_DTLS_CD    =   a.HLOF_STTS_CD
		        )                                               as HLOF_STTS_NM
		     ,  to_char(a.APST_YMD, 'yyyymmdd')                 as APST_YMD
		     ,  to_char(a.APFN_YMD, 'yyyymmdd')                 as APFN_YMD
		     ,  case
		            when a.ONSL_FMLY_DVSN_CD = '01' then a.EMPL_NM
		            else a.FMLY_NM
		            end                                         as RDEX_TGPR_NM
		     ,  case
		            when substr(a.RDEX_TGPR_BRRN, 1, 1) in ('1', '3', '5', '7')
		                then    'M'
		            else        'F'
		            end                                         as GEND_CD
		     ,  ''                                              as RDEX_TGPR_BTDT
		     ,  a.RDEX_TGPR_FRRN                                as RDEX_TGPR_FRRN
		     ,  a.RDEX_TGPR_BRRN                                as RDEX_TGPR_BRRN
		     ,  a.ONSL_FMLY_DVSN_CD                             as ONSL_FMLY_DVSN_CD
		     ,  case
		            when a.ONSL_FMLY_DVSN_CD = '01' then '01'       -- AC009 / 01 : 직원 본인, 06 : 직원 가족
		            else ''
		            end                                         as RDEX_RLTN_CD
		     ,  ''                                              as FMLY_RLTN_CD
		     ,  case
		            when a.ONSL_FMLY_DVSN_CD = '01' then '본인'
		            else    (   select  DETL_CD_NM
		                          from  CCCMCDDMT
		                         where  COMN_GRP_CD     =   'ACB_034'
		                           and  COMN_DTLS_CD    =   a.FMLY_RLTN_NM
		                    )
		            end                                         as FMLY_RLTN_NM
		  from  LIST_KU a
		 order
		    by  RDEX_ALCM_CD
		     ,  DPRT_CD
		     ,  DPRT_NM
		     ,  EMPL_ID
		     ,  ONSL_FMLY_DVSN_CD
		     ,  FMLY_RLTN_CD
		;
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdex-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="emplRdexTgprSno" column="EMPL_RDEX_TGPR_SNO"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="emplId" column="EMPL_ID"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="emfmSno" column="EMFM_SNO"/>
		<result property="ptno" column="PTNO"/>
		<result property="onslFmlyDvsnCd" column="ONSL_FMLY_DVSN_CD"/>
		<result property="onslFmlyDvsnNm" column="ONSL_FMLY_DVSN_NM"/>
		<result property="rdexRltnCd" column="RDEX_RLTN_CD"/>
		<result property="rdexRltnNm" column="RDEX_RLTN_NM"/>
		<result property="rdexTgprNm" column="RDEX_TGPR_NM"/>
		<result property="rdexTgprBtdt" column="RDEX_TGPR_BTDT"/>
		<result property="rdexTgprFrrn" column="RDEX_TGPR_FRRN"/>
		<result property="rdexTgprBrrn" column="RDEX_TGPR_BRRN"/>
		<result property="gendCd" column="GEND_CD"/>
		<result property="rdexAlcmCd" column="RDEX_ALCM_CD"/>
		<result property="rdexAlcmNm" column="RDEX_ALCM_NM"/>
		<result property="dprtNm" column="DPRT_NM"/>
		<result property="ocfmNm" column="OCFM_NM"/>
		<result property="ocpsNm" column="OCPS_NM"/>
		<result property="bsisRdexCd" column="BSIS_RDEX_CD"/>
		<result property="rdexNm" column="RDEX_NM"/>
		<result property="rmrkCtn" column="RMRK_CTN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdex (직원감면대상 조회) 
        Description :                                           직원감면대상 조회
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdex-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdex"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdex-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdex */
		select  a.EMPL_RDEX_TGPR_SNO                            as EMPL_RDEX_TGPR_SNO
		     ,  to_char(a.APST_YMD, 'yyyymmdd')                 as APST_YMD
		     ,  to_char(a.APFN_YMD, 'yyyymmdd')                 as APFN_YMD
		     ,  a.EMPL_ID                                       as EMPL_ID
		     ,  a.EMPL_NM                                       as EMPL_NM
		     ,  a.EMFM_SNO                                      as EMFM_SNO
		     ,  a.PTNO                                          as PTNO
		     ,  a.ONSL_FMLY_DVSN_CD                             as ONSL_FMLY_DVSN_CD
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'ACB_028'
		               and  COMN_DTLS_CD    =   a.ONSL_FMLY_DVSN_CD
		        )                                               as ONSL_FMLY_DVSN_NM
		     ,  a.RDEX_RLTN_CD                                  as RDEX_RLTN_CD
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'AC009'
		               and  COMN_DTLS_CD    =   a.RDEX_RLTN_CD
		        )                                               as RDEX_RLTN_NM
		     ,  a.RDEX_TGPR_NM                                  as RDEX_TGPR_NM
		     ,  to_char(a.RDEX_TGPR_BTDT, 'yyyymmdd')           as RDEX_TGPR_BTDT
		     ,  a.RDEX_TGPR_FRRN                                as RDEX_TGPR_FRRN
		     ,  a.RDEX_TGPR_BRRN                                as RDEX_TGPR_BRRN
		     ,  a.GEND_CD                                       as GEND_CD
		     ,  a.RDEX_ALCM_CD                                  as RDEX_ALCM_CD
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'AC034'
		               and  COMN_DTLS_CD    =   a.RDEX_ALCM_CD
		        )                                               as RDEX_ALCM_NM         -- 감면관계사명
		     ,  a.DPRT_NM                                       as DPRT_NM
		     ,  a.OCFM_NM                                       as OCFM_NM              -- 직종명
		     ,  a.OCPS_NM                                       as OCPS_NM              -- 직위명
		     ,  a.BSIS_RDEX_CD                                  as BSIS_RDEX_CD
		     ,  (   select  CNPL_NM
		              from  ACCNCNPLT
		             where  CNPL_RDEX_CD    =   a.BSIS_RDEX_CD
		               and  trunc(sysdate) between APST_YMD and APFN_YMD
		        )                                               as RDEX_NM              -- 감면명
		     ,  a.RMRK_CTN                                      as RMRK_CTN
		  from  ACCNERTPT a
		 where  1 = 1
		 <choose>
		   <!-- #{inqrCndtVl} -->
		   <when test='inqrCndtVl != null and inqrCndtVl == "ACTV_TRGT"'>               -- (인터페이스 연결Key기준) 유효한 동기화대상 조회
		   and  a.EMPL_ID           =   #{emplId}
		   and  a.EMFM_SNO          =   #{emfmSno}
		   and  a.RDEX_ALCM_CD      =   #{rdexAlcmCd}
		   and  trunc(sysdate) between a.APST_YMD and a.APFN_YMD
		   </when>
		   <when test='inqrCndtVl != null and inqrCndtVl == "LIST_CNDT"'>               -- 일반조건으로 조회
		   and  trim(#{emplId} || #{ptno} || #{inqrYmd} || #{rdexTgprNm}) is not null   -- 필수항목 누락에 대비한 조건...
		   </when>
		   <when test='inqrCndtVl != null and inqrCndtVl == "PK_CNDT"'>                 -- PK 조건으로 조회
		   and  a.EMPL_RDEX_TGPR_SNO    =   #{emplRdexTgprSno}
		   </when>
		   <otherwise>
		   and  1 = 2
		   </otherwise>
		 </choose>
		 <if test='inqrCndtVl == "LIST_CNDT" and emplId != null and emplId != ""'>
		   and  a.EMPL_ID           =   #{emplId}
		 </if>
		 <if test='inqrCndtVl == "LIST_CNDT" and ptno != null and ptno != ""'>
		   and  a.PTNO              =   #{ptno}
		 </if>
		 <if test='inqrCndtVl == "LIST_CNDT" and inqrYmd != null and inqrYmd != ""'>
		   and  to_date(#{inqrYmd}, 'yyyymmdd') between a.APST_YMD and a.APFN_YMD
		 </if>
		 <if test='inqrCndtVl == "LIST_CNDT" and rdexTgprNm != null and rdexTgprNm != ""'>
		   and  a.RDEX_TGPR_NM      =   #{rdexTgprNm}
		 </if>
		 <if test='rdexAlcmCd != null and rdexAlcmCd != ""'>
		   and  a.RDEX_ALCM_CD      =   #{rdexAlcmCd}
		 </if>
		 <if test='rdexRltnCd != null and rdexRltnCd != ""'>
		   and  a.RDEX_RLTN_CD      =   #{rdexRltnCd}
		 </if>
		 <if test='rdexTgprFrrn != null and rdexTgprFrrn != ""'>
		   and  a.RDEX_TGPR_FRRN    =   #{rdexTgprFrrn}
		 </if>
		 <if test='rdexTgprBrrn != null and rdexTgprBrrn != ""'>
		   and  a.RDEX_TGPR_BRRN    =   #{rdexTgprBrrn}
		 </if>
		 <!-- #{wodvCd} -->
		 <if test='wodvCd != null and wodvCd == "A"'>  /* 환자번호 매핑 안된건을 조회하기 위해. */
		   and  a.PTNO is null
		 </if>
		 order
		    by  a.RDEX_RLTN_CD
		     ,  a.RDEX_TGPR_FRRN
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexSrch-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="emplId" column="EMPL_ID"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="rdexAlcmCd" column="RDEX_ALCM_CD"/>
		<result property="rdexAlcmNm" column="RDEX_ALCM_NM"/>
		<result property="dprtNm" column="DPRT_NM"/>
		<result property="ptno" column="PTNO"/>
		<result property="rdexCd" column="RDEX_CD"/>
		<result property="rdexNm" column="RDEX_NM"/>
		<result property="btdt" column="BTDT"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexSrch (직원감면 대상자 검색) 
        Description :                                           직원감면 대상자 검색
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexSrch-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexSrch"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexSrch-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexSrch */
		select  a.EMPL_ID                                           as EMPL_ID          -- 직원사번
		     ,  a.EMPL_NM                                           as EMPL_NM          -- 직원명
		     ,  to_char(a.APST_YMD, 'yyyymmdd')                     as APST_YMD         -- 적용개시일자
		     ,  to_char(a.APFN_YMD, 'yyyymmdd')                     as APFN_YMD         -- 적용종료일자
		     ,  a.RDEX_ALCM_CD                                      as RDEX_ALCM_CD     -- 감면관계사코드
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'AC034'
		               and  COMN_DTLS_CD    =   a.RDEX_ALCM_CD
		        )                                                   as RDEX_ALCM_NM     -- 감면관계사명
		     ,  a.DPRT_NM                                           as DPRT_NM          -- 부서명
		     ,  a.PTNO                                              as PTNO             -- 환자번호
		     ,  a.BSIS_RDEX_CD                                      as RDEX_CD          -- 감면코드
		     ,  (   select  CNPL_NM
		              from  ACCNCNPLT
		             where  CNPL_RDEX_CD    =   a.BSIS_RDEX_CD
		               and  trunc(sysdate) between APST_YMD and APFN_YMD
		        )                                                   as RDEX_NM          -- 감면명
		     ,  to_char(a.RDEX_TGPR_BTDT, 'yyyymmdd')               as BTDT             -- 직원생년월일
		  from  ACCNERTPT a         -- 직원감면대상자
		 where  a.EMPL_ID   in  (   select  EMPL_ID
		                              from  ACCNERTPT a
		                             where  (   a.PTNO      =   #{srwrVl}
		                                    or  a.EMPL_ID   =   #{srwrVl}
		                                    or  a.EMPL_NM   =   #{srwrVl}
		                                    )
		                        )
		   and  (   a.RDEX_RLTN_CD      =   '01'        -- 감면관계코드 / 01 : 직원 본인
		        or  a.ONSL_FMLY_DVSN_CD =   '01'        -- 본인가족구분코드 / 01 : 본인
		        )
		 <if test='inqrYmd != null and inqrYmd != ""'>
		   and  to_date(#{inqrYmd}, 'yyyymmdd') between a.APST_YMD and nvl(a.APFN_YMD, to_date('29991231', 'yyyymmdd'))
		 </if>
		 order
		    by  RDEX_ALCM_CD
		     ,  EMPL_NM
		     ,  APST_YMD
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexInrf-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="rdexAlcmCd" column="RDEX_ALCM_CD"/>
		<result property="emplId" column="EMPL_ID"/>
		<result property="emfmSno" column="EMFM_SNO"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="emplClsfCd" column="EMPL_CLSF_CD"/>
		<result property="ocfmNm" column="OCFM_NM"/>
		<result property="ocpsNm" column="OCPS_NM"/>
		<result property="alcmDprtCd" column="ALCM_DPRT_CD"/>
		<result property="alcmDprtNm" column="ALCM_DPRT_NM"/>
		<result property="onslFmlyDvsnCd" column="ONSL_FMLY_DVSN_CD"/>
		<result property="fmlyRltnCd" column="FMLY_RLTN_CD"/>
		<result property="fmlyRltnNm" column="FMLY_RLTN_NM"/>
		<result property="rdexTgprNm" column="RDEX_TGPR_NM"/>
		<result property="rdexTgprBtdt" column="RDEX_TGPR_BTDT"/>
		<result property="rdexTgprFrrn" column="RDEX_TGPR_FRRN"/>
		<result property="rdexTgprBrrn" column="RDEX_TGPR_BRRN"/>
		<result property="gendCd" column="GEND_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexInrf (직원감면 I/F정보 조회) 
        Description :                                           직원감면 I/F정보 조회
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexInrf-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexInrf"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexInrf-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplRdexInrf */
		select  a.RDEX_ALCM_CD                          as RDEX_ALCM_CD
		     ,  a.EMPL_ID                               as EMPL_ID
		     ,  a.EMFM_SNO                              as EMFM_SNO
		     ,  a.EMPL_NM                               as EMPL_NM
		     ,  to_char(a.APST_YMD, 'yyyymmdd')         as APST_YMD
		     ,  to_char(a.APFN_YMD, 'yyyymmdd')         as APFN_YMD
		     ,  a.EMPL_CLSF_CD                          as EMPL_CLSF_CD
		     ,  a.OCFM_NM                               as OCFM_NM
		     ,  a.OCPS_NM                               as OCPS_NM
		     ,  a.ALCM_DPRT_CD                          as ALCM_DPRT_CD
		     ,  a.ALCM_DPRT_NM                          as ALCM_DPRT_NM
		     ,  a.ONSL_FMLY_DVSN_CD                     as ONSL_FMLY_DVSN_CD
		     ,  a.FMLY_RLTN_CD                          as FMLY_RLTN_CD
		     ,  a.FMLY_RLTN_NM                          as FMLY_RLTN_NM
		     ,  a.RDEX_TGPR_NM                          as RDEX_TGPR_NM
		     ,  to_char(a.RDEX_TGPR_BTDT, 'yyyymmdd')   as RDEX_TGPR_BTDT
		     ,  a.RDEX_TGPR_FRRN                        as RDEX_TGPR_FRRN
		     ,  a.RDEX_TGPR_BRRN                        as RDEX_TGPR_BRRN
		     ,  a.GEND_CD                               as GEND_CD
		  from  SEHRCOM.ACCNRRIFT a
		 where  trim(#{rdexAlcmCd} || #{emplId} || #{rdexTgprNm} || #{inqrYmd}) is not null
		 <if test='rdexAlcmCd != null and rdexAlcmCd != ""'>
		   and  a.RDEX_ALCM_CD  =   #{rdexAlcmCd}
		 </if>
		 <if test='emplId != null and emplId != ""'>
		   and  a.EMPL_ID       =   #{emplId}
		 </if>
		 <if test='emfmSno != null and emfmSno != 0'>
		   and  a.EMFM_SNO      =   #{emfmSno}
		 </if>
		 <if test='rdexTgprNm != null and rdexTgprNm != ""'>
		   and  a.RDEX_TGPR_NM  =   #{rdexTgprNm}
		 </if>
		 <if test='inqrYmd != null and inqrYmd != ""'>
		   and  to_date(#{inqrYmd}, 'yyyymmdd') between a.APST_YMD and a.APFN_YMD
		 </if>
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplSrchAPI-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="emplId" column="EMPL_ID"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="dprtNm" column="DPRT_NM"/>
		<result property="clno" column="CLNO"/>
		<result property="rdexAlcmNm" column="RDEX_ALCM_NM"/>
		<result property="encmYmd" column="ENCM_YMD"/>
		<result property="rtrmYmd" column="RTRM_YMD"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="bsplCd" column="BSPL_CD"/>
		<result property="hlofSttsCd" column="HLOF_STTS_CD"/>
		<result property="hlofSttsNm" column="HLOF_STTS_NM"/>
		<result property="ocfmCd" column="OCFM_CD"/>
		<result property="ocfmNm" column="OCFM_NM"/>
		<result property="ocpsCd" column="OCPS_CD"/>
		<result property="ocpsNm" column="OCPS_NM"/>
		<result property="btdt" column="BTDT"/>
		<result property="rsrn" column="RSRN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplSrchAPI (직원(동문)정보조회 API) 
        Description :                                           직원(동문)정보조회 API
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplSrchAPI-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplSrchAPI"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplSrchAPI-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listEmplSrchAPI */
		with HSPT_INFM as
		(
		    select  a.RCPR_INSY_ID                                  as RCPR_INSY_ID
		         ,  case
		                when a.RCPR_INSY_ID = '11100117' then '1A'  -- 안암
		                when a.RCPR_INSY_ID = '11100494' then '2A'  -- 구로
		                when a.RCPR_INSY_ID = '31100252' then '3A'  -- 안산
		                end                                         as ABRV_HSPT_CD
		         ,  a.HSPT_NM                                       as HSPT_NM
		      from  CCCHOSPMT a
		     where  trunc(sysdate) between a.APST_YMD and a.APFN_YMD
		       and  rownum = 1
		)
		-- 의료원 직원
		select  a.EMNO                                          as EMPL_ID
		     ,  a.EMPY_NM                                       as EMPL_NM
		     ,  nvl (   (   select  KORN_DPRT_NM
		                      from  HZDEPTMMT
		                     where  DPRT_CD     =   a.DPRT_CD
		                )
		            ,   nvl(a.DPRT_CD, '*')
		            )                                           as DPRT_NM
		     ,  a.EMPY_CLNO                                     as CLNO
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'AC034'
		               and  COMN_DTLS_CD    =   a.BSPL_CD
		        )                                               as RDEX_ALCM_NM
		     ,  to_char(a.ENCM_YMD, 'yyyymmdd')                 as ENCM_YMD         -- 입사일자
		     ,  to_char(a.RTRM_PRAP_DD, 'yyyymmdd')             as RTRM_YMD         -- 퇴직일자
		     ,  case
		            when a.BSPL_CD = b.ABRV_HSPT_CD then    1
		            else                                    2
		            end                                         as SORT_SQNC
		     ,  a.BSPL_CD                                       as BSPL_CD
		     ,  a.HLOF_STTS_CD                                  as HLOF_STTS_CD     -- 재직상태코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'HHZ_001'
		               and  MIS_COMN_CD     =   a.HLOF_STTS_CD
		        )                                               as HLOF_STTS_NM     -- 재작상태명
		     ,  a.OCFM_CD                                       as OCFM_CD          -- 직종코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'GP006'
		               and  MIS_COMN_CD     =   a.OCFM_CD
		        )                                               as OCFM_NM
		     ,  a.OCPS_CD                                       as OCPS_CD          -- 직위코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'GP008'
		               and  MIS_COMN_CD     =   a.OCPS_CD
		        )                                               as OCPS_NM
		     ,  to_char(a.BTDT, 'yyyymmdd')                     as BTDT
		     ,  a.EMPL_FRRN || a.EMPL_BRRN                      as RSRN
		  from  HZUSERMMT a
		     ,  HSPT_INFM b
		 where  trim(#{emplId} || #{emplNm}) is not null
		 <if test='emplId != null and emplId != ""'>
		   and  a.EMNO          =   #{emplId}
		 </if>
		 <if test='emplNm != null and emplNm != ""'>
		   and  a.EMPY_NM       =   #{emplNm}
		 </if>
		-- 본교직원
		union all
		select  a.EMPL_ID                                       as EMPL_ID
		     ,  a.EMPL_NM                                       as EMPL_NM
		     ,  a.OCFM_NM
		        ||  ' '
		        ||  case
		                when a.EMPL_DVSN_VL = 'UNIV' then a.FMLY_NM     -- 대학은 가족명에 과정보가 들어옴
		                else a.EMPL_DVSN_NM
		                end                                     as DPRT_NM
		     ,  ''                                              as CLNO
		     ,  '본교 '
		        ||  case
		                when a.EMPL_DVSN_VL = 'UNIV' then a.EMPL_DVSN_NM
		                else '교직원'
		                end                                     as RDEX_ALCM_NM
		     ,  to_char(a.APST_YMD, 'yyyymmdd')                 as ENCM_YMD             -- 입사일자
		     ,  to_char(a.APFN_YMD, 'yyyymmdd')                 as RTRM_YMD             -- 퇴직일자
		     ,  case
		            when a.EMPL_DVSN_CD in ('4', '5', '6', '7') then    12
		            else                                                11
		            end                                         as SORT_SQNC
		     ,  a.EMPL_DVSN_CD                                  as BSPL_CD
		     ,  a.HLOF_STTS_CD                                  as HLOF_STTS_CD         -- 재직상태코드
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'ACB_035'
		               and  COMN_DTLS_CD    =   a.HLOF_STTS_CD
		        )                                               as HLOF_STTS_NM
		     ,  ''                                              as OCFM_CD              -- 직종코드
		     ,  a.OCFM_NM                                       as OCFM_NM
		     ,  ''                                              as OCPS_CD              -- 직위코드
		     ,  case
		            when a.EMPL_DVSN_VL = 'UNIV' then a.FMLY_NM     -- 대학은 가족명에 과정보가 들어옴
		            else a.EMPL_DVSN_NM
		            end                                         as OCPS_NM
		     ,  ''                                              as BTDT
		     ,  a.EMPL_RSRN                                     as RSRN
		  from  (   select  case
		                        when h.EMPL_DVSN_CD in ('4', '5', '6', '7')
		                            then    'UNIV'
		                        else        'EMPL'
		                        end                                         as EMPL_DVSN_VL
		                 ,  (   select  DETL_CD_NM
		                          from  CCCMCDDMT
		                         where  COMN_GRP_CD     =   'ACB_033'
		                           and  COMN_DTLS_CD    =   h.EMPL_DVSN_CD
		                    )                                               as EMPL_DVSN_NM
		                 ,  h.*
		              from  ACETKUEFT h
		             where  h.EMPL_RSRN     =   h.FMLY_RSRN
		               and  h.DLTN_DT is null
		               and  trim(#{emplId} || #{emplNm}) is not null
		             <if test='emplId != null and emplId != ""'>
		               and  h.EMPL_ID       =   #{emplId}
		             </if>
		             <if test='emplNm != null and emplNm != ""'>
		               and  h.EMPL_NM       =   #{emplNm}
		             </if>
		        ) a
		 order
		    by  SORT_SQNC
		     ,  BSPL_CD
		     ,  EMPL_ID
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByRdexCd-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="rdexCd" column="RDEX_CD"/>
		<result property="rdexNm" column="RDEX_NM"/>
		<result property="emplId" column="EMPL_ID"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="rdexRltnCd" column="RDEX_RLTN_CD"/>
		<result property="rdexRltnNm" column="RDEX_RLTN_NM"/>
		<result property="ptno" column="PTNO"/>
		<result property="ptntNm" column="PTNT_NM"/>
		<result property="mcrcYmd" column="MCRC_YMD"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="abrvMcdpCd" column="ABRV_MCDP_CD"/>
		<result property="tomcAmt" column="TOMC_AMT"/>
		<result property="rcpcRdexAmt" column="RCPC_RDEX_AMT"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByRdexCd (감면코드별 금액조회) 
        Description :                                           감면코드별 금액조회
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByRdexCd-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByRdexCd"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByRdexCd-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByRdexCd */
		with LIST_RDEX as
		(   select  a.PTNO                      as PTNO
		         ,  a.MCRC_YMD                  as MCRC_YMD
		         ,  b.CODV_CD                   as CODV_CD
		         ,  b.MCDP_CD                   as MCDP_CD
		         ,  a.CNPL_RDEX_CD              as CNPL_RDEX_CD
		         ,  sum(a.RCPC_RDEX_AMT)        as RCPC_RDEX_AMT
		      from  ACRCCPRCT a     -- 환자계약처수납
		         ,  APRCRPTNT b
		     where  1 = 1
		       and  a.MCRC_YMD between to_date(#{apstYmd}, 'yyyymmdd') and to_date(#{apfnYmd}, 'yyyymmdd')
		       and  a.CNPL_RDEX_DVSN_CD in ('A', 'R')
		     <if test='rdexCd != null and rdexCd != ""'>
		       and  a.CNPL_RDEX_CD  =   #{rdexCd}
		     </if>
		       and  b.MDRP_NO       =   a.MDRP_NO
		       and  b.CNCL_DT is null
		       and  exists  (   select  1 
		                          from  ACCNERTPT h
		                         where  h.PTNO      =   a.PTNO 
		                           and  a.MCRC_YMD between h.APST_YMD and h.APFN_YMD
		                    )
		     group
		        by  a.PTNO
		         ,  a.MCRC_YMD
		         ,  b.CODV_CD
		         ,  b.MCDP_CD
		         ,  a.CNPL_RDEX_CD
		)
		select  a.CNPL_RDEX_CD                                  as RDEX_CD
		     ,  (   select  CNPL_NM
		              from  ACCNCNPLT
		             where  CNPL_RDEX_CD    =   a.CNPL_RDEX_CD
		               and  a.MCRC_YMD between APST_YMD and APFN_YMD
		        )                                               as RDEX_NM
		     ,  c.EMPL_ID                                       as EMPL_ID
		     ,  c.EMPL_NM                                       as EMPL_NM
		     ,  c.RDEX_RLTN_CD                                  as RDEX_RLTN_CD
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'AC009'
		               and  COMN_DTLS_CD    =   c.RDEX_RLTN_CD
		        )                                               as RDEX_RLTN_NM
		     ,  a.PTNO                                          as PTNO
		     ,  d.PTNT_NM                                       as PTNT_NM
		     ,  to_char(a.MCRC_YMD, 'yyyymmdd')                 as MCRC_YMD
		     ,  a.CODV_CD                                       as CODV_CD
		     ,  a.MCDP_CD                                       as MCDP_CD
		     ,  (   select  ABRV_DPRT_CD
		              from  HZDEPTMMT
		             where  DPRT_CD     =   a.MCDP_CD
		        )                                               as ABRV_MCDP_CD
		     ,  b.TOMC_AMT                                      as TOMC_AMT
		     ,  a.RCPC_RDEX_AMT                                 as RCPC_RDEX_AMT
		  from  LIST_RDEX a
		     ,  (   select  a.PTNO              as PTNO
		                 ,  a.MCRC_YMD          as MCRC_YMD
		                 ,  a.CODV_CD           as CODV_CD
		                 ,  a.MCDP_CD           as MCDP_CD
		                 ,  sum(TOMC_AMT)       as TOMC_AMT
		                 ,  sum(RDEX_AMT)       as RDEX_AMT
		              from  ACRCRCPCT a     -- 진료비수납
		                 ,  (   select  distinct
		                                PTNO
		                             ,  MCRC_YMD
		                             ,  CODV_CD
		                             ,  MCDP_CD
		                          from  LIST_RDEX
		                    ) b
		             where  b.PTNO      =   a.PTNO
		               and  b.MCRC_YMD  =   a.MCRC_YMD
		               and  b.CODV_CD   =   a.CODV_CD
		               and  b.MCDP_CD   =   a.MCDP_CD
		             group
		                by  a.PTNO
		                 ,  a.MCRC_YMD
		                 ,  a.CODV_CD
		                 ,  a.MCDP_CD
		        ) b
		     ,  (   select  a.PTNO                              as PTNO        
		                 ,  a.EMPL_ID                           as EMPL_ID     
		                 ,  a.EMPL_NM                           as EMPL_NM     
		                 ,  a.RDEX_RLTN_CD                      as RDEX_RLTN_CD
		                 ,  a.BSIS_RDEX_CD                      as BSIS_RDEX_CD
		                 ,  row_number() over
		                    (   partition by a.PTNO
		                        order by a.APFN_YMD desc, a.APST_YMD desc
		                    )                                   as SQNC
		              from  ACCNERTPT a
		                 ,  (   select  distinct
		                                PTNO
		                             ,  MCRC_YMD
		                          from  LIST_RDEX
		                    ) b
		             where  b.PTNO      =   a.PTNO
		               and  b.MCRC_YMD between a.APST_YMD and a.APFN_YMD
		        ) c
		     ,  APPTPTNTT d
		 where  a.RCPC_RDEX_AMT !=  0
		   and  b.PTNO          =   a.PTNO
		   and  b.MCRC_YMD      =   a.MCRC_YMD
		   and  b.CODV_CD       =   a.CODV_CD
		   and  b.MCDP_CD       =   a.MCDP_CD
		   and  c.PTNO          =   a.PTNO
		   and  c.SQNC          =   1               -- 환자의 가장최근 직원감면대상 정보
		   and  d.PTNO          =   a.PTNO
		 order
		    by  a.CNPL_RDEX_CD
		     ,  c.EMPL_ID
		     ,  a.PTNO
		     ,  a.MCRC_YMD
		     ,  a.CODV_CD
		     ,  a.MCDP_CD
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByTgpr-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ptntNm" column="PTNT_NM"/>
		<result property="rdexRltnCd" column="RDEX_RLTN_CD"/>
		<result property="rdexRltnNm" column="RDEX_RLTN_NM"/>
		<result property="bsisRdexCd" column="BSIS_RDEX_CD"/>
		<result property="bsisRdexNm" column="BSIS_RDEX_NM"/>
		<result property="mcrcYmd" column="MCRC_YMD"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="abrvMcdpCd" column="ABRV_MCDP_CD"/>
		<result property="tomcAmt" column="TOMC_AMT"/>
		<result property="rdexAmt" column="RDEX_AMT"/>
		<result property="rdexCd" column="RDEX_CD"/>
		<result property="rdexNm" column="RDEX_NM"/>
		<result property="rcpcRdexAmt" column="RCPC_RDEX_AMT"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByTgpr (감면대상자 금액조회) 
        Description :                                           감면대상자 금액조회
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByTgpr-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByTgpr"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByTgpr-result" useCache="true" flushCache="false">
		/* SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexAmtByTgpr */
		with LIST_TGPR as
		(   select  x.PTNO
		         ,  x.RDEX_RLTN_CD
		         ,  x.BSIS_RDEX_CD
		      from  (   select  a.PTNO                      as PTNO
		                     ,  a.RDEX_RLTN_CD              as RDEX_RLTN_CD
		                     ,  a.BSIS_RDEX_CD              as BSIS_RDEX_CD
		                     ,  row_number() over
		                        (   partition by a.PTNO
		                            order by a.APFN_YMD desc, a.APST_YMD desc
		                        )                           as SQNC
		                  from  ACCNERTPT a
		                 where  1 = 1
		                   and  a.EMPL_ID       =   #{emplId}
		                   and  a.PTNO is not null
		                 <if test='inqrYmd != null and inqrYmd != ""'>
		                   and  to_date(#{inqrYmd}, 'yyyymmdd') between a.APST_YMD and nvl(a.APFN_YMD, to_date('29991231', 'yyyymmdd'))
		                 </if>
		            ) x
		     where  x.SQNC  =   1
		)
		select  a.PTNO                                          as PTNO
		     ,  (   select  PTNT_NM
		              from  APPTPTNTT
		             where  PTNO    =   a.PTNO
		        )                                               as PTNT_NM
		     ,  a.RDEX_RLTN_CD                                  as RDEX_RLTN_CD             -- 감면관계코드
		     ,  (   select  DETL_CD_NM
		              from  CCCMCDDMT
		             where  COMN_GRP_CD     =   'AC009'
		               and  COMN_DTLS_CD    =   a.RDEX_RLTN_CD
		        )                                               as RDEX_RLTN_NM
		     ,  a.BSIS_RDEX_CD                                  as BSIS_RDEX_CD             -- 기본감면코드
		     ,  (   select  CNPL_NM
		              from  ACCNCNPLT
		             where  CNPL_RDEX_CD    =   a.BSIS_RDEX_CD
		               /* and  b.MCRC_YMD between APST_YMD and APFN_YMD */
		               and  rownum = 1
		        )                                               as BSIS_RDEX_NM             -- 기본감면명
		     ,  to_char(b.MCRC_YMD, 'yyyymmdd')                 as MCRC_YMD                 -- 진료비수납일자
		     ,  b.CODV_CD                                       as CODV_CD
		     ,  b.MCDP_CD                                       as MCDP_CD
		     ,  (   select  ABRV_DPRT_CD
		              from  HZDEPTMMT
		             where  DPRT_CD     =   b.MCDP_CD
		        )                                               as ABRV_MCDP_CD
		     ,  c.TOMC_AMT                                      as TOMC_AMT                 -- 총진료비금액
		     ,  c.RDEX_AMT                                      as RDEX_AMT                 -- 감면금액
		     ,  b.CNPL_RDEX_CD                                  as RDEX_CD                  -- (수납)감면코드
		     ,  (   select  CNPL_NM
		              from  ACCNCNPLT
		             where  CNPL_RDEX_CD    =   b.CNPL_RDEX_CD
		               and  b.MCRC_YMD between APST_YMD and APFN_YMD
		               and  rownum = 1
		        )                                               as RDEX_NM                  -- (수납)감면명
		     ,  b.RCPC_RDEX_AMT                                 as RCPC_RDEX_AMT            -- 감면금액
		  from  LIST_TGPR a
		     ,  (   select  a.PTNO                  as PTNO
		                 ,  b.MCRC_YMD              as MCRC_YMD
		                 ,  c.CODV_CD               as CODV_CD
		                 ,  c.MCDP_CD               as MCDP_CD
		                 ,  b.CNPL_RDEX_CD          as CNPL_RDEX_CD
		                 ,  sum(b.RCPC_RDEX_AMT)    as RCPC_RDEX_AMT
		              from  LIST_TGPR a
		                 ,  ACRCCPRCT b
		                 ,  APRCRPTNT c
		             where  b.PTNO          =   a.PTNO
		               and  b.MCRC_YMD between to_date(#{apstYmd}, 'yyyymmdd') and to_date(#{apfnYmd}, 'yyyymmdd')
		               and  b.RCPC_RDEX_AMT !=  0               -- 감면금액이 있는 건만 처리'
		               and  c.MDRP_NO   =   b.MDRP_NO
		               and  c.CNCL_DT is null
		             group
		                by  a.PTNO
		                 ,  b.MCRC_YMD
		                 ,  c.CODV_CD
		                 ,  c.MCDP_CD
		                 ,  b.CNPL_RDEX_CD
		        ) b
		     ,  (   select  a.PTNO                  as PTNO
		                 ,  b.MCRC_YMD              as MCRC_YMD
		                 ,  c.CODV_CD               as CODV_CD
		                 ,  c.MCDP_CD               as MCDP_CD
		                 ,  sum(b.TOMC_AMT)         as TOMC_AMT         -- 총진료비금액
		                 ,  sum(b.RDEX_AMT)         as RDEX_AMT         -- 감면금액
		              from  LIST_TGPR a
		                 ,  ACRCRCPCT b
		                 ,  APRCRPTNT c
		             where  b.PTNO          =   a.PTNO
		               and  b.MCRC_YMD between to_date(#{apstYmd}, 'yyyymmdd') and to_date(#{apfnYmd}, 'yyyymmdd')
		               and  c.MDRP_NO   =   b.MDRP_NO
		               and  c.CNCL_DT is null
		             group
		                by  a.PTNO
		                 ,  b.MCRC_YMD
		                 ,  c.CODV_CD
		                 ,  c.MCDP_CD
		        ) c
		 where  b.PTNO          =   a.PTNO
		   and  b.RCPC_RDEX_AMT !=  0
		   and  c.PTNO          =   b.PTNO
		   and  c.MCRC_YMD      =   b.MCRC_YMD
		   and  c.CODV_CD       =   b.CODV_CD
		   and  c.MCDP_CD       =   b.MCDP_CD
		 order
		    by  a.PTNO
		     ,  b.MCRC_YMD
		     ,  b.CODV_CD
		     ,  b.MCDP_CD
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexBsif-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="rdexAlcmCd" column="RDEX_ALCM_CD"/>
		<result property="emplClsfCd" column="EMPL_CLSF_CD"/>
		<result property="onslFmlyDvsnCd" column="ONSL_FMLY_DVSN_CD"/>
		<result property="fmlyRltnCd" column="FMLY_RLTN_CD"/>
		<result property="cndtVl" column="CNDT_VL"/>
		<result property="rdexRltnCd" column="RDEX_RLTN_CD"/>
		<result property="bsisRdexCd" column="BSIS_RDEX_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexBsif (감면기본정보 조회) 
        Description :                                           감면기본정보 조회
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexBsif-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexBsif"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexBsif-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-listRdexBsif */
		<![CDATA[
		with LIST_RDEX as
		(
		select  instr(a.MCCS_DTLS_CTRL_CD, '_', 1, 1)       as INDX_1
		     ,  instr(a.MCCS_DTLS_CTRL_CD, '_', 1, 2)       as INDX_2
		     ,  instr(a.MCCS_DTLS_CTRL_CD, '_', 1, 3)       as INDX_3
		     ,  a.*
		  from  ACCTRLMMT a
		 where  a.MCCS_CTRL_CD = 'ACB_011'
		)
		select  x.RDEX_ALCM_CD
		     ,  x.EMPL_CLSF_CD
		     ,  x.ONSL_FMLY_DVSN_CD
		     ,  x.FMLY_RLTN_CD
		     ,  x.CNDT_VL
		     ,  x.RDEX_RLTN_CD
		     ,  x.BSIS_RDEX_CD
		  from  (
		            select  substr(a.MCCS_DTLS_CTRL_CD, 1, a.INDX_1 - 1)    as RDEX_ALCM_CD         -- 감면관계사코드
		                 ,  case
		                        when a.INDX_2 > 0 then  substr(a.MCCS_DTLS_CTRL_CD, a.INDX_1 + 1, a.INDX_2 - a.INDX_1 - 1)
		                        else                    substr(a.MCCS_DTLS_CTRL_CD, a.INDX_1 + 1, 20)
		                        end                                         as EMPL_CLSF_CD         -- 직원분류코드
		                 ,  case
		                        when a.INDX_3 > 0 then  substr(a.MCCS_DTLS_CTRL_CD, a.INDX_2 + 1, a.INDX_3 - a.INDX_2 - 1)
		                        else                    substr(a.MCCS_DTLS_CTRL_CD, a.INDX_2 + 1, 20)
		                        end                                         as ONSL_FMLY_DVSN_CD    -- 본인가족구분코드
		                 ,  case
		                        when a.INDX_3 > 0 then  substr(a.MCCS_DTLS_CTRL_CD, a.INDX_3 + 1, 20)
		                        end                                         as FMLY_RLTN_CD         -- 가족관계코드
		                 ,  a.CTRL_DSCR_CTN                                 as CNDT_VL
		                 ,  a.MCCS_CTRL_CHRC_VL1                            as RDEX_RLTN_CD         -- 감면관계코드
		                 ,  a.MCCS_CTRL_CHRC_VL3                            as BSIS_RDEX_CD         -- 기본감면코드
		              from  LIST_RDEX a
		        ) x
		 where  x.RDEX_ALCM_CD      =   #{rdexAlcmCd}
		   and  (   #{emplClsfCd}   =   '*'
		        or  x.EMPL_CLSF_CD  =   #{emplClsfCd}
		        )
		   and  x.ONSL_FMLY_DVSN_CD =   #{onslFmlyDvsnCd}
		   and  nvl(x.FMLY_RLTN_CD, '*') = nvl(#{fmlyRltnCd}, '*')
		   and  (   rtrim(#{cndtVl1} || #{cndtVl2}) is null
		          or  
		            rtrim(#{cndtVl1} || #{cndtVl2}) is not null  ---조건값 들어와도 무시
		        --or  x.CNDT_VL like '%(' || {cndtVl1} || ',' || {cndtVl2} || ')%'      -- (직종,직위)
		        --or  x.CNDT_VL like '%(' || {cndtVl1} || ',*)%'
		        )
		 order
		    by  x.BSIS_RDEX_CD
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="emplId" column="EMPL_ID"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="rdexAlcmCd" column="RDEX_ALCM_CD"/>
		<result property="dprtNm" column="DPRT_NM"/>
		<result property="ocfmCd" column="OCFM_CD"/>
		<result property="ocfmNm" column="OCFM_NM"/>
		<result property="ocpsCd" column="OCPS_CD"/>
		<result property="ocpsNm" column="OCPS_NM"/>
		<result property="emfmSno" column="EMFM_SNO"/>
		<result property="fmlyRltnCd" column="FMLY_RLTN_CD"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="rdexTgprNm" column="RDEX_TGPR_NM"/>
		<result property="rdexTgprBtdt" column="RDEX_TGPR_BTDT"/>
		<result property="gendCd" column="GEND_CD"/>
		<result property="rdexTgprFrrn" column="RDEX_TGPR_FRRN"/>
		<result property="rdexTgprBrrn" column="RDEX_TGPR_BRRN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm (인사정보(직원본인, 직원가족) 조회) 
        Description :                                           인사정보(직원본인, 직원가족) 조회
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm */
		select  a.EMNO                                                                  as EMPL_ID
		     ,  a.EMPY_NM                                                               as EMPL_NM
		     ,  a.BSPL_CD                                                               as RDEX_ALCM_CD
		     ,  (   select  KORN_DPRT_NM
		              from  HZDEPTMMT
		             where  DPRT_CD         =   a.DPRT_CD
		        )                                                                       as DPRT_NM
		     ,  a.OCFM_CD                                                               as OCFM_CD              -- 직종코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'GP006'
		               and  MIS_COMN_CD     =   a.OCFM_CD
		        )                                                                       as OCFM_NM
		     ,  a.OCPS_CD                                                               as OCPS_CD              -- 직위코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'GP008'
		               and  MIS_COMN_CD     =   a.OCPS_CD
		        )                                                                       as OCPS_NM
		        -- 여기서부터 감면대상정보
		     ,  b.SQNC                                                                  as EMFM_SNO
		     ,  b.FMLY_RLTN_CD                                                          as FMLY_RLTN_CD
		     ,  to_char(nvl(b.STRT_YMD, nvl(a.ENCM_YMD, trunc(sysdate))), 'yyyymmdd')   as APST_YMD
		     ,  nvl(to_char(a.RTRM_PRAP_DD, 'yyyymmdd'), '29991231')                    as APFN_YMD
		     ,  nvl(b.FMLY_NM, a.EMPY_NM)                                               as RDEX_TGPR_NM
		     ,  to_char(nvl(b.BTDT, a.BTDT), 'yyyymmdd')                                as RDEX_TGPR_BTDT
		     ,  nvl(b.GEND_CD, a.GEND_CD)                                               as GEND_CD
		     ,  nvl(b.FMLY_FRRN, a.EMPL_FRRN)                                           as RDEX_TGPR_FRRN
		     ,  nvl(b.FMLY_BRRN, a.EMPL_BRRN)                                           as RDEX_TGPR_BRRN
		  from  HZUSERMMT a
		     ,  HHFAMILYT b
		 where  a.EMNO          =   #{emplId}
		   and  b.EMNO      (+) =   a.EMNO
		   and  b.SQNC      (+) =   #{emfmSno}
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm2-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="emplId" column="EMPL_ID"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="rdexAlcmCd" column="RDEX_ALCM_CD"/>
		<result property="dprtNm" column="DPRT_NM"/>
		<result property="ocfmCd" column="OCFM_CD"/>
		<result property="ocfmNm" column="OCFM_NM"/>
		<result property="ocpsCd" column="OCPS_CD"/>
		<result property="ocpsNm" column="OCPS_NM"/>
		<result property="emfmSno" column="EMFM_SNO"/>
		<result property="fmlyRltnCd" column="FMLY_RLTN_CD"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="rdexTgprNm" column="RDEX_TGPR_NM"/>
		<result property="rdexTgprBtdt" column="RDEX_TGPR_BTDT"/>
		<result property="gendCd" column="GEND_CD"/>
		<result property="rdexTgprFrrn" column="RDEX_TGPR_FRRN"/>
		<result property="rdexTgprBrrn" column="RDEX_TGPR_BRRN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm2 (인사정보(직원본인, 직원가족) 조회(Inner join)) 
        Description :                                           인사정보(직원본인, 직원가족) 조회(Inner join)
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm2-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm2"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm2-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneHrafInfm2 */
		select  a.EMNO                                                                  as EMPL_ID
		     ,  a.EMPY_NM                                                               as EMPL_NM
		     ,  a.BSPL_CD                                                               as RDEX_ALCM_CD
		     ,  (   select  KORN_DPRT_NM
		              from  HZDEPTMMT
		             where  DPRT_CD         =   a.DPRT_CD
		        )                                                                       as DPRT_NM
		     ,  a.OCFM_CD                                                               as OCFM_CD              -- 직종코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'GP006'
		               and  MIS_COMN_CD     =   a.OCFM_CD
		        )                                                                       as OCFM_NM
		     ,  a.OCPS_CD                                                               as OCPS_CD              -- 직위코드
		     ,  (   select  COMN_CD_NM
		              from  HZMICOCDT
		             where  COMN_GRP_CD     =   'GP008'
		               and  MIS_COMN_CD     =   a.OCPS_CD
		        )                                                                       as OCPS_NM
		        -- 여기서부터 감면대상정보
		     ,  b.SQNC                                                                  as EMFM_SNO
		     ,  b.FMLY_RLTN_CD                                                          as FMLY_RLTN_CD
		     ,  to_char(nvl(b.STRT_YMD, nvl(a.ENCM_YMD, trunc(sysdate))), 'yyyymmdd')   as APST_YMD
		     ,  nvl(to_char(a.RTRM_PRAP_DD, 'yyyymmdd'), '29991231')                    as APFN_YMD
		     ,  nvl(b.FMLY_NM, a.EMPY_NM)                                               as RDEX_TGPR_NM
		     ,  to_char(nvl(b.BTDT, a.BTDT), 'yyyymmdd')                                as RDEX_TGPR_BTDT
		     ,  nvl(b.GEND_CD, a.GEND_CD)                                               as GEND_CD
		     ,  nvl(b.FMLY_FRRN, a.EMPL_FRRN)                                           as RDEX_TGPR_FRRN
		     ,  nvl(b.FMLY_BRRN, a.EMPL_BRRN)                                           as RDEX_TGPR_BRRN
		  from  HZUSERMMT a
		     ,  HHFAMILYT b
		 where  a.EMNO          =   #{emplId}
		   and  b.EMNO          =   a.EMNO
		   and  b.SQNC          =   #{emfmSno}
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewEmfmSno-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="emfmSno" column="EMFM_SNO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewEmfmSno (직원가족일련번호 신규채번) 
        Description :                                           직원가족일련번호 신규채번
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewEmfmSno-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewEmfmSno"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewEmfmSno-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewEmfmSno */
		select  nvl(max(a.EMFM_SNO), 0) + 1     as EMFM_SNO
		  from  SEHRCOM.ACCNRRIFT a
		 where  a.RDEX_ALCM_CD      =   #{rdexAlcmCd}
		   and  a.EMPL_ID           =   #{emplId}
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewSno-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="emplRdexTgprSno" column="EMPL_RDEX_TGPR_SNO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewSno (신규순번 채번 (직원감면대상자일련번호)) 
        Description :                                           신규순번 채번 (직원감면대상자일련번호)
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewSno-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewSno"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewSno-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneNewSno */
		select  nvl(max(a.EMPL_RDEX_TGPR_SNO), 0) + 1       as EMPL_RDEX_TGPR_SNO
		  from  ACCNERTPT a
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneDummy-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="rdexAlcmCd" column="RDEX_ALCM_CD"/>
		<result property="emplId" column="EMPL_ID"/>
		<result property="emfmSno" column="EMFM_SNO"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="emplClsfCd" column="EMPL_CLSF_CD"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="ocfmNm" column="OCFM_NM"/>
		<result property="ocpsNm" column="OCPS_NM"/>
		<result property="alcmDprtCd" column="ALCM_DPRT_CD"/>
		<result property="alcmDprtNm" column="ALCM_DPRT_NM"/>
		<result property="onslFmlyDvsnCd" column="ONSL_FMLY_DVSN_CD"/>
		<result property="fmlyRltnCd" column="FMLY_RLTN_CD"/>
		<result property="fmlyRltnNm" column="FMLY_RLTN_NM"/>
		<result property="rdexTgprNm" column="RDEX_TGPR_NM"/>
		<result property="rdexTgprBtdt" column="RDEX_TGPR_BTDT"/>
		<result property="rdexTgprFrrn" column="RDEX_TGPR_FRRN"/>
		<result property="rdexTgprBrrn" column="RDEX_TGPR_BRRN"/>
		<result property="workTrgtYn" column="WORK_TRGT_YN"/>
		<result property="dvsnNm" column="DVSN_NM"/>
		<result property="hsptCd" column="HSPT_CD"/>
		<result property="mdfcHxSno" column="MDFC_HX_SNO"/>
		<result property="emno" column="EMNO"/>
		<result property="sqnc" column="SQNC"/>
		<result property="prpdPtno" column="PRPD_PTNO"/>
		<result property="nwbrPtno" column="NWBR_PTNO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneDummy (selectOneDummy) 
        Description :                                           selectOneDummy
                                            
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneDummy-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneDummy"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneDummy-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectOneDummy */
		select  'A'         as RDEX_ALCM_CD
		     ,  'A'         as EMPL_ID
		     ,  1           as EMFM_SNO
		     ,  'A'         as EMPL_NM
		     ,  '01'        as EMPL_CLSF_CD
		     ,  '20110101'  as APST_YMD
		     ,  '20110101'  as APFN_YMD
		     ,  'A'         as OCFM_NM
		     ,  'A'         as OCPS_NM
		     ,  'A'         as ALCM_DPRT_CD
		     ,  'A'         as ALCM_DPRT_NM
		     ,  'A'         as ONSL_FMLY_DVSN_CD
		     ,  'A'         as FMLY_RLTN_CD
		     ,  'A'         as FMLY_RLTN_NM
		     ,  'A'         as RDEX_TGPR_NM
		     ,  '20110101'  as RDEX_TGPR_BTDT
		     ,  'A'         as RDEX_TGPR_FRRN
		     ,  'A'         as RDEX_TGPR_BRRN
		     ,  'A'         as WORK_TRGT_YN
		     ,  'A'         as DVSN_NM
		     ,  'A'         as HSPT_CD
		     ,  1           as MDFC_HX_SNO
		     ,  'A'         as EMNO
		     ,  1           as SQNC
		     ,  'A'         as PRPD_PTNO                -- 산모환자번호
		     ,  'A'         as NWBR_PTNO                -- 신생아환자번호
		  from  dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectEmplRdexAPI-result" type="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO">
	
		<result property="emplId" column="EMPL_ID"/>
		<result property="emplNm" column="EMPL_NM"/>
		<result property="rdexRltnCd" column="RDEX_RLTN_CD"/>
		<result property="rdexRltnNm" column="RDEX_RLTN_NM"/>
		<result property="rdexTgprFrrn" column="RDEX_TGPR_FRRN"/>
		<result property="rdexTgprBrrn" column="RDEX_TGPR_BRRN"/>
		<result property="occlNm" column="OCCL_NM"/>
		<result property="ocpsNm" column="OCPS_NM"/>
		<result property="dprtNm" column="DPRT_NM"/>
		<result property="bsisRdexCd" column="BSIS_RDEX_CD"/>
		<result property="bsisRdexNm" column="BSIS_RDEX_NM"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectEmplRdexAPI (API 감면대상자조회) 
        Description :                       
		parameterType : com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO
		resultMap : com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectEmplRdexAPI-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectEmplRdexAPI"  parameterType="com.sds.healthcare.ehr.adm.ac.acb.vo.AcbEmplRdexMngmDVO"  resultMap="com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectEmplRdexAPI-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-adm-ac-acb-dao-AcbEmplRdexMngmDAO-selectEmplRdexAPI */
		        a.EMPL_ID                                             /* 직원ID */
		      , a.EMPL_NM                                             /* 직원명 */
		      , a.RDEX_RLTN_CD                                        /* 감면관계코드 */
		      ,  (select  DETL_CD_NM
		           from  CCCMCDDMT
		          where  COMN_GRP_CD     =   'AC009'
		            and  COMN_DTLS_CD    =   a.RDEX_RLTN_CD
		        ) as RDEX_RLTN_NM                                     /* 감면관계명 */
		      , a.RDEX_TGPR_FRRN                                      /* 감면대상자앞주민등록번호 */
		      , a.RDEX_TGPR_BRRN                                      /* 감면대상자뒤주민등록번호 */
		      ,  (select e.DETL_CD_NM
		            from CCCMCDDMT e
		           where e.COMN_GRP_CD(+)  = 'GP005'
		             and  e.COMN_DTLS_CD(+)  = d.OCCL_CD) as OCCL_NM  /* 직급명 */
		      ,  (select e.DETL_CD_NM
		            from CCCMCDDMT e
		           where e.COMN_GRP_CD(+)  = 'GP008'
		             and e.COMN_DTLS_CD(+)  = d.OCPS_CD) as OCPS_NM   /* 직위명 */      
		      , a.DPRT_NM                                             /* 부서명 */
		      , a.BSIS_RDEX_CD                                  as BSIS_RDEX_CD             -- 기본감면코드
		      , (   select  cc.CNPL_NM
		              from  ACCNCNPLT cc
		             where  cc.CNPL_RDEX_CD    =   a.BSIS_RDEX_CD
		               and  cc.APST_YMD        =  (select  max(APST_YMD)
		                                             from  ACCNCNPLT
		                                            where  CNPL_RDEX_CD    =   a.BSIS_RDEX_CD
		                                           )
		            )as BSIS_RDEX_NM             -- 기본감면명
		from ACCNERTPT a 
		    ,CCUSERAMT d
		where RDEX_TGPR_NM = #{rdexTgprNm}
		and RDEX_TGPR_FRRN = #{rdexTgprFrrn}
		and RDEX_TGPR_BRRN = #{rdexTgprBrrn}
		and d.LGIN_ID(+) = a.EMPL_ID
		and rownum = 1
	</select>



</mapper>