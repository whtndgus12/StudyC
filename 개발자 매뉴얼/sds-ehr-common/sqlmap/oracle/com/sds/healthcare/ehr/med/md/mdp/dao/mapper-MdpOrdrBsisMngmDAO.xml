<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_MdpOrdrBsisMngmDAO_sql.xml 
    Description : -->
<mapper namespace="MdpOrdrBsisMngmDAO">


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneOrdrBsisMngmDual-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO">
	
		<result property="afiCrtfOrdvVl" column="AFI_CRTF_ORDV_VL"/>
		<result property="afiRulIdVl" column="AFI_RUL_ID_VL"/>
		<result property="afiRulRspnVl" column="AFI_RUL_RSPN_VL"/>
		<result property="afiErrmDschOrdrInptYn" column="AFI_ERRM_DSCH_ORDR_INPT_YN"/>
		<result property="afiTmprOrdrSno" column="AFI_TMPR_ORDR_SNO"/>
		<result property="ordrHoldDvsnCd" column="ORDR_HOLD_DVSN_CD"/>
		<result property="afiOrglOrdrDcDvsnCd" column="AFI_ORGL_ORDR_DC_DVSN_CD"/>
		<result property="ordrInrfClotYn" column="ORDR_INRF_CLOT_YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneOrdrBsisMngmDual (DVO Parameter를 유지하기 위한 DUAL SELECT) 
        Description :                                           DVO Parameter 를 유지하기 위한 DUAL SELECT
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneOrdrBsisMngmDual-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneOrdrBsisMngmDual"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneOrdrBsisMngmDual-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneOrdrBsisMngmDual */
		       '' AS AFI_CRTF_ORDV_VL
		     , '' AS AFI_RUL_ID_VL
		     , '' AS AFI_RUL_RSPN_VL
		     , '' AS AFI_ERRM_DSCH_ORDR_INPT_YN
		     , 0  AS AFI_TMPR_ORDR_SNO
		     , '' AS ORDR_HOLD_DVSN_CD
		     , '' AS AFI_ORGL_ORDR_DC_DVSN_CD
		     , '' as ORDR_INRF_CLOT_YN
		from dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneBsisOrdrSno-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO">
	
		<result property="ordrSno" column="ORDR_SNO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneBsisOrdrSno (기본처방 Sequence 조회) 
        Description :                                           기본처방 처방일련번호에 사용되는 sequence를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneBsisOrdrSno-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneBsisOrdrSno"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneBsisOrdrSno-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneBsisOrdrSno */
		          MDBASORDTQ.nextval as ORDR_SNO
		 from  dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOnePtntLtstBsisBefOrdrYmd-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO">
	
		<result property="ordrYmd" column="ORDR_YMD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOnePtntLtstBsisBefOrdrYmd (최근 기본 전처방 일자 조회) 
        Description :                                           최근 기본 전처방 일자를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOnePtntLtstBsisBefOrdrYmd-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOnePtntLtstBsisBefOrdrYmd"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOnePtntLtstBsisBefOrdrYmd-result" useCache="true" flushCache="false">
				<![CDATA[
				   select  /*+ index_desc(a MDBASORDT_I03) SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOnePtntLtstBsisBefOrdrYmd */
						   to_char(ORDR_YMD, 'yyyymmdd') as ORDR_YMD
					 from  MDBASORDT a
		                ,  MDORDRCMT b
				    where  a.ORDR_CD = b.ORDR_CD
		              and  a.ORDR_YMD < to_date(#{ordrYmd}, 'yyyymmdd')
					  and  a.MDRP_NO = #{mdrpNo}
		             ]]>
			 		 <if test='orocDprtCd != null and orocDprtCd != ""'>
		               and  a.OROC_DPRT_CD = #{orocDprtCd}
			  		 </if>
			          <![CDATA[
					   and  a.ODKI_CD     like #{odkiCd}||'%'
					   and  a.MCDP_CD     = #{mcdpCd}
					   and  a.DC_DVSN_CD in ('N', 'Y')   /*  취소된처방 제외 */
					   and  a.ORDR_CD <> 'C030017'
					   and  nvl(a.NOTC_YN, 'Y') = 'Y'
		               and  nvl(b.SCRN_INPT_DSLW_YN, 'N') <> 'Y'  
					   and  rownum <= 1
					]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneDscgOrdrYn-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO">
	
		<result property="afiDschIdctOrdrEn" column="AFI_DSCH_IDCT_ORDR_EN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneDscgOrdrYn (퇴원지시처방 유무 조회) 
        Description :                                           환자에게 내려진 퇴원지시처방이 존재하는지 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneDscgOrdrYn-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneDscgOrdrYn"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneDscgOrdrYn-result" useCache="true" flushCache="false">
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneDscgOrdrYn */
		           case when count ( PTNO ) &gt; 0 then 'Y' else 'N'end as AFI_DSCH_IDCT_ORDR_EN
		  from  MDBASORDT
		where  MDRP_NO = #{mdrpNo}
		   and  ORDR_CD = 'C0900004'     /*  ASIS - 'C060008' */
		   and  CODV_CD = 'E'
		   and  nvl(DC_DVSN_CD, 'N') = 'N'
		   and  rownum = 1
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneErDscgCareFinsYn-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO">
	
		<result property="yn" column="YN"/>
		<result property="errmDschOrdrCeckYn" column="ERRM_DSCH_ORDR_CECK_YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneErDscgCareFinsYn (응급환자 Discharge 처방 간호완료 조회) 
        Description :                                           응급환자에게 내려진 Discharge 처방의 간호완료여부를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneErDscgCareFinsYn-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneErDscgCareFinsYn"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneErDscgCareFinsYn-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneErDscgCareFinsYn */
		                  decode(count(*), 0, 'N', 
		                  decode ( MAX(( 
		                    select  TO_CHAR(NVL(DSCH_DT,TO_DATE('29991231','YYYYMMDD')),'YYYYMMDD')              /*  원무 function 풀기 환자. 퇴원일자가 없는 환자만 체크한다 */
		                                     from  APRCRPTNT
		                                     where  MDRP_NO =  #{mdrpNo}  /*  진료접수번호 */
		                                      and  CODV_CD   = 'E'
		                                      and  CNCL_DT is null
		                                  )), '29991231', 'Y', 'N' )
		                  ) as YN
		     ,  #{errmDschOrdrCeckYn} as ERRM_DSCH_ORDR_CECK_YN
		<choose>
		 <when test='errmDschOrdrCeckYn == "N"'>
		  from  MNEERRPAT
		 where  MDRP_NO = #{mdrpNo}
		   and  CHOT_DT is not null  
		 </when>
		 <otherwise>
		  from  MDBASORDT
		 where  MDRP_NO = #{mdrpNo}  /*  진료접수번호 */
		   and  CODV_CD = 'E'
		   and  nvl(DC_DVSN_CD, 'N') = 'N'
		   and  OROC_DPRT_CD = fn_cc_get_dprt_cd('WARD_ER')
		   and  ORDR_CD = FN_CC_GET_CNST_VL('CCD_002', 'DISCHARGE')
		   and  ORCN_NURS_ID is not null
		 </otherwise>
		</choose>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntBsisOrdrList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO">
	
		<result property="saveDvsnCd" column="SAVE_DVSN_CD"/>
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="odkiDetlCd" column="ODKI_DETL_CD"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="careSttsCd" column="CARE_STTS_CD"/>
		<result property="adtnOrdvCd" column="ADTN_ORDV_CD"/>
		<result property="rgorFndrId" column="RGOR_FNDR_ID"/>
		<result property="rgorFinsDt" column="RGOR_FINS_DT"/>
		<result property="orcnNursId" column="ORCN_NURS_ID"/>
		<result property="orcnDt" column="ORCN_DT"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="dcCnnuId" column="DC_CNNU_ID"/>
		<result property="dcCnfrDt" column="DC_CNFR_DT"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="bsisOrdrUnslCtn" column="BSIS_ORDR_UNSL_CTN"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="athnId" column="ATHN_ID"/>
		<result property="crtfIp" column="CRTF_IP"/>
		<result property="crtfDt" column="CRTF_DT"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="clrsPrjcDrId" column="CLRS_PRJC_DR_ID"/>
		<result property="oprtYmd" column="OPRT_YMD"/>
		<result property="oprtSno" column="OPRT_SNO"/>
		<result property="itrnBsdvCd" column="ITRN_BSDV_CD"/>
		<result property="srrqCmntCtn" column="SRRQ_CMNT_CTN"/>
		<result property="cnntOrdrBndlNo" column="CNNT_ORDR_BNDL_NO"/>
		<result property="ordrValdStrtYmd" column="ORDR_VALD_STRT_YMD"/>
		<result property="ordrValdFnshYmd" column="ORDR_VALD_FNSH_YMD"/>
		<result property="implOrdrPblcNtm" column="IMPL_ORDR_PBLC_NTM"/>
		<result property="implOrdrPblcLmttNtm" column="IMPL_ORDR_PBLC_LMTT_NTM"/>
		<result property="orglOrdrYmd" column="ORGL_ORDR_YMD"/>
		<result property="orglOrdrSno" column="ORGL_ORDR_SNO"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="dietQty" column="DIET_QTY"/>
		<result property="distMedvCd" column="DIST_MEDV_CD"/>
		<result property="kcalQty" column="KCAL_QTY"/>
		<result property="adtnAdjsDvsnCd" column="ADTN_ADJS_DVSN_CD"/>
		<result property="notcYn" column="NOTC_YN"/>
		<result property="sfdiYn" column="SFDI_YN"/>
		<result property="actnNtm" column="ACTN_NTM"/>
		<result property="otptApntWorkYn" column="OTPT_APNT_WORK_YN"/>
		<result property="imgnBsisOrdrCndrId" column="IMGN_BSIS_ORDR_CNDR_ID"/>
		<result property="imgnBsisOrcnDt" column="IMGN_BSIS_ORCN_DT"/>
		<result property="inqrExclYn" column="INQR_EXCL_YN"/>
		<result property="bsisOrdrVrsnVl" column="BSIS_ORDR_VRSN_VL"/>
		<result property="bsisOrdrPackOrdrCd" column="BSIS_ORDR_PACK_ORDR_CD"/>
		<result property="lwrnOrdrSno" column="LWRN_ORDR_SNO"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="ordrCrtnLnknNo" column="ORDR_CRTN_LNKN_NO"/>
		<result property="sporBndlNm" column="SPOR_BNDL_NM"/>
		<result property="sporBndlNo" column="SPOR_BNDL_NO"/>
		<result property="frstRgsrId" column="FRST_RGSR_ID"/>
		<result property="frstRgstIp" column="FRST_RGST_IP"/>
		<result property="frstRgstDt" column="FRST_RGST_DT"/>
		<result property="lastUpdrId" column="LAST_UPDR_ID"/>
		<result property="lastUpdtIp" column="LAST_UPDT_IP"/>
		<result property="lastUpdtDt" column="LAST_UPDT_DT"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="afiBsisOrdrCdNm" column="AFI_BSIS_ORDR_CD_NM"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntBsisOrdrList (환자의 기본 처방 정보 조회) 
        Description :                                           환자의 기본 처방 정보를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntBsisOrdrList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntBsisOrdrList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntBsisOrdrList-result" useCache="true" flushCache="false">
		    <![CDATA[
			   SELECT  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntBsisOrdrList_기본 처방 조회 */
			                 'S'  as SAVE_DVSN_CD
			              ,  a.PTNO as PTNO                             /* 환자번호*/
			              ,  to_char ( a.ORDR_YMD, 'YYYYMMDD') as ORDR_YMD /* 처방일자*/
			              ,  a.ORDR_SNO as ORDR_SNO                         /* 처방일련번호*/
			              ,  a.MDRP_NO as MDRP_NO                          /* 진료접수번호*/
			              ,  a.ORDR_CD as ORDR_CD                          /* 처방코드*/
			              ,  a.MCDP_CD as MCDP_CD                          /* 진료과코드*/
			              ,  a.ODDR_ID as ODDR_ID                          /* 처방의사ID*/
			              ,  a.CHDR_ID as CHDR_ID                          /* 지정의사ID*/
			              ,  a.GNDR_ID as GNDR_ID                          /* 주치의사ID*/
			              ,  a.CODV_CD as CODV_CD                          /* 내원구분코드*/
			              ,  a.PTAD_CODV_CD as PTAD_CODV_CD                     /* 원무내원구분코드*/
			              ,  a.ORDR_CLTY_CD as ORDR_CLTY_CD                     /* 처방분류유형코드*/
			              ,  a.ORCL_CD as ORCL_CD                          /* 처방분류코드*/
			              ,  a.ODKI_CD as ODKI_CD                          /* 처방종류코드*/
			              ,  a.ODKI_DETL_CD as ODKI_DETL_CD                     /* 처방종류상세코드*/
			              ,  a.ORFR_CD as ORFR_CD                          /* 처방형태코드*/
			              ,  a.HSLC_DVSN_CD as HSLC_DVSN_CD                     /* 위치구분코드*/
			              ,  a.MCCN_CD as MCCN_CD                          /* 진료센터코드*/
			              ,  a.WARD_CD as WARD_CD                          /* 병동코드*/
			              ,  a.OROC_DPRT_CD as OROC_DPRT_CD                          /* 처방발생원코드*/
			              ,  a.FRNS_DPRT_CD as FRNS_DPRT_CD                     /* 불출부서코드*/
			              ,  a.SLIP_CD as SLIP_CD                          /* SLIP코드*/
			              ,  a.CARE_STTS_CD as CARE_STTS_CD                     /* 간호상태코드*/
			              ,  a.ADTN_ORDV_CD as ADTN_ORDV_CD                     /* 추가처방구분코드*/
			              ,  a.RGOR_FNDR_ID as RGOR_FNDR_ID                     /* 정규처방완료의사ID*/
			               ,  to_char ( a.RGOR_FINS_DT, 'YYYYMMDDhh24miss') as RGOR_FINS_DT /* 정규처방완료일시*/
			              ,  a.ORCN_NURS_ID as ORCN_NURS_ID                     /* 처방확인간호사ID*/
			               ,  to_char ( a.ORCN_DT, 'YYYYMMDDhh24miss') as ORCN_DT /* 처방확인일시*/
			              ,  a.TMPR_ORDR_YN as TMPR_ORDR_YN                     /* 임시처방여부*/
			              ,  a.DC_DVSN_CD as DC_DVSN_CD                       /* DC구분코드*/
			              ,  a.DC_ODDR_ID as DC_ODDR_ID                       /* DC처방의사ID*/
			               ,  to_char ( a.DC_ORDR_DT, 'YYYYMMDDhh24miss') as DC_ORDR_DT /* DC처방일시*/
			              ,  a.DC_CNNU_ID as DC_CNNU_ID                       /* DC확인간호사ID*/
			               ,  to_char ( a.DC_CNFR_DT, 'YYYYMMDDhh24miss') as DC_CNFR_DT /* DC확인일시*/
			              ,  a.SORT_SQNC as SORT_SQNC                        /* 정렬순서*/
			              ,  a.BSIS_ORDR_UNSL_CTN as BSIS_ORDR_UNSL_CTN               /* 기본처방특이내용*/
			              ,  a.INPT_USER_DVSN_CD as INPT_USER_DVSN_CD                /* 입력사용자구분코드*/
			              ,  a.CRTF_DVSN_CD as CRTF_DVSN_CD                     /* 인증구분코드*/
			              ,  a.ATHN_ID as ATHN_ID                          /* 인증자ID*/
			              ,  a.CRTF_IP as CRTF_IP                          /* 인증IP*/
			               ,  to_char ( a.CRTF_DT, 'YYYYMMDDhh24miss') as CRTF_DT /* 인증일시*/
			              ,  a.CLRS_PRJC_CD as CLRS_PRJC_CD                     /* 임상연구과제코드*/
			              ,  a.CLRS_PRJC_DR_ID as CLRS_PRJC_DR_ID                  /* 임상연구과제의사ID*/
			              ,  a.OPRT_YMD as OPRT_YMD                         /* 수술일자*/
			              ,  a.OPRT_SNO as OPRT_SNO                         /* 수술일련번호*/
			              ,  a.ITRN_BSDV_CD as ITRN_BSDV_CD                     /* 인턴업무구분코드*/
			              ,  a.SRRQ_CMNT_CTN as SRRQ_CMNT_CTN                    /* SR커멘트내용*/
			              ,  a.CNNT_ORDR_BNDL_NO as CNNT_ORDR_BNDL_NO                /* 동시처방묶음번호*/
			               ,  to_char ( a.ORDR_VALD_STRT_YMD, 'YYYYMMDD') as ORDR_VALD_STRT_YMD /* 처방유효시작일자*/
			               ,  to_char ( a.ORDR_VALD_FNSH_YMD, 'YYYYMMDD') as ORDR_VALD_FNSH_YMD /* 처방유효종료일자*/
			              ,  a.IMPL_ORDR_PBLC_NTM as IMPL_ORDR_PBLC_NTM               /* 실시처방발행횟수*/
			              ,  a.IMPL_ORDR_PBLC_LMTT_NTM as IMPL_ORDR_PBLC_LMTT_NTM          /* 실시처방발행제한횟수*/
			               ,  to_char ( a.ORGL_ORDR_YMD, 'YYYYMMDD') as ORGL_ORDR_YMD /* 원처방일자*/
			              ,  a.ORGL_ORDR_SNO as ORGL_ORDR_SNO                    /* 원처방일련번호*/
			              ,  a.ORDR_NM as ORDR_NM                          /* 처방명*/
			              ,  a.DIET_QTY as DIET_QTY                         /* 식사량*/
			              ,  a.DIST_MEDV_CD as DIST_MEDV_CD                     /* 식사시작끼니구분코드*/
			              ,  a.KCAL_QTY as KCAL_QTY                         /* KCAL량*/
			              ,  a.ADTN_ADJS_DVSN_CD as ADTN_ADJS_DVSN_CD                /* 추가조정구분코드*/
			              ,  a.NOTC_YN as NOTC_YN                          /* 노티여부*/
			              ,  a.SFDI_YN as SFDI_YN                          /* 연식여부*/
			              ,  a.ACTN_NTM as ACTN_NTM                         /* 액팅횟수*/
			              ,  a.OTPT_APNT_WORK_YN as OTPT_APNT_WORK_YN                /* 외래예약작업여부*/
			              ,  a.IMGN_BSIS_ORDR_CNDR_ID as IMGN_BSIS_ORDR_CNDR_ID           /* 영상기본처방확인의사ID*/
			               ,  to_char ( a.IMGN_BSIS_ORCN_DT, 'YYYYMMDDhh24miss') as IMGN_BSIS_ORCN_DT /* 영상기본처방확인일시*/
			              ,  a.INQR_EXCL_YN as INQR_EXCL_YN                     /* 조회제외여부*/
			              ,  a.BSIS_ORDR_VRSN_VL as BSIS_ORDR_VRSN_VL                /* 기본처방버젼값*/
			              ,  a.BSIS_ORDR_PACK_ORDR_CD as BSIS_ORDR_PACK_ORDR_CD           /* 기본처방Pack처방코드*/
			              ,  a.LWRN_ORDR_SNO as LWRN_ORDR_SNO                    /* 하위처방일련번호*/
			              ,  a.ORDR_CRTN_DVSN_CD as ORDR_CRTN_DVSN_CD                /* 처방생성구분코드*/
			              ,  a.ORDR_CRTN_LNKN_NO as ORDR_CRTN_LNKN_NO                /* 처방생성연결번호*/
		                  ,  a.SPOR_BNDL_NM                                     /* 스페셜처방묶음명 */
		                  ,  a.SPOR_BNDL_NO                                     /* 스페셜처방묶음번호*/                  
			              ,  a.FRST_RGSR_ID as FRST_RGSR_ID
			              ,  a.FRST_RGST_IP as FRST_RGST_IP
			               ,  to_char ( a.FRST_RGST_DT, 'YYYYMMDDhh24miss') as FRST_RGST_DT
			              ,  a.LAST_UPDR_ID as LAST_UPDR_ID
			              ,  a.LAST_UPDT_IP as LAST_UPDT_IP
			               ,  to_char ( a.LAST_UPDT_DT, 'YYYYMMDDhh24miss') as LAST_UPDT_DT
			              ,  b.ORDR_PSBL_DVSN_CD as ORDR_PSBL_DVSN_CD  /* 처방가능구분코드*/
			              /* ,  case when a.CNNT_ORDR_BNDL_NO > 0 -- PACK 처방
			                      then case when a.BSIS_ORDR_PACK_ORDR_CD is null -- PACK 처방코드가 없으면 처방명으로
			                                then a.ORDR_NM
			                                                                        PACK 처방코드가 있으면 PACK 처방코드 검색
			                                else ( select DETL_IDCT_CTN from MDDBOPKBT where ORDR_CD = a.BSIS_ORDR_PACK_ORDR_CD and LWRN_ORDR_SNO = a.LWRN_ORDR_SNO and rownum = 1 )
			                                end
			                      else b.ORDR_NM -- PACK 처방이 아니면 처방마스터의 기본처방 명
			                      end AFI_BSIS_ORDR_CD_NM*/
			              , case when a.CNNT_ORDR_BNDL_NO > 0 /*  PACK 처방 */
			                          then a.ORDR_NM
			                          else b.ORDR_NM /*  PACK 처방이 아니면 처방마스터의 기본처방 명 */
			                          end  as AFI_BSIS_ORDR_CD_NM
			           from  MDBASORDT a
			              ,  MDORDRCMT b
		                  ,  APRCRPTNT rcr
			          where  a.PTNO     = #{ptno}
			            and  a.ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
			            and  a.CODV_CD  = #{codvCd}
			        ]]>
				    <if test='orocDprtCd != null and orocDprtCd != ""'>
			            and  a.OROC_DPRT_CD = #{orocDprtCd}
				    </if>
		            <choose>
		              <when test='dcDvsnCd == "T"'>
		                and a.DC_DVSN_CD = #{dcDvsnCd}
		              </when>
		              <otherwise>
			            and  a.DC_DVSN_CD not in ( 'X' , 'F' , 'E', 'T' ) /*  취소, 실처방 전환, 임시처방 취소, 외래당일입원가처방은 조회 제외 */
		                /*  DC_DVSN_CD 가 'N' 이거나 NULL 인 경우 전체조회 */
			            /*  DC_DVSN_CD 임시처방인 경우는 DC_DVSN_CD 'Y' 것도 같이 조회 */
			            and  'TRUE' = case when #{dcDvsnCd} = 'N' or #{dcDvsnCd} is null then 'TRUE'
			                               else case when a.DC_DVSN_CD = #{dcDvsnCd} then 'TRUE'
			                                         when a.DC_DVSN_CD = 'Y' then 'TRUE'
			                                         end
			                               end
		              </otherwise>
		            </choose>
				    <if test='odkiCd != null and odkiCd != ""'>
		                and  a.ODKI_CD = #{odkiCd}
				    </if>
		            <if test='codvCd == "O"'>
		                and rcr.CNCL_DT is null
		            </if>
		            <if test='codvCd == "O" and chdrId != null and chdrId != ""'>
		                and a.CHDR_ID = #{chdrId}
		            </if>
				    <![CDATA[
			            /*  Client logic 이동 외래일때 같은 진료과만 처리 */
			            and  'TRUE' = case when a.CODV_CD = 'O'
			                               then case when a.MCDP_CD like #{mcdpCd} ||'%' /* 단독 처방 조회 기능이 있어서 like 로 처리*/
			                                         then 'TRUE'
			                                         else 'FALSE' end
			                               else 'TRUE'
			                               end
			            and  'TRUE' = case when a.CODV_CD <> 'O'
			                               then case when a.MDRP_NO = #{mdrpNo}
			                                    then 'TRUE'
			                                    else 'FALSE'
			                                    end
			                               else 'TRUE'
			                               end
			            /*  단독 처방 조회 */
			            and   'TRUE' = case when #{ordrSno} > 0
			                                then case when a.ORDR_SNO = #{ordrSno}
			                                          then 'TRUE'
			                                          else 'FALSE'
			                                          end
			                                else 'TRUE'
			                                end
			            and  a.ORDR_CD  = b.ORDR_CD(+)
		                and  a.MDRP_NO = rcr.MDRP_NO
					order
					by    decode(a.ODKI_DETL_CD, 'Z', a.SPOR_BNDL_NO, 0)
		               ,  a.FRST_RGST_DT
				  	   ,  a.SORT_SQNC
		               ,  a.ORDR_SNO
					 ]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntLtstBsisBefOrdrList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO">
	
		<result property="saveDvsnCd" column="SAVE_DVSN_CD"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="userNm" column="USER_NM"/>
		<result property="adtnOrdvCd" column="ADTN_ORDV_CD"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="ordrUnslCtn" column="ORDR_UNSL_CTN"/>
		<result property="careSttsCd" column="CARE_STTS_CD"/>
		<result property="rgorFinsDt" column="RGOR_FINS_DT"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="lastUpdtDt" column="LAST_UPDT_DT"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="actnNtm" column="ACTN_NTM"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="cnntOrdrBndlNo" column="CNNT_ORDR_BNDL_NO"/>
		<result property="afiBsisOrdrCdNm" column="AFI_BSIS_ORDR_CD_NM"/>
		<result property="bsisOrdrPackOrdrCd" column="BSIS_ORDR_PACK_ORDR_CD"/>
		<result property="lwrnOrdrSno" column="LWRN_ORDR_SNO"/>
		<result property="bsisOrdrVrsnVl" column="BSIS_ORDR_VRSN_VL"/>
		<result property="dietQty" column="DIET_QTY"/>
		<result property="kcalQty" column="KCAL_QTY"/>
		<result property="afiBsisOrdrVrsnUpdtYn" column="AFI_BSIS_ORDR_VRSN_UPDT_YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntLtstBsisBefOrdrList (최근 기본 전처방 목록 조회) 
        Description :                                           최근 기본 전처방 목록을 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntLtstBsisBefOrdrList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntLtstBsisBefOrdrList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntLtstBsisBefOrdrList-result" useCache="true" flushCache="false">
				<![CDATA[
				   SELECT  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-listPtntLtstBsisBefOrdrList */
		                  'I' as SAVE_DVSN_CD
		                ,  to_char(a.ORDR_YMD, 'YYYYMMDD') as ORDR_YMD                            /* (공통) 처방일자                           */
		                ,  a.ORDR_SNO as ORDR_SNO                                                 /* (공통) 처방순번                           */
		                ,  a.CODV_CD as CODV_CD                                                   /* (공통) 환자구분                           */
		                ,  to_char(p.MDCR_DT, 'yyyymmddhh24mi') as MDCR_DT                        /* (공통) 진료/입원/수술(DSC)/응급실도착일시 */
		                ,  a.OROC_DPRT_CD as OROC_DPRT_CD                                         /* (공통) 처방발생원                         */
		                ,  a.MCDP_CD as MCDP_CD                                                   /* (공통) 진료과                             */
		                ,  a.ORCL_CD as ORCL_CD                                                   /* (공통) 처방분류                           */
		                ,  a.ODKI_CD as ODKI_CD                                                   /* (공통) 처방종류                           */
		                ,  a.ORDR_CLTY_CD as ORDR_CLTY_CD                                         /* (공통) 처방구별                           */
		                ,  a.ORFR_CD as ORFR_CD                                                   /* (공통) 처방형태                           */
		                ,  a.ORDR_CD as ORDR_CD                                                   /* (공통) 처방코드                           */
		                ,  a.SLIP_CD as SLIP_CD                                                   /* (공통) SLIP코드                           */
		                ,  a.ODDR_ID as ODDR_ID                                                   /* (공통) 처방의사                           */
		                ,  c.USER_NM as USER_NM                                                   /* (공통) 처방의사명                         */
		                ,  a.ADTN_ORDV_CD as ADTN_ORDV_CD                                         /* (공통) 추가처방여부                       */
		                ,  a.ORDR_CRTN_DVSN_CD as ORDR_CRTN_DVSN_CD                               /* (공통) CP적용여부                         */
		                ,  a.SORT_SQNC as SORT_SQNC                                               /* (공통) 나열순서                           */
		                ,  a.BSIS_ORDR_UNSL_CTN as ORDR_UNSL_CTN                              /* (공통) 특기사항                           */
		                ,  a.CARE_STTS_CD as CARE_STTS_CD                                         /* (공통) 간호STATUS                         */
		                ,  a.RGOR_FINS_DT as RGOR_FINS_DT                                         /* (공통) 정규처방완료일시                   */
		                ,  a.DC_DVSN_CD as DC_DVSN_CD                                             /* (공통) D/C여부                            */
		                ,  a.DC_ODDR_ID as DC_ODDR_ID                                             /* (공통) D/C처방의사                        */
		                ,  a.DC_ORDR_DT as DC_ORDR_DT                                             /* (공통) D/C처방일시                        */
		                ,  a.INPT_USER_DVSN_CD as INPT_USER_DVSN_CD                               /* (공통) 입력USER구분(1.의사 2.간호사)      */
		                ,  to_char(a.LAST_UPDT_DT, 'yyyymmddhh24mi') as LAST_UPDT_DT              /* (공통) 수정일시                           */
		                ,  a.ORDR_NM as ORDR_NM
		                ,  a.ACTN_NTM as ACTN_NTM                                                 /* (기본/약/처치/수혈) ACTING실시 횟수       */
		                ,  a.FRNS_DPRT_CD as FRNS_DPRT_CD                                         /* (약) 가야할 곳(약국) a.PHRM_PTGO_CD -> 불출장소 코드로 변경  */
		                ,  case when (a.SLIP_CD like FN_CC_GET_CNST_VL('MDP_005', 'SLIP_CD_DIET') ||'%') 
		                        then (select  ORDR_PSBL_YN
		                                from  SUDIECDCT
		                               where  DIET_CD = a.ORDR_CD
		                                 and  rownum = 1)
		                        else b.ORDR_PSBL_DVSN_CD 
		                    end as ORDR_PSBL_DVSN_CD    /* (처방마스터) 처방가능여부                 */
		                ,  a.CLRS_PRJC_CD as CLRS_PRJC_CD
		                ,  a.CNNT_ORDR_BNDL_NO as CNNT_ORDR_BNDL_NO
		                ,  case when a.CNNT_ORDR_BNDL_NO > 0 /*  PACK 처방 */
		                            then a.ORDR_NM
		                            else b.ORDR_NM          /*  PACK 처방이 아니면 처방마스터의 기본처방 명 */
		                            end  as AFI_BSIS_ORDR_CD_NM
		                ,  a.BSIS_ORDR_PACK_ORDR_CD as BSIS_ORDR_PACK_ORDR_CD
		                ,  a.LWRN_ORDR_SNO as LWRN_ORDR_SNO
		                ,  b.BSIS_ORDR_VRSN_VL as BSIS_ORDR_VRSN_VL
		                ,  DIET_QTY as DIET_QTY
		                ,  KCAL_QTY as KCAL_QTY
		                ,  case when a.BSIS_ORDR_VRSN_VL is not null and
		                                  b.BSIS_ORDR_VRSN_VL is not null and
		                                  a.BSIS_ORDR_VRSN_VL <> b.BSIS_ORDR_VRSN_VL
		                         then 'Y'
		                         end as AFI_BSIS_ORDR_VRSN_UPDT_YN /*(기본) 기본처방 버젼 update 여부 */
		            from
		                  MDBASORDT a
		               ,  MDORDRCMT b
		               ,  CCUSRDPHT c  /*  OCS사용자 */
		               ,  HZDEPTMMT g
		               ,  APRCRPTNT p /*  진료접수 */
		           where  a.PTNO        = #{ptno}
		             and  a.ORDR_YMD    = to_date(#{ordrYmd}, 'yyyymmdd')
		             and  case when a.ORDR_CD = 'C0000000'
		                       then case when BSIS_ORDR_PACK_ORDR_CD is not null
		                                 then 'TRUE'
		                                 else 'FALSE' end
		                       else 'TRUE' end = 'TRUE'
					  ]]>
		 		     <if test='orocDprtCd != null and orocDprtCd != ""'>
		             and  a.OROC_DPRT_CD = #{orocDprtCd}
		  		     </if>
		             <![CDATA[
		             and  a.ODKI_CD like #{odkiCd}||'%'
		             and  a.MCDP_CD = #{mcdpCd}
		             and  a.MDRP_NO = #{mdrpNo}
		             and  a.DC_DVSN_CD = 'N'   /*  DC, 취소된처방 제외 */
		             and  a.ORDR_CD not in ('C030017', 'C0900005') /*  Enteral feeding */
		             and  nvl(a.NOTC_YN, 'Y') = 'Y' /*  노티여부 */ /*  노티여부는 왜 체크하지? */
		             and  nvl(b.SCRN_INPT_DSLW_YN, 'N') <> 'Y'
		             and  b.ORDR_CD(+) = a.ORDR_CD
		             and  c.USER_ID(+)  = a.ODDR_ID
		             and  a.MCDP_CD = g.DPRT_CD
		             and  p.MDRP_NO = a.MDRP_NO
		          order  by  a.FRST_RGST_DT
		                       ,  a.SORT_SQNC
		                       ,  a.ORDR_SNO
					]]>
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-updateBsisOrdr (기본 처방 Update) 
        Description :                                           처방 내림한 기본 처방을 수정한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-updateBsisOrdr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  >
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-updateBsisOrdr */
		             MDBASORDT
		       set
		             ORDR_CD = #{ordrCd}                                                /*  처방코드 */
		          ,  MCDP_CD = #{mcdpCd}                                             /*  진료과코드 */
		          ,  WARD_CD = #{wardCd}                                              /*  병동코드 */
		          ,  ORCL_CD = #{orclCd}                                                 /*  처방분류코드 */
		          ,  ODKI_CD = #{odkiCd}                                                 /*  처방종류코드 */
		          ,  ODKI_DETL_CD = #{odkiDetlCd}                                    /*  처방종류상세코드(신규) */
		          ,  ORFR_CD = #{orfrCd}                                                  /*  처방형태코드 */
		          ,  ORDR_NM = #{ordrNm}                                               /*  처방명 */
		          ,  SLIP_CD = #{slipCd}                                                    /*  SLIP CD */
		          ,  CHDR_ID = #{chdrId}                                                   /*  지정의사ID */
		          ,  GNDR_ID = #{gndrId}                                                   /*  주치의사ID */
		          ,  ADTN_ORDV_CD = #{adtnOrdvCd}                                 /*  추가처방구분코드 */
		          ,  BSIS_ORDR_UNSL_CTN = #{bsisOrdrUnslCtn}                    /*  기본처방특이내용 */
		          ,  RGOR_FNDR_ID = #{rgorFndrId}                                     /*  정규처방완료의사ID */
		          ,  RGOR_FINS_DT = to_date ( #{rgorFinsDt}, 'YYYYMMDDhh24miss' ) /*  정규처방완료일시 */
		          ,  ORCN_NURS_ID = #{orcnNursId}                                    /*  처방확인간호사ID */
		          ,  ORCN_DT = to_date ( #{orcnDt}, 'YYYYMMDDhh24miss' ) /*  처방확인일시 */
		          ,  CLRS_PRJC_CD = #{clrsPrjcCd}                                      /*  임상연구과제코드 */
		          ,  CLRS_PRJC_DR_ID = #{clrsPrjcDrId}                                /*  임상연구과제의사ID */
		          ,  ATHN_ID = #{athnId}                                                  /*  인증자ID */
		          ,  CRTF_IP = #{crtfIp}                                                      /*  인증IP */
		          ,  CRTF_DT = to_date ( #{crtfDt}, 'YYYYMMDDhh24miss' )   /*  인증일시 */
		          ,  DIET_QTY = #{dietQty}                                                /*  식사량 */
		          ,  KCAL_QTY = #{kcalQty}                                               /*  KCAL량 */
		          ,  DIST_MEDV_CD = #{distMedvCd}                                 /*  식사시작끼니구분코드 */
		          ,  ADTN_ADJS_DVSN_CD = #{adtnAdjsDvsnCd}                 /*  추가조정구분코드 */
		          ,  SFDI_YN = #{sfdiYn}                                                   /*  연식여부 */
		          ,  NOTC_YN = #{notcYn}                                                /*  노티여부 */
		          ,  ITRN_BSDV_CD = #{itrnBsdvCd}                                    /*  인턴업무구분코드 */
		          ,  UNSL_CTN_CNFR_YN = #{unslCtnCnfrYn}
		          ,  SPOR_BNDL_NM = #{sporBndlNm}                                    /* 스페셜처방묶음명 */
		          ,  SPOR_BNDL_NO = #{sporBndlNo}                                    /* 스페셜처방묶음번호*/                            
		          ,  LAST_UPDR_ID = #{gvUserId}                                       /*  최종수정자ID  */
		          ,  LAST_UPDT_IP = #{gvUserIp}                                        /*  최종수정IP */
		          ,  LAST_UPDT_DT = sysdate                                           /*  최종수정일시  */
		          ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}               /*  최종수정SMC클라이언트프로그램ID */
		          ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}               /*  최종수정SMC서버프로그램ID      */
		          ,  ORDR_UPDT_DT = sysdate                                          /*  처방수정일시*/
		          ,  ORDR_UPDR_ID = #{gvUserId}                                       /*  처방수정자ID*/
		 where  PTNO = #{ptno}                                                          /*  환자번호 */
		    and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )          /*  처방일자 */
		    and  ORDR_SNO = #{ordrSno}
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-updateBsisOrdrDc (기본처방 DC 및 취소) 
        Description :                                           처방 내림한 기본처방을 DC 및 취소 처리한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-updateBsisOrdrDc"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  >
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-updateBsisOrdrDc */
		             MDBASORDT
		       set  DC_DVSN_CD = #{dcDvsnCd}
		           ,  DC_ODDR_ID = case when #{ordrCrtnDvsnCd} = 'S07'     /*  'S07' : 의사식사처방, 간호식사발행 일치를 위한 자동 D/C 처리 */
		                                           then ODDR_ID else #{dcOddrId} end
		           ,  DC_ORDR_DT = case when #{ordrCrtnDvsnCd} = 'S07'
		                                           then to_date ( #{orcnDt}, 'YYYYMMDDhh24miss' )
		                                           else to_date ( #{dcOrdrDt}, 'YYYYMMDDhh24miss' ) end
		           ,  DC_CNNU_ID = case when #{ordrCrtnDvsnCd} = 'S07'
		                                           then #{orcnNursId}
		                                           else DC_CNNU_ID end
		           ,  DC_CNFR_DT = case when #{ordrCrtnDvsnCd} = 'S07'
		                                           then  to_date ( #{orcnDt}, 'YYYYMMDDhh24miss' )
		                                           else DC_CNFR_DT end
		           ,  LAST_UPDR_ID = #{gvUserId}                                                   /*  최종수정자ID                  */
		           ,  LAST_UPDT_IP = #{gvUserIp}                                                   /*  최종수정IP                    */
		           ,  LAST_UPDT_DT = to_date ( #{dcOrdrDt}, 'YYYYMMDDhh24miss' )                   /*  최종수정일시                     */
		           ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}                                     /*  최종수정SMC클라이언트프로그램ID */
		           ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}                                     /*  최종수정SMC서버프로그램ID      */
		  where  PTNO = #{ptno}
		      and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )                                /* 처방일자 */
		      and  ORDR_SNO = #{ordrSno}
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-insertBsisOrdr (기본 처방 저장) 
        Description :                                           환자 치료를 위한 처방 내림 중 기본 처방을 저장한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
    -->	
	<insert id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-insertBsisOrdr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  >
		<![CDATA[
		   insert /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpBsisOrdrSaveDVO-insertBsisOrdr */
		   into  MDBASORDT
		   (
			   PTNO                        /* 환자번호*/
			   ,  ORDR_YMD                 /* 처방일자*/
			   ,  ORDR_SNO                 /* 처방일련번호*/
			   ,  MDRP_NO                  /* 진료접수번호*/
			   ,  ORDR_CD                  /* 처방코드*/
			   ,  MCDP_CD                  /* 진료과코드*/
			   ,  ODDR_ID                  /* 처방의사ID*/
			   ,  CHDR_ID                  /* 지정의사ID*/
			   ,  GNDR_ID                  /* 주치의사ID*/
			   ,  CODV_CD                  /* 내원구분코드*/
			   ,  PTAD_CODV_CD             /* 원무내원구분코드*/
			   ,  ORDR_CLTY_CD             /* 처방분류유형코드*/
			   ,  ORCL_CD                  /* 처방분류코드*/
			   ,  ODKI_CD                  /* 처방종류코드*/
			   ,  ODKI_DETL_CD             /* 처방종류상세코드*/
			   ,  ORFR_CD                  /* 처방형태코드*/
			   ,  HSLC_DVSN_CD             /* 위치구분코드*/
			   ,  MCCN_CD                  /* 진료센터코드*/
			   ,  WARD_CD                  /* 병동코드*/
			   ,  OROC_DPRT_CD             /* 처방발생원코드*/
			   ,  FRNS_DPRT_CD             /* 불출부서코드*/
			   ,  SLIP_CD                  /* SLIP코드*/
			   ,  CARE_STTS_CD             /* 간호상태코드*/
			   ,  ADTN_ORDV_CD             /* 추가처방구분코드*/
			   ,  RGOR_FNDR_ID             /* 정규처방완료의사ID*/
			   ,  RGOR_FINS_DT             /* 정규처방완료일시*/
			   ,  ORCN_NURS_ID             /* 처방확인간호사ID*/
			   ,  ORCN_DT                  /* 처방확인일시*/
			   ,  TMPR_ORDR_YN             /* 임시처방여부*/
			   ,  DC_DVSN_CD               /* DC구분코드*/
			   ,  DC_ODDR_ID               /* DC처방의사ID*/
			   ,  DC_ORDR_DT               /* DC처방일시*/
			   ,  DC_CNNU_ID               /* DC확인간호사ID*/
			   ,  DC_CNFR_DT               /* DC확인일시*/
			   ,  SORT_SQNC                /* 정렬순서*/
			   ,  BSIS_ORDR_UNSL_CTN       /* 기본처방특이내용*/
			   ,  INPT_USER_DVSN_CD        /* 입력사용자구분코드*/
			   ,  CRTF_DVSN_CD             /* 인증구분코드*/
			   ,  ATHN_ID                  /* 인증자ID*/
			   ,  CRTF_IP                  /* 인증IP*/
			   ,  CRTF_DT                  /* 인증일시*/
			   ,  CLRS_PRJC_CD             /* 임상연구과제코드*/
			   ,  CLRS_PRJC_DR_ID          /* 임상연구과제의사ID*/
			   ,  OPRT_YMD                 /* 수술일자*/
			   ,  OPRT_SNO                 /* 수술일련번호*/
			   ,  ITRN_BSDV_CD             /* 인턴업무구분코드*/
			   ,  SRRQ_CMNT_CTN            /* SR커멘트내용*/
			   ,  CNNT_ORDR_BNDL_NO        /* 동시처방묶음번호*/
			   ,  ORDR_VALD_STRT_YMD       /* 처방유효시작일자*/
			   ,  ORDR_VALD_FNSH_YMD       /* 처방유효종료일자*/
			   ,  IMPL_ORDR_PBLC_NTM       /* 실시처방발행횟수*/
			   ,  IMPL_ORDR_PBLC_LMTT_NTM  /* 실시처방발행제한횟수*/
			   ,  ORGL_ORDR_YMD            /* 원처방일자*/
			   ,  ORGL_ORDR_SNO            /* 원처방일련번호*/
			   ,  ORDR_NM                  /* 처방명*/
			   ,  DIET_QTY                 /* 식사량*/
			   ,  DIST_MEDV_CD             /* 식사시작끼니구분코드*/
			   ,  KCAL_QTY                 /* KCAL량*/
			   ,  ADTN_ADJS_DVSN_CD        /* 추가조정구분코드*/
			   ,  NOTC_YN                  /* 노티여부*/
			   ,  SFDI_YN                  /* 연식여부*/
			   ,  ACTN_NTM                 /* 액팅횟수*/
			   ,  OTPT_APNT_WORK_YN        /* 외래예약작업여부*/
			   ,  IMGN_BSIS_ORDR_CNDR_ID   /* 영상기본처방확인의사ID*/
			   ,  IMGN_BSIS_ORCN_DT        /* 영상기본처방확인일시*/
			   ,  INQR_EXCL_YN             /* 조회제외여부*/
			   ,  BSIS_ORDR_VRSN_VL        /* 기본처방버젼값*/
			   ,  BSIS_ORDR_PACK_ORDR_CD   /* 기본처방Pack처방코드*/
			   ,  LWRN_ORDR_SNO            /* 하위처방일련번호*/
			   ,  ORDR_CRTN_DVSN_CD        /* 처방생성구분코드*/
			   ,  ORDR_CRTN_LNKN_NO        /* 처방생성연결번호*/
		       ,  SPOR_BNDL_NM             /* 스페셜처방묶음명 */
		       ,  SPOR_BNDL_NO             /* 스페셜처방묶음번호*/                 
			   ,  FRST_RGSR_ID             /* 최초등록자ID*/
			   ,  FRST_RGST_IP             /* 최초등록IP*/
			   ,  FRST_RGST_DT             /* 최초등록일시*/
			   ,  FRST_RGST_CLNT_PRGM_ID   /* 최초등록SMC클라이언트프로그램ID*/
			   ,  FRST_RGST_SRVR_PRGM_ID   /* 최초등록SMC서버프로그램ID*/
			   ,  LAST_UPDR_ID             /* 최종수정자ID*/
			   ,  LAST_UPDT_IP             /* 최종수정IP*/
			   ,  LAST_UPDT_DT             /* 최종수정일시*/
			   ,  LAST_UPDT_CLNT_PRGM_ID   /* 최종수정SMC클라이언트프로그램ID*/
			   ,  LAST_UPDT_SRVR_PRGM_ID   /* 최종수정SMC서버프로그램ID*/
			   ,  ORDR_UPDT_DT             /* 처방수정일시*/
			   ,  ORDR_UPDR_ID             /* 처방수정자ID*/
		   )
		   values
		   (
			   #{ptno}                              /* 환자번호*/
			   ,  to_date( #{ordrYmd}, 'YYYYMMDD' ) /* 처방일자*/
			   ,  #{ordrSno}                        /* 처방일련번호*/
			   ,  #{mdrpNo}                         /* 진료접수번호*/
			   ,  #{ordrCd}                         /* 처방코드*/
			   ,  #{mcdpCd}                         /* 진료과코드*/
			   ,  #{oddrId}                         /* 처방의사id*/
			   ,  #{chdrId}                         /* 지정의사id*/
			   ,  #{gndrId}                         /* 주치의사id*/
			   ,  #{codvCd}                         /* 내원구분코드*/
			   ,  #{ptadCodvCd}                     /* 원무내원구분코드*/
			   ,  #{ordrCltyCd}                     /* 처방분류유형코드 [주사약, 외용약, 검체검사, 환자검사 인지를 구별하는 코드로 처방 분류(AI048)의 상위개념으로 볼 수 있다. *. 수가 테이블에 있는 정보를 가져옴. (MM182)]*/
			   ,  #{orclCd}                         /* 처방분류코드*/
			   ,  #{odkiCd}                         /* 처방종류코드*/
			   ,  #{odkiDetlCd}                     /* 처방종류상세코드*/
			   ,  #{orfrCd}                         /* 처방형태코드*/
			   ,  #{hslcDvsnCd}                     /* 위치구분코드*/
			   ,  #{mccnCd}                         /* 진료센터코드*/
			   ,  #{wardCd}                         /* 병동코드*/
			   ,  #{orocDprtCd}                         /* 처방발생원코드*/
			   ,  #{frnsDprtCd}                     /* 불출부서코드*/
			   ,  #{slipCd}                         /* SLIP코드*/
			   ,  #{careSttsCd}                     /* 간호상태코드*/
			   ,  #{adtnOrdvCd}                     /* 추가처방구분코드*/
			   ,  #{rgorFndrId}                     /* 정규처방완료의사id*/
			   ,  to_date( #{rgorFinsDt}, 'YYYYMMDDhh24miss') /* 정규처방완료일시*/
			   ,  #{orcnNursId}                     /* 처방확인간호사id*/
			   ,  to_date( #{orcnDt}, 'YYYYMMDDhh24miss') /* 처방확인일시*/
			   ,  #{tmprOrdrYn}                     /* 임시처방여부*/
			   ,  #{dcDvsnCd}                       /* DC구분코드*/
			   ,  #{dcOddrId}                       /* DC처방의사id*/
			   ,  to_date( #{dcOrdrDt}, 'YYYYMMDDhh24miss') /* DC처방일시*/
			   ,  #{dcCnnuId}                       /* DC확인간호사ID*/
			   ,  to_date( #{dcCnfrDt}, 'YYYYMMDDhh24miss') /* DC확인일시*/
			   ,  #{sortSqnc}                       /* 정렬순서*/
			   ,  #{bsisOrdrUnslCtn}                /* 기본처방특이내용*/
			   ,  #{inptUserDvsnCd}                 /* 입력사용자구분코드*/
			   ,  case when #{crtfDvsnCd} is null then '0' else #{crtfDvsnCd} end  /* 인증구분코드*/
			   ,  #{athnId}                         /* 인증자ID*/
			   ,  #{crtfIp}                         /* 인증IP*/
			   ,  to_date( #{crtfDt}, 'YYYYMMDDhh24miss')   /* 인증일시*/
			   ,  #{clrsPrjcCd}                     /* 임상연구과제코드*/
			   ,  #{clrsPrjcDrId}                   /* 임상연구과제의사ID*/
			   ,  to_date( #{oprtYmd}, 'YYYYMMDD' ) /* 수술일자*/
			   ,  #{oprtSno}                        /* 수술일련번호*/
			   ,  #{itrnBsdvCd}                     /* 인턴업무구분코드*/
			   ,  #{srrqCmntCtn}                    /* SR커멘트내용*/
			   ,  #{cnntOrdrBndlNo}                 /* 동시처방묶음번호*/
			   ,  to_date( #{ordrValdStrtYmd}, 'YYYYMMDD' ) /* 처방유효시작일자*/
			   ,  to_date( #{ordrValdFnshYmd}, 'YYYYMMDD' ) /* 처방유효종료일자*/
			   ,  #{implOrdrPblcNtm}                /* 실시처방발행횟수*/
			   ,  #{implOrdrPblcLmttNtm}            /* 실시처방발행제한횟수*/
			   ,  to_date( #{orglOrdrYmd}, 'YYYYMMDD' )      /* 원처방일자*/
			   ,  #{orglOrdrSno}                    /* 원처방일련번호*/
			   ,  #{ordrNm}                         /* 처방명*/
			   ,  #{dietQty}                        /* 식사량*/
			   ,  #{distMedvCd}                     /* 식사시작끼니구분코드*/
			   ,  #{kcalQty}                        /* kcal량*/
			   ,  #{adtnAdjsDvsnCd}                 /* 추가조정구분코드*/
			   ,  #{notcYn}                         /* 노티여부*/
			   ,  #{sfdiYn}                         /* 연식여부*/
			   ,  #{actnNtm}                        /* 액팅횟수*/
			   ,  #{otptApntWorkYn}                 /* 외래예약작업여부*/
			   ,  #{imgnBsisOrdrCndrId}             /* 영상기본처방확인의사id*/
			   ,  to_date( #{imgnBsisOrcnDt}, 'YYYYMMDDhh24miss') /* 영상기본처방확인일시*/
			   ,  #{inqrExclYn}                     /* 조회제외여부*/
			   ,  #{bsisOrdrVrsnVl}                 /* 기본처방버전값*/
			   ,  #{bsisOrdrPackOrdrCd}             /* 기본처방Pack처방코드*/
			   ,  #{lwrnOrdrSno}                    /* 하위처방일련번호*/
			   ,  #{ordrCrtnDvsnCd}                 /* 처방생성구분코드*/
			   ,  #{ordrCrtnLnknNo}                 /* 처방생성연결번호*/
		       ,  #{sporBndlNm}                     /* 스페셜처방묶음명 */
		       ,  #{sporBndlNo}                     /* 스페셜처방묶음번호 */              
			   ,  #{gvUserId}                       /* 최초등록자ID*/
			   ,  #{gvUserIp}                       /* 최초등록IP*/
			   ,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss') /* 최초등록일시*/
			   ,  #{gvClntPrgmId}                   /* 최초등록SMC클라이언트프로그램ID*/
			   ,  #{gvSrvrPrgmId}                   /* 최초등록SMC서버프로그램ID*/
			   ,  #{gvUserId}                       /* 최종수정자ID*/
			   ,  #{gvUserIp}                       /* 최종수정IP*/
			   ,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss') /* 최종수정일시*/
			   ,  #{gvClntPrgmId}                   /* 최종수정SMC클라이언트프로그램ID*/
			   ,  #{gvSrvrPrgmId}                   /* 최종수정SMC서버프로그램ID*/
			   ,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss') /* 처방수정일시*/
			   ,  #{gvUserId}                       /* 처방수정자ID*/
		   )
			]]>
	</insert>


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneMdbasordtMdbasordt-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="odkiDetlCd" column="ODKI_DETL_CD"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="orocCdOld" column="OROC_CD_OLD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="careSttsCd" column="CARE_STTS_CD"/>
		<result property="adtnOrdvCd" column="ADTN_ORDV_CD"/>
		<result property="rgorFndrId" column="RGOR_FNDR_ID"/>
		<result property="rgorFinsDt" column="RGOR_FINS_DT"/>
		<result property="orcnNursId" column="ORCN_NURS_ID"/>
		<result property="orcnDt" column="ORCN_DT"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="dcCnnuId" column="DC_CNNU_ID"/>
		<result property="dcCnfrDt" column="DC_CNFR_DT"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="bsisOrdrUnslCtn" column="BSIS_ORDR_UNSL_CTN"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="athnId" column="ATHN_ID"/>
		<result property="crtfIp" column="CRTF_IP"/>
		<result property="crtfDt" column="CRTF_DT"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="clrsPrjcDrId" column="CLRS_PRJC_DR_ID"/>
		<result property="oprtYmd" column="OPRT_YMD"/>
		<result property="oprtSno" column="OPRT_SNO"/>
		<result property="itrnBsdvCd" column="ITRN_BSDV_CD"/>
		<result property="srrqCmntCtn" column="SRRQ_CMNT_CTN"/>
		<result property="cnntOrdrBndlNo" column="CNNT_ORDR_BNDL_NO"/>
		<result property="ordrValdStrtYmd" column="ORDR_VALD_STRT_YMD"/>
		<result property="ordrValdFnshYmd" column="ORDR_VALD_FNSH_YMD"/>
		<result property="implOrdrPblcNtm" column="IMPL_ORDR_PBLC_NTM"/>
		<result property="implOrdrPblcLmttNtm" column="IMPL_ORDR_PBLC_LMTT_NTM"/>
		<result property="orglOrdrYmd" column="ORGL_ORDR_YMD"/>
		<result property="orglOrdrSno" column="ORGL_ORDR_SNO"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="dietQty" column="DIET_QTY"/>
		<result property="distMedvCd" column="DIST_MEDV_CD"/>
		<result property="kcalQty" column="KCAL_QTY"/>
		<result property="adtnAdjsDvsnCd" column="ADTN_ADJS_DVSN_CD"/>
		<result property="notcYn" column="NOTC_YN"/>
		<result property="sfdiYn" column="SFDI_YN"/>
		<result property="actnNtm" column="ACTN_NTM"/>
		<result property="otptApntWorkYn" column="OTPT_APNT_WORK_YN"/>
		<result property="unslCtnCnfrYn" column="UNSL_CTN_CNFR_YN"/>
		<result property="imgnBsisOrdrCndrId" column="IMGN_BSIS_ORDR_CNDR_ID"/>
		<result property="imgnBsisOrcnDt" column="IMGN_BSIS_ORCN_DT"/>
		<result property="inqrExclYn" column="INQR_EXCL_YN"/>
		<result property="bsisOrdrVrsnVl" column="BSIS_ORDR_VRSN_VL"/>
		<result property="bsisOrdrPackOrdrCd" column="BSIS_ORDR_PACK_ORDR_CD"/>
		<result property="lwrnOrdrSno" column="LWRN_ORDR_SNO"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="ordrCrtnLnknNo" column="ORDR_CRTN_LNKN_NO"/>
		<result property="ordrUpdtDt" column="ORDR_UPDT_DT"/>
		<result property="ordrUpdrId" column="ORDR_UPDR_ID"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneMdbasordtMdbasordt (MDBASORDT 처방KEY를 이용한 전체컬럼 조회) 
        Description :                                           MDBASORDT 처방KEY를 이용한 전체컬럼 조회
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneMdbasordtMdbasordt-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneMdbasordtMdbasordt"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrBsisMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneMdbasordtMdbasordt-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneMdbasordtMdbasordt *//*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrBsisMngmDAO-selectOneMdbasordtMdbasordt */
		         PTNO                    as PTNO
		     ,  to_char(ORDR_YMD,'YYYYMMDD') as ORDR_YMD
		     ,  ORDR_SNO                as ORDR_SNO
		     ,  MDRP_NO                 as MDRP_NO
		     ,  ORDR_CD                 as ORDR_CD
		     ,  MCDP_CD                 as MCDP_CD
		     ,  ODDR_ID                 as ODDR_ID
		     ,  CHDR_ID                 as CHDR_ID
		     ,  GNDR_ID                 as GNDR_ID
		     ,  CODV_CD                 as CODV_CD
		     ,  PTAD_CODV_CD            as PTAD_CODV_CD
		     ,  ORDR_CLTY_CD            as ORDR_CLTY_CD
		     ,  ORCL_CD                 as ORCL_CD
		     ,  ODKI_CD                 as ODKI_CD
		     ,  ODKI_DETL_CD            as ODKI_DETL_CD
		     ,  ORFR_CD                 as ORFR_CD
		     ,  HSLC_DVSN_CD            as HSLC_DVSN_CD
		     ,  MCCN_CD                 as MCCN_CD
		     ,  WARD_CD                 as WARD_CD
		     ,  OROC_CD_OLD             as OROC_CD_OLD
		     ,  FRNS_DPRT_CD            as FRNS_DPRT_CD
		     ,  SLIP_CD                 as SLIP_CD
		     ,  CARE_STTS_CD            as CARE_STTS_CD
		     ,  ADTN_ORDV_CD            as ADTN_ORDV_CD
		     ,  RGOR_FNDR_ID            as RGOR_FNDR_ID
		     ,  to_char (RGOR_FINS_DT, 'YYYYMMDDhh24miss') as RGOR_FINS_DT
		     ,  ORCN_NURS_ID            as ORCN_NURS_ID
		     ,  to_char (ORCN_DT, 'YYYYMMDDhh24miss') as ORCN_DT
		     ,  TMPR_ORDR_YN            as TMPR_ORDR_YN
		     ,  DC_DVSN_CD              as DC_DVSN_CD
		     ,  DC_ODDR_ID              as DC_ODDR_ID
		     ,  to_char (DC_ORDR_DT, 'YYYYMMDDhh24miss') as DC_ORDR_DT
		     ,  DC_CNNU_ID              as DC_CNNU_ID
		     ,  to_char (DC_CNFR_DT, 'YYYYMMDDhh24miss') as DC_CNFR_DT
		     ,  SORT_SQNC               as SORT_SQNC
		     ,  BSIS_ORDR_UNSL_CTN      as BSIS_ORDR_UNSL_CTN
		     ,  INPT_USER_DVSN_CD       as INPT_USER_DVSN_CD
		     ,  CRTF_DVSN_CD            as CRTF_DVSN_CD
		     ,  ATHN_ID                 as ATHN_ID
		     ,  CRTF_IP                 as CRTF_IP
		     ,  to_char (CRTF_DT, 'YYYYMMDDhh24miss') as CRTF_DT
		     ,  CLRS_PRJC_CD            as CLRS_PRJC_CD
		     ,  CLRS_PRJC_DR_ID         as CLRS_PRJC_DR_ID
		     ,  to_char(OPRT_YMD,'YYYYMMDD') as OPRT_YMD
		     ,  OPRT_SNO                as OPRT_SNO
		     ,  ITRN_BSDV_CD            as ITRN_BSDV_CD
		     ,  SRRQ_CMNT_CTN           as SRRQ_CMNT_CTN
		     ,  CNNT_ORDR_BNDL_NO       as CNNT_ORDR_BNDL_NO
		     ,  to_char(ORDR_VALD_STRT_YMD,'YYYYMMDD') as ORDR_VALD_STRT_YMD
		     ,  to_char(ORDR_VALD_FNSH_YMD,'YYYYMMDD') as ORDR_VALD_FNSH_YMD
		     ,  IMPL_ORDR_PBLC_NTM      as IMPL_ORDR_PBLC_NTM
		     ,  IMPL_ORDR_PBLC_LMTT_NTM as IMPL_ORDR_PBLC_LMTT_NTM
		     ,  to_char(ORGL_ORDR_YMD,'YYYYMMDD') as ORGL_ORDR_YMD
		     ,  ORGL_ORDR_SNO           as ORGL_ORDR_SNO
		     ,  ORDR_NM                 as ORDR_NM
		     ,  DIET_QTY                as DIET_QTY
		     ,  DIST_MEDV_CD            as DIST_MEDV_CD
		     ,  KCAL_QTY                as KCAL_QTY
		     ,  ADTN_ADJS_DVSN_CD       as ADTN_ADJS_DVSN_CD
		     ,  NOTC_YN                 as NOTC_YN
		     ,  SFDI_YN                 as SFDI_YN
		     ,  ACTN_NTM                as ACTN_NTM
		     ,  OTPT_APNT_WORK_YN       as OTPT_APNT_WORK_YN
		     ,  UNSL_CTN_CNFR_YN        as UNSL_CTN_CNFR_YN
		     ,  IMGN_BSIS_ORDR_CNDR_ID  as IMGN_BSIS_ORDR_CNDR_ID
		     ,  to_char (IMGN_BSIS_ORCN_DT, 'YYYYMMDDhh24miss') as IMGN_BSIS_ORCN_DT
		     ,  INQR_EXCL_YN            as INQR_EXCL_YN
		     ,  BSIS_ORDR_VRSN_VL       as BSIS_ORDR_VRSN_VL
		     ,  BSIS_ORDR_PACK_ORDR_CD  as BSIS_ORDR_PACK_ORDR_CD
		     ,  LWRN_ORDR_SNO           as LWRN_ORDR_SNO
		     ,  ORDR_CRTN_DVSN_CD       as ORDR_CRTN_DVSN_CD
		     ,  ORDR_CRTN_LNKN_NO       as ORDR_CRTN_LNKN_NO
		     ,  to_char (ORDR_UPDT_DT, 'YYYYMMDDhh24miss') as ORDR_UPDT_DT
		     ,  ORDR_UPDR_ID            as ORDR_UPDR_ID
		     ,  OROC_DPRT_CD            as OROC_DPRT_CD
		  from  MDBASORDT
		 where  PTNO = #{ptno}
		   and  ORDR_YMD = to_date (#{ordrYmd},'YYYYMMDD')
		   and  ORDR_SNO = #{ordrSno}
	</select>



</mapper>