<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_MdpOrdrExmnMngmDAO_sql.xml 
    Description : -->
<mapper namespace="MdpOrdrExmnMngmDAO">


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneOrdrExmnMngmDual-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="frstIpdvCd" column="FRST_IPDV_CD"/>
		<result property="pacsInrfYn" column="PACS_INRF_YN"/>
		<result property="afiCrtfOrdvVl" column="AFI_CRTF_ORDV_VL"/>
		<result property="mdcrYn" column="MDCR_YN"/>
		<result property="afiRulIdVl" column="AFI_RUL_ID_VL"/>
		<result property="afiRulRspnVl" column="AFI_RUL_RSPN_VL"/>
		<result property="afiRdctInfmCnfrYn" column="AFI_RDCT_INFM_CNFR_YN"/>
		<result property="exrmCd" column="EXRM_CD"/>
		<result property="schdTypCd" column="SCHD_TYP_CD"/>
		<result property="schdDtlsTypCd" column="SCHD_DTLS_TYP_CD"/>
		<result property="afiTmprOrdrSno" column="AFI_TMPR_ORDR_SNO"/>
		<result property="afiOrglOrdrDcDvsnCd" column="AFI_ORGL_ORDR_DC_DVSN_CD"/>
		<result property="mdprUicmTaboCd" column="MDPR_UICM_TABO_CD"/>
		<result property="mriCnrcDvsnCd" column="MRI_CNRC_DVSN_CD"/>
		<result property="exmnAndvCd" column="EXMN_ANDV_CD"/>
		<result property="pthlNo" column="PTHL_NO"/>
		<result property="ptexAdorSno" column="PTEX_ADOR_SNO"/>
		<result property="inftDprtCd" column="INFT_DPRT_CD"/>
		<result property="wntdDt1" column="WNTD_DT_1"/>
		<result property="afiOrfrNm" column="AFI_ORFR_NM"/>
		<result property="orreExstYn" column="ORRE_EXST_YN"/>
		<result property="ordrInrfClotYn" column="ORDR_INRF_CLOT_YN"/>
		<result property="doneExrsCtn" column="DONE_EXRS_CTN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneOrdrExmnMngmDual (DVO Parameter를 유지하기 위한 DUAL SELECT) 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneOrdrExmnMngmDual-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneOrdrExmnMngmDual"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneOrdrExmnMngmDual-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneOrdrExmnMngmDual */
		       '' as FRST_IPDV_CD
		     , '' as PACS_INRF_YN
		     , '' as AFI_CRTF_ORDV_VL
		     , '' as MDCR_YN
		     , '' as AFI_RUL_ID_VL
		     , '' as AFI_RUL_RSPN_VL
		     , '' as AFI_RDCT_INFM_CNFR_YN
		     , '' as EXRM_CD
		     , '' as SCHD_TYP_CD
		     , '' as SCHD_DTLS_TYP_CD
		     , 0 as AFI_TMPR_ORDR_SNO
		     , '' as AFI_ORGL_ORDR_DC_DVSN_CD
		     , '' as MDPR_UICM_TABO_CD
		     , '' as MRI_CNRC_DVSN_CD
		     , '' as EXMN_ANDV_CD
		     , '' as PTHL_NO
		     , 0 as PTEX_ADOR_SNO
		     , '' as INFT_DPRT_CD
		     , '' as WNTD_DT_1
		     , '' as AFI_ORFR_NM
		     , '' as ORRE_EXST_YN	/* 처방사유존재여부 */
		     , '' as ORDR_INRF_CLOT_YN /* 처방인터페이스호출여부 */
		     , '' as DONE_EXRS_CTN /* 선실시검사결과내용 */
		from dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrSno-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="ordrSno" column="ORDR_SNO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrSno (검사처방 Sequence 조회) 
        Description :                                           검사처방 처방일련번호에 사용되는 sequence를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrSno-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrSno"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrSno-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrSno */
		          MDEXMORDTQ.nextval as ORDR_SNO
		 from  dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOnePtntLtstExmnBefOrdrYmd-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="ordrYmd" column="ORDR_YMD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOnePtntLtstExmnBefOrdrYmd (최근 검사 전처방 처방일자 조회) 
        Description :                                           최근 검사 전처방 처방일자를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOnePtntLtstExmnBefOrdrYmd-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOnePtntLtstExmnBefOrdrYmd"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOnePtntLtstExmnBefOrdrYmd-result" useCache="true" flushCache="false">
		<![CDATA[
			   select  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOnePtntLtstExmnBefOrdrYmd */
					   max(to_char(a.ORDR_YMD,'yyyymmdd')) as ORDR_YMD
				 from  MDEXMORDT a
				 where  a.PTNO        =  #{ptno}
				   and  a.ORDR_YMD    <= to_date(#{ordrYmd}, 'yyyymmdd')
		]]>
			     <if test='orocDprtCd != null and orocDprtCd != ""'>
		           and  a.OROC_DPRT_CD = #{orocDprtCd}
			  	 </if>
		         <if test='mcdpCd != null and mcdpCd != ""'>
		           and  a.MCDP_CD = #{mcdpCd}
		         </if>
		         <if test='chdrId != null and chdrId != ""'>
		           and  a.CHDR_ID = #{chdrId}
		         </if>
		<![CDATA[ 
				   and  a.CODV_CD like #{codvCd}||'%'
				   and  a.ODKI_CD like #{odkiCd}||'%'  /*  퇴원처방 구분하기 위해 추가 */
				   and  ((a.ORCL_CD is null)
						  or ((a.ORCL_CD is not null) and (a.ORCL_CD <> 'NTR')))       /*  간호처치 교육처방 제외(처방코드마스터에 없는것) */
						/*
						 * 위 로직은 인증구분으로 처리하는 방법을 생각해보자
						 * 간호처치 교육처방 데이터가 존재하나?
						 */
				   and  a.DC_DVSN_CD = 'N'   /*  취소된처방 제외 */
				   and  nvl( a.ORDR_CRTN_DVSN_CD, 'X' ) not in ( '08' , '10' , '11' ) /*  PRN실시처방 , 응급실1차실시처방 , 1회추가실시처방  */
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnImplOrdrPblcYn-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="yn" column="YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnImplOrdrPblcYn (검사 실시처방 발행 제한 횟수 조회) 
        Description :                                           검사 실시처방 발행 제한 횟수를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnImplOrdrPblcYn-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnImplOrdrPblcYn"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnImplOrdrPblcYn-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnImplOrdrPblcYn */
					case when ( nvl(IMPL_ORDR_PBLC_LMTT_NTM,999) - nvl(IMPL_ORDR_PBLC_NTM,0) ) > 0 then 'Y' else 'N'end as YN
			 from  MDEXMORDT
			where  PTNO = #{ptno}
			  and  ORDR_YMD = to_date ( #{orglOrdrYmd}, 'YYYYMMDD' )
			  and  ORDR_SNO = #{orglOrdrSno}
			  and  ORFR_CD  = case when #{ordrCrtnDvsnCd} = '08' then 'P'
								   when #{ordrCrtnDvsnCd} = '10' then 'F'
								   when #{ordrCrtnDvsnCd} = '11' then 'I'
								   else ORFR_CD END
			  and  DC_DVSN_CD = 'N'
			]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrAtmtRtrnTrgt-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="mdfeCd" column="MDFE_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrAtmtRtrnTrgt (검사처방 자동반납 대상 처방 조회) 
        Description :                                           검사처방 자동반납 대상 처방을 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrAtmtRtrnTrgt-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrAtmtRtrnTrgt"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrAtmtRtrnTrgt-result" useCache="true" flushCache="false">
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrAtmtRtrnTrgt */
		           b.mdfe_cd as MDFE_CD
		  from  MDEXMORDT a
		        ,  AIMFMDFET b
		where  a.PTNO = #{ptno}
		   and  a.ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		   and  a.ORDR_SNO = #{ordrSno}
		   and  a.ORDR_CD = b.MDFE_CD
		   and  b.MDAC_CLSF_CD = '09'
		   and  b.MDCF_CD in ('OP1', 'BR1')
		   and  a.ORDR_YMD between b.APST_YMD and b.APFN_YMD
		   and  rownum = 1
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrDplcOrdrYn-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="yn" column="YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrDplcOrdrYn (동일 처방일에 중복처방내림 방지를 위한 검사처방정보조회) 
        Description :                                           BP7A05, BP7B07 처방코드 동일 처방일에 중복처방내림 방지를 위한 검사처방정보를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrDplcOrdrYn-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrDplcOrdrYn"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrDplcOrdrYn-result" useCache="true" flushCache="false">
		<![CDATA[
		 select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnOrdrDplcOrdrYn */
		           case when count(PTNO) > 0 then 'Y' else 'N'end as YN
		  from  MDEXMORDT
		where  PTNO       = #{ptno}
		   and  ORDR_YMD   = to_date(#{ordrYmd},'yyyymmdd')
		   and  DC_DVSN_CD = 'N'
		   and  ORDR_CD    = decode(#{ordrCd},'BP7A05','BP7B07','BP7A05')
		   and  rownum < 2
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntExmnOrdrList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="saveDvsnCd" column="SAVE_DVSN_CD"/>
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ptadMdrpNo" column="PTAD_MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="odkiDetlCd" column="ODKI_DETL_CD"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="careSttsCd" column="CARE_STTS_CD"/>
		<result property="rtrnSttsCd" column="RTRN_STTS_CD"/>
		<result property="rtrnRqstDt" column="RTRN_RQST_DT"/>
		<result property="rtrnRqprId" column="RTRN_RQPR_ID"/>
		<result property="adtnOrdvCd" column="ADTN_ORDV_CD"/>
		<result property="rgorFndrId" column="RGOR_FNDR_ID"/>
		<result property="rgorFinsDt" column="RGOR_FINS_DT"/>
		<result property="orcnNursId" column="ORCN_NURS_ID"/>
		<result property="orcnDt" column="ORCN_DT"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="dcCnnuId" column="DC_CNNU_ID"/>
		<result property="dcCnfrDt" column="DC_CNFR_DT"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="exorUnslCtn" column="EXOR_UNSL_CTN"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="athnId" column="ATHN_ID"/>
		<result property="crtfIp" column="CRTF_IP"/>
		<result property="crtfDt" column="CRTF_DT"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="clrsPrjcDrId" column="CLRS_PRJC_DR_ID"/>
		<result property="oprtYmd" column="OPRT_YMD"/>
		<result property="oprtSno" column="OPRT_SNO"/>
		<result property="itrnBsdvCd" column="ITRN_BSDV_CD"/>
		<result property="srrqCmntCtn" column="SRRQ_CMNT_CTN"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="ptadIpdvCd" column="PTAD_IPDV_CD"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="cnplCd" column="CNPL_CD"/>
		<result property="ptadClamYmd" column="PTAD_CLAM_YMD"/>
		<result property="ptadClbaYmd" column="PTAD_CLBA_YMD"/>
		<result property="paclYmd" column="PACL_YMD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="rpntId" column="RPNT_ID"/>
		<result property="rcpcDt" column="RCPC_DT"/>
		<result property="viaAdmsRcstCd" column="VIA_ADMS_RCST_CD"/>
		<result property="opsrId" column="OPSR_ID"/>
		<result property="cpdrId" column="CPDR_ID"/>
		<result property="endrId" column="ENDR_ID"/>
		<result property="endrNm" column="ENDR_NM"/>
		<result property="exmnWntdDrId" column="EXMN_WNTD_DR_ID"/>
		<result property="exmnWntdDrNm" column="EXMN_WNTD_DR_NM"/>
		<result property="wntdDt" column="WNTD_DT"/>
		<result property="exmnWntdYmdDvsnCd" column="EXMN_WNTD_YMD_DVSN_CD"/>
		<result property="nnmtExmnYn" column="NNMT_EXMN_YN"/>
		<result property="nnmtExmnNtfcYmd" column="NNMT_EXMN_NTFC_YMD"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="abcEnfrYmd" column="ABC_ENFR_YMD"/>
		<result property="abcMcdpCd" column="ABC_MCDP_CD"/>
		<result property="abcEfdpCd" column="ABC_EFDP_CD"/>
		<result property="abcOddrId" column="ABC_ODDR_ID"/>
		<result property="abcEndrId" column="ABC_ENDR_ID"/>
		<result property="vatTrgtYn" column="VAT_TRGT_YN"/>
		<result property="icuVsDsplYn" column="ICU_VS_DSPL_YN"/>
		<result property="cnntOrdrBndlNo" column="CNNT_ORDR_BNDL_NO"/>
		<result property="ordrValdStrtYmd" column="ORDR_VALD_STRT_YMD"/>
		<result property="ordrValdFnshYmd" column="ORDR_VALD_FNSH_YMD"/>
		<result property="implOrdrPblcNtm" column="IMPL_ORDR_PBLC_NTM"/>
		<result property="implOrdrPblcLmttNtm" column="IMPL_ORDR_PBLC_LMTT_NTM"/>
		<result property="orglOrdrYmd" column="ORGL_ORDR_YMD"/>
		<result property="orglOrdrSno" column="ORGL_ORDR_SNO"/>
		<result property="scexAdtnOrdvCd" column="SCEX_ADTN_ORDV_CD"/>
		<result property="befrSpcmNo" column="BEFR_SPCM_NO"/>
		<result property="exmnRefrDvsnCd" column="EXMN_REFR_DVSN_CD"/>
		<result property="refrLnknNo" column="REFR_LNKN_NO"/>
		<result property="durvYn" column="DURV_YN"/>
		<result property="durvResnCtn" column="DURV_RESN_CTN"/>
		<result property="durvOrdrYmd" column="DURV_ORDR_YMD"/>
		<result property="durvOrdrCd" column="DURV_ORDR_CD"/>
		<result property="exmnRtreCd" column="EXMN_RTRE_CD"/>
		<result property="rtrnSpsbCtn" column="RTRN_SPSB_CTN"/>
		<result property="excfCd" column="EXCF_CD"/>
		<result property="indrId1" column="INDR_ID1"/>
		<result property="indrId2" column="INDR_ID2"/>
		<result property="indrId3" column="INDR_ID3"/>
		<result property="spcmCd1" column="SPCM_CD1"/>
		<result property="spcmNeedQty1" column="SPCM_NEED_QTY1"/>
		<result property="spcnCd1" column="SPCN_CD1"/>
		<result property="spcnNeedCot1" column="SPCN_NEED_COT1"/>
		<result property="spcmCd2" column="SPCM_CD2"/>
		<result property="spcmNeedQty2" column="SPCM_NEED_QTY2"/>
		<result property="spcnCd2" column="SPCN_CD2"/>
		<result property="spcnNeedCot2" column="SPCN_NEED_COT2"/>
		<result property="spcmNo1" column="SPCM_NO1"/>
		<result property="spcmNo2" column="SPCM_NO2"/>
		<result property="exorPrssCd" column="EXOR_PRSS_CD"/>
		<result property="istpAdmnVlm" column="ISTP_ADMN_VLM"/>
		<result property="mdcrBeexYn" column="MDCR_BEEX_YN"/>
		<result property="anadYn" column="ANAD_YN"/>
		<result property="anggInrvDvsnCd" column="ANGG_INRV_DVSN_CD"/>
		<result property="prtbYn" column="PRTB_YN"/>
		<result property="acmpYn" column="ACMP_YN"/>
		<result property="blclExmnYn" column="BLCL_EXMN_YN"/>
		<result property="iodiMdteTsrYn" column="IODI_MDTE_TSR_YN"/>
		<result property="dxPthlAdorYn" column="DX_PTHL_ADOR_YN"/>
		<result property="brcdPrinYn" column="BRCD_PRIN_YN"/>
		<result property="brcdPnprId" column="BRCD_PNPR_ID"/>
		<result property="blclBrcdPrinDt" column="BLCL_BRCD_PRIN_DT"/>
		<result property="apntDt" column="APNT_DT"/>
		<result property="ordrApntDt" column="ORDR_APNT_DT"/>
		<result property="exrmRptnDt" column="EXRM_RPTN_DT"/>
		<result property="enfrDt" column="ENFR_DT"/>
		<result property="intrDt" column="INTR_DT"/>
		<result property="rprtDt" column="RPRT_DT"/>
		<result property="acimNursId" column="ACIM_NURS_ID"/>
		<result property="actnDt" column="ACTN_DT"/>
		<result property="acimInptDt" column="ACIM_INPT_DT"/>
		<result property="acimUpdtDt" column="ACIM_UPDT_DT"/>
		<result property="acimSpabCtn" column="ACIM_SPAB_CTN"/>
		<result property="acimCnfrCd" column="ACIM_CNFR_CD"/>
		<result property="actnLastCnfmId" column="ACTN_LAST_CNFM_ID"/>
		<result property="actnLastCnfrDt" column="ACTN_LAST_CNFR_DT"/>
		<result property="dschOrdrCasbCtn" column="DSCH_ORDR_CASB_CTN"/>
		<result property="dschOrdrExmnDt" column="DSCH_ORDR_EXMN_DT"/>
		<result property="pacsAccsNo" column="PACS_ACCS_NO"/>
		<result property="pacsTrdvCd" column="PACS_TRDV_CD"/>
		<result property="dadvCd" column="DADV_CD"/>
		<result property="hlscExmnYn" column="HLSC_EXMN_YN"/>
		<result property="endsPacsTrdvCd" column="ENDS_PACS_TRDV_CD"/>
		<result property="prvnInjcOrno" column="PRVN_INJC_ORNO"/>
		<result property="mdfeAplyYmd" column="MDFE_APLY_YMD"/>
		<result property="mdctPacsTrdvCd" column="MDCT_PACS_TRDV_CD"/>
		<result property="mriIpdvUpdtCd" column="MRI_IPDV_UPDT_CD"/>
		<result property="hlscApntNo" column="HLSC_APNT_NO"/>
		<result property="riskFctrVl" column="RISK_FCTR_VL"/>
		<result property="dytmWardUseWntdYn" column="DYTM_WARD_USE_WNTD_YN"/>
		<result property="endsChfrAmdrId" column="ENDS_CHFR_AMDR_ID"/>
		<result property="ordrValdPerdExptYmd" column="ORDR_VALD_PERD_EXPT_YMD"/>
		<result property="dspcNursAdjsBndlNo" column="DSPC_NURS_ADJS_BNDL_NO"/>
		<result property="dspcNursAdjsNo" column="DSPC_NURS_ADJS_NO"/>
		<result property="dspcNursAdjsBndlNm" column="DSPC_NURS_ADJS_BNDL_NM"/>
		<result property="dspcNursAdjsPtgoCtn" column="DSPC_NURS_ADJS_PTGO_CTN"/>
		<result property="exrsNtfcMthdDvsnCd" column="EXRS_NTFC_MTHD_DVSN_CD"/>
		<result property="imlnOrdrYn" column="IMLN_ORDR_YN"/>
		<result property="sspcScinNm" column="SSPC_SCIN_NM"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="ordrCrtnLnknNo" column="ORDR_CRTN_LNKN_NO"/>
		<result property="sporBndlNm" column="SPOR_BNDL_NM"/>
		<result property="sporBndlNo" column="SPOR_BNDL_NO"/>
		<result property="slpnYn" column="SLPN_YN"/>
		<result property="frstRgsrId" column="FRST_RGSR_ID"/>
		<result property="frstRgstIp" column="FRST_RGST_IP"/>
		<result property="frstRgstDt" column="FRST_RGST_DT"/>
		<result property="lastUpdrId" column="LAST_UPDR_ID"/>
		<result property="lastUpdtIp" column="LAST_UPDT_IP"/>
		<result property="lastUpdtDt" column="LAST_UPDT_DT"/>
		<result property="hmtpBsclRcpnRltnCd" column="HMTP_BSCL_RCPN_RLTN_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="setExmnYn" column="SET_EXMN_YN"/>
		<result property="dxObjcUltsYn" column="DX_OBJC_ULTS_YN"/>
		<result property="ultsClsfCd" column="ULTS_CLSF_CD"/>
		<result property="insrIpdvCd" column="INSR_IPDV_CD"/>
		<result property="prtcIpdvCd" column="PRTC_IPDV_CD"/>
		<result property="incsIpdvCd" column="INCS_IPDV_CD"/>
		<result property="tainIpdvCd" column="TAIN_IPDV_CD"/>
		<result property="scexAdtnOrdvCd1" column="SCEX_ADTN_ORDV_CD_1"/>
		<result property="pctsExmnPsblYn" column="PCTS_EXMN_PSBL_YN"/>
		<result property="tdmCdDvsnCd" column="TDM_CD_DVSN_CD"/>
		<result property="phrkExmnCd" column="PHRK_EXMN_CD"/>
		<result property="erExmnPsblYn" column="ER_EXMN_PSBL_YN"/>
		<result property="apntNeedEn" column="APNT_NEED_EN"/>
		<result property="wardApntPsblYn" column="WARD_APNT_PSBL_YN"/>
		<result property="otptCareBlclYn" column="OTPT_CARE_BLCL_YN"/>
		<result property="mvmnDvsnCd" column="MVMN_DVSN_CD"/>
		<result property="donePsblYn" column="DONE_PSBL_YN"/>
		<result property="cnmdPrvnAntbTrgtYn" column="CNMD_PRVN_ANTB_TRGT_YN"/>
		<result property="wardExrmCd" column="WARD_EXRM_CD"/>
		<result property="mdfeItdvCd" column="MDFE_ITDV_CD"/>
		<result property="afiMdcrBeexPsblYn" column="AFI_MDCR_BEEX_PSBL_YN"/>
		<result property="afiOrglOrdrNm" column="AFI_ORGL_ORDR_NM"/>
		<result property="afiOrglOrdrExrmRptnDt" column="AFI_ORGL_ORDR_EXRM_RPTN_DT"/>
		<result property="afiExmnPsblSpcmCdCtn" column="AFI_EXMN_PSBL_SPCM_CD_CTN"/>
		<result property="hmtpBsclRcpnRltnCd" column="HMTP_BSCL_RCPN_RLTN_CD"/>
		<result property="insrEdiCd" column="INSR_EDI_CD"/>
		<result property="cisInrfYn" column="CIS_INRF_YN"/>
		<result property="dtlsExcfCd" column="DTLS_EXCF_CD"/>
		<result property="chldDvsnCd" column="CHLD_DVSN_CD"/>
		<result property="cnmdPrvnAntbTrgtYn" column="CNMD_PRVN_ANTB_TRGT_YN"/>
		<result property="tissExmnYn" column="TISS_EXMN_YN"/>
		<result property="ultsSiteCd" column="ULTS_SITE_CD"/>
		<result property="erExmnPsblYn" column="ER_EXMN_PSBL_YN"/>
		<result property="slpnPsblYn" column="SLPN_PSBL_YN"/>
		<result property="erMcteAddvCd" column="ER_MCTE_ADDV_CD"/>
		<result property="erMcteAditYn" column="ER_MCTE_ADIT_YN"/>
		<result property="oprtMdfeCdYn" column="OPRT_MDFE_CD_YN"/>
		<result property="tdmCeckCtn" column="TDM_CECK_CTN"/>
		<result property="dxExmnTdmYn" column="DX_EXMN_TDM_YN"/>
		<result property="dgmtTdmYn" column="DGMT_TDM_YN"/>
		<result property="dxExmnCmtxCd" column="DX_EXMN_CMTX_CD"/>
		<result property="dgmtCmtxCd" column="DGMT_CMTX_CD"/>
		<result property="insrAcknBaseCeckYn" column="INSR_ACKN_BASE_CECK_YN"/>
		<result property="subTypeCd" column="SUB_TYPE_CD"/>
		<result property="scrgInpyOnbrRt" column="SCRG_INPY_ONBR_RT"/>
		<result property="insrOpnnCtn" column="INSR_OPNN_CTN"/>
		<result property="prnPsblYn" column="PRN_PSBL_YN"/>
		<result property="cnsnRltdYn" column="CNSN_RLTD_YN"/>
		<result property="cnsnRltdMcdpCd" column="CNSN_RLTD_MCDP_CD"/>
		<result property="cnmdDetlCtn" column="CNMD_DETL_CTN"/>
		<result property="ptexLvelDvsnCd" column="PTEX_LVEL_DVSN_CD"/>
		<result property="rmrkYn" column="RMRK_YN"/>
		<result property="pacsInrfYn" column="PACS_INRF_YN"/>
		<result property="nghtAditRt" column="NGHT_ADIT_RT"/>
		<result property="agdcNeedEn" column="AGDC_NEED_EN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntExmnOrdrList (환자의 검사 처방 정보 조회) 
        Description :                                           환자의 검사 처방 정보를 조회한다..
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntExmnOrdrList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntExmnOrdrList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntExmnOrdrList-result" useCache="true" flushCache="false">
		<![CDATA[
		SELECT  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntExmnOrdrList_검사 처방 조회 */
				   'S'  as SAVE_DVSN_CD
				   ,  a.PTNO as PTNO  /* 환자번호*/
				   ,  to_char ( a.ORDR_YMD, 'YYYYMMDD') as ORDR_YMD  /* 처방일자*/
				   ,  a.ORDR_SNO as ORDR_SNO  /* 처방일련번호*/
				   ,  a.MDRP_NO as MDRP_NO  /* 진료접수번호*/
				   ,  a.PTAD_MDRP_NO as PTAD_MDRP_NO  /* 원무접수번호*/
				   ,  a.ORDR_CD as ORDR_CD  /* 처방코드*/
				   ,  a.MCDP_CD as MCDP_CD  /* 진료과코드*/
				   ,  a.ODDR_ID as ODDR_ID  /* 처방의사ID*/
				   ,  a.CHDR_ID as CHDR_ID  /* 지정의사ID*/
				   ,  a.GNDR_ID as GNDR_ID  /* 주치의사ID*/
				   ,  a.CODV_CD as CODV_CD  /* 내원구분코드*/
				   ,  a.PTAD_CODV_CD as PTAD_CODV_CD  /* 원무내원구분코드*/
				   ,  a.ORDR_CLTY_CD as ORDR_CLTY_CD  /* 처방분류유형코드*/
				   ,  a.ORCL_CD as ORCL_CD  /* 처방분류코드*/
				   ,  a.ODKI_CD as ODKI_CD  /* 처방종류코드*/
				   ,  a.ODKI_DETL_CD as ODKI_DETL_CD  /* 처방종류상세코드*/
				   ,  a.ORFR_CD as ORFR_CD  /* 처방형태코드*/
				   ,  a.HSLC_DVSN_CD as HSLC_DVSN_CD  /* 위치구분코드*/
				   ,  a.MCCN_CD as MCCN_CD  /* 진료센터코드*/
				   ,  a.WARD_CD as WARD_CD  /* 병동코드*/
				   ,  a.OROC_DPRT_CD as OROC_DPRT_CD  /* 처방발생원코드*/
				   ,  a.FRNS_DPRT_CD as FRNS_DPRT_CD  /* 불출부서코드*/
				   ,  a.SLIP_CD as SLIP_CD  /* SLIP코드*/
				   ,  a.CARE_STTS_CD as CARE_STTS_CD  /* 간호상태코드*/
				   ,  a.RTRN_STTS_CD as RTRN_STTS_CD  /* 반납상태코드*/
				   ,  to_char ( a.RTRN_RQST_DT, 'YYYYMMDDhh24miss') as RTRN_RQST_DT  /* 반납요청일시*/
				   ,  a.RTRN_RQPR_ID as RTRN_RQPR_ID  /* 반납요청자ID*/
				   ,  a.ADTN_ORDV_CD as ADTN_ORDV_CD  /* 추가처방구분코드*/
				   ,  a.RGOR_FNDR_ID as RGOR_FNDR_ID  /* 정규처방완료의사ID*/
				   ,  to_char ( a.RGOR_FINS_DT, 'YYYYMMDDhh24miss') as RGOR_FINS_DT  /* 정규처방완료일시*/
				   ,  a.ORCN_NURS_ID as ORCN_NURS_ID  /* 처방확인간호사ID*/
				   ,  to_char ( a.ORCN_DT, 'YYYYMMDDhh24miss') as ORCN_DT  /* 처방확인일시*/
				   ,  a.TMPR_ORDR_YN as TMPR_ORDR_YN  /* 임시처방여부*/
				   ,  a.DC_DVSN_CD as DC_DVSN_CD  /* DC구분코드*/
				   ,  a.DC_ODDR_ID as DC_ODDR_ID  /* DC처방의사ID*/
					,  to_char ( a.DC_ORDR_DT, 'YYYYMMDDhh24miss') as DC_ORDR_DT  /* DC처방일시*/
				   ,  a.DC_CNNU_ID as DC_CNNU_ID  /* DC확인간호사ID*/
				   ,  to_char ( a.DC_CNFR_DT, 'YYYYMMDDhh24miss' )   as DC_CNFR_DT  /* DC확인일시*/
				   /* ,  a.SORT_SQNC */
				   ,  decode(a.ORDR_CRTN_DVSN_CD,'08',9900,'09',9901,'10',9902,'11',9903, a.SORT_SQNC) as SORT_SQNC  /* 정렬순서*/
				   ,  a.EXOR_UNSL_CTN as EXOR_UNSL_CTN  /* 검사처방특이내용*/
				   ,  a.INPT_USER_DVSN_CD as INPT_USER_DVSN_CD  /* 입력사용자구분코드*/
				   ,  a.CRTF_DVSN_CD as CRTF_DVSN_CD  /* 인증구분코드*/
				   ,  a.ATHN_ID as ATHN_ID  /* 인증자ID*/
				   ,  a.CRTF_IP as CRTF_IP  /* 인증IP*/
				   ,  to_char ( a.CRTF_DT, 'YYYYMMDDhh24miss') as CRTF_DT  /* 인증일시*/
				   ,  a.CLRS_PRJC_CD as CLRS_PRJC_CD  /* 임상연구과제코드*/
				   ,  a.CLRS_PRJC_DR_ID as CLRS_PRJC_DR_ID  /* 임상연구과제의사ID*/
				   ,  to_char ( a.OPRT_YMD, 'YYYYMMDD') as OPRT_YMD  /* 수술일자*/
				   ,  a.OPRT_SNO as OPRT_SNO  /* 수술일련번호*/
				   ,  a.ITRN_BSDV_CD as ITRN_BSDV_CD  /* 인턴업무구분코드*/
				   ,  a.SRRQ_CMNT_CTN as SRRQ_CMNT_CTN  /* SR커멘트내용*/
				   ,  a.ORDR_IPDV_CD as ORDR_IPDV_CD  /* 보험급여구분코드*/
				   ,  a.PTAD_IPDV_CD as PTAD_IPDV_CD  /* 심사급여구분코드*/
				   ,  a.ISTY_CD as ISTY_CD  /* 보험유형코드*/
				   ,  a.ISTY_ASST_CD as ISTY_ASST_CD  /* 보험유형보조코드*/
				   ,  a.CNPL_CD as CNPL_CD  /* 계약처코드*/
				   ,  to_char ( a.PTAD_CLAM_YMD, 'YYYYMMDD') as PTAD_CLAM_YMD  /* 원무청구일자*/
				   ,  to_char ( a.PTAD_CLBA_YMD, 'YYYYMMDDhh24miss') as PTAD_CLBA_YMD  /* 원무계산기준일자*/
				   ,  to_char ( a.PACL_YMD, 'YYYYMMDD') as PACL_YMD  /* 원무계산일자*/
				   ,  a.RCST_CD as RCST_CD  /* 수납상태코드*/
				   ,  a.RPNT_ID as RPNT_ID  /* 수납자ID*/
				   ,  to_char ( a.RCPC_DT, 'YYYYMMDDhh24miss') as RCPC_DT  /* 수납일시*/
				   ,  a.VIA_ADMS_RCST_CD as VIA_ADMS_RCST_CD  /* 경유입원수납상태코드*/
				   ,  a.OPSR_ID as OPSR_ID  /* 집도의사ID*/
				   ,  a.CPDR_ID as CPDR_ID  /* 협진의사ID*/
				   ,  a.ENDR_ID as ENDR_ID  /* 시행의사ID*/
		           ,  u2.USER_NM as ENDR_NM
				   ,  a.EXMN_WNTD_DR_ID as EXMN_WNTD_DR_ID  /* 검사희망의사ID*/
				   ,  u1.USER_NM as EXMN_WNTD_DR_NM  /* 검사희망의사명*/
				   ,  to_char ( a.WNTD_DT, 'YYYYMMDDhh24miss') as WNTD_DT  /* 희망일시*/
				   ,  a.EXMN_WNTD_YMD_DVSN_CD as EXMN_WNTD_YMD_DVSN_CD  /* 검사희망일자구분코드*/
				   ,  a.NNMT_EXMN_YN as NNMT_EXMN_YN  /* 비대면검사여부*/
				   ,  to_char ( a.NNMT_EXMN_NTFC_YMD, 'YYYYMMDD') as NNMT_EXMN_NTFC_YMD  /* 비대면검사통보일시*/
				   ,  a.PTPT_CD as PTPT_CD  /* 환자가야할장소코드*/
				   ,  to_char ( a.ABC_ENFR_YMD, 'YYYYMMDD') as ABC_ENFR_YMD  /* ABC시행일자*/
				   ,  a.ABC_MCDP_CD as ABC_MCDP_CD  /* ABC진료과코드*/
				   ,  a.ABC_EFDP_CD as ABC_EFDP_CD  /* ABC시행부서코드*/
				   ,  a.ABC_ODDR_ID as ABC_ODDR_ID  /* ABC처방의사ID*/
				   ,  a.ABC_ENDR_ID as ABC_ENDR_ID  /* ABC시행의사ID*/
				   ,  a.VAT_TRGT_YN as VAT_TRGT_YN  /* 부가세대상여부*/
				   ,  a.ICU_VS_DSPL_YN as ICU_VS_DSPL_YN  /* ICU_VitalSign표시여부*/
				   ,  a.CNNT_ORDR_BNDL_NO as CNNT_ORDR_BNDL_NO  /* 동시처방묶음번호*/
				   ,  to_char ( a.ORDR_VALD_STRT_YMD, 'YYYYMMDD') as ORDR_VALD_STRT_YMD  /* 처방유효시작일자*/
				   ,  to_char ( a.ORDR_VALD_FNSH_YMD, 'YYYYMMDD') as ORDR_VALD_FNSH_YMD  /* 처방유효종료일자*/
				   ,  a.IMPL_ORDR_PBLC_NTM as IMPL_ORDR_PBLC_NTM  /* 실시처방발행횟수*/
				   ,  a.IMPL_ORDR_PBLC_LMTT_NTM as IMPL_ORDR_PBLC_LMTT_NTM  /* 실시처방발행제한횟수*/
				   ,  to_char ( a.ORGL_ORDR_YMD, 'YYYYMMDD') as ORGL_ORDR_YMD  /* 원처방일자*/
				   ,  a.ORGL_ORDR_SNO as ORGL_ORDR_SNO  /* 원처방일련번호*/
				   ,  a.SCEX_ADTN_ORDV_CD as SCEX_ADTN_ORDV_CD  /* 검체검사추가처방구분코드*/
				   ,  a.BEFR_SPCM_NO as BEFR_SPCM_NO  /* 이전검체번호*/
				   ,  a.EXMN_REFR_DVSN_CD as EXMN_REFR_DVSN_CD  /* 검사의뢰구분코드*/
				   ,  a.REFR_LNKN_NO as REFR_LNKN_NO  /* 의뢰연결번호*/
				   ,  a.DURV_YN as DURV_YN  /* DUR여부*/
				   ,  a.DURV_RESN_CTN as DURV_RESN_CTN  /* DUR사유내용*/
				   ,  to_char ( a.DURV_ORDR_YMD, 'YYYYMMDD') as DURV_ORDR_YMD  /* DUR처방일자*/
				   ,  a.DURV_ORDR_CD as DURV_ORDR_CD  /* DUR처방코드*/
				   ,  a.EXMN_RTRE_CD as EXMN_RTRE_CD  /* 검사반납사유코드*/
				   ,  a.RTRN_SPSB_CTN as RTRN_SPSB_CTN  /* 반납특기사항내용*/
				   ,  a.EXCF_CD as EXCF_CD  /* 검사분류코드*/
				   ,  a.INDR_ID1 as INDR_ID1  /* 판독의사ID1*/
				   ,  a.INDR_ID2 as INDR_ID2  /* 판독의사ID2*/
				   ,  a.INDR_ID3 as INDR_ID3  /* 판독의사ID3*/
				   ,  a.SPCM_CD1 as SPCM_CD1  /* 검체코드1*/
				   ,  a.SPCM_NEED_QTY1 as SPCM_NEED_QTY1  /* 검체필요량1*/
				   ,  a.SPCN_CD1 as SPCN_CD1  /* 검체용기코드1*/
				   ,  a.SPCN_NEED_COT1 as SPCN_NEED_COT1  /* 검체용기필요개수1*/
				   ,  a.SPCM_CD2 as SPCM_CD2  /* 검체코드2*/
				   ,  a.SPCM_NEED_QTY2 as SPCM_NEED_QTY2  /* 검체필요량2*/
				   ,  a.SPCN_CD2 as SPCN_CD2  /* 검체용기코드2*/
				   ,  a.SPCN_NEED_COT2 as SPCN_NEED_COT2  /* 검체용기필요개수2*/
				   ,  a.SPCM_NO1 as SPCM_NO1  /* 검체번호1*/
				   ,  a.SPCM_NO2 as SPCM_NO2  /* 검체번호2*/
				   ,  a.EXOR_PRSS_CD as EXOR_PRSS_CD  /* 검사처방진행상태코드*/
				   ,  a.ISTP_ADMN_VLM as ISTP_ADMN_VLM  /* 동위원소투여용량*/
				   ,  a.MDCR_BEEX_YN as MDCR_BEEX_YN  /* 진료이전검사여부*/
				   ,  a.ANAD_YN as ANAD_YN  /* 항생제투여여부*/
				   ,  a.ANGG_INRV_DVSN_CD as ANGG_INRV_DVSN_CD  /* ANGIO중재구분코드*/
				   ,  a.PRTB_YN as PRTB_YN                                            /* 포터블여부*/
				   ,  a.ACMP_YN as ACMP_YN                                            /* 동반여부*/
				   ,  a.BLCL_EXMN_YN as BLCL_EXMN_YN                                       /* 채혈검사여부*/
				   ,  a.IODI_MDTE_TSR_YN as IODI_MDTE_TSR_YN                                   /* 요오드치료TSR여부*/
				   ,  a.DX_PTHL_ADOR_YN as DX_PTHL_ADOR_YN                                    /* 진단병리추가처방여부*/
				   ,  a.BRCD_PRIN_YN as BRCD_PRIN_YN                                       /* 바코드출력여부*/
				   ,  a.BRCD_PNPR_ID as BRCD_PNPR_ID                                       /* 바코드출력자ID*/
				   ,  to_char ( a.BLCL_BRCD_PRIN_DT, 'YYYYMMDDhh24miss') as BLCL_BRCD_PRIN_DT  /* 채혈바코드출력일시*/
				   ,  to_char ( a.APNT_DT, 'YYYYMMDDhh24miss') as APNT_DT            /* 예약일시*/
				   ,  to_char ( a.ORDR_APNT_DT, 'YYYYMMDDhh24miss') as ORDR_APNT_DT       /* 처방예약일시*/
				   ,  to_char ( a.EXRM_RPTN_DT, 'YYYYMMDDhh24miss') as EXRM_RPTN_DT       /* 검사실접수일시*/
				   ,  to_char ( a.ENFR_DT, 'YYYYMMDDhh24miss') as ENFR_DT            /* 시행일시*/
				   ,  to_char ( a.INTR_DT, 'YYYYMMDDhh24miss') as INTR_DT            /* 판독일시*/
				   ,  to_char ( a.RPRT_DT, 'YYYYMMDDhh24miss') as RPRT_DT            /* 보고일시*/
				   ,  a.ACIM_NURS_ID as ACIM_NURS_ID                                       /* 액팅실시간호사ID*/
				   ,  to_char ( a.ACTN_DT, 'YYYYMMDDhh24miss') as ACTN_DT            /* 액팅일시*/
				   ,  to_char ( a.ACIM_INPT_DT, 'YYYYMMDDhh24miss') as ACIM_INPT_DT       /* 액팅실시입력일시*/
				   ,  to_char ( a.ACIM_UPDT_DT, 'YYYYMMDDhh24miss') as ACIM_UPDT_DT       /* 액팅실시수정일시*/
				   ,  a.ACIM_SPAB_CTN as ACIM_SPAB_CTN                                      /* 액팅실시특기내용*/
				   ,  a.ACIM_CNFR_CD as ACIM_CNFR_CD                                       /* 액팅실시확인코드*/
				   ,  a.ACTN_LAST_CNFM_ID as ACTN_LAST_CNFM_ID                                  /* 액팅최종확인자ID*/
				   ,  to_char ( a.ACTN_LAST_CNFR_DT, 'YYYYMMDDhh24miss') as ACTN_LAST_CNFR_DT  /* 액팅최종확인일시*/
				   ,  a.DSCH_ORDR_CASB_CTN as DSCH_ORDR_CASB_CTN                                 /* 퇴원처방주의사항내용*/
				   ,  to_char ( a.DSCH_ORDR_EXMN_DT, 'YYYYMMDDhh24miss') as DSCH_ORDR_EXMN_DT  /* 퇴원처방검사일시*/
				   ,  a.PACS_ACCS_NO as PACS_ACCS_NO                                       /* PACS접근번호*/
				   ,  a.PACS_TRDV_CD as PACS_TRDV_CD                                       /* PACS송신구분코드*/
				   ,  a.DADV_CD as DADV_CD                                            /* 주야구분코드*/
				   ,  a.HLSC_EXMN_YN as HLSC_EXMN_YN                                       /* 건강검진검사여부*/
				   ,  a.ENDS_PACS_TRDV_CD as ENDS_PACS_TRDV_CD                                  /* 내시경PACS송신구분코드*/
				   ,  a.PRVN_INJC_ORNO as PRVN_INJC_ORNO                                     /* 예방주사차수*/
				   ,  to_char ( a.MDFE_APLY_YMD, 'YYYYMMDD') as MDFE_APLY_YMD              /* 수가적용일자*/
				   ,  a.MDCT_PACS_TRDV_CD as MDCT_PACS_TRDV_CD                                  /* MDCT_PACS송신구분코드*/
				   ,  a.MRI_IPDV_UPDT_CD as MRI_IPDV_UPDT_CD                                   /* MRI급여구분수정코드*/
				   ,  a.HLSC_APNT_NO as HLSC_APNT_NO                                       /* 건강검진예약번호*/
				   ,  a.RISK_FCTR_VL as RISK_FCTR_VL                                       /* 위험인자값*/
				   ,  a.DYTM_WARD_USE_WNTD_YN as DYTM_WARD_USE_WNTD_YN                              /* 낮병동사용희망여부*/
				   ,  a.ENDS_CHFR_AMDR_ID as ENDS_CHFR_AMDR_ID                                  /* 내시경무료예약의사ID*/
				   ,  to_char ( a.ORDR_VALD_PERD_EXPT_YMD, 'YYYYMMDD' ) as ORDR_VALD_PERD_EXPT_YMD    /* 처방유효기간만료일자*/
				   /* ,  a.ENFR_PLAC_NM                                     /* 시행장소명 => ENFR_PLAC_NM 을 삭제하고 FRNS_DPRT_CD ( 불출부서로 사용 ) */
				   ,  a.DSPC_NURS_ADJS_BNDL_NO as DSPC_NURS_ADJS_BNDL_NO                             /* 퇴원계획지간호사조정묶음번호*/
				   ,  a.DSPC_NURS_ADJS_NO as DSPC_NURS_ADJS_NO                                  /* 퇴원계획지간호사조정번호*/
				   ,  a.DSPC_NURS_ADJS_BNDL_NM as DSPC_NURS_ADJS_BNDL_NM                             /* 퇴원계획지간호사조정묶음명*/
				   ,  a.DSPC_NURS_ADJS_PTGO_CTN as DSPC_NURS_ADJS_PTGO_CTN                            /* 퇴원계획지간호사조정가야할장소코드*/
				   ,  a.EXRS_NTFC_MTHD_DVSN_CD as EXRS_NTFC_MTHD_DVSN_CD                             /* 검사결과통보방법구분코드*/
				   ,  a.IMLN_ORDR_YN as IMLN_ORDR_YN                                       /* 임플란트처방여부*/
				   ,  a.SSPC_SCIN_NM as SSPC_SCIN_NM                                       /* 의심상병명*/
				   ,  a.ORDR_CRTN_DVSN_CD as ORDR_CRTN_DVSN_CD                                  /* 처방생성구분코드*/
				   ,  a.ORDR_CRTN_LNKN_NO as ORDR_CRTN_LNKN_NO                                  /* 처방생성연결번호*/
		           ,  a.SPOR_BNDL_NM                                     /* 스페셜처방묶음명 */
		           ,  a.SPOR_BNDL_NO                                     /* 스페셜처방묶음번호*/
		           ,  a.SLPN_YN											   /* 수면여부 */
				   ,  a.FRST_RGSR_ID as FRST_RGSR_ID                                       /* 최초등록자ID*/
				   ,  a.FRST_RGST_IP as FRST_RGST_IP                                       /* 최초등록IP*/
				   ,  to_char ( a.FRST_RGST_DT, 'YYYYMMDDhh24miss') as FRST_RGST_DT       /* 최초등록일시*/
				   ,  a.LAST_UPDR_ID as LAST_UPDR_ID                                       /* 최종수정자ID*/
				   ,  a.LAST_UPDT_IP as LAST_UPDT_IP                                       /* 최종수정IP*/
				   ,  to_char ( a.LAST_UPDT_DT, 'YYYYMMDDhh24miss') as LAST_UPDT_DT       /* 최종수정일시*/
		           ,  a.HMTP_BSCL_RCPN_RLTN_CD as HMTP_BSCL_RCPN_RLTN_CD  /* 조혈모세포수혜자관계코드 */
				   ,  b.ORDR_NM as ORDR_NM
				   ,  b.ORDR_PSBL_DVSN_CD as ORDR_PSBL_DVSN_CD
				   ,  b.SET_EXMN_YN as SET_EXMN_YN
				   ,  decode(c.DX_OBJC_ULTS_YN||c.INSR_IPDV_CD||c.INSR_BTTY_CD,'Y1S','Y','N') as DX_OBJC_ULTS_YN /*  진단초음파여부 */
		           ,  c.ULTS_CLSF_CD /* 초음파 분류 코드*/
				   ,  c.INSR_IPDV_CD as INSR_IPDV_CD                                       /* 보험급여구분(AI041)*/
				   ,  c.PRTC_IPDV_CD as PRTC_IPDV_CD                                       /* 보호급여구분(AI041)*/
				   ,  c.INCS_IPDV_CD as INCS_IPDV_CD                                       /* 산재급여구분(AI041)*/
				   ,  c.TAIN_IPDV_CD       as TAIN_IPDV_CD                                /* 자보급여구분(AI041)*/
				   /*  검체검사 기초데이터 추가 start */
				   ,  sf.SCEX_ADTN_ORDV_CD as SCEX_ADTN_ORDV_CD_1              /* 검체검사추가처방구분코드 */
				   ,  b.PCTS_EXMN_PSBL_YN as PCTS_EXMN_PSBL_YN                                  /* POCT검사가능여부 */
				   ,  b.TDM_CD_DVSN_CD as TDM_CD_DVSN_CD                                     /* TDM코드구분코드 */
				   ,  b.PHRK_EXMN_CD as PHRK_EXMN_CD                                       /* 약물동력학검사코드 */
				   ,  b.ER_EXMN_PSBL_YN as ER_EXMN_PSBL_YN                                    /* 응급검사가능여부 */
				   ,  b.APNT_NEED_EN as APNT_NEED_EN                                       /* 예약필요유무 */
				   ,  b.WARD_APNT_PSBL_YN as WARD_APNT_PSBL_YN                                  /* 병동예약가능여부 */
				   ,  sf.OTPT_CARE_BLCL_YN    as OTPT_CARE_BLCL_YN                              /* 외래간호채혈여부 */
				   /*  검체검사 기초데이터 추가 end */
				   /*  환자검사 기초데이터 추가 start */
				   ,  b.MVMN_DVSN_CD as MVMN_DVSN_CD                                       /* 이동구분코드 */
				   ,  b.DONE_PSBL_YN as DONE_PSBL_YN
				   ,  b.CNMD_PRVN_ANTB_TRGT_YN as CNMD_PRVN_ANTB_TRGT_YN                             /* 조영제예방항생제대상여부 */
				   ,  b.WARD_EXRM_CD       as WARD_EXRM_CD                                /* 병동검사실코드 */
				   /*  환자검사 기초데이터 추가 end */
				   ,  c.MDFE_ITDV_CD as MDFE_ITDV_CD                                       /*  수가입력구분(AI046):처치,재료필수입력구분 */
				   ,  b.MDCR_BEEX_YN as AFI_MDCR_BEEX_PSBL_YN                 /*  진료이전검사가능여부 */
		           ,  case when a.SCEX_ADTN_ORDV_CD is not null then (
																	  select  t1.ORDR_NM
																		from  MDEXMORDT t
																		   ,  MDORDRCMT t1
																	   where  1 = 1
																		 and  t.PTNO     = a.PTNO
																		 and  t.ORDR_YMD = a.ORGL_ORDR_YMD
																		 and  t.ORDR_SNO = a.ORGL_ORDR_SNO
																		 and  t1.ORDR_CD = t.ORDR_CD
																	 )
																 else ''end as AFI_ORGL_ORDR_NM       /*  원처방명 */
		           ,  case when a.SCEX_ADTN_ORDV_CD is not null then (
																	  select  to_char ( t.EXRM_RPTN_DT, 'YYYYMMDDhh24miss' )
																		from  MDEXMORDT t
																	   where  1 = 1
																		 and  t.PTNO     = a.PTNO
																		 and  t.ORDR_YMD = a.ORGL_ORDR_YMD
																		 and  t.ORDR_SNO = a.ORGL_ORDR_SNO
																	 )
																else '' end  as AFI_ORGL_ORDR_EXRM_RPTN_DT     /*  원처방검사실접수일시 */
		           ,  case when substr ( a.ORDR_CLTY_CD, 0, 1 ) = 'C' and a.EXCF_CD <> 'SP'
						then ( select  listagg(SPCM_CD, ',') within group(order by rownum)
								 from  SFCORDSPT
								where  EXMN_CD = a.ORDR_CD )
						 end as AFI_EXMN_PSBL_SPCM_CD_CTN              /*  처방가능검체코드내용 (EXCF_CD <> 'SP') 병리는 제외 */
		           ,  a.HMTP_BSCL_RCPN_RLTN_CD as HMTP_BSCL_RCPN_RLTN_CD  /* 조혈모세포수혜자관계코드*/
		           ,  c.INSR_EDI_CD as INSR_EDI_CD  /* 보험 EDI CD */
		           ,  b.CIS_INRF_YN as CIS_INRF_YN  /* CIS 인터페이스 여부 */
		           ,  b.DTLS_EXCF_CD as DTLS_EXCF_CD  /* 세부검사분류코드 */
		           ,  b.CHLD_DVSN_CD as CHLD_DVSN_CD  /* 소아검사구분코드 */
		           ,  b.CNMD_PRVN_ANTB_TRGT_YN as CNMD_PRVN_ANTB_TRGT_YN  /* 조영제예방항생제대상여부 */
				   ,  sw.TISS_EXMN_YN as TISS_EXMN_YN  /* 조직검사여부 */
		           ,  a.ULTS_SITE_CD as ULTS_SITE_CD  /* 초음파치료부위 */
		           ,  b.ER_EXMN_PSBL_YN
		           ,  b.SLPN_PSBL_YN		/* 수면가능여부 */
		           ,  c.ER_MCTE_ADDV_CD as ER_MCTE_ADDV_CD	/* 응급의료가산구분코드 */
		           ,  FN_AC_CECK_ER_MCTE_ADDV_YN(a.ORDR_CD, a.ORDR_YMD, a.CODV_CD) as ER_MCTE_ADIT_YN
		           ,  c.OPRT_MDFE_CD_YN as OPRT_MDFE_CD_YN
		           ,  a.TDM_CECK_CTN /* TDM체크내용 */
		           ,  sf.DX_EXMN_TDM_YN
		           ,  sf.DGMT_TDM_YN
		           ,  sf.DX_EXMN_CMTX_CD
		           ,  sf.DGMT_CMTX_CD
		           ,  b.INSR_ACKN_BASE_CECK_YN as INSR_ACKN_BASE_CECK_YN /* 보험인정기준체크여부 */
		           ,  a.SUB_TYPE_CD as SUB_TYPE_CD
		           ,  a.SCRG_INPY_ONBR_RT as SCRG_INPY_ONBR_RT
		           ,  a.INSR_OPNN_CTN     as INSR_OPNN_CTN               /* 보험소견내용 */
		           ,  b.PRN_PSBL_YN
		           ,  a.CNSN_RLTD_YN
		           ,  a.CNSN_RLTD_MCDP_CD
		           ,  FN_MD_GET_CNMD_DETL_CTN(a.ORDR_CD) as CNMD_DETL_CTN
		           ,  b.PTEX_LVEL_DVSN_CD   as PTEX_LVEL_DVSN_CD   /* 병리검사레벨구분코드 */
		           ,  b.RMRK_YN /* 임상소견필수여부 */
		           ,  b.PACS_INRF_YN
		           ,  c.NGHT_ADIT_RT      as NGHT_ADIT_RT      /* 야간가산율  */
		           ,  b.AGDC_NEED_EN      as AGDC_NEED_EN      /*동의서필요여부 */
		     from  MDEXMORDT a
				,  MDORDRCMT b
				,  AIMFMDFET c
				,  SFCORDRCT sf
		        ,  SWORDRCMT sw
				,  CCUSRDPHT u1
		        ,  CCUSRDPHT u2
		        ,  APRCRPTNT rcr
			where  a.PTNO = #{ptno}
			  and  a.ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
			  and  a.CODV_CD  = #{codvCd}
			]]>
		  <if test='orocDprtCd != null and orocDprtCd != ""'>
		      and  a.OROC_DPRT_CD = #{orocDprtCd}
		  </if>
		  <if test='odkiCd != null and odkiCd != ""'>
		      and  a.ODKI_CD = #{odkiCd}
		  </if>
		  <if test='codvCd == "O"'>
		      and rcr.CNCL_DT is null
		  </if>  		         
		  <if test='codvCd == "O" and chdrId != null and chdrId != ""'>
		      and a.CHDR_ID = #{chdrId}
		  </if>
		  <choose>
		    <when test='dcDvsnCd=="T"'>
		      and  a.DC_DVSN_CD = #{dcDvsnCd}
		    </when>
		    <otherwise>
		      and  a.DC_DVSN_CD not in ( 'X' , 'F' , 'E', 'T' ) /*  취소, 실처방 전환, 임시처방 취소, 외래당일입원가처방은 조회 제외 */
		      /*  DC_DVSN_CD 가 'N' 이거나 NULL 인 경우 전체조회 */
		      /*  DC_DVSN_CD 임시처방인 경우는 DC_DVSN_CD 'Y' 것도 같이 조회 */
		      and  'TRUE' = case when #{dcDvsnCd} = 'N' or #{dcDvsnCd} is null then 'TRUE'
		                         else case when a.DC_DVSN_CD = #{dcDvsnCd} then 'TRUE'
		                                   when a.DC_DVSN_CD = 'Y' then 'TRUE'
		                              end
		                    end  
		    </otherwise>
		  </choose>
		<![CDATA[
			  /*  Client logic 이동 외래일때 같은 진료과만 처리 */
			  and  'TRUE' = case when a.CODV_CD = 'O'
								 then case when a.MCDP_CD like #{mcdpCd} ||'%' /* 단독 처방 조회 기능이 있어서 like 로 처리*/
										   then 'TRUE'
										   else 'FALSE' end
									  else 'TRUE'
									  end
			  and  'TRUE' = case when a.CODV_CD <> 'O'
									  then case when a.MDRP_NO = #{mdrpNo}
													 then 'TRUE'
													 else 'FALSE'
													 end
								 else 'TRUE'
								 end
			  /*  단독 처방 조회 */
			  and   'TRUE' = case when #{ordrSno} > 0
									   then case when a.ORDR_SNO = #{ordrSno}
												 then 'TRUE'
												 else 'FALSE'
												 end
								  else 'TRUE'
								  end
			  and  a.ORDR_CD = b.ORDR_CD(+)
			  and  a.ORDR_CD = c.MDFE_CD(+)
			  and  to_date ( #{ordrYmd} , 'YYYYMMDD' ) between c.APST_YMD (+) and c.APFN_YMD (+)
		      and  a.ORDR_CRTN_DVSN_CD not in ('71') /* 진단검사2차처방 제외 */
			  /* and  nvl ( ORDR_CRTN_DVSN_CD, '00' ) not in ('08','10')    /* PRN실시처방, 응급실1차실시처방 제외*/
			  and  a.ORDR_CD = sf.ORDR_CD(+)
			  and  a.ORDR_CD = sw.ORDR_CD(+)
			  and  a.EXMN_WNTD_DR_ID = u1.USER_ID(+)
		      and  a.ENDR_ID         = u2.USER_ID(+)
		      and  a.MDRP_NO = rcr.MDRP_NO
			  and  to_date ( #{ordrYmd} , 'YYYYMMDD' ) between u1.APST_YMD(+) and u1.APFN_YMD (+)
		      and  a.ORDR_CD not in (select exmn_dtls_ctrl_nm 
		                               from szctrlmmt
		                              where exmn_ctrl_cd = 'SFW_012' 
		                                and exmn_dtls_ctrl_cd = '1')  /* 종합검증검사코드 제외 */ 
			order
			   by     decode(a.ODKI_DETL_CD, 'Z', a.SPOR_BNDL_NO, 0)
		           ,  a.FRST_RGST_DT
				   ,  a.SORT_SQNC
		           ,  a.ORDR_SNO
			]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntLtstExmnBefOrdrList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="saveDvsnCd" column="SAVE_DVSN_CD"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="adtnOrdvCd" column="ADTN_ORDV_CD"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="ordrUnslCtn" column="ORDR_UNSL_CTN"/>
		<result property="careSttsCd" column="CARE_STTS_CD"/>
		<result property="rgorFinsDt" column="RGOR_FINS_DT"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="ptadIpdvCd" column="PTAD_IPDV_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="lastUpdtDt" column="LAST_UPDT_DT"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="exorPrssCd" column="EXOR_PRSS_CD"/>
		<result property="implOrdrPblcNtm" column="IMPL_ORDR_PBLC_NTM"/>
		<result property="dadvCd" column="DADV_CD"/>
		<result property="wntdDt" column="WNTD_DT"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="excfCd" column="EXCF_CD"/>
		<result property="exmnWntdDrId" column="EXMN_WNTD_DR_ID"/>
		<result property="exmnWntdDrNm" column="EXMN_WNTD_DR_NM"/>
		<result property="spcmCd1" column="SPCM_CD_1"/>
		<result property="spcmCd2" column="SPCM_CD_2"/>
		<result property="istpAdmnVlm" column="ISTP_ADMN_VLM"/>
		<result property="mdcrBeexYn" column="MDCR_BEEX_YN"/>
		<result property="anadYn" column="ANAD_YN"/>
		<result property="anggInrvDvsnCd" column="ANGG_INRV_DVSN_CD"/>
		<result property="prtbYn" column="PRTB_YN"/>
		<result property="acmpYn" column="ACMP_YN"/>
		<result property="blclExmnYn" column="BLCL_EXMN_YN"/>
		<result property="dxPthlAdorYn" column="DX_PTHL_ADOR_YN"/>
		<result property="apntDt" column="APNT_DT"/>
		<result property="pacsAccsNo" column="PACS_ACCS_NO"/>
		<result property="pacsTrdvCd" column="PACS_TRDV_CD"/>
		<result property="rprtDt" column="RPRT_DT"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="setExmnYn" column="SET_EXMN_YN"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="clrsPrjcDrId" column="CLRS_PRJC_DR_ID"/>
		<result property="riskFctrVl" column="RISK_FCTR_VL"/>
		<result property="implOrdrPblcLmttNtm" column="IMPL_ORDR_PBLC_LMTT_NTM"/>
		<result property="vatTrgtYn" column="VAT_TRGT_YN"/>
		<result property="tdmCdDvsnCd" column="TDM_CD_DVSN_CD"/>
		<result property="phrkExmnCd" column="PHRK_EXMN_CD"/>
		<result property="cnntOrdrBndlNo" column="CNNT_ORDR_BNDL_NO"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="scexAdtnOrdvCd" column="SCEX_ADTN_ORDV_CD"/>
		<result property="imlnOrdrYn" column="IMLN_ORDR_YN"/>
		<result property="ordrCltyCd1" column="ORDR_CLTY_CD_1"/>
		<result property="hmtpBsclRcpnRltnCd" column="HMTP_BSCL_RCPN_RLTN_CD"/>
		<result property="ultsSiteCd" column="ULTS_SITE_CD"/>
		<result property="slpnYn" column="SLPN_YN"/>
		<result property="subTypeCd" column="SUB_TYPE_CD"/>
		<result property="scrgInpyOnbrRt" column="SCRG_INPY_ONBR_RT"/>
		<result property="insrOpnnCtn" column="INSR_OPNN_CTN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntLtstExmnBefOrdrList (최근 검사 전처방 목록 조회) 
        Description :                                           최근 검사 전처방 목록을 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntLtstExmnBefOrdrList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntLtstExmnBefOrdrList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntLtstExmnBefOrdrList-result" useCache="true" flushCache="false">
			<![CDATA[
			   select  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntLtstExmnBefOrdrList */
		              'I' as SAVE_DVSN_CD
					,  to_char(a.ORDR_YMD, 'YYYYMMDD') as ORDR_YMD                /* (공통) 처방일자                           */
					,  a.ORDR_SNO as ORDR_SNO                                     /* (공통) 처방순번                           */
					,  a.CODV_CD as CODV_CD                                       /* (공통) 환자구분                           */
					,  a.OROC_DPRT_CD as OROC_DPRT_CD                             /* (공통) 처방발생원                         */
					,  a.MCDP_CD as MCDP_CD                                       /* (공통) 진료과                             */
					,  a.ORCL_CD as ORCL_CD                                       /* (공통) 처방분류                           */
					,  a.ODKI_CD as ODKI_CD                                       /* (공통) 처방종류                           */
					,  a.ORDR_CLTY_CD as ORDR_CLTY_CD                             /* (공통) 처방구별                           */
					,  a.ORFR_CD as ORFR_CD                                       /* (공통) 처방형태                           */
					,  a.ORDR_CD as ORDR_CD                                       /* (공통) 처방코드                           */
					,  a.SLIP_CD as SLIP_CD                                       /* (공통) SLIP코드                           */
					,  a.ODDR_ID as ODDR_ID                                       /* (공통) 처방의사                           */
					,  a.ADTN_ORDV_CD as ADTN_ORDV_CD                             /* (공통) 추가처방여부                       */
					,  a.ORDR_CRTN_DVSN_CD as ORDR_CRTN_DVSN_CD                   /* (공통) CP적용여부                         */
					,  a.SORT_SQNC as SORT_SQNC                                   /* (공통) 나열순서                           */
					,  a.EXOR_UNSL_CTN as ORDR_UNSL_CTN                           /* (공통) 특기사항                           */
					,  a.CARE_STTS_CD as CARE_STTS_CD                             /* (공통) 간호STATUS                         */
					,  a.RGOR_FINS_DT as RGOR_FINS_DT                             /* (공통) 정규처방완료일시                   */
					,  a.DC_DVSN_CD as DC_DVSN_CD                                 /* (공통) D/C여부                            */
					,  a.DC_ODDR_ID as DC_ODDR_ID                                 /* (공통) D/C처방의사                        */
					,  a.DC_ORDR_DT as DC_ORDR_DT                                 /* (공통) D/C처방일시                        */
					,  a.ORDR_IPDV_CD as ORDR_IPDV_CD                             /* (공통) 급여구분(처방)                     */
					,  a.PTAD_IPDV_CD as PTAD_IPDV_CD                             /* (공통) 급여구분(심사)                     */
					,  a.RCST_CD as RCST_CD                                       /* (공통) 수납구분                           */
					,  a.INPT_USER_DVSN_CD as INPT_USER_DVSN_CD                   /* (공통) 입력USER구분(1.의사 2.간호사)      */
					,  '' as PTPT_CD
					,  to_char(a.LAST_UPDT_DT, 'yyyymmddhh24mi') as LAST_UPDT_DT  /* (공통) 수정일시                 */
					,  b.ORDR_NM as ORDR_NM
					,  a.EXOR_PRSS_CD as EXOR_PRSS_CD                             /* (약/검사/수혈/재활) 진행STATUS(진료지원)  */
					,  a.IMPL_ORDR_PBLC_NTM as IMPL_ORDR_PBLC_NTM                 /* (약/검사) PRN실시횟수                     */
					,  a.DADV_CD as DADV_CD                                       /* (검사/처치/수술/마취) 주야구분            */
					,  to_char(a.WNTD_DT, 'yyyymmddhh24mi') as WNTD_DT            /* (검사/수혈/협진) 희망일시                 */
					,  a.FRNS_DPRT_CD as FRNS_DPRT_CD                             /* (약) 가야할 곳(약국) a.PHRM_PTGO_CD -> 불출장소 코드로 변경  */
					,  a.EXCF_CD as EXCF_CD                                       /* (검사) 검사분류                           */
					,  a.EXMN_WNTD_DR_ID as EXMN_WNTD_DR_ID                       /* (검사) 검사희망의사                       */
					,  (select USER_NM from CCUSRDPHT where USER_ID = a.EXMN_WNTD_DR_ID) as EXMN_WNTD_DR_NM /* (검사) 검사희망의사명 */
					,  a.SPCM_CD1 as SPCM_CD_1
					,  a.SPCM_CD2 as SPCM_CD_2                                    /* (검사) 검체코드2                          */
					,  a.ISTP_ADMN_VLM as ISTP_ADMN_VLM                           /* (검사) 동위원소투여량                     */
					,  a.MDCR_BEEX_YN as MDCR_BEEX_YN                             /* (검사) 진료전검사여부                     */
					,  a.ANAD_YN as ANAD_YN                                       /* (검사) 항생제투여여부                     */
					,  a.ANGG_INRV_DVSN_CD as ANGG_INRV_DVSN_CD                   /* (검사) ANGIO/INTV구분                     */
					,  a.PRTB_YN as PRTB_YN                                       /* (검사) PORTABLE 여부                      */
					,  a.ACMP_YN as ACMP_YN                                       /* (검사) 동반여부                           */
					,  a.BLCL_EXMN_YN as BLCL_EXMN_YN                             /* (검사) 채혈검사여부                       */
					,  a.DX_PTHL_ADOR_YN as DX_PTHL_ADOR_YN                       /* (검사) 진단병리추가처방여부               */
					,  to_char(a.APNT_DT, 'yyyymmddhh24mi') as APNT_DT            /* (검사) 예약일시(진행)=> 병동 영상의학검사 */
					,  a.PACS_ACCS_NO as PACS_ACCS_NO                             /* (검사) PACS ACCESSION NUMBER              */
					,  a.PACS_TRDV_CD as PACS_TRDV_CD                             /* (검사) PACS 전송여부                      */
					,  to_char(a.RPRT_DT, 'yyyymmddhh24miss') as RPRT_DT          /*  (검사) 보고일시                          */
					,  case when (a.ORDR_CD like 'DT%') or (a.ORDR_CD like 'Q%') then (select ORDR_PSBL_YN
																						   from  SUDIECDCT
																						  where  DIET_CD = a.ORDR_CD
																							and  rownum = 1)
																				 else b.ORDR_PSBL_DVSN_CD end as ORDR_PSBL_DVSN_CD    /* (처방마스터) 처방가능여부                 */
					,  b.SET_EXMN_YN as SET_EXMN_YN                                  /* (처방마스터) SET검사여부                  */
					,  a.CLRS_PRJC_CD as CLRS_PRJC_CD                             /* (공통) <임상연구비> Project코드 */
					,  decode(a.CLRS_PRJC_DR_ID, null, null, a.CLRS_PRJC_DR_ID||'['||(select USER_NM from CCUSRDPHT where USER_ID = a.CLRS_PRJC_DR_ID)||']') as CLRS_PRJC_DR_ID
					,  a.RISK_FCTR_VL as RISK_FCTR_VL                             /* (검사) 위험인자 */
					,  a.IMPL_ORDR_PBLC_LMTT_NTM as IMPL_ORDR_PBLC_LMTT_NTM       /*  Prn 제한횟수 */
					,  a.VAT_TRGT_YN as VAT_TRGT_YN                               /*  VAT여부 */
					,  b.TDM_CD_DVSN_CD as TDM_CD_DVSN_CD                         /*  TDM코드구분코드 */
					,  b.PHRK_EXMN_CD as PHRK_EXMN_CD                             /*  약물동력학검사코드 */
					,  a.CNNT_ORDR_BNDL_NO as CNNT_ORDR_BNDL_NO                   /*  (공통) 동시처방묶음번호 */
					,  a.TMPR_ORDR_YN as TMPR_ORDR_YN                             /* (공통) 임시처방여부 */
					,  a.MDRP_NO as MDRP_NO                                       /* (공통) 진료접수 */
					,  a.SCEX_ADTN_ORDV_CD as SCEX_ADTN_ORDV_CD                   /* (약/검사) 검체검사추가처방구분코드 */
					,  a.IMLN_ORDR_YN as IMLN_ORDR_YN                             /* (공통) 임플란트처방여부 */
					,  b.ORDR_CLTY_CD as ORDR_CLTY_CD_1                                        /*  (마스터)처방분류유형코드1 */
		            ,  a.HMTP_BSCL_RCPN_RLTN_CD
		            ,  a.ULTS_SITE_CD
		            ,  a.SLPN_YN																	/* 수면여부 */
		            ,  a.SUB_TYPE_CD
		            ,  a.SCRG_INPY_ONBR_RT
		            ,  a.INSR_OPNN_CTN                                             /* 보험소견내용 */
				 from
					   CCUSRDPHT c  /*  OCS사용자 */
					,  MDORDRCMT b
					,  MDEXMORDT a
					,  APRCRPTNT p /*  진료접수 */
				where  a.PTNO        = #{ptno}
				  and  a.ORDR_YMD    = to_date(#{ordrYmd}, 'yyyymmdd')
		]]>
			 	 <if test='orocDprtCd != null and orocDprtCd != ""'>
		          and  a.OROC_DPRT_CD = #{orocDprtCd}
			  	 </if>
		         <if test='mcdpCd != null and mcdpCd != ""'>
		          and  a.MCDP_CD = #{mcdpCd}
		         </if>
		         <if test='chdrId != null and chdrId != ""'>
		          and  a.CHDR_ID = #{chdrId}
		         </if>
		<![CDATA[
				  and  a.CODV_CD like #{codvCd}||'%'
				  and  a.ODKI_CD like #{odkiCd}||'%'                                  /*  퇴원처방 구분하기 위해 추가 */
				  and  ((a.ORCL_CD is null)
						 or ((a.ORCL_CD is not null) and (a.ORCL_CD <> 'NTR')))       /*  간호처치 교육처방 제외(처방코드마스터에 없는것) */
				  and  a.DC_DVSN_CD = 'N'
				  and  nvl( a.ORDR_CRTN_DVSN_CD, 'X' ) not in ( '08' , '10' , '11' )  /*  PRN실시처방 , 응급실1차실시처방 , 1회추가실시처방  */
				  and  b.ORDR_CD(+) = a.ORDR_CD
				  and  c.USER_ID(+)  = a.ODDR_ID
				  and  p.MDRP_NO = a.MDRP_NO
		          and  a.ORDR_CD not in (select exmn_dtls_ctrl_nm 
		                                   from szctrlmmt
		                                  where exmn_ctrl_cd = 'SFW_012' 
		                                    and exmn_dtls_ctrl_cd = '1')  /* 종합검증검사코드 제외 */ 
		        order by
							   a.FRST_RGST_DT
							,  a.SORT_SQNC
		                    ,  a.ORDR_SNO
				]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntApntNnimExmnOrdrList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="afiOrdrCltyNm" column="AFI_ORDR_CLTY_NM"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="mdcrDprtCd" column="MDCR_DPRT_CD"/>
		<result property="abrvDprtCd" column="ABRV_DPRT_CD"/>
		<result property="adtnOrdvCd" column="ADTN_ORDV_CD"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="ordrUnslCtn" column="ORDR_UNSL_CTN"/>
		<result property="careSttsCd" column="CARE_STTS_CD"/>
		<result property="rgorFinsDt" column="RGOR_FINS_DT"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="ptadIpdvCd" column="PTAD_IPDV_CD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="lastUpdtDt" column="LAST_UPDT_DT"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="implOrdrPblcNtm" column="IMPL_ORDR_PBLC_NTM"/>
		<result property="dadvCd" column="DADV_CD"/>
		<result property="wntdDt" column="WNTD_DT"/>
		<result property="excfCd" column="EXCF_CD"/>
		<result property="exmnWntdDrId" column="EXMN_WNTD_DR_ID"/>
		<result property="afiExmnWntdDrNm" column="AFI_EXMN_WNTD_DR_NM"/>
		<result property="spcmCd1" column="SPCM_CD_1"/>
		<result property="spcmCd2" column="SPCM_CD_2"/>
		<result property="istpAdmnVlm" column="ISTP_ADMN_VLM"/>
		<result property="mdcrBeexYn" column="MDCR_BEEX_YN"/>
		<result property="anadYn" column="ANAD_YN"/>
		<result property="spcmCd1" column="SPCM_CD_1"/>
		<result property="prtbYn" column="PRTB_YN"/>
		<result property="acmpYn" column="ACMP_YN"/>
		<result property="blclExmnYn" column="BLCL_EXMN_YN"/>
		<result property="dxPthlAdorYn" column="DX_PTHL_ADOR_YN"/>
		<result property="apntDt" column="APNT_DT"/>
		<result property="pacsAccsNo" column="PACS_ACCS_NO"/>
		<result property="pacsTrdvCd" column="PACS_TRDV_CD"/>
		<result property="rprtDt" column="RPRT_DT"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="setExmnYn" column="SET_EXMN_YN"/>
		<result property="riskFctrVl" column="RISK_FCTR_VL"/>
		<result property="implOrdrPblcLmttNtm" column="IMPL_ORDR_PBLC_LMTT_NTM"/>
		<result property="vatTrgtYn" column="VAT_TRGT_YN"/>
		<result property="saveDvsnCd" column="SAVE_DVSN_CD"/>
		<result property="phrkExmnCd" column="PHRK_EXMN_CD"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="slpnYn" column="SLPN_YN"/>
		<result property="subTypeCd" column="SUB_TYPE_CD"/>
		<result property="scrgInpyOnbrRt" column="SCRG_INPY_ONBR_RT"/>
		<result property="userNm" column="USER_NM"/>
		<result property="afiPrssNm" column="AFI_PRSS_NM"/>
		<result property="ordrCltyCd1" column="ORDR_CLTY_CD_1"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntApntNnimExmnOrdrList () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntApntNnimExmnOrdrList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntApntNnimExmnOrdrList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntApntNnimExmnOrdrList-result" useCache="true" flushCache="false">
		<![CDATA[
		SELECT  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPtntApntNnimExmnOrdrList_미실시 검사 조회 */
		        to_char(a.ORDR_YMD, 'YYYYMMDD') as ORDR_YMD     /* (공통) 처방일자                           */
		     ,  a.ORDR_SNO as ORDR_SNO     /* (공통) 처방순번                           */
		     ,  a.CODV_CD as CODV_CD                                       /* (공통) 환자구분                           */
		     ,  to_char(p.MDCR_DT, 'yyyymmddhh24mi') as MDCR_DT /* (공통) 진료/입원/수술(DSC)/응급실도착일시 */
		     ,  a.OROC_DPRT_CD as OROC_DPRT_CD                                       /* (공통) 처방발생부서코드                         */
		     ,  g.ABRV_DPRT_CD as MCDP_CD                       /*(공통) 진료과                             */
		     ,  a.ORCL_CD as ORCL_CD                                       /* (공통) 처방분류                           */
		     ,  a.ODKI_CD as ODKI_CD                                       /* (공통) 처방종류                           */
		     ,  a.ORDR_CLTY_CD as ORDR_CLTY_CD                                  /* (공통) 처방구별                           */
		     , ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'MM182' and COMN_DTLS_CD = a.ORDR_CLTY_CD and rownum = 1 ) as AFI_ORDR_CLTY_NM /* (공통) 처방구별명 */
		     ,  a.ORFR_CD as ORFR_CD                                       /* (공통) 처방형태                           */
		     ,  a.ORDR_CD as ORDR_CD                                       /* (공통) 처방코드                           */
		     ,  a.SLIP_CD as SLIP_CD                                       /* (공통) SLIP코드                           */
		     ,  a.ODDR_ID as ODDR_ID                                       /* (공통) 처방의사                           */
		     ,  f.MDCR_DPRT_CD                                              /*(공통) 처방의사진료과                     */
		     ,  h.ABRV_DPRT_CD
		     ,  a.ADTN_ORDV_CD as ADTN_ORDV_CD                                  /* (공통) 추가처방여부                       */
		     ,  a.ORDR_CRTN_DVSN_CD as ORDR_CRTN_DVSN_CD                             /* (공통) CP적용여부                         */
		     ,  a.SORT_SQNC as SORT_SQNC    /* (공통) 나열순서                           */
		     ,  a.EXOR_UNSL_CTN as ORDR_UNSL_CTN                                 /* (공통) 특기사항                           */
		     ,  a.CARE_STTS_CD as CARE_STTS_CD                                  /* (공통) 간호STATUS                     */
		     ,  a.RGOR_FINS_DT as RGOR_FINS_DT                                  /* (공통) 정규처방완료일시                   */
		     ,  a.DC_DVSN_CD as DC_DVSN_CD                                    /* (공통) D/C여부                            */
		     ,  a.DC_ODDR_ID as DC_ODDR_ID                                    /* (공통) D/C처방의사                        */
		     ,  a.DC_ORDR_DT as DC_ORDR_DT                                    /* (공통) D/C처방일시                        */
		     ,  a.ORDR_IPDV_CD as ORDR_IPDV_CD                                  /* (공통) 급여구분(처방)                     */
		     ,  a.PTAD_IPDV_CD as PTAD_IPDV_CD                                  /* (공통) 급여구분(심사)                     */
		     ,  a.RCST_CD as RCST_CD                                       /* (공통) 수납구분                           */
		     ,  a.INPT_USER_DVSN_CD as INPT_USER_DVSN_CD                             /* (공통) 입력USER구분(1.의사 2.간호사)      */
		     ,  to_char(a.LAST_UPDT_DT, 'yyyymmddhh24mi') as LAST_UPDT_DT /* (공통) 수정일시                 */
		     ,  b.ORDR_NM as ORDR_NM
		     ,  a.IMPL_ORDR_PBLC_NTM  as IMPL_ORDR_PBLC_NTM                          /* (약/검사) PRN실시횟수                     */
		     ,  a.DADV_CD as DADV_CD                                       /* (검사/처치/수술/마취) 주야구분            */
		     ,  to_char(a.WNTD_DT, 'yyyymmddhh24mi') as WNTD_DT /* (검사/수혈/협진) 희망일시                 */
		     ,  a.EXCF_CD as EXCF_CD                                       /* (검사) 검사분류                           */
		     ,  a.EXMN_WNTD_DR_ID as EXMN_WNTD_DR_ID                               /* (검사) 검사희망의사                       */
		     ,  (select USER_NM from CCUSRDPHT where USER_ID = a.EXMN_WNTD_DR_ID) as AFI_EXMN_WNTD_DR_NM /* (검사) 검사희망의사명 */
		     ,  a.SPCM_CD1 as SPCM_CD_1
		     ,  a.SPCM_CD2 as SPCM_CD_2   /* (검사) 검체코드2                          */
		     ,  a.ISTP_ADMN_VLM as ISTP_ADMN_VLM                /* (검사) 동위원소투여량                     */
		     ,  a.MDCR_BEEX_YN as MDCR_BEEX_YN                                  /* (검사) 진료전검사여부                     */
		     ,  a.ANAD_YN as ANAD_YN                                       /* (검사) 항생제투여여부                     */
		     ,  a.ANGG_INRV_DVSN_CD as SPCM_CD_1                             /* (검사) ANGIO/INTV구분                     */
		     ,  a.PRTB_YN as PRTB_YN                                       /* (검사) PORTABLE 여부                      */
		     ,  a.ACMP_YN as ACMP_YN                                       /* (검사) 동반여부                           */
		     ,  a.BLCL_EXMN_YN as BLCL_EXMN_YN                                  /* (검사) 채혈검사여부                       */
		     ,  a.DX_PTHL_ADOR_YN as DX_PTHL_ADOR_YN                               /* (검사) 진단병리추가처방여부               */
		     ,  to_char(a.APNT_DT, 'yyyymmddhh24mi') as APNT_DT /* (검사) 예약일시(진행)=> 병동 영상의학검사 */
		     ,  a.PACS_ACCS_NO as PACS_ACCS_NO                                  /* (검사) PACS ACCESSION NUMBER              */
		     ,  a.PACS_TRDV_CD as PACS_TRDV_CD                                  /* (검사) PACS 전송여부                      */
		     ,  to_char(a.RPRT_DT, 'yyyymmddhh24miss') as RPRT_DT /*  (검사) 보고일시                   */
		     ,  case when (a.ORDR_CD like 'DT%') or (a.ORDR_CD like 'Q%') then (select ORDR_PSBL_YN
		                                                                            from  SUDIECDCT
		                                                                           where  DIET_CD = a.ORDR_CD
		                                                                             and  rownum = 1)
		                                                                  else b.ORDR_PSBL_DVSN_CD end as ORDR_PSBL_DVSN_CD    /* (처방마스터) 처방가능여부                 */
		     ,  b.SET_EXMN_YN as SET_EXMN_YN                                   /* (처방마스터) SET검사여부                  */
		     ,  a.RISK_FCTR_VL as RISK_FCTR_VL                                 /* (검사) 위험인자 */
		     ,  a.IMPL_ORDR_PBLC_LMTT_NTM as IMPL_ORDR_PBLC_LMTT_NTM /*  Prn 제한횟수  2009.09.17 YKC    */
		     ,  a.VAT_TRGT_YN as VAT_TRGT_YN                                 /*  VAT여부            2011.07.03 KST        */
		     ,  'I' as SAVE_DVSN_CD  /*  저장구분 임시 */
		     ,  b.PHRK_EXMN_CD as PHRK_EXMN_CD                              /*  약물동력학검사코드 */
		     ,  a.TMPR_ORDR_YN as TMPR_ORDR_YN
		     ,  a.MDRP_NO as MDRP_NO
		     ,  a.SLPN_YN		as SLPN_YN				/* 수면여부 */
		     ,  a.SUB_TYPE_CD as SUB_TYPE_CD
		     ,  a.SCRG_INPY_ONBR_RT as SCRG_INPY_ONBR_RT
		     ,  c.USER_NM                                       /*(공통) 처방의사명                         */
		     ,  nvl((select DETL_CD_NM
		               from CCCMCDDMT
		             where COMN_GRP_CD = 'ST005'
		                and COMN_DTLS_CD = a.EXOR_PRSS_CD and rownum = 1), '검사예정') as AFI_PRSS_NM  /* AFI검사처방진행상태명 */
		     , (
		         select t.ORDR_CLTY_CD
		           from MDORDRCMT t
		         where t.ORDR_CD = a.ORDR_CD
		            and rownum < 2
		        )  as ORDR_CLTY_CD_1   /* (마스터)처방분류유형코드1 */
		  from
		            MDEXMORDT a
		         ,  MDORDRCMT b
		         ,  CCUSRDPHT c  /* OCS사용자 */
		         ,  CCUSRDPHT f  /* 사용자진료조직관계이력 */
		         ,  HZDEPTMMT g
		         ,  HZDEPTMMT h
		         ,  APRCRPTNT p -- 진료접수
		 where  1 = 1
		   and  a.PTNO     = #{ptno}
		   and  a.ORDR_YMD <= trunc(sysdate)
		   and  a.ORDR_YMD >= ( sysdate - nvl((select MDCR_CTRL_NMBR_VL1 from  MZCTRLMMT where  MDCR_CTRL_CD = 'MDP_138' and  ROWNUM = 1 ),180)) /*조회기간 MDP_138*/
		   and  a.APNT_DT  >= trunc(sysdate)
		   and  a.DC_DVSN_CD = 'N'
		   and  nvl(a.ORFR_CD, 'Z') not in ('D', 'P')         /*  Done, PRN 제외 */
		   and  a.CODV_CD <> 'G'                    /*  건진처방 제외 */
		   and  a.TMPR_ORDR_YN = 'N'                /*  임시처방 제외 */
		   and  a.EXRM_RPTN_DT is null
		   and  a.ORDR_CD = b.ORDR_CD (+)
		   and  g.DPRT_CD(+) = a.MCDP_CD
		   and  p.MDRP_NO(+)  = a.MDRP_NO
		   and  c.USER_ID(+)  = a.ODDR_ID
		   and  f.USER_ID(+)  = c.USER_ID
		   and  h.DPRT_CD(+)  = f.MDCR_DPRT_CD
		  order by g.ABRV_DPRT_CD, a.ORDR_YMD desc, a.ODDR_ID
		]]>
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnOrdr (검사 처방 Update) 
        Description :                                           처방 내림한 검사 처방을 수정한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnOrdr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  >
		update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnOrdr */
		        MDEXMORDT a
		   set  MCDP_CD = #{mcdpCd}                                                  /*  진료과코드 */
		     ,  WARD_CD = #{wardCd}                                                   /*  병동코드 */
		     ,  ORCL_CD  = #{orclCd}                                                     /*  처방분류코드 */
		     ,  ODKI_CD  = #{odkiCd}                                                     /*  처방종류코드 */
		     ,  ODKI_DETL_CD = #{odkiDetlCd}                                        /*  처방종류상세코드(신규) */
		     ,  ORDR_CLTY_CD = #{ordrCltyCd}                                        /*  처방분류유형코드 */
		     ,  ORFR_CD = #{orfrCd}                                                       /*  처방형태코드 */
		     ,  SLIP_CD = #{slipCd}                                                         /*  SLIP 코드 */
		     ,  EXCF_CD = #{excfCd}                                                       /*  검사분류코드 */
		     ,  CHDR_ID = #{chdrId}                                                       /*  지정의사ID */
		     ,  GNDR_ID = #{gndrId}                                                       /*  주치의사ID */
		     ,  OPSR_ID = #{opsrId}                                                        /*  집도의사ID */
		     ,  CPDR_ID = #{cpdrId}                                                       /*  협진의사ID */
		     ,  EXMN_WNTD_DR_ID = #{exmnWntdDrId}                           /*  검사희망의사ID */
		     ,  WNTD_DT = to_date ( #{wntdDt}, 'YYYYMMDDhh24miss' )    /*  희망일시 */
		     ,  EXMN_WNTD_YMD_DVSN_CD = #{exmnWntdYmdDvsnCd}   /*  검사희망일자구분코드 */
		     ,  NNMT_EXMN_YN = #{nnmtExmnYn}                                  /*  비대면검사여부 */
		     ,  NNMT_EXMN_NTFC_YMD = to_date ( #{nnmtExmnNtfcYmd} , 'YYYYMMDD' )     /*  비대면검사통보일자 */
		     ,  SPCM_CD1 = #{spcmCd1}                                                /*  검체코드1 */
		     ,  SPCM_CD2 = #{spcmCd2}                                                /*  검체코드2 */
		     ,  SPCN_CD1 = #{spcnCd1}                                                 /*  검체용기코드1 */
		     ,  PRVN_INJC_ORNO = #{prvnInjcOrno}                                  /*  예방주사차수 */
		     ,  PTPT_CD = nvl(#{ptptCd}, PTPT_CD )                                /*  환자가야할장소코드 */
		     ,  ISTP_ADMN_VLM = #{istpAdmnVlm}                                  /*  동위원소투여용량 */
		     ,  ADTN_ORDV_CD = #{adtnOrdvCd}                                     /*  추가처방구분코드 */
		     ,  MDCR_BEEX_YN = #{mdcrBeexYn}                                      /*  진료이전검사여부 */
		     ,  ANAD_YN = #{anadYn}                                                    /*  항생제투여여부 */
		     ,  ANGG_INRV_DVSN_CD = #{anggInrvDvsnCd}                      /*  ANGIO중재구분코드 */
		     ,  PRTB_YN = #{prtbYn}                                                       /*  포터블여부 */
		     ,  ORDR_APNT_DT = to_date( #{ordrApntDt},'yyyymmddhh24miss')  /*  처방예약일시 */
		     ,  PACL_YMD = to_date( #{paclYmd},'YYYYMMDD' )               /*  원무계산일자:Done검사일때 계산일자에 처방일자 넣어줌(2003.02.10 이호진 과장님 요청) */
		     ,  EXRS_NTFC_MTHD_DVSN_CD = #{exrsNtfcMthdDvsnCd}
		     ,  EXOR_UNSL_CTN = #{exorUnslCtn}
		     ,  ORDR_IPDV_CD = #{ordrIpdvCd}
		     ,  PTAD_IPDV_CD = #{ptadIpdvCd}
		     ,  PTAD_CLBA_YMD = to_date ( #{ptadClbaYmd}, 'YYYYMMDDhh24miss' )  /*  원무계산기준일자 */
		     ,  RGOR_FNDR_ID = #{rgorFndrId}                                        /*  정규처방완료의사ID */
		     ,  RGOR_FINS_DT = to_date ( #{rgorFinsDt}, 'YYYYMMDDhh24miss' ) /*  정규처방완료일시 */
		     ,  ORCN_NURS_ID = #{orcnNursId}                                      /*  처방확인간호사ID */
		     ,  ORCN_DT = to_date ( #{orcnDt}, 'YYYYMMDDhh24miss' )    /*  처방확인일시 */
		     ,  CLRS_PRJC_CD = #{clrsPrjcCd}                                         /*  임상연구과제코드 */
		     ,  CLRS_PRJC_DR_ID = #{clrsPrjcDrId}                                   /*  임상연구과제의사ID */
		     ,  ATHN_ID = #{athnId}                                                     /*  인증자ID */
		     ,  CRTF_IP = #{crtfIp}                                                        /*  인증IP */
		     ,  CRTF_DT = to_date (#{crtfDt}, 'YYYYMMDDhh24miss' )       /*  인증일시 */
		     ,  PACS_ACCS_NO = #{pacsAccsNo}                                   /*  PACS접근번호 */
		     ,  PACS_TRDV_CD = #{pacsTrdvCd}
		     ,  ENDS_PACS_TRDV_CD = #{endsPacsTrdvCd}
		     ,  RISK_FCTR_VL = #{riskFctrVl}                                          /*  위험인자값 */
		     ,  ORDR_VALD_PERD_EXPT_YMD = to_date ( #{ordrValdPerdExptYmd} , 'YYYYMMDD' )/*  처방유효기간만료일자 */
		     ,  FRNS_DPRT_CD = #{frnsDprtCd}                                     /* 시행장소명 =&gt; ENFR_PLAC_NM 을 삭제하고 FRNS_DPRT_CD ( 불출부서로 사용 ) */
		     ,  VAT_TRGT_YN = #{vatTrgtYn}                                          /*  부가세대상여부 */
		     ,  ITRN_BSDV_CD = #{itrnBsdvCd}                                      /*  인턴업무구분코드 */
		     ,  SCEX_ADTN_ORDV_CD = #{scexAdtnOrdvCd}                    /* 검체검사추가처방구분코드 */
		     ,  BEFR_SPCM_NO = #{befrSpcmNo}                                   /* 이전검체번호 */
		     ,  EXMN_REFR_DVSN_CD = #{exmnRefrDvsnCd}                    /* 검사의뢰구분코드 */
		     ,  REFR_LNKN_NO = #{refrLnknNo}                                      /* 의뢰연결번호 */
		     ,  TMPR_ORDR_YN = #{tmprOrdrYn}                                    /* 임시처방여부 */
		     ,  PTAD_CODV_CD = #{ptadCodvCd}
		     ,  PTAD_MDRP_NO = #{ptadMdrpNo}
		     ,  IMLN_ORDR_YN = #{imlnOrdrYn}
		     ,  SSPC_SCIN_NM = #{sspcScinNm}
		     ,  SPOR_BNDL_NM = #{sporBndlNm}                                    /* 스페셜처방묶음명 */
		     ,  SPOR_BNDL_NO = #{sporBndlNo}                                    /* 스페셜처방묶음번호*/
		     ,  LAST_UPDR_ID = #{gvUserId}                                           /*  최종수정자ID                  */
		     ,  LAST_UPDT_IP = #{gvUserIp}                                            /*  최종수정IP                    */
		     ,  LAST_UPDT_DT = sysdate                                               /*  최종수정일시                     */
		     ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}                   /*  최종수정SMC클라이언트프로그램ID */
		     ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}                    /*  최종수정SMC서버프로그램ID      */
		     ,  ORDR_UPDT_DT = sysdate                                               /*  처방수정일시 */
		     ,  ORDR_UPDR_ID = #{gvUserId}                                           /*  처방수정자ID */
		     ,  EXOR_PRSS_CD = #{exorPrssCd}
		     ,  INTR_DT = to_date (#{intrDt},'yyyymmddhh24miss')
		     ,  INDR_ID1 = #{indrId1}
		     ,  INDR_ID2 = #{indrId2}
		     ,  INDR_ID3 = #{indrId3}
		     ,  RPRT_DT = to_date (#{rprtDt},'yyyymmddhh24miss')
		     ,  ENDR_ID = #{endrId}
		     ,  DADV_CD = #{dadvCd}
		     ,  EXRM_RPTN_DT = to_date (#{exrmRptnDt},'yyyymmddhh24miss')
		     ,  ENFR_DT = to_date (#{enfrDt},'yyyymmddhh24miss')
		     ,  MRI_IPDV_UPDT_CD = #{mriIpdvUpdtCd}
		     ,  APNT_DT = to_date (#{apntDt},'yyyymmddhh24miss')
		     ,  ACIM_CNFR_CD = #{acimCnfrCd}
		     ,  ACTN_LAST_CNFM_ID = #{actnLastCnfmId}
		     ,  ACTN_LAST_CNFR_DT = to_date (#{actnLastCnfrDt}	,'yyyymmddhh24miss')
		     ,  RTRN_STTS_CD = #{rtrnSttsCd}                                       /* 반납상태코드 */
		     ,  RTRN_RQST_DT = to_date(#{rtrnRqstDt}, 'YYYYMMDDhh24miss')          /* 반납요청일시 */
		     ,  RTRN_RQPR_ID = #{rtrnRqprId}                                       /* 반납요청자ID */
		     ,  BLCL_BRCD_PRIN_DT = to_date(#{blclBrcdPrinDt}, 'YYYYMMDDhh24miss')
		     ,  BRCD_PNPR_ID = #{brcdPnprId}
		     ,  BRCD_PRIN_YN = #{brcdPrinYn}
		     ,  EXMN_RTRE_CD = #{exmnRtreCd}
		     ,  SPCM_NO1 = #{spcmNo1}
		     ,  SPCM_NO2 = #{spcmNo2}
		     ,  RTRN_SPSB_CTN = #{rtrnSpsbCtn}
		     ,  HMTP_BSCL_RCPN_RLTN_CD = #{hmtpBsclRcpnRltnCd}
		     ,  ULTS_SITE_CD = #{ultsSiteCd}               /* 초음파부위코드 */
		     ,  SLPN_YN =#{slpnYn}
		     ,  TDM_CECK_CTN = #{tdmCeckCtn}
		     ,  SUB_TYPE_CD = #{subTypeCd}
		     ,  SCRG_INPY_ONBR_RT = #{scrgInpyOnbrRt}
		     ,  INSR_OPNN_CTN     = #{insrOpnnCtn}         /* 보험소견내용 */
		     ,  CNSN_RLTD_YN      = #{cnsnRltdYn}
		     ,  CNSN_RLTD_MCDP_CD = case when (#{cnsnRltdYn} = 'Y') and (Trim(#{cnsnRltdMcdpCd}) = '' or #{cnsnRltdMcdpCd} is null)
		                                 then (select MDCR_DPRT_CD from CCUSRDPHT where USER_ID = a.ODDR_ID)
		                                 else #{cnsnRltdMcdpCd}
		                             end 
		     ,  ORDR_NTM_QTY      = #{ordrNtmQty}
		 where  PTNO        =   #{ptno}
		   and  ORDR_YMD    =   to_date ( #{ordrYmd}, 'YYYYMMDD' )              /*  처방일자 */
		   and  ORDR_SNO    =   #{ordrSno}
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnOrdrDc (검사처방 DC 및 취소) 
        Description :                                           처방 내림한 검사처방을 DC 및 취소 처리한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnOrdrDc"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  >
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnOrdrDc */
		             MDEXMORDT
		       set  DC_DVSN_CD = #{dcDvsnCd}
		           ,  DC_ODDR_ID = #{dcOddrId}
		           ,  DC_ORDR_DT = to_date ( #{dcOrdrDt}, 'YYYYMMDDhh24miss' )
		           ,  PACS_TRDV_CD = decode( PACS_ACCS_NO, null, null, 'Y', null, 'C' )            /*  PACS i/f */
		           ,  ENDS_PACS_TRDV_CD = decode(PACS_ACCS_NO, null, null , 'Y', null, 'C')        /*  PACS i/f : 내시경PACS송신구분코드 */
		           ,  MDCT_PACS_TRDV_CD = decode(PACS_ACCS_NO, null, null, 'X')                    /*  PACS i/f : MDCT_PACS송신구분코드 */
		           ,  RTRN_STTS_CD = NVL ( #{rtrnSttsCd}, RTRN_STTS_CD )
		           ,  RTRN_RQST_DT = NVL ( to_date(#{rtrnRqstDt}, 'YYYYMMDDhh24miss'), RTRN_RQST_DT )
		           ,  RTRN_RQPR_ID = NVL ( #{rtrnRqprId}, RTRN_RQPR_ID )
		           ,  LAST_UPDR_ID = #{gvUserId}                                                   /*  최종수정자ID                  */
		           ,  LAST_UPDT_IP = #{gvUserIp}                                                   /*  최종수정IP                    */
		           ,  LAST_UPDT_DT = to_date ( #{dcOrdrDt}, 'YYYYMMDDhh24miss' )                   /*  최종수정일시                  */
		           ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}                                     /*  최종수정SMC클라이언트프로그램ID */
		           ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}                                     /*  최종수정SMC서버프로그램ID      */
		  where  PTNO = #{ptno}
		     and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )                                /* 처방일자 */
		     and  ORDR_SNO = #{ordrSno}                                                        /* 처방일련번호 */
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnImplOrdrPblcNtm (검사 원처방 실시 처방 발행 횟수 Update) 
        Description :                                           검사 실시 처방 발행후 원처방의 실시처방 발행 횟수를 Update 한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnImplOrdrPblcNtm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  >
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-updateExmnImplOrdrPblcNtm */
		             MDMEDORDT
		       set  IMPL_ORDR_PBLC_NTM = nvl ( IMPL_ORDR_PBLC_NTM, 0 ) + DECODE ( #{ntm}, 0, 1, null, 1, #{ntm}  )
		           ,  LAST_UPDR_ID = #{gvUserId}     		                /*  최종수정자ID */
		           ,  LAST_UPDT_IP = #{gvUserIp}          	                /*  최종수정IP */
		           ,  LAST_UPDT_DT = sysdate              		            /*  최종수정일시 */
		           ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}  /*  최종수정SMC클라이언트프로그램ID */
		           ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}  /*  최종수정SMC서버프로그램ID */
		   where  PTNO     = #{ptno}
		      and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
		      and  ORDR_SNO = #{ordrSno}
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-insertExmnOrdrImplOrdr (PRN 검사처방 실시처방 등록) 
        Description :                                           PRN 검사처방 의사 원처방에 대한 실시처방을 저장한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
    -->	
	<insert id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-insertExmnOrdrImplOrdr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  >
		<![CDATA[
		   insert  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-insertExmnOrdrImplOrdr */
			 into  MDEXMORDT
				(
					   PTNO               /*  환자번호 */
					,  ORDR_YMD           /*  처방일자 */
					,  ORDR_SNO           /*  처방순번 */
					,  MDRP_NO            /*  진료접수번호 */
					,  PTAD_MDRP_NO       /*  원무진료접수번호 */
					,  TMPR_ORDR_YN       /*  임시처방여부 */
					,  CODV_CD            /*  환자구분 */
					,  PTAD_CODV_CD       /*  원무환자구분 */
					,  OROC_DPRT_CD       /*  처방발생원 */
					,  MCDP_CD            /*  진료과 */
					,  WARD_CD            /*  병동 */
					,  OPRT_YMD           /*  수술일자 */
					,  OPRT_SNO           /*  수술순번 */
					,  ORCL_CD            /*  처방분류 */
					,  ODKI_CD            /*  처방종류 */
					,  ORDR_CLTY_CD       /*  처방구별 */
					,  ORFR_CD            /*  처방형태 */
					,  ORDR_CD            /*  처방코드 */
					,  SLIP_CD            /*  SLIP코드 */
					,  EXCF_CD            /*  검사분류 */
					,  ODDR_ID            /*  처방의사 */
					,  CHDR_ID            /*  주치의사 */
					,  GNDR_ID            /*  담당의사 */
					,  OPSR_ID            /*  집도의사 */
					,  CPDR_ID            /*  협진의사 */
					,  EXMN_WNTD_DR_ID    /*  검사희망의사 */
					,  WNTD_DT            /*  희망일시 */
					,  SPCM_CD1           /*  검체코드1 */
					,  SPCM_CD2           /*  검체코드2 */
					,  SPCM_NEED_QTY1     /*  검체필요량1 */
					,  SPCM_NEED_QTY2     /*  검체필요량2 */
					,  SPCN_CD1           /*  용기코드1 */
					,  SPCN_CD2           /*  용기코드2 */
					,  SPCN_NEED_COT1     /*  검체용기1필요개수 */
					,  SPCN_NEED_COT2     /*  검체용기2필요개수 */
					,  EXOR_PRSS_CD       /*  진행STATUS(진료지원) */
					,  PTPT_CD            /*  환자가야할곳 */
					,  ISTP_ADMN_VLM      /*  동위원소투여량 */
					,  ADTN_ORDV_CD       /*  추가처방여부 */
					,  MDCR_BEEX_YN       /*  진료전검사여부 */
					,  ANAD_YN            /*  항생제투여여부 */
					,  ANGG_INRV_DVSN_CD  /*  ANGIO/INTV구분 */
					,  PRTB_YN            /*  PORTABLE 여부 */
					,  ACMP_YN            /*  동반여부 */
					,  BLCL_EXMN_YN       /*  채혈검사여부 */
					,  IODI_MDTE_TSR_YN   /*  CP적용여부 */
					,  APNT_DT            /*  예약일시(진행) */
					,  SORT_SQNC          /*  나열순서 */
					,  EXOR_UNSL_CTN      /*  특기사항 */
					,  DC_DVSN_CD         /*  D/C여부 */
					,  DC_ODDR_ID         /*  D/C 처방의 */
					,  DC_ORDR_DT         /*  D/C 처방일시 */
					,  ORDR_IPDV_CD       /*  급여구분(처방) */
					,  PTAD_IPDV_CD       /*  급여구분(심사) */
					,  PTAD_CLBA_YMD      /*  원무계산기준일자 */
					,  INPT_USER_DVSN_CD  /*  입력USER구분(1.의사 2.간호사) */
					,  RGOR_FNDR_ID       /*  정규처방 완료의사 */
					,  RGOR_FINS_DT       /*  정규처방 완료시간 */
					,  ORCN_NURS_ID       /*  정규처방 확인 간호사 */
					,  ORCN_DT            /*  정규처방 확인 시간 */
					,  HSLC_DVSN_CD       /*  장소구분 */
					,  MCCN_CD            /*  센터구분 */
					,  DURV_RESN_CTN
					,  DURV_YN
					,  DURV_ORDR_YMD
					,  DURV_ORDR_CD
					,  ORGL_ORDR_YMD       /*  원처방 일자 */
					,  ORGL_ORDR_SNO       /*  원처방 순번 PRNORGSEQNO */
					,  ORDR_CRTN_DVSN_CD   /*  처방생성구분코드 */
					,  FRST_RGSR_ID        /*  최초등록자ID */
					,  FRST_RGST_IP        /*  최초등록IP */
					,  FRST_RGST_DT        /*  최초등록일시 */
					,  FRST_RGST_CLNT_PRGM_ID   /*  최초등록SMC클라이언트프로그램ID */
					,  FRST_RGST_SRVR_PRGM_ID   /*  최초등록SMC서버프로그램ID */
					,  LAST_UPDR_ID        /*  최종수정자ID */
					,  LAST_UPDT_IP        /*  최종수정IP */
					,  LAST_UPDT_DT        /*  최종수정일시 */
					,  LAST_UPDT_CLNT_PRGM_ID   /*  최종수정SMC클라이언트프로그램ID */
					,  LAST_UPDT_SRVR_PRGM_ID   /*  최종수정SMC서버프로그램ID */
					,  ORDR_UPDT_DT        /*  처방수정일시 */
					,  ORDR_UPDR_ID        /*  처방수정자ID */
					,  PACL_YMD            /*  원무계산일자 */
					,  ODKI_DETL_CD        /*  처방형태상세                       */
		            ,  SPOR_BNDL_NM	   /* 스페셜묶음명 */
		            ,  SPOR_BNDL_NO	   /* 스페셜묶음번호 */
		            ,  SLPN_YN				   /* 수면여부 */
		            ,  SUB_TYPE_CD
		            ,  SCRG_INPY_ONBR_RT
		            ,  INSR_OPNN_CTN        /* 보험소견내용 */
		            ,  CNSN_RLTD_YN
		            ,  CNSN_RLTD_MCDP_CD
				)
				(
				   select
					   PTNO                              /*  환자번호 */
					,  ORDR_YMD                          /*  처방일자 */
					,  #{ordrSno}      				     /*  처방순번 */
					,  MDRP_NO                           /*  진료접수번호 */
					,  PTAD_MDRP_NO                      /*  원무진료접수번호 */
					,  'N' as TMPR_ORDR_YN               /*  임시처방여부 -> 실시했기 때문에 N으로 한다. */
					,  CODV_CD                           /*  환자구분 */
					,  PTAD_CODV_CD                      /*  원무환자구분 */
					,  OROC_DPRT_CD                      /*  처방발생원 */
					,  MCDP_CD                           /*  진료과 */
					,  WARD_CD                           /*  병동 */
					,  OPRT_YMD                          /*  수술일자 */
					,  OPRT_SNO                          /*  수술순번 */
					,  ORCL_CD                           /*  처방분류 */
					,  decode(ODKI_CD, 'I', 'I', 'G')    /*  처방종류 => 일반처방 */
					,  ORDR_CLTY_CD                      /*  처방구별 */
					,  nvl(#{orfrCd}, 'I')               /*  처방형태 */
					,  ORDR_CD                           /*  처방코드 */
					,  SLIP_CD                           /*  SLIP코드 */
					,  EXCF_CD                           /*  검사분류 */
					,  ODDR_ID                           /*  처방의사 */
					,  CHDR_ID                           /*  주치의사 */
					,  GNDR_ID                           /*  담당의사 */
					,  OPSR_ID                           /*  집도의사 */
					,  CPDR_ID                           /*  협진의사 */
					,  EXMN_WNTD_DR_ID                   /*  검사희망의사 */
					,  WNTD_DT                           /*  희망일시 */
					,  SPCM_CD1                          /*  검체코드1 */
					,  SPCM_CD2                          /*  검체코드2 */
					,  SPCM_NEED_QTY1                    /*  검체필요량1 */
					,  SPCM_NEED_QTY2                    /*  검체필요량2 */
					,  SPCN_CD1                          /*  용기코드1 */
					,  SPCN_CD2                          /*  용기코드2 */
					,  SPCN_NEED_COT1                    /*  검체용기1필요개수 */
					,  SPCN_NEED_COT2                    /*  검체용기2필요개수 */
					,  ''                                /*  진행STATUS(진료지원) */
					,  PTPT_CD                           /*  환자가야할곳 */
					,  ISTP_ADMN_VLM                     /*  동위원소투여량 */
					,  ADTN_ORDV_CD                      /*  추가처방여부 */
					,  MDCR_BEEX_YN                      /*  진료전검사여부 */
					,  ANAD_YN                           /*  항생제투여여부 */
					,  ANGG_INRV_DVSN_CD                 /*  ANGIO/INTV구분 */
					,  PRTB_YN                           /*  PORTABLE 여부 */
					,  ACMP_YN                           /*  동반여부 */
					,  BLCL_EXMN_YN                      /*  채혈검사여부 */
					,  IODI_MDTE_TSR_YN                  /*  CP적용여부 */
					,  APNT_DT                           /*  예약일시(진행) */
					,  SORT_SQNC                         /*  나열순서 */
					,  EXOR_UNSL_CTN                     /*  특기사항 */
					,  DC_DVSN_CD                        /*  D/C여부 */
					,  DC_ODDR_ID                        /*  D/C 처방의 */
					,  DC_ORDR_DT                        /*  D/C 처방일시 */
					,  ORDR_IPDV_CD                      /*  급여구분(처방) */
					,  PTAD_IPDV_CD                      /*  급여구분(심사) */
					,  PTAD_CLBA_YMD                     /*  원무계산기준일자 */
					,  INPT_USER_DVSN_CD                 /*  입력USER구분(1.의사 2.간호사) */
					,  RGOR_FNDR_ID                      /*  정규처방 완료의사 */
					,  RGOR_FINS_DT                      /*  정규처방 완료시간 */
					,  ORCN_NURS_ID                      /*  정규처방 확인 간호사 */
					,  ORCN_DT                           /*  정규처방 확인 시간 */
					,  nvl( #{hslcDvsnCd}, HSLC_DVSN_CD ) /*  장소구분 */
					,  nvl( #{mccnCd}, MCCN_CD )         /*  센터구분 */
					,  DURV_RESN_CTN
					,  DURV_YN
					,  DURV_ORDR_YMD
					,  DURV_ORDR_CD
					,  to_date ( #{orglOrdrYmd}, 'yyyymmdd' ) /*  원처방 일자 PRNORGSEQNO */
					,  #{orglOrdrSno}                    /*  원처방 순번 PRNORGSEQNO */
					,  '08'                              /*  ★★ 처방생성구분코드 PRN실시처방 PRN★★ */
					,  #{gvUserId}                       /*  최초등록자ID */
					,  #{gvUserIp}                       /*  최초등록IP */
					,  sysdate                           /*  최초등록일시 */
					,  #{gvClntPrgmId}                   /*  최초등록SMC클라이언트프로그램ID */
					,  #{gvSrvrPrgmId}                   /*  최초등록SMC서버프로그램ID */
					,  #{gvUserId}                       /*  최종수정자ID */
					,  #{gvUserIp}                       /*  최종수정IP */
					,  sysdate                           /*  최종수정일시 */
					,  #{gvClntPrgmId}                   /*  최종수정SMC클라이언트프로그램ID */
					,  #{gvSrvrPrgmId}                   /*  최종수정SMC서버프로그램ID */
					,  sysdate                           /*  처방수정일시 */
					,  #{gvUserId}                       /*  처방수정자ID */
					,  case when PACL_YMD is null then decode ( #{orfrCd}, 'D', ORDR_YMD, null ) else PACL_YMD end  /*  원무계산일자 */
					,  ODKI_DETL_CD                      /*  처방형태상세 */
		            ,  SPOR_BNDL_NM
		            ,  SPOR_BNDL_NO
		            ,  SLPN_YN
		            ,  SUB_TYPE_CD
		            ,  SCRG_INPY_ONBR_RT
		            ,  INSR_OPNN_CTN                      /* 보험소견내용 */
		            ,  CNSN_RLTD_YN
		            ,  CNSN_RLTD_MCDP_CD
				 from  MDEXMORDT
				where  PTNO  = #{ptno}
				  AND  ORDR_YMD = to_date( #{orglOrdrYmd}, 'yyyymmdd')
				  and  ORDR_SNO = #{orglOrdrSno}
				  and  ORFR_CD = 'P'
				)
			]]>
	</insert>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-insertExmnOrdr (검사처방 저장) 
        Description :                                           환자 치료를 위한 처방 내림 중 검사처방을 저장한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
    -->	
	<insert id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-insertExmnOrdr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  >
		   insert  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-insertExmnOrdr */
		   into  MDEXMORDT
		   (
			   PTNO                         /* 환자번호*/
			   ,  ORDR_YMD                  /* 처방일자*/
			   ,  ORDR_SNO                  /* 처방일련번호*/
			   ,  MDRP_NO                   /* 진료접수번호*/
			   ,  PTAD_MDRP_NO              /* 원무접수번호*/
			   ,  ORDR_CD                   /* 처방코드*/
			   ,  MCDP_CD                   /* 진료과코드*/
			   ,  ODDR_ID                   /* 처방의사ID*/
			   ,  CHDR_ID                   /* 지정의사ID*/
			   ,  GNDR_ID                   /* 주치의사ID*/
			   ,  CODV_CD                   /* 내원구분코드*/
			   ,  PTAD_CODV_CD              /* 원무내원구분코드*/
			   ,  ORDR_CLTY_CD              /* 처방분류유형코드*/
			   ,  ORCL_CD                   /* 처방분류코드*/
			   ,  ODKI_CD                   /* 처방종류코드*/
			   ,  ODKI_DETL_CD              /* 처방종류상세코드*/
			   ,  ORFR_CD                   /* 처방형태코드*/
			   ,  HSLC_DVSN_CD              /* 위치구분코드*/
			   ,  MCCN_CD                   /* 진료센터코드*/
			   ,  WARD_CD                   /* 병동코드*/
			   ,  OROC_DPRT_CD              /* 처방발생원코드*/
			   ,  FRNS_DPRT_CD              /* 불출부서코드*/
			   ,  SLIP_CD                   /* SLIP코드*/
			   ,  CARE_STTS_CD              /* 간호상태코드*/
			   ,  RTRN_STTS_CD              /* 반납상태코드*/
			   ,  RTRN_RQST_DT              /* 반납요청일시*/
			   ,  RTRN_RQPR_ID              /* 반납요청자ID*/
			   ,  ADTN_ORDV_CD              /* 추가처방구분코드*/
			   ,  RGOR_FNDR_ID              /* 정규처방완료의사ID*/
			   ,  RGOR_FINS_DT              /* 정규처방완료일시*/
			   ,  ORCN_NURS_ID              /* 처방확인간호사ID*/
			   ,  ORCN_DT                   /* 처방확인일시*/
			   ,  TMPR_ORDR_YN              /* 임시처방여부*/
			   ,  DC_DVSN_CD                /* DC구분코드*/
			   ,  DC_ODDR_ID                /* DC처방의사ID*/
			   ,  DC_ORDR_DT                /* DC처방일시*/
			   ,  DC_CNNU_ID                /* DC확인간호사ID*/
			   ,  DC_CNFR_DT                /* DC확인일시*/
			   ,  SORT_SQNC                 /* 정렬순서*/
			   ,  EXOR_UNSL_CTN             /* 검사처방특이내용*/
			   ,  INPT_USER_DVSN_CD         /* 입력사용자구분코드*/
			   ,  CRTF_DVSN_CD              /* 인증구분코드*/
			   ,  ATHN_ID                   /* 인증자ID*/
			   ,  CRTF_IP                   /* 인증IP*/
			   ,  CRTF_DT                   /* 인증일시*/
			   ,  CLRS_PRJC_CD              /* 임상연구과제코드*/
			   ,  CLRS_PRJC_DR_ID           /* 임상연구과제의사ID*/
			   ,  OPRT_YMD                  /* 수술일자*/
			   ,  OPRT_SNO                  /* 수술일련번호*/
			   ,  ITRN_BSDV_CD              /* 인턴업무구분코드*/
			   ,  SRRQ_CMNT_CTN             /* SR커멘트내용*/
			   ,  ORDR_IPDV_CD              /* 보험급여구분코드*/
			   ,  PTAD_IPDV_CD              /* 심사급여구분코드*/
			   ,  ISTY_CD                   /* 보험유형코드*/
			   ,  ISTY_ASST_CD              /* 보험유형보조코드*/
			   ,  CNPL_CD                   /* 계약처코드*/
			   ,  PTAD_CLAM_YMD             /* 원무청구일자*/
			   ,  PTAD_CLBA_YMD             /* 원무계산기준일자*/
			   ,  PACL_YMD                  /* 원무계산일자*/
			   ,  RCST_CD                   /* 수납상태코드*/
			   ,  RPNT_ID                   /* 수납자ID*/
			   ,  RCPC_DT                   /* 수납일시*/
			   ,  VIA_ADMS_RCST_CD          /* 경유입원수납상태코드*/
		       ,  RDEX_CD                  /* 감면코드 */
			   ,  OPSR_ID                   /* 집도의사ID*/
			   ,  CPDR_ID                   /* 협진의사ID*/
			   ,  ENDR_ID                   /* 시행의사ID*/
			   ,  EXMN_WNTD_DR_ID           /* 검사희망의사ID*/
			   ,  WNTD_DT                   /* 희망일시*/
			   ,  EXMN_WNTD_YMD_DVSN_CD     /* 검사희망일자구분코드*/
			   ,  NNMT_EXMN_YN              /* 비대면검사여부*/
			   ,  NNMT_EXMN_NTFC_YMD        /* 비대면검사통보일시*/
			   ,  PTPT_CD                   /* 환자가야할장소코드*/
			   ,  ABC_ENFR_YMD              /* ABC시행일자*/
			   ,  ABC_MCDP_CD               /* ABC진료과코드*/
			   ,  ABC_EFDP_CD               /* ABC시행부서코드*/
			   ,  ABC_ODDR_ID               /* ABC처방의사ID*/
			   ,  ABC_ENDR_ID               /* ABC시행의사ID*/
			   ,  VAT_TRGT_YN               /* 부가세대상여부*/
			   ,  ICU_VS_DSPL_YN            /* ICU_VitalSign표시여부*/
			   ,  CNNT_ORDR_BNDL_NO         /* 동시처방묶음번호*/
			   ,  ORDR_VALD_STRT_YMD        /* 처방유효시작일자*/
			   ,  ORDR_VALD_FNSH_YMD        /* 처방유효종료일자*/
			   ,  IMPL_ORDR_PBLC_NTM        /* 실시처방발행횟수*/
			   ,  IMPL_ORDR_PBLC_LMTT_NTM   /* 실시처방발행제한횟수*/
			   ,  ORGL_ORDR_YMD             /* 원처방일자*/
			   ,  ORGL_ORDR_SNO             /* 원처방일련번호*/
			   ,  SCEX_ADTN_ORDV_CD         /* 검체검사추가처방구분코드*/
			   ,  BEFR_SPCM_NO              /* 이전검체번호*/
			   ,  EXMN_REFR_DVSN_CD         /* 검사의뢰구분코드*/
			   ,  REFR_LNKN_NO              /* 의뢰연결번호*/
			   ,  DURV_YN                   /* DUR여부*/
			   ,  DURV_RESN_CTN             /* DUR사유내용*/
			   ,  DURV_ORDR_YMD             /* DUR처방일자*/
			   ,  DURV_ORDR_CD              /* DUR처방코드*/
			   ,  EXMN_RTRE_CD              /* 검사반납사유코드*/
			   ,  RTRN_SPSB_CTN             /* 반납특기사항내용*/
			   ,  EXCF_CD                   /* 검사분류코드*/
			   ,  INDR_ID1                  /* 판독의사ID1*/
			   ,  INDR_ID2                  /* 판독의사ID2*/
			   ,  INDR_ID3                  /* 판독의사ID3*/
			   ,  SPCM_CD1                  /* 검체코드1*/
			   ,  SPCM_NEED_QTY1            /* 검체필요량1*/
			   ,  SPCN_CD1                  /* 검체용기코드1*/
			   ,  SPCN_NEED_COT1            /* 검체용기필요개수1*/
			   ,  SPCM_CD2                  /* 검체코드2*/
			   ,  SPCM_NEED_QTY2            /* 검체필요량2*/
			   ,  SPCN_CD2                  /* 검체용기코드2*/
			   ,  SPCN_NEED_COT2            /* 검체용기필요개수2*/
			   ,  SPCM_NO1                  /* 검체번호1*/
			   ,  SPCM_NO2                  /* 검체번호2*/
			   ,  EXOR_PRSS_CD              /* 검사처방진행상태코드*/
			   ,  ISTP_ADMN_VLM             /* 동위원소투여용량*/
			   ,  MDCR_BEEX_YN              /* 진료이전검사여부*/
			   ,  ANAD_YN                   /* 항생제투여여부*/
			   ,  ANGG_INRV_DVSN_CD         /* ANGIO중재구분코드*/
			   ,  PRTB_YN                   /* 포터블여부*/
			   ,  ACMP_YN                   /* 동반여부*/
			   ,  BLCL_EXMN_YN              /* 채혈검사여부*/
			   ,  IODI_MDTE_TSR_YN          /* 요오드치료TSR여부*/
			   ,  DX_PTHL_ADOR_YN           /* 진단병리추가처방여부*/
			   ,  BRCD_PRIN_YN              /* 바코드출력여부*/
			   ,  BRCD_PNPR_ID              /* 바코드출력자ID*/
			   ,  BLCL_BRCD_PRIN_DT         /* 채혈바코드출력일시*/
			   ,  APNT_DT                   /* 예약일시*/
			   ,  ORDR_APNT_DT              /* 처방예약일시*/
			   ,  EXRM_RPTN_DT              /* 검사실접수일시*/
			   ,  ENFR_DT                   /* 시행일시*/
			   ,  INTR_DT                   /* 판독일시*/
			   ,  RPRT_DT                   /* 보고일시*/
			   ,  ACIM_NURS_ID              /* 액팅실시간호사ID*/
			   ,  ACTN_DT                   /* 액팅일시*/
			   ,  ACIM_INPT_DT              /* 액팅실시입력일시*/
			   ,  ACIM_UPDT_DT              /* 액팅실시수정일시*/
			   ,  ACIM_SPAB_CTN             /* 액팅실시특기내용*/
			   ,  ACIM_CNFR_CD              /* 액팅실시확인코드*/
			   ,  ACTN_LAST_CNFM_ID         /* 액팅최종확인자ID*/
			   ,  ACTN_LAST_CNFR_DT         /* 액팅최종확인일시*/
			   ,  DSCH_ORDR_CASB_CTN        /* 퇴원처방주의사항내용*/
			   ,  DSCH_ORDR_EXMN_DT         /* 퇴원처방검사일시*/
			   ,  PACS_ACCS_NO              /* PACS접근번호*/
			   ,  PACS_TRDV_CD              /* PACS송신구분코드*/
			   ,  DADV_CD                   /* 주야구분코드*/
			   ,  HLSC_EXMN_YN              /* 건강검진검사여부*/
			   ,  ENDS_PACS_TRDV_CD         /* 내시경PACS송신구분코드*/
			   ,  PRVN_INJC_ORNO            /* 예방주사차수*/
			   ,  MDFE_APLY_YMD             /* 수가적용일자*/
			   ,  MDCT_PACS_TRDV_CD         /* MDCT_PACS송신구분코드*/
			   ,  MRI_IPDV_UPDT_CD          /* MRI급여구분수정코드*/
			   ,  HLSC_APNT_NO              /* 건강검진예약번호*/
			   ,  RISK_FCTR_VL              /* 위험인자값*/
			   ,  DYTM_WARD_USE_WNTD_YN     /* 낮병동사용희망여부*/
			   ,  ENDS_CHFR_AMDR_ID         /* 내시경무료예약의사ID*/
			   ,  ORDR_VALD_PERD_EXPT_YMD   /* 처방유효기간만료일자*/
			   ,  DSPC_NURS_ADJS_BNDL_NO    /* 퇴원계획지간호사조정묶음번호*/
			   ,  DSPC_NURS_ADJS_NO         /* 퇴원계획지간호사조정번호*/
			   ,  DSPC_NURS_ADJS_BNDL_NM    /* 퇴원계획지간호사조정묶음명*/
			   ,  DSPC_NURS_ADJS_PTGO_CTN   /* 퇴원계획지간호사조정가야할장소코드*/
			   ,  EXRS_NTFC_MTHD_DVSN_CD    /* 검사결과통보방법구분코드*/
			   ,  IMLN_ORDR_YN              /* 임플란트처방여부*/
			   ,  SSPC_SCIN_NM              /* 의심상병명*/
			   ,  ORDR_CRTN_DVSN_CD         /* 처방생성구분코드*/
			   ,  ORDR_CRTN_LNKN_NO         /* 처방생성연결번호*/
		       ,  SPOR_BNDL_NM             /* 스페셜처방묶음명 */
		       ,  SPOR_BNDL_NO             /* 스페셜처방묶음번호*/
		       ,  SLPN_YN                       /* 수면여부 */
		       ,  ORDR_UPDT_DT              /* 처방수정일시*/
			   ,  ORDR_UPDR_ID              /* 처방수정자ID*/
		       ,  HMTP_BSCL_RCPN_RLTN_CD  /* 조혈모세포수혜자관계코드 */
		       ,  ULTS_SITE_CD               /* 초음파부위코드 */
		       ,  TDM_CECK_CTN            /* TDM체크내용 */
		       ,  SUB_TYPE_CD               /* 부유형코드 */
		       ,  SCRG_INPY_ONBR_RT     /* 선별급여본인부담율 */
		       ,  INSR_OPNN_CTN         /* 보험소견내용 */
		       ,  CNSN_RLTD_YN          /* 컨설트 관련여부 */
		       ,  CNSN_RLTD_MCDP_CD		/* 컨설트관련진료과코드 */
		       ,  ORDR_NTM_QTY          /* 처방횟수량 */
			   ,  FRST_RGSR_ID              /* 최초등록자ID*/
			   ,  FRST_RGST_IP              /* 최초등록IP*/
			   ,  FRST_RGST_DT              /* 최초등록일시*/
			   ,  FRST_RGST_CLNT_PRGM_ID         /* 최초등록SMC클라이언트프로그램ID*/
			   ,  FRST_RGST_SRVR_PRGM_ID         /* 최초등록SMC서버프로그램ID*/
			   ,  LAST_UPDR_ID              /* 최종수정자ID*/
			   ,  LAST_UPDT_IP              /* 최종수정IP*/
			   ,  LAST_UPDT_DT              /* 최종수정일시*/
			   ,  LAST_UPDT_CLNT_PRGM_ID         /* 최종수정SMC클라이언트프로그램ID*/
			   ,  LAST_UPDT_SRVR_PRGM_ID         /* 최종수정SMC서버프로그램ID*/
		   )
		   values  (
			   #{ptno}                            /* 환자번호*/
			   ,  to_date ( #{ordrYmd}, 'YYYYMMDD' ) /* 처방일자*/
			   ,  #{ordrSno}                        /* 처방일련번호*/
			   ,  #{mdrpNo}                         /* 진료접수번호*/
			   ,  #{ptadMdrpNo}                    /* 원무접수번호*/
			   ,  #{ordrCd}                         /* 처방코드*/
			   ,  #{mcdpCd}                         /* 진료과코드*/
			   ,  #{oddrId}                         /* 처방의사ID*/
			   ,  #{chdrId}                         /* 지정의사ID*/
			   ,  #{gndrId}                         /* 주치의사ID*/
			   ,  #{codvCd}                         /* 내원구분코드 [D: DSC, E:응급, G: 건진, H:가정간호, I:입원, O:외래 - ASIS(AP025)]*/
			   ,  #{ptadCodvCd}                    /* 원무내원구분코드*/
			   ,  #{ordrCltyCd}                    /* 처방분류유형코드 [주사약, 외용약, 검체검사, 환자검사 인지를 구별하는 코드로 처방 분류(AI048)의 상위개념으로 볼 수 있다. *. 수가 테이블에 있는 정보를 가져옴. ASIS(MM182)]*/
			   ,  #{orclCd}                         /* 처방분류코드*/
			   ,  #{odkiCd}                         /* 처방종류코드*/
			   ,  #{odkiDetlCd}                    /* 처방종류상세코드*/
			   ,  #{orfrCd}                         /* 처방형태코드*/
			   ,  #{hslcDvsnCd}                    /* 위치구분코드*/
			   ,  #{mccnCd}                         /* 진료센터코드*/
			   ,  #{wardCd}                         /* 병동코드*/
			   ,  #{orocDprtCd}                         /* 처방발생원코드*/
			   ,  #{frnsDprtCd}                    /* 불출부서코드*/
			   ,  #{slipCd}                         /* SLIP코드*/
			   ,  #{careSttsCd}                    /* 간호상태코드*/
			   ,  #{rtrnSttsCd}                    /* 반납상태코드*/
			   ,  to_date (#{rtrnRqstDt}, 'YYYYMMDDhh24miss') /* 반납요청일시*/
			   ,  #{rtrnRqprId}                    /* 반납요청자ID*/
			   ,  #{adtnOrdvCd}                    /* 추가처방구분코드*/
			   ,  #{rgorFndrId}                    /* 정규처방완료의사ID*/
			   ,   to_date (#{rgorFinsDt}, 'YYYYMMDDhh24miss') /* 정규처방완료일시*/
			   ,  #{orcnNursId}                    /* 처방확인간호사ID*/
			   ,  to_date (#{orcnDt}, 'YYYYMMDDhh24miss') /* 처방확인일시*/
			   ,  #{tmprOrdrYn}                    /* 임시처방여부*/
			   ,  #{dcDvsnCd}                      /* DC구분코드*/
			   ,  #{dcOddrId}                      /* DC처방의사ID*/
			   ,  to_date (#{dcOrdrDt}, 'YYYYMMDDhh24miss')    /* DC처방일시*/
			   ,  #{dcCnnuId}                      /* DC확인간호사ID*/
			   ,  to_date (#{dcCnfrDt}, 'YYYYMMDDhh24miss')    /* DC확인일시*/
			   ,  #{sortSqnc}                       /* 정렬순서*/
			   ,  #{exorUnslCtn}                   /* 검사처방특이내용*/
			   ,  #{inptUserDvsnCd}               /* 입력사용자구분코드*/
			   ,  case when #{crtfDvsnCd} is null then '0' else #{crtfDvsnCd} end  /* 인증구분코드*/
			   ,  #{athnId}                         /* 인증자id*/
			   ,  #{crtfIp}                         /* 인증ip*/
			   ,  to_date (#{crtfDt}, 'YYYYMMDDhh24miss')  /* 인증일시*/
			   ,  #{clrsPrjcCd}                    /* 임상연구과제코드*/
			   ,  #{clrsPrjcDrId}                 /* 임상연구과제의사id*/
			   ,  to_date (#{oprtYmd}, 'YYYYMMDD' ) /* 수술일자*/
			   ,  #{oprtSno}                        /* 수술일련번호*/
			   ,  #{itrnBsdvCd}                    /* 인턴업무구분코드*/
			   ,  #{srrqCmntCtn}                   /* sr커멘트내용*/
			   ,  #{ordrIpdvCd}                    /* 보험급여구분코드*/
			   ,  #{ptadIpdvCd}                    /* 심사급여구분코드*/
			   ,  #{istyCd}                         /* 보험유형코드*/
			   ,  #{istyAsstCd}                    /* 보험유형보조코드*/
			   ,  #{cnplCd}                         /* 계약처코드*/
			   ,  to_date (#{ptadClamYmd}, 'YYYYMMDD' ) /* 원무청구일자*/
			   ,  to_date (#{ptadClbaYmd}, 'YYYYMMDDhh24miss' ) /* 원무계산기준일자*/
			   ,  decode ( #{orfrCd},'D',to_date( #{ordrYmd},'YYYYMMDD' ), null ) /* 원무계산일자: 계산일자(원무)Done검사일때 계산일자에 처방일자 넣어줌(2003.02.10 이호진 과장님 요청)*/
			   ,  #{rcstCd}                         /* 수납상태코드*/
			   ,  #{rpntId}                         /* 수납자id*/
			   ,  to_date (#{rcpcDt}, 'YYYYMMDDhh24miss') /* 수납일시*/
			   ,  #{viaAdmsRcstCd}                /* 경유입원수납상태코드*/
		       ,  #{rdexCd}							/* 감면코드_건진I/F처방시 입력할 수 있음. */
			   ,  #{opsrId}                         /* 집도의사id*/
			   ,  #{cpdrId}                         /* 협진의사id*/
			   ,  #{endrId}                         /* 시행의사id*/
			   ,  #{exmnWntdDrId}                 /* 검사희망의사id*/
			   ,  to_date ( #{wntdDt}, 'YYYYMMDDhh24miss') /* 희망일시*/
			   ,  #{exmnWntdYmdDvsnCd}           /* 검사희망일자구분코드*/
			   ,  #{nnmtExmnYn}                    /* 비대면검사여부*/
			   ,  to_date ( #{nnmtExmnNtfcYmd} , 'YYYYMMDD' ) /* 비대면검사통보일시*/
			   ,  #{ptptCd}                         /* 환자가야할장소코드*/
			   ,  null                                                /* ABC시행일자*/
			   ,  null                                                /* ABC진료과코드*/
			   ,  null                                                /* ABC시행부서코드*/
			   ,  null                                                /* ABC처방의사ID*/
			   ,  null                                                /* ABC시행의사ID*/
			   ,  #{vatTrgtYn}                     /* 부가세대상여부*/
			   ,  #{icuVsDsplYn}                  /* icu_vitalsign표시여부*/
			   ,  #{cnntOrdrBndlNo}               /* 동시처방묶음번호*/
			   ,  to_date (#{ordrValdStrtYmd}, 'YYYYMMDD' ) /* 처방유효시작일자*/
			   ,  to_date (#{ordrValdFnshYmd}, 'YYYYMMDD' ) /* 처방유효종료일자*/
			   ,  #{implOrdrPblcNtm}              /* 실시처방발행횟수*/
			   ,  #{implOrdrPblcLmttNtm}         /* 실시처방발행제한횟수*/
			   ,  to_date (#{orglOrdrYmd}, 'YYYYMMDD' ) /* 원처방일자*/
			   ,  #{orglOrdrSno}                   /* 원처방일련번호*/
			   ,  #{scexAdtnOrdvCd}               /* 검체검사추가처방구분코드*/
			   ,  #{befrSpcmNo}                    /* 이전검체번호*/
			   ,  #{exmnRefrDvsnCd}               /* 검사의뢰구분코드*/
			   ,  #{refrLnknNo}                    /* 의뢰연결번호*/
			   ,  #{durvYn}                         /* dur여부*/
			   ,  #{durvResnCtn}                   /* dur사유내용*/
			   ,  to_date (#{durvOrdrYmd}, 'YYYYMMDD' ) /* dur처방일자*/
			   ,  #{durvOrdrCd}                    /* dur처방코드*/
			   ,  #{exmnRtreCd}                    /* 검사반납사유코드*/
			   ,  #{rtrnSpsbCtn}                   /* 반납특기사항내용*/
			   ,  #{excfCd}                         /* 검사분류코드*/
			   ,  #{indrId1}                       /* 판독의사id1*/
			   ,  #{indrId2}                       /* 판독의사id2*/
			   ,  #{indrId3}                       /* 판독의사id3*/
			   ,  #{spcmCd1}                       /* 검체코드1*/
			   ,  #{spcmNeedQty1}                 /* 검체필요량1*/
			   ,  #{spcnCd1}                       /* 검체용기코드1*/
			   ,  #{spcnNeedCot1}                 /* 검체용기필요개수1*/
			   ,  #{spcmCd2}                       /* 검체코드2*/
			   ,  #{spcmNeedQty2}                 /* 검체필요량2*/
			   ,  #{spcnCd2}                       /* 검체용기코드2*/
			   ,  #{spcnNeedCot2}                 /* 검체용기필요개수2*/
			   ,  #{spcmNo1}                       /* 검체번호1*/
			   ,  #{spcmNo2}                       /* 검체번호2*/
			   ,  #{exorPrssCd}                    /* 검사처방진행상태코드*/
			   ,  #{istpAdmnVlm}                   /* 동위원소투여용량*/
			   ,  #{mdcrBeexYn}                    /* 진료이전검사여부*/
			   ,  #{anadYn}                         /* 항생제투여여부*/
			   ,  #{anggInrvDvsnCd}               /* angio중재구분코드*/
			   ,  #{prtbYn}                         /* 포터블여부*/
			   ,  #{acmpYn}                         /* 동반여부*/
			   ,  #{blclExmnYn}                    /* 채혈검사여부*/
			   ,  #{iodiMdteTsrYn}                /* 요오드치료tsr여부*/
			   ,  #{dxPthlAdorYn}                 /* 진단병리추가처방여부*/
			   ,  #{brcdPrinYn}                    /* 바코드출력여부*/
			   ,  #{brcdPnprId}                    /* 바코드출력자id*/
			   ,  to_date (#{blclBrcdPrinDt}, 'YYYYMMDDhh24miss' )/* 채혈바코드출력일시*/
			   ,  to_date (#{apntDt}, 'YYYYMMDDhh24miss' )          /* 예약일시*/
			   ,  decode(#{codvCd},'O',to_date( #{ordrYmd},'YYYYMMDD' )
													,'I',decode(#{odkiCd},'D', to_date( #{wntdDt},'yyyymmddhh24miss') ,null )
													,null ) /*  처방예약일시 */
			   ,  to_date (#{exrmRptnDt}, 'YYYYMMDD' )             /* 검사실접수일시*/
			   ,  to_date (#{enfrDt}, 'YYYYMMDDhh24miss' )          /* 시행일시*/
			   ,  to_date (#{intrDt}, 'YYYYMMDDhh24miss' )          /* 판독일시*/
			   ,  to_date (#{rprtDt}, 'YYYYMMDDhh24miss' )          /* 보고일시*/
			   ,  #{acimNursId}                    /* 액팅실시간호사id*/
			   ,  to_date (#{actnDt}, 'YYYYMMDDhh24miss' )          /* 액팅일시*/
			   ,  to_date (#{acimInptDt}, 'YYYYMMDDhh24miss' )     /* 액팅실시입력일시*/
			   ,  to_date (#{acimUpdtDt}, 'YYYYMMDDhh24miss' )     /* 액팅실시수정일시*/
			   ,  #{acimSpabCtn}                   /* 액팅실시특기내용*/
			   ,  #{acimCnfrCd}                    /* 액팅실시확인코드*/
			   ,  #{actnLastCnfmId}               /* 액팅최종확인자id*/
			   ,  to_date (#{actnLastCnfrDt}, 'YYYYMMDDhh24miss' )/* 액팅최종확인일시*/
			   ,  #{dschOrdrCasbCtn}              /* 퇴원처방주의사항내용*/
			   ,  to_date (#{dschOrdrExmnDt}, 'YYYYMMDDhh24miss' )/* 퇴원처방검사일시*/
			   ,  #{pacsAccsNo}                    /* pacs접근번호*/
			   ,  #{pacsTrdvCd}                    /* pacs송신구분코드*/
			   ,  #{dadvCd}                         /* 주야구분코드*/
			   ,  #{hlscExmnYn}                    /* 건강검진검사여부*/
			   ,  #{endsPacsTrdvCd}               /* 내시경pacs송신구분코드*/
			   ,  #{prvnInjcOrno}                  /* 예방주사차수*/
			   ,  to_date (#{mdfeAplyYmd}, 'YYYYMMDD' ) /* 수가적용일자*/
			   ,  #{mdctPacsTrdvCd}               /* mdct_pacs송신구분코드*/
			   ,  #{mriIpdvUpdtCd}                /* mri급여구분수정코드*/
			   ,  #{hlscApntNo}                    /* 건강검진예약번호*/
			   ,  #{riskFctrVl}                    /* 위험인자값*/
			   ,  #{dytmWardUseWntdYn}           /* 낮병동사용희망여부*/
			   ,  #{endsChfrAmdrId}               /* 내시경무료예약의사id*/
			   ,  to_date ( #{ordrValdPerdExptYmd} , 'YYYYMMDD' )/* 처방유효기간만료일자*/
			   /*  ,  :mds_exmordt_000[0].enfr_plac_nm                    /* 시행장소명 =&gt; ENFR_PLAC_NM 을 삭제하고 FRNS_DPRT_CD ( 불출부서로 사용 )*/
			   ,  #{dspcNursAdjsBndlNo}          /* 퇴원계획지간호사조정묶음번호*/
			   ,  #{dspcNursAdjsNo}               /* 퇴원계획지간호사조정번호*/
			   ,  #{dspcNursAdjsBndlNm}          /* 퇴원계획지간호사조정묶음명*/
			   ,  #{dspcNursAdjsPtgoCtn}         /* 퇴원계획지간호사조정가야할장소코드*/
			   ,  #{exrsNtfcMthdDvsnCd}          /* 검사결과통보방법구분코드*/
			   ,  #{imlnOrdrYn}                    /* 임플란트처방여부*/
			   ,  #{sspcScinNm}                    /* 의심상병명*/
			   ,  #{ordrCrtnDvsnCd}               /* 처방생성구분코드*/
			   ,  #{ordrCrtnLnknNo}               /* 처방생성연결번호*/
		       ,  #{sporBndlNm}                     /* 스페셜처방묶음명 */
		       ,  #{sporBndlNo}                     /* 스페셜처방묶음번호 */
		       ,  #{slpnYn}							  /* 수면여부 */
		       ,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss') /* 처방수정일시*/
			   ,  #{gvUserId}                                    /* 처방수정자ID*/
		       ,  #{hmtpBsclRcpnRltnCd}  /* 조혈모세포수혜자관계코드 */
		       ,  #{ultsSiteCd}               /* 초음파부위코드 */
		       ,  #{tdmCeckCtn}            /* TDM체크내용 */
		       ,  #{subTypeCd}
		       ,  #{scrgInpyOnbrRt}
			   ,  #{insrOpnnCtn}           /* 보험소견내용 */
		       ,  #{cnsnRltdYn}
		       ,  case when (#{cnsnRltdYn} = 'Y') and (Trim(#{cnsnRltdMcdpCd}) = '' or #{cnsnRltdMcdpCd} is null)
		               then (select MDCR_DPRT_CD from CCUSRDPHT where USER_ID = #{oddrId})
		               else #{cnsnRltdMcdpCd}
		           end 
		       ,  #{ordrNtmQty}          /* 처방횟수량 */ 
			   ,  #{gvUserId}                                    /* 최초등록자ID*/
			   ,  #{gvUserIp}                                         /* 최초등록IP*/
			   ,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss') /* 최초등록일시*/
			   ,  #{gvClntPrgmId}                                        /* 최초등록SMC클라이언트프로그램ID*/
			   ,  #{gvSrvrPrgmId}                                        /* 최초등록SMC서버프로그램ID*/
			   ,  #{gvUserId}                                    /* 최종수정자ID*/
			   ,  #{gvUserIp}                                         /* 최종수정IP*/
			   ,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss') /* 최종수정일시*/
			   ,  #{gvClntPrgmId}                                        /* 최종수정SMC클라이언트프로그램ID*/
			   ,  #{gvSrvrPrgmId}                                        /* 최종수정SMC서버프로그램ID*/
		   )
	</insert>


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneMdexmordt-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ptadMdrpNo" column="PTAD_MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="ptadCodvCd" column="PTAD_CODV_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="odkiDetlCd" column="ODKI_DETL_CD"/>
		<result property="orfrCd" column="ORFR_CD"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="orocCdOld" column="OROC_CD_OLD"/>
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="careSttsCd" column="CARE_STTS_CD"/>
		<result property="rtrnSttsCd" column="RTRN_STTS_CD"/>
		<result property="rtrnRqstDt" column="RTRN_RQST_DT"/>
		<result property="rtrnRqprId" column="RTRN_RQPR_ID"/>
		<result property="exmnRtreCd" column="EXMN_RTRE_CD"/>
		<result property="rtrnSpsbCtn" column="RTRN_SPSB_CTN"/>
		<result property="adtnOrdvCd" column="ADTN_ORDV_CD"/>
		<result property="rgorFndrId" column="RGOR_FNDR_ID"/>
		<result property="rgorFinsDt" column="RGOR_FINS_DT"/>
		<result property="orcnNursId" column="ORCN_NURS_ID"/>
		<result property="orcnDt" column="ORCN_DT"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="dcCnnuId" column="DC_CNNU_ID"/>
		<result property="dcCnfrDt" column="DC_CNFR_DT"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="exorUnslCtn" column="EXOR_UNSL_CTN"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="athnId" column="ATHN_ID"/>
		<result property="crtfIp" column="CRTF_IP"/>
		<result property="crtfDt" column="CRTF_DT"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="clrsPrjcDrId" column="CLRS_PRJC_DR_ID"/>
		<result property="oprtYmd" column="OPRT_YMD"/>
		<result property="oprtSno" column="OPRT_SNO"/>
		<result property="itrnBsdvCd" column="ITRN_BSDV_CD"/>
		<result property="srrqCmntCtn" column="SRRQ_CMNT_CTN"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="ptadIpdvCd" column="PTAD_IPDV_CD"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="cnplCd" column="CNPL_CD"/>
		<result property="ptadClamYmd" column="PTAD_CLAM_YMD"/>
		<result property="ptadClbaYmd" column="PTAD_CLBA_YMD"/>
		<result property="paclYmd" column="PACL_YMD"/>
		<result property="rcstCd" column="RCST_CD"/>
		<result property="rpntId" column="RPNT_ID"/>
		<result property="rcpcDt" column="RCPC_DT"/>
		<result property="viaAdmsRcstCd" column="VIA_ADMS_RCST_CD"/>
		<result property="rdexCd" column="RDEX_CD"/>
		<result property="opsrId" column="OPSR_ID"/>
		<result property="cpdrId" column="CPDR_ID"/>
		<result property="endrId" column="ENDR_ID"/>
		<result property="exmnWntdDrId" column="EXMN_WNTD_DR_ID"/>
		<result property="wntdDt" column="WNTD_DT"/>
		<result property="exmnWntdYmdDvsnCd" column="EXMN_WNTD_YMD_DVSN_CD"/>
		<result property="nnmtExmnYn" column="NNMT_EXMN_YN"/>
		<result property="nnmtExmnNtfcYmd" column="NNMT_EXMN_NTFC_YMD"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="abcEnfrYmd" column="ABC_ENFR_YMD"/>
		<result property="abcMcdpCd" column="ABC_MCDP_CD"/>
		<result property="abcEfdpCd" column="ABC_EFDP_CD"/>
		<result property="abcOddrId" column="ABC_ODDR_ID"/>
		<result property="abcEndrId" column="ABC_ENDR_ID"/>
		<result property="vatTrgtYn" column="VAT_TRGT_YN"/>
		<result property="icuVsDsplYn" column="ICU_VS_DSPL_YN"/>
		<result property="cnntOrdrBndlNo" column="CNNT_ORDR_BNDL_NO"/>
		<result property="ordrValdStrtYmd" column="ORDR_VALD_STRT_YMD"/>
		<result property="ordrValdFnshYmd" column="ORDR_VALD_FNSH_YMD"/>
		<result property="implOrdrPblcNtm" column="IMPL_ORDR_PBLC_NTM"/>
		<result property="implOrdrPblcLmttNtm" column="IMPL_ORDR_PBLC_LMTT_NTM"/>
		<result property="orglOrdrYmd" column="ORGL_ORDR_YMD"/>
		<result property="orglOrdrSno" column="ORGL_ORDR_SNO"/>
		<result property="scexAdtnOrdvCd" column="SCEX_ADTN_ORDV_CD"/>
		<result property="befrSpcmNo" column="BEFR_SPCM_NO"/>
		<result property="exmnRefrDvsnCd" column="EXMN_REFR_DVSN_CD"/>
		<result property="refrLnknNo" column="REFR_LNKN_NO"/>
		<result property="durvYn" column="DURV_YN"/>
		<result property="durvResnCtn" column="DURV_RESN_CTN"/>
		<result property="durvOrdrYmd" column="DURV_ORDR_YMD"/>
		<result property="durvOrdrCd" column="DURV_ORDR_CD"/>
		<result property="excfCd" column="EXCF_CD"/>
		<result property="indrId1" column="INDR_ID1"/>
		<result property="indrId2" column="INDR_ID2"/>
		<result property="indrId3" column="INDR_ID3"/>
		<result property="spcmCd1" column="SPCM_CD1"/>
		<result property="spcmNeedQty1" column="SPCM_NEED_QTY1"/>
		<result property="spcnCd1" column="SPCN_CD1"/>
		<result property="spcnNeedCot1" column="SPCN_NEED_COT1"/>
		<result property="spcmCd2" column="SPCM_CD2"/>
		<result property="spcmNeedQty2" column="SPCM_NEED_QTY2"/>
		<result property="spcnCd2" column="SPCN_CD2"/>
		<result property="spcnNeedCot2" column="SPCN_NEED_COT2"/>
		<result property="spcmNo1" column="SPCM_NO1"/>
		<result property="spcmNo2" column="SPCM_NO2"/>
		<result property="exorPrssCd" column="EXOR_PRSS_CD"/>
		<result property="istpAdmnVlm" column="ISTP_ADMN_VLM"/>
		<result property="mdcrBeexYn" column="MDCR_BEEX_YN"/>
		<result property="anadYn" column="ANAD_YN"/>
		<result property="anggInrvDvsnCd" column="ANGG_INRV_DVSN_CD"/>
		<result property="prtbYn" column="PRTB_YN"/>
		<result property="acmpYn" column="ACMP_YN"/>
		<result property="blclExmnYn" column="BLCL_EXMN_YN"/>
		<result property="iodiMdteTsrYn" column="IODI_MDTE_TSR_YN"/>
		<result property="dxPthlAdorYn" column="DX_PTHL_ADOR_YN"/>
		<result property="brcdPrinYn" column="BRCD_PRIN_YN"/>
		<result property="brcdPnprId" column="BRCD_PNPR_ID"/>
		<result property="blclBrcdPrinDt" column="BLCL_BRCD_PRIN_DT"/>
		<result property="ordrApntDt" column="ORDR_APNT_DT"/>
		<result property="apntDt" column="APNT_DT"/>
		<result property="exrmRptnDt" column="EXRM_RPTN_DT"/>
		<result property="enfrDt" column="ENFR_DT"/>
		<result property="intrDt" column="INTR_DT"/>
		<result property="rprtDt" column="RPRT_DT"/>
		<result property="acimNursId" column="ACIM_NURS_ID"/>
		<result property="actnDt" column="ACTN_DT"/>
		<result property="acimInptDt" column="ACIM_INPT_DT"/>
		<result property="acimUpdtDt" column="ACIM_UPDT_DT"/>
		<result property="acimSpabCtn" column="ACIM_SPAB_CTN"/>
		<result property="acimCnfrCd" column="ACIM_CNFR_CD"/>
		<result property="actnLastCnfmId" column="ACTN_LAST_CNFM_ID"/>
		<result property="actnLastCnfrDt" column="ACTN_LAST_CNFR_DT"/>
		<result property="dschOrdrCasbCtn" column="DSCH_ORDR_CASB_CTN"/>
		<result property="dschOrdrExmnDt" column="DSCH_ORDR_EXMN_DT"/>
		<result property="pacsAccsNo" column="PACS_ACCS_NO"/>
		<result property="pacsTrdvCd" column="PACS_TRDV_CD"/>
		<result property="mdctPacsTrdvCd" column="MDCT_PACS_TRDV_CD"/>
		<result property="dadvCd" column="DADV_CD"/>
		<result property="hlscExmnYn" column="HLSC_EXMN_YN"/>
		<result property="endsPacsTrdvCd" column="ENDS_PACS_TRDV_CD"/>
		<result property="prvnInjcOrno" column="PRVN_INJC_ORNO"/>
		<result property="mdfeAplyYmd" column="MDFE_APLY_YMD"/>
		<result property="mriIpdvUpdtCd" column="MRI_IPDV_UPDT_CD"/>
		<result property="hlscApntNo" column="HLSC_APNT_NO"/>
		<result property="riskFctrVl" column="RISK_FCTR_VL"/>
		<result property="dytmWardUseWntdYn" column="DYTM_WARD_USE_WNTD_YN"/>
		<result property="endsChfrAmdrId" column="ENDS_CHFR_AMDR_ID"/>
		<result property="ordrValdPerdExptYmd" column="ORDR_VALD_PERD_EXPT_YMD"/>
		<result property="dspcNursAdjsBndlNo" column="DSPC_NURS_ADJS_BNDL_NO"/>
		<result property="dspcNursAdjsNo" column="DSPC_NURS_ADJS_NO"/>
		<result property="dspcNursAdjsBndlNm" column="DSPC_NURS_ADJS_BNDL_NM"/>
		<result property="dspcNursAdjsPtgoCtn" column="DSPC_NURS_ADJS_PTGO_CTN"/>
		<result property="exrsNtfcMthdDvsnCd" column="EXRS_NTFC_MTHD_DVSN_CD"/>
		<result property="imlnOrdrYn" column="IMLN_ORDR_YN"/>
		<result property="sspcScinNm" column="SSPC_SCIN_NM"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="ordrCrtnLnknNo" column="ORDR_CRTN_LNKN_NO"/>
		<result property="exmnApntMdrpNo" column="EXMN_APNT_MDRP_NO"/>
		<result property="ordrUpdtDt" column="ORDR_UPDT_DT"/>
		<result property="ordrUpdrId" column="ORDR_UPDR_ID"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="hmtpBsclRcpnRltnCd" column="HMTP_BSCL_RCPN_RLTN_CD"/>
		<result property="ultsSiteCd" column="ULTS_SITE_CD"/>
		<result property="sporBndlNm" column="SPOR_BNDL_NM"/>
		<result property="sporBndlNo" column="SPOR_BNDL_NO"/>
		<result property="cnclCnfrDt" column="CNCL_CNFR_DT"/>
		<result property="cnclCnnuId" column="CNCL_CNNU_ID"/>
		<result property="slpnYn" column="SLPN_YN"/>
		<result property="tdmCeckCtn" column="TDM_CECK_CTN"/>
		<result property="subTypeCd" column="SUB_TYPE_CD"/>
		<result property="scrgInpyOnbrRt" column="SCRG_INPY_ONBR_RT"/>
		<result property="insrOpnnCtn" column="INSR_OPNN_CTN"/>
		<result property="cnsnRltdYn" column="CNSN_RLTD_YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneMdexmordt (MDEXMORDT 처방KEY를 이용한 전체컬럼 조회) 
        Description :                                           MDEXMORDT 처방KEY를 이용한 전체컬럼 조회
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneMdexmordt-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneMdexmordt"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneMdexmordt-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneMdexmordt */
		        PTNO                     as PTNO
		     ,  to_char(ORDR_YMD,'YYYYMMDD') as ORDR_YMD
		     ,  ORDR_SNO                 as ORDR_SNO
		     ,  MDRP_NO                  as MDRP_NO
		     ,  PTAD_MDRP_NO             as PTAD_MDRP_NO
		     ,  ORDR_CD                  as ORDR_CD
		     ,  MCDP_CD                  as MCDP_CD
		     ,  ODDR_ID                  as ODDR_ID
		     ,  CHDR_ID                  as CHDR_ID
		     ,  GNDR_ID                  as GNDR_ID
		     ,  CODV_CD                  as CODV_CD
		     ,  PTAD_CODV_CD             as PTAD_CODV_CD
		     ,  ORDR_CLTY_CD             as ORDR_CLTY_CD
		     ,  ORCL_CD                  as ORCL_CD
		     ,  ODKI_CD                  as ODKI_CD
		     ,  ODKI_DETL_CD             as ODKI_DETL_CD
		     ,  ORFR_CD                  as ORFR_CD
		     ,  HSLC_DVSN_CD             as HSLC_DVSN_CD
		     ,  MCCN_CD                  as MCCN_CD
		     ,  WARD_CD                  as WARD_CD
		     ,  OROC_CD_OLD              as OROC_CD_OLD
		     ,  FRNS_DPRT_CD             as FRNS_DPRT_CD
		     ,  SLIP_CD                  as SLIP_CD
		     ,  CARE_STTS_CD             as CARE_STTS_CD
		     ,  RTRN_STTS_CD             as RTRN_STTS_CD
		     ,  to_char (RTRN_RQST_DT, 'YYYYMMDDhh24miss') as RTRN_RQST_DT
		     ,  RTRN_RQPR_ID             as RTRN_RQPR_ID
		     ,  EXMN_RTRE_CD             as EXMN_RTRE_CD
		     ,  RTRN_SPSB_CTN            as RTRN_SPSB_CTN
		     ,  ADTN_ORDV_CD             as ADTN_ORDV_CD
		     ,  RGOR_FNDR_ID             as RGOR_FNDR_ID
		     ,  to_char (RGOR_FINS_DT, 'YYYYMMDDhh24miss') as RGOR_FINS_DT
		     ,  ORCN_NURS_ID             as ORCN_NURS_ID
		     ,  to_char (ORCN_DT, 'YYYYMMDDhh24miss') as ORCN_DT
		     ,  TMPR_ORDR_YN             as TMPR_ORDR_YN
		     ,  DC_DVSN_CD               as DC_DVSN_CD
		     ,  DC_ODDR_ID               as DC_ODDR_ID
		     ,  to_char (DC_ORDR_DT, 'YYYYMMDDhh24miss') as DC_ORDR_DT
		     ,  DC_CNNU_ID               as DC_CNNU_ID
		     ,  to_char (DC_CNFR_DT, 'YYYYMMDDhh24miss') as DC_CNFR_DT
		     ,  SORT_SQNC                as SORT_SQNC
		     ,  EXOR_UNSL_CTN            as EXOR_UNSL_CTN
		     ,  INPT_USER_DVSN_CD        as INPT_USER_DVSN_CD
		     ,  CRTF_DVSN_CD             as CRTF_DVSN_CD
		     ,  ATHN_ID                  as ATHN_ID
		     ,  CRTF_IP                  as CRTF_IP
		     ,  to_char (CRTF_DT, 'YYYYMMDDhh24miss') as CRTF_DT
		     ,  CLRS_PRJC_CD             as CLRS_PRJC_CD
		     ,  CLRS_PRJC_DR_ID          as CLRS_PRJC_DR_ID
		     ,  to_char(OPRT_YMD,'YYYYMMDD') as OPRT_YMD
		     ,  OPRT_SNO                 as OPRT_SNO
		     ,  ITRN_BSDV_CD             as ITRN_BSDV_CD
		     ,  SRRQ_CMNT_CTN            as SRRQ_CMNT_CTN
		     ,  ORDR_IPDV_CD             as ORDR_IPDV_CD
		     ,  PTAD_IPDV_CD             as PTAD_IPDV_CD
		     ,  ISTY_CD                  as ISTY_CD
		     ,  ISTY_ASST_CD             as ISTY_ASST_CD
		     ,  CNPL_CD                  as CNPL_CD
		     ,  to_char(PTAD_CLAM_YMD,'YYYYMMDD') as PTAD_CLAM_YMD
		     ,  to_char(PTAD_CLBA_YMD,'YYYYMMDD') as PTAD_CLBA_YMD
		     ,  to_char(PACL_YMD,'YYYYMMDD') as PACL_YMD
		     ,  RCST_CD                  as RCST_CD
		     ,  RPNT_ID                  as RPNT_ID
		     ,  to_char (RCPC_DT, 'YYYYMMDDhh24miss') as RCPC_DT
		     ,  VIA_ADMS_RCST_CD         as VIA_ADMS_RCST_CD
		     ,  RDEX_CD                  as RDEX_CD
		     ,  OPSR_ID                  as OPSR_ID
		     ,  CPDR_ID                  as CPDR_ID
		     ,  ENDR_ID                  as ENDR_ID
		     ,  EXMN_WNTD_DR_ID          as EXMN_WNTD_DR_ID
		     ,  to_char (WNTD_DT, 'YYYYMMDDhh24miss') as WNTD_DT
		     ,  EXMN_WNTD_YMD_DVSN_CD    as EXMN_WNTD_YMD_DVSN_CD
		     ,  NNMT_EXMN_YN             as NNMT_EXMN_YN
		     ,  to_char(NNMT_EXMN_NTFC_YMD,'YYYYMMDD') as NNMT_EXMN_NTFC_YMD
		     ,  PTPT_CD                  as PTPT_CD
		     ,  to_char(ABC_ENFR_YMD,'YYYYMMDD') as ABC_ENFR_YMD
		     ,  ABC_MCDP_CD              as ABC_MCDP_CD
		     ,  ABC_EFDP_CD              as ABC_EFDP_CD
		     ,  ABC_ODDR_ID              as ABC_ODDR_ID
		     ,  ABC_ENDR_ID              as ABC_ENDR_ID
		     ,  VAT_TRGT_YN              as VAT_TRGT_YN
		     ,  ICU_VS_DSPL_YN           as ICU_VS_DSPL_YN
		     ,  CNNT_ORDR_BNDL_NO        as CNNT_ORDR_BNDL_NO
		     ,  to_char(ORDR_VALD_STRT_YMD,'YYYYMMDD') as ORDR_VALD_STRT_YMD
		     ,  to_char(ORDR_VALD_FNSH_YMD,'YYYYMMDD') as ORDR_VALD_FNSH_YMD
		     ,  IMPL_ORDR_PBLC_NTM       as IMPL_ORDR_PBLC_NTM
		     ,  IMPL_ORDR_PBLC_LMTT_NTM  as IMPL_ORDR_PBLC_LMTT_NTM
		     ,  to_char(ORGL_ORDR_YMD,'YYYYMMDD') as ORGL_ORDR_YMD
		     ,  ORGL_ORDR_SNO            as ORGL_ORDR_SNO
		     ,  SCEX_ADTN_ORDV_CD        as SCEX_ADTN_ORDV_CD
		     ,  BEFR_SPCM_NO             as BEFR_SPCM_NO
		     ,  EXMN_REFR_DVSN_CD        as EXMN_REFR_DVSN_CD
		     ,  REFR_LNKN_NO             as REFR_LNKN_NO
		     ,  DURV_YN                  as DURV_YN
		     ,  DURV_RESN_CTN            as DURV_RESN_CTN
		     ,  to_char(DURV_ORDR_YMD,'YYYYMMDD') as DURV_ORDR_YMD
		     ,  DURV_ORDR_CD             as DURV_ORDR_CD
		     ,  EXCF_CD                  as EXCF_CD
		     ,  INDR_ID1                 as INDR_ID1
		     ,  INDR_ID2                 as INDR_ID2
		     ,  INDR_ID3                 as INDR_ID3
		     ,  SPCM_CD1                 as SPCM_CD1
		     ,  SPCM_NEED_QTY1           as SPCM_NEED_QTY1
		     ,  SPCN_CD1                 as SPCN_CD1
		     ,  SPCN_NEED_COT1           as SPCN_NEED_COT1
		     ,  SPCM_CD2                 as SPCM_CD2
		     ,  SPCM_NEED_QTY2           as SPCM_NEED_QTY2
		     ,  SPCN_CD2                 as SPCN_CD2
		     ,  SPCN_NEED_COT2           as SPCN_NEED_COT2
		     ,  SPCM_NO1                 as SPCM_NO1
		     ,  SPCM_NO2                 as SPCM_NO2
		     ,  EXOR_PRSS_CD             as EXOR_PRSS_CD
		     ,  ISTP_ADMN_VLM            as ISTP_ADMN_VLM
		     ,  MDCR_BEEX_YN             as MDCR_BEEX_YN
		     ,  ANAD_YN                  as ANAD_YN
		     ,  ANGG_INRV_DVSN_CD        as ANGG_INRV_DVSN_CD
		     ,  PRTB_YN                  as PRTB_YN
		     ,  ACMP_YN                  as ACMP_YN
		     ,  BLCL_EXMN_YN             as BLCL_EXMN_YN
		     ,  IODI_MDTE_TSR_YN         as IODI_MDTE_TSR_YN
		     ,  DX_PTHL_ADOR_YN          as DX_PTHL_ADOR_YN
		     ,  BRCD_PRIN_YN             as BRCD_PRIN_YN
		     ,  BRCD_PNPR_ID             as BRCD_PNPR_ID
		     ,  to_char (BLCL_BRCD_PRIN_DT, 'YYYYMMDDhh24miss') as BLCL_BRCD_PRIN_DT
		     ,  to_char (ORDR_APNT_DT, 'YYYYMMDDhh24miss') as ORDR_APNT_DT
		     ,  to_char (APNT_DT, 'YYYYMMDDhh24miss') as APNT_DT
		     ,  to_char (EXRM_RPTN_DT, 'YYYYMMDDhh24miss') as EXRM_RPTN_DT
		     ,  to_char (ENFR_DT, 'YYYYMMDDhh24miss') as ENFR_DT
		     ,  to_char (INTR_DT, 'YYYYMMDDhh24miss') as INTR_DT
		     ,  to_char (RPRT_DT, 'YYYYMMDDhh24miss') as RPRT_DT
		     ,  ACIM_NURS_ID             as ACIM_NURS_ID
		     ,  to_char (ACTN_DT, 'YYYYMMDDhh24miss') as ACTN_DT
		     ,  to_char (ACIM_INPT_DT, 'YYYYMMDDhh24miss') as ACIM_INPT_DT
		     ,  to_char (ACIM_UPDT_DT, 'YYYYMMDDhh24miss') as ACIM_UPDT_DT
		     ,  ACIM_SPAB_CTN            as ACIM_SPAB_CTN
		     ,  ACIM_CNFR_CD             as ACIM_CNFR_CD
		     ,  ACTN_LAST_CNFM_ID        as ACTN_LAST_CNFM_ID
		     ,  to_char (ACTN_LAST_CNFR_DT, 'YYYYMMDDhh24miss') as ACTN_LAST_CNFR_DT
		     ,  DSCH_ORDR_CASB_CTN       as DSCH_ORDR_CASB_CTN
		     ,  to_char (DSCH_ORDR_EXMN_DT, 'YYYYMMDDhh24miss') as DSCH_ORDR_EXMN_DT
		     ,  PACS_ACCS_NO             as PACS_ACCS_NO
		     ,  PACS_TRDV_CD             as PACS_TRDV_CD
		     ,  MDCT_PACS_TRDV_CD        as MDCT_PACS_TRDV_CD
		     ,  DADV_CD                  as DADV_CD
		     ,  HLSC_EXMN_YN             as HLSC_EXMN_YN
		     ,  ENDS_PACS_TRDV_CD        as ENDS_PACS_TRDV_CD
		     ,  PRVN_INJC_ORNO           as PRVN_INJC_ORNO
		     ,  to_char(MDFE_APLY_YMD,'YYYYMMDD') as MDFE_APLY_YMD
		     ,  MRI_IPDV_UPDT_CD         as MRI_IPDV_UPDT_CD
		     ,  HLSC_APNT_NO             as HLSC_APNT_NO
		     ,  RISK_FCTR_VL             as RISK_FCTR_VL
		     ,  DYTM_WARD_USE_WNTD_YN    as DYTM_WARD_USE_WNTD_YN
		     ,  ENDS_CHFR_AMDR_ID        as ENDS_CHFR_AMDR_ID
		     ,  to_char(ORDR_VALD_PERD_EXPT_YMD,'YYYYMMDD') as ORDR_VALD_PERD_EXPT_YMD
		     ,  DSPC_NURS_ADJS_BNDL_NO   as DSPC_NURS_ADJS_BNDL_NO
		     ,  DSPC_NURS_ADJS_NO        as DSPC_NURS_ADJS_NO
		     ,  DSPC_NURS_ADJS_BNDL_NM   as DSPC_NURS_ADJS_BNDL_NM
		     ,  DSPC_NURS_ADJS_PTGO_CTN  as DSPC_NURS_ADJS_PTGO_CTN
		     ,  EXRS_NTFC_MTHD_DVSN_CD   as EXRS_NTFC_MTHD_DVSN_CD
		     ,  IMLN_ORDR_YN             as IMLN_ORDR_YN
		     ,  SSPC_SCIN_NM             as SSPC_SCIN_NM
		     ,  ORDR_CRTN_DVSN_CD        as ORDR_CRTN_DVSN_CD
		     ,  ORDR_CRTN_LNKN_NO        as ORDR_CRTN_LNKN_NO
		     ,  EXMN_APNT_MDRP_NO        as EXMN_APNT_MDRP_NO
		     ,  to_char (ORDR_UPDT_DT, 'YYYYMMDDhh24miss') as ORDR_UPDT_DT
		     ,  ORDR_UPDR_ID             as ORDR_UPDR_ID
		     ,  OROC_DPRT_CD             as OROC_DPRT_CD
		     ,  HMTP_BSCL_RCPN_RLTN_CD as HMTP_BSCL_RCPN_RLTN_CD
		     ,  ULTS_SITE_CD                     as ULTS_SITE_CD
		     ,  SPOR_BNDL_NM
		     ,  SPOR_BNDL_NO
		     ,  to_char(CNCL_CNFR_DT, 'yyyymmddhh24miss') as CNCL_CNFR_DT
		     ,  CNCL_CNNU_ID
		     ,  SLPN_YN
		     ,  TDM_CECK_CTN
		     ,  SUB_TYPE_CD
		     ,  SCRG_INPY_ONBR_RT
		     ,  INSR_OPNN_CTN            as INSR_OPNN_CTN
		     ,  CNSN_RLTD_YN
		  from  MDEXMORDT
		 where  PTNO = #{ptno}
		   and  ORDR_YMD = to_date (#{ordrYmd},'YYYYMMDD')
		   and  ORDR_SNO = #{ordrSno}
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPthlScndOrdr-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="spcmCd1" column="SPCM_CD1"/>
		<result property="spcmCd2" column="SPCM_CD2"/>
		<result property="spcmNeedQty1" column="SPCM_NEED_QTY1"/>
		<result property="spcmNeedQty2" column="SPCM_NEED_QTY2"/>
		<result property="spcnCd1" column="SPCN_CD1"/>
		<result property="spcnCd2" column="SPCN_CD2"/>
		<result property="spcnNeedCot1" column="SPCN_NEED_COT1"/>
		<result property="spcnNeedCot2" column="SPCN_NEED_COT2"/>
		<result property="excfCd" column="EXCF_CD"/>
		<result property="blclExmnYn" column="BLCL_EXMN_YN"/>
		<result property="acmpYn" column="ACMP_YN"/>
		<result property="mdcrBeexYn" column="MDCR_BEEX_YN"/>
		<result property="mvmnDvsnCd" column="MVMN_DVSN_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPthlScndOrdr (진단병리2차처방상세정보 조회) 
        Description :                                           진단병리2차처방상세정보 조회 mdd_ordrcmt_l20
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPthlScndOrdr-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPthlScndOrdr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPthlScndOrdr-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-listPthlScndOrdr */
		        decode(b.INSR_IPDV_CD, '1', decode(b.INSR_BTTY_CD, 'C', a.ORDR_NM||'" 기준外 100/100가능】', a.ORDR_NM)
		                             , '3', decode(b.INSR_BTTY_CD, 'E', decode(a.ORDR_CD, 'BL5241', a.ORDR_NM  /* 3E중 제외코드 */
		                                                                                , 'BL5242', a.ORDR_NM  /* 3E중 제외코드 */
		                                                                                , 'BL5243', a.ORDR_NM  /* 3E중 제외코드 */
		                                                                                ,  a.ORDR_NM||'"기준內 보험가능】')
		                                                         , 'D', decode(a.ORCL_CD, 'DG1', a.ORDR_NM||'"기준內 보험가능】'
		                                                                                , 'IJ1', a.ORDR_NM||'"기준內 보험가능】'
		                                                                                ,  a.ORDR_NM)
		                                                         , a.ORDR_NM)
		                             , '2', decode(b.INSR_BTTY_CD, 'X', decode(a.ORCL_CD, 'MAT', a.ORDR_NM||'"무산정가】', a.ORDR_NM)
		                                                         , 'T', a.ORDR_NM
		                                                         , a.ORDR_NM||'"비급여】')
		                             , '6', decode(b.INSR_BTTY_CD, 'E', a.ORDR_NM||'"기준內 보험가능】'
		                                                         , a.ORDR_NM)
		              )||decode(fn_sd_getkfdacategory_s(a.ORDR_CD), '2', '"임부금기 2등급】', '') as ORDR_NM
		     ,   a.ORCL_CD            /* 처방분류                                  */
		     ,   a.ORDR_CLTY_CD       /* 처방구별                                  */
		     ,   a.SLIP_CD            /* SLIP코드                                  */
		     /* ------ 환자가야할곳(주사,처치장소)------ */
		     ,  decode(a.EXCF_CD, 'SL', decode(#{ptptCd}, 'M', a.PTPT_CD
		                                               , 'C', a.CACN_PTPT_CD)
		                              , decode(nvl(#{ptptCd}, 'M'), 'M', decode(a.MNHS_EXMN_YN, 'Y', a.PTPT_CD, a.CACN_PTPT_CD)
		                                                         , 'C', decode(a.CACN_EXMN_YN, 'Y', a.CACN_PTPT_CD, a.PTPT_CD)
		                                                         , a.PTPT_CD)
		               ) as PTPT_CD
		     ,  a.SPCM_CD1             /* 검체코드1                                 */
		     ,  a.SPCM_CD2             /* 검체코드2                                 */
		     ,  a.SPCM_NEED_QTY1       /* 검체필요량1                               */
		     ,  a.SPCM_NEED_QTY2       /* 검체필요량2                               */
		     ,  a.SPCN_CD1             /* 검체용기코드1                             */
		     ,  a.SPCN_CD2             /* 검체용기코드2                             */
		     ,  a.SPCN_NEED_COT1       /* 검체용기1필요개수                         */
		     ,  a.SPCN_NEED_COT2       /* 검체용기2필요개수                         */
		     ,  a.EXCF_CD              /* 검사분류                                  */
		     ,  a.BLCL_EXMN_YN         /* 채혈검사여부                              */
		     ,  decode(substr(ORDR_CLTY_CD, 1, 1), 'B', CLNC_EXAM_DRUG_YN, a.ACMP_YN) as ACMP_YN /* 동반여부 약인경우에는 임상시험약여부 가져옴  2005.09.28 이은정        */
		     ,  a.MDCR_BEEX_YN         /* 진료전 검사여부                           */
		     ,  a.MVMN_DVSN_CD         /* PORTABLE(이동)여부                        */
		  from
		        MDORDRCMT a
		     ,  AIMFMDFET b
		 where
		        a.ORDR_CD = #{ordrCd}
		   and  a.ORDR_PSBL_DVSN_CD    = 'Y'
		   /* SLM 연구용처방 - 20100420YKC */
		   and  (
		                 (
		                  (nvl(#{mcdpCd}, 'X') != 'SLM')
		                   and  (nvl(a.EXCF_CD, 'X') not in ('CR', 'CT', 'GR'))
		                   and  (nvl(a.SLIP_CD, 'X') not in ('CRP', 'CTC', 'GRC'))
		                   and  (nvl(a.ORCL_CD, 'X') != 'SL1')
		                 )
		                 or
		                 (
		                  (nvl(#{mcdpCd}, 'X') = 'SLM')
		                 )
		        )
		   and  b.MDFE_CD = a.ORDR_CD
		   and  trunc(sysdate) between b.APST_YMD and b.APFN_YMD
		   and  b.ORDR_PSBL_YN    = 'Y'
		union
		select
		        a.ORDR_NM
		     ,  a.ORCL_CD          /* 처방분류                                  */
		     ,  a.ORDR_CLTY_CD     /* 처방구별                                  */
		     ,  a.SLIP_CD          /* SLIP코드                                  */
		     ,  a.PTPT_CD          /* 환자가야할곳                              */
		     ,  a.SPCM_CD1         /* 검체코드1                                 */
		     ,  a.SPCM_CD2         /* 검체코드2                                 */
		     ,  a.SPCM_NEED_QTY1   /* 검체필요량1                               */
		     ,  a.SPCM_NEED_QTY2   /* 검체필요량2                               */
		     ,  a.SPCN_CD1         /* 검체용기코드1                             */
		     ,  a.SPCN_CD2         /* 검체용기코드2                             */
		     ,  a.SPCN_NEED_COT1   /* 검체용기1필요개수                         */
		     ,  a.SPCN_NEED_COT2   /* 검체용기2필요개수                         */
		     ,  a.EXCF_CD          /* 검사분류                                  */
		     ,  a.BLCL_EXMN_YN     /* 채혈검사여부                             */
		     ,  decode(substr(a.ORDR_CLTY_CD, 1, 1), 'B', a.CLNC_EXAM_DRUG_YN, a.ACMP_YN) as ACMP_YN /* 동반여부 약인경우에는 임상시험약여부 가져옴  2005.09.28 이은정        */
		     ,  a.MDCR_BEEX_YN          /* 진료전 검사여부                           */
		     ,  a.MVMN_DVSN_CD          /* PORTABLE(이동)여부                        */
		  from
		        MDORDRCMT a
		 where  a.ORDR_CD = #{ordrCd}
		   and  a.ORDR_CLTY_CD = 'B9'
		   and  a.ORDR_CD like 'SELF%'
		   and  a.ORDR_PSBL_DVSN_CD = 'Y'
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneDschPntmLtstNnimExmnYn-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="yn" column="YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneDschPntmLtstNnimExmnYn (퇴원 시점 최근 미실시 검사 조회) 
        Description :                                           미실시된 검사리스트가 존재시 정리를 해야 퇴원처방을 발행 할 수 있다
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneDschPntmLtstNnimExmnYn-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneDschPntmLtstNnimExmnYn"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneDschPntmLtstNnimExmnYn-result" useCache="true" flushCache="false">
		<![CDATA[
		SELECT /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneDschPntmLtstNnimExmnYn */
		       case when count(*) > 0 then 'Y' else 'N'end as YN
		  from
					MDEXMORDT a
				 ,  MDORDRCMT b
				 ,  APRCRPTNT p -- 진료접수
		 where  1 = 1
		   and  a.PTNO     = #{ptno}
		   and  a.ORDR_YMD <= trunc(sysdate)
		   and  a.ORDR_YMD >= trunc(sysdate) - nvl((select x.MDCR_CTRL_NMBR_VL1
		                                              from mzctrlmmt x
		                                             where mdcr_ctrl_cd = 'MDP_843'
		                                               and mdcr_dtls_ctrl_cd = '2'), 2)
		   and  a.MDRP_NO  = #{mdrpNo}
		   and  a.DC_DVSN_CD = 'N'
		   and  nvl(a.ORFR_CD, 'Z') not in ('D', 'P')       /*  Done, PRN 제외    */
		   and  a.CODV_CD <> 'G'                            /*  건진처방 제외     */
		   and  a.TMPR_ORDR_YN = 'N'                        /*  임시처방 제외     */
		   and  a.EXRM_RPTN_DT is null                      /*  검사실 접수 일시  */
		   and  nvl(a.DSAF_PRGR_YN, 'N') <> 'Y'             /*  퇴원이후진행여부  */
		   and  a.ODKI_CD = 'G'
		   and  a.ORDR_CD  = b.ORDR_CD
		   and  p.MDRP_NO  = a.MDRP_NO
		   and  nvl(b.SCND_ORDR_YN, 'N') <> 'Y'
		   and  a.ORDR_CD not in (select EXMN_DTLS_CTRL_NM 
		                            from szctrlmmt
		                            where exmn_ctrl_cd = 'SFW_012' 
		                              and exmn_dtls_ctrl_cd = '1'   
		                         )  /* 종합검증검사코드 제외 */
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnWorkInfm-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="excfCd" column="EXCF_CD"/>
		<result property="exmnSttsCd" column="EXMN_STTS_CD"/>
		<result property="apntDt" column="APNT_DT"/>
		<result property="amprId" column="AMPR_ID"/>
		<result property="schdTypCd" column="SCHD_TYP_CD"/>
		<result property="schdDtlsTypCd" column="SCHD_DTLS_TYP_CD"/>
		<result property="mdreCtn" column="MDRE_CTN"/>
		<result property="andvCd" column="ANDV_CD"/>
		<result property="exmnAndvCd" column="EXMN_ANDV_CD"/>
		<result property="abrvDprtCd" column="ABRV_DPRT_CD"/>
		<result property="etcMdrpNo" column="ETC_MDRP_NO"/>
		<result property="ordrSttsCd" column="ORDR_STTS_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnWorkInfm (검사처방) 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnWorkInfm-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnWorkInfm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrExmnMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnWorkInfm-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrExmnMngmDAO-selectOneExmnWorkInfm */
		select PTNO
				     , to_char(ORDR_YMD, 'YYYYMMDD') as ORDR_YMD
				     , ORDR_SNO
				     , EXCF_CD
				     , ''  as EXMN_STTS_CD
				     , to_char(APNT_DT, 'yyyy-mm-dd hh24:mi') as APNT_DT
				     , AMPR_ID
				     , SCHD_TYP_CD
				     , SCHD_DTLS_TYP_CD
				     , '처방 DC'  as MDRE_CTN
				     , ANDV_CD
				     , EXMN_ANDV_CD
				     , ABRV_DPRT_CD
				     , ETC_MDRP_NO
				     , EXMN_STTS_CD as ORDR_STTS_CD
				  from SWWORKMMT
				 where PTNO      = #{ptno}
				  and  ORDR_YMD  = to_date(#{ordrYmd}, 'YYYYMMDD')
				  and  ORDR_SNO  = #{ordrSno}
	</select>



</mapper>