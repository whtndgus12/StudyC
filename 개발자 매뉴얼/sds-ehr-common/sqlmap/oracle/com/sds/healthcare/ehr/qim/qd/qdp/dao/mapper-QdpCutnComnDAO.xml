<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_QdpCutnComnDAO_sql.xml 
    Description :                                      감염 코션 공통 DAO
                  -->
<mapper namespace="QdpCutnComnDAO">


	<resultMap id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutnByPtnoComn0001-result" type="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ptntNm" column="PTNT_NM"/>
		<result property="infdCd" column="INFD_CD"/>
		<result property="infdCdNm" column="INFD_CD_NM"/>
		<result property="infdCdKornNm" column="INFD_CD_KORN_NM"/>
		<result property="cutnSgnRgstSno" column="CUTN_SGN_RGST_SNO"/>
		<result property="cutnSgnRgstDt" column="CUTN_SGN_RGST_DT"/>
		<result property="cutnSgnInptPathCd" column="CUTN_SGN_INPT_PATH_CD"/>
		<result property="detlCdNm1" column="DETL_CD_NM_1"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="userNm1" column="USER_NM_1"/>
		<result property="clno2" column="CLNO_2"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="userNm2" column="USER_NM_2"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="userNm3" column="USER_NM_3"/>
		<result property="clno3" column="CLNO_3"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="admsDt" column="ADMS_DT"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="abrvDprtCd1" column="ABRV_DPRT_CD_1"/>
		<result property="kornDprtNm1" column="KORN_DPRT_NM_1"/>
		<result property="ptrmNo" column="PTRM_NO"/>
		<result property="sckbNo" column="SCKB_NO"/>
		<result property="exrsCdNm" column="EXRS_CD_NM"/>
		<result property="infcMngmRomCnfmId" column="INFC_MNGM_ROM_CNFM_ID"/>
		<result property="userNm4" column="USER_NM_4"/>
		<result property="infcMngmRomCnfrIp" column="INFC_MNGM_ROM_CNFR_IP"/>
		<result property="infcMngmRomCnfrDt" column="INFC_MNGM_ROM_CNFR_DT"/>
		<result property="lastUpdrId" column="LAST_UPDR_ID"/>
		<result property="userNm5" column="USER_NM_5"/>
		<result property="lastUpdtIp" column="LAST_UPDT_IP"/>
		<result property="lastUpdtDt" column="LAST_UPDT_DT"/>
		<result property="spcmNo" column="SPCM_NO"/>
		<result property="spcmCd" column="SPCM_CD"/>
		<result property="spcmNm" column="SPCM_NM"/>
		<result property="rprtDt" column="RPRT_DT"/>
		<result property="exmnCd" column="EXMN_CD"/>
		<result property="exmnNm" column="EXMN_NM"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="abrvDprtCd2" column="ABRV_DPRT_CD_2"/>
		<result property="kornDprtNm2" column="KORN_DPRT_NM_2"/>
		<result property="mdrpYmd" column="MDRP_YMD"/>
		<result property="scinSno" column="SCIN_SNO"/>
		<result property="scinCd" column="SCIN_CD"/>
		<result property="mcrrRptnNo" column="MCRR_RPTN_NO"/>
		<result property="mcrrCd" column="MCRR_CD"/>
		<result property="antbCd" column="ANTB_CD"/>
		<result property="ptntClncDxSno" column="PTNT_CLNC_DX_SNO"/>
		<result property="chrcTrasYn" column="CHRC_TRAS_YN"/>
		<result property="chrcTrasDt" column="CHRC_TRAS_DT"/>
		<result property="notcTrasYn" column="NOTC_TRAS_YN"/>
		<result property="notcTrasDt" column="NOTC_TRAS_DT"/>
		<result property="cutnStrtYmd" column="CUTN_STRT_YMD"/>
		<result property="cutnReleYmd" column="CUTN_RELE_YMD"/>
		<result property="cutnInptPathCd" column="CUTN_INPT_PATH_CD"/>
		<result property="detlCdNm2" column="DETL_CD_NM_2"/>
		<result property="cutnReleDvsnCd" column="CUTN_RELE_DVSN_CD"/>
		<result property="detlCdNm3" column="DETL_CD_NM_3"/>
		<result property="cutnRlsrId" column="CUTN_RLSR_ID"/>
		<result property="userNm6" column="USER_NM_6"/>
		<result property="cutnReleIp" column="CUTN_RELE_IP"/>
		<result property="cutnReleDt" column="CUTN_RELE_DT"/>
		<result property="cutnRereCtn" column="CUTN_RERE_CTN"/>
		<result property="cutnReleCnreCtn" column="CUTN_RELE_CNRE_CTN"/>
		<result property="causInfdCd" column="CAUS_INFD_CD"/>
		<result property="causCutnStrtYmd" column="CAUS_CUTN_STRT_YMD"/>
		<result property="mngrCmntCtn" column="MNGR_CMNT_CTN"/>
		<result property="notcDt" column="NOTC_DT"/>
		<result property="rgsrDprtCd" column="RGSR_DPRT_CD"/>
		<result property="abrvDprtCd3" column="ABRV_DPRT_CD_3"/>
		<result property="kornDprtNm3" column="KORN_DPRT_NM_3"/>
		<result property="rlsrDprtCd" column="RLSR_DPRT_CD"/>
		<result property="abrvDprtCd4" column="ABRV_DPRT_CD_4"/>
		<result property="kornDprtNm4" column="KORN_DPRT_NM_4"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="unsbCtn" column="UNSB_CTN"/>
		<result property="yn1" column="YN_1"/>
		<result property="acmpAplyCutnInfdCd" column="ACMP_APLY_CUTN_INFD_CD"/>
		<result property="cutnInfdYn" column="CUTN_INFD_YN"/>
		<result property="mdroYn" column="MDRO_YN"/>
		<result property="isrmMndtYn" column="ISRM_MNDT_YN"/>
		<result property="npirUseYn" column="NPIR_USE_YN"/>
		<result property="catnCtn" column="CATN_CTN"/>
		<result property="rmrkCtn" column="RMRK_CTN"/>
		<result property="fnshBaseCtn" column="FNSH_BASE_CTN"/>
		<result property="edmrFileId" column="EDMR_FILE_ID"/>
		<result property="gideFileId" column="GIDE_FILE_ID"/>
		<result property="cutnRgstSmsrTrasYn" column="CUTN_RGST_SMSR_TRAS_YN"/>
		<result property="cutnRgstSmsrPhrsCtn" column="CUTN_RGST_SMSR_PHRS_CTN"/>
		<result property="sspcYn" column="SSPC_YN"/>
		<result property="lnknFndgInfdCd" column="LNKN_FNDG_INFD_CD"/>
		<result property="cutnRgstNotcTrasYn" column="CUTN_RGST_NOTC_TRAS_YN"/>
		<result property="cutnRgstNotcOddrTrasYn" column="CUTN_RGST_NOTC_ODDR_TRAS_YN"/>
		<result property="cutnRgstNotcGndrTrasYn" column="CUTN_RGST_NOTC_GNDR_TRAS_YN"/>
		<result property="cutnRgstNotcWardNursTrasYn" column="CUTN_RGST_NOTC_WARD_NURS_TRAS_YN"/>
		<result property="cutnRgstNotcRcvrId1" column="CUTN_RGST_NOTC_RCVR_ID_1"/>
		<result property="userNm7" column="USER_NM_7"/>
		<result property="clno4" column="CLNO_4"/>
		<result property="cutnRgstNotcRcvrId2" column="CUTN_RGST_NOTC_RCVR_ID_2"/>
		<result property="userNm8" column="USER_NM_8"/>
		<result property="clno5" column="CLNO_5"/>
		<result property="cutnRgstNotcRcvrId3" column="CUTN_RGST_NOTC_RCVR_ID_3"/>
		<result property="userNm9" column="USER_NM_9"/>
		<result property="clno6" column="CLNO_6"/>
		<result property="cutnRgstNotcTrasPhrsCtn" column="CUTN_RGST_NOTC_TRAS_PHRS_CTN"/>
		<result property="ordrYmd2" column="ORDR_YMD_2"/>
		<result property="ordrSno2" column="ORDR_SNO_2"/>
		<result property="exmnCd2" column="EXMN_CD_2"/>
		<result property="exmnNm2" column="EXMN_NM_2"/>
		<result property="spcmNo2" column="SPCM_NO_2"/>
		<result property="spcmCd2" column="SPCM_CD_2"/>
		<result property="spcmNm2" column="SPCM_NM_2"/>
		<result property="exrsFrmtCd2" column="EXRS_FRMT_CD_2"/>
		<result property="exrsNcvlVl2" column="EXRS_NCVL_VL_2"/>
		<result property="rprtDt2" column="RPRT_DT_2"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="abrvDprtCd5" column="ABRV_DPRT_CD_5"/>
		<result property="kornDprtNm5" column="KORN_DPRT_NM_5"/>
		<result property="gendCd" column="GEND_CD"/>
		<result property="ageVl" column="AGE_VL"/>
		<result property="rptnDt" column="RPTN_DT"/>
		<result property="detlCdNm4" column="DETL_CD_NM_4"/>
		<result property="frstRgsrId" column="FRST_RGSR_ID"/>
		<result property="userNm10" column="USER_NM_10"/>
		<result property="isltStrtYmd" column="ISLT_STRT_YMD"/>
		<result property="isltReleYmd" column="ISLT_RELE_YMD"/>
		<result property="rptnDt1" column="RPTN_DT_1"/>
		<result property="mcdpCd1" column="MCDP_CD_1"/>
		<result property="abrvDprtCd6" column="ABRV_DPRT_CD_6"/>
		<result property="kornDprtNm6" column="KORN_DPRT_NM_6"/>
		<result property="wardCd1" column="WARD_CD_1"/>
		<result property="abrvDprtCd7" column="ABRV_DPRT_CD_7"/>
		<result property="kornDprtNm7" column="KORN_DPRT_NM_7"/>
		<result property="ptrmNo1" column="PTRM_NO_1"/>
		<result property="sckbNo1" column="SCKB_NO_1"/>
		<result property="mccnCd1" column="MCCN_CD_1"/>
		<result property="abrvDprtCd8" column="ABRV_DPRT_CD_8"/>
		<result property="kornDprtNm8" column="KORN_DPRT_NM_8"/>
		<result property="mcdpCd2" column="MCDP_CD_2"/>
		<result property="abrvDprtCd9" column="ABRV_DPRT_CD_9"/>
		<result property="kornDprtNm9" column="KORN_DPRT_NM_9"/>
		<result property="wardCd2" column="WARD_CD_2"/>
		<result property="abrvDprtCd10" column="ABRV_DPRT_CD_10"/>
		<result property="kornDprtNm10" column="KORN_DPRT_NM_10"/>
		<result property="ptrmNo2" column="PTRM_NO_2"/>
		<result property="sckbNo2" column="SCKB_NO_2"/>
		<result property="mccnCd2" column="MCCN_CD_2"/>
		<result property="abrvDprtCd11" column="ABRV_DPRT_CD_11"/>
		<result property="kornDprtNm11" column="KORN_DPRT_NM_11"/>
		<result property="dschDt" column="DSCH_DT"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutnByPtnoComn0001 (코션 CAUTION 환자번호기준 조회) 
        Description :                                           코션 CAUTION 환자번호기준 조회
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
		resultMap : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutnByPtnoComn0001-result
    -->
	<select id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutnByPtnoComn0001"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  resultMap="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutnByPtnoComn0001-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutnByPtnoComn0001 */
		select  /*+ INDEX (m QDSINFMDT_PK) index(wok SFWWORKMT_PK ) INDEX(trtv.a APRCDTRTT_I10) INDEX(ord_O MDEXMORDT_I29) INDEX(trtv_o.a APRCDTRTT_I10) INDEX(islt QDSISLTMT_PK) qdd_sinfmdt_l03$S01_코션 CAUTION 환자번호기준 조회 dam*/
		       m.PTNO as PTNO
		     , ( select ptnt.PTNT_NM from APPTPTNTT ptnt where ptnt.PTNO = m.PTNO)  as PTNT_NM
		     , m.INFD_CD as INFD_CD
		     , decode(m.INFD_CD,'00019', a.INFD_CD_NM||' - '||substr(m.UNSB_CTN,1,400), a.INFD_CD_NM) as INFD_CD_NM /*  경고기타인 경우 특이사항을  */
		     , ( select  decode( m.INFD_CD,'00019', '기타', substr(f_b.str,0,length(f_b.STR)-1) )
		           from (
		                 select ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'A' and f_a.AIR_CATN_YN = 'Y')||
		                        ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'D' and f_a.DRPL_YN = 'Y')||
		                        ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'C' and f_a.CTCT_YN = 'Y')||
		                        ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'B' and f_a.BLOD_CATN_YN = 'Y')||
		                        ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'S' and f_a.BLOD_CATN_YN = 'Y')||
		                        ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'E' and f_a.INVR_ISLT_YN = 'Y') STR
		                       , f_a.INFD_CD
		                    from QDAINFDCT f_a
		                ) f_b
		          where  1=1
		            and f_b.INFD_CD = m.INFD_CD
		       )   as INFD_CD_KORN_NM
		     , c.CUTN_SGN_RGST_SNO as CUTN_SGN_RGST_SNO
		     , to_char(c.CUTN_SGN_RGST_DT,'yyyymmddhh24mi')    as CUTN_SGN_RGST_DT
		     , c.CUTN_SGN_INPT_PATH_CD as CUTN_SGN_INPT_PATH_CD
		     , ( select nvl(F_B.DETL_CD_NM, F_A.DETL_CD_NM)
		           from CCCMCDDMT F_A,CCCMCDDLT F_B
		          where F_A.COMN_GRP_CD = F_B.COMN_GRP_CD(+)
		            and F_A.COMN_DTLS_CD = F_B.COMN_DTLS_CD(+)
		            and F_A.COMN_GRP_CD = 'QDS_050'
		            and F_A.COMN_DTLS_CD =  c.CUTN_SGN_INPT_PATH_CD
		            and F_B.LNGG_CD(+) = nvl('', '*')
		       )   as DETL_CD_NM_1
		     , to_char(c.ORDR_YMD, 'yyyymmdd')  as ORDR_YMD
		     , c.ORDR_SNO as ORDR_SNO
		     , ord.ordr_cd as ORDR_CD
		     , ( select cmt.ORDR_NM from MDORDRCMT cmt where cmt.ORDR_CD = ord.ORDR_CD)  as ORDR_NM
		     , ord.ODDR_ID as ODDR_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = ord.ODDR_ID )  as USER_NM_1
		     , ( select  F_A.clno
		           from CCUSERAMT F_A
		              , CCUSRDPHT F_B
		          where  F_A.LGIN_ID = F_B.LGIN_ID
		            and F_A.CLNO is not null
		            and F_B.APFN_YMD = ( select to_date(IFMN_CTRL_CHRC_VL1,'yyyymmdd') from QDCTRLMMT where IFMN_CTRL_CD = 'CONST_VL' and IFMN_DETL_CTRL_VL = 'UNKNOWNDATE')
		            and rownum = 1
		            and F_B.user_id = ord.ODDR_ID
		       )  as CLNO_2
		     , ord.CHDR_ID as CHDR_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = ord.CHDR_ID )  as USER_NM_2
		     , nvl(ord.GNDR_ID, trtv.GNDR_ID)  as GNDR_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = nvl(ord.GNDR_ID, trtv.GNDR_ID) )  as USER_NM_3
		     , ( select  F_A.clno
		           from CCUSERAMT F_A
		              , CCUSRDPHT F_B
		          where  F_A.LGIN_ID = F_B.LGIN_ID
		            and F_A.CLNO is not null
		            and F_B.APFN_YMD = ( select to_date(IFMN_CTRL_CHRC_VL1,'yyyymmdd') from QDCTRLMMT where IFMN_CTRL_CD = 'CONST_VL' and IFMN_DETL_CTRL_VL = 'UNKNOWNDATE')
		            and rownum = 1
		            and F_B.user_id = nvl(ord.GNDR_ID, trtv.GNDR_ID)
		       )  as CLNO_3
		     , c.MDRP_NO as MDRP_NO
		     , ( select to_char(MDCR_DT,'yyyymmddhh24mi') from APRCRPTNT where MDRP_NO = c.MDRP_NO )  as ADMS_DT
		     , c.CODV_CD as CODV_CD
		     , decode (c.CODV_CD,'O','', c.WARD_CD)   as WARD_CD
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = c.WARD_CD and c.CODV_CD <![CDATA[<>]]> 'O' group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_1
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = c.WARD_CD and c.CODV_CD <![CDATA[<>]]> 'O' group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_1
		     , decode (c.CODV_CD,'O','', trtv.PTRM_NO)   as PTRM_NO
		     , decode (c.CODV_CD,'O','', trtv.SCKB_NO)   as SCKB_NO
		     , c.EXRS_CD_NM as EXRS_CD_NM
		     , c.INFC_MNGM_ROM_CNFM_ID as INFC_MNGM_ROM_CNFM_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = c.INFC_MNGM_ROM_CNFM_ID )  as USER_NM_4
		     , c.INFC_MNGM_ROM_CNFR_IP as INFC_MNGM_ROM_CNFR_IP
		     , to_char(c.INFC_MNGM_ROM_CNFR_DT, 'yyyymmddhh24mi')  as INFC_MNGM_ROM_CNFR_DT
		     , c.LAST_UPDR_ID as LAST_UPDR_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = c.LAST_UPDR_ID )   as USER_NM_5
		     , c.LAST_UPDT_IP as LAST_UPDT_IP
		     , to_char(c.LAST_UPDT_DT, 'yyyymmddhh24mi')   as LAST_UPDT_DT
		     , c.SPCM_NO as SPCM_NO
		     , wok.SPCM_CD as SPCM_CD
		     , ( select SPCM_NM from SFCSPCMCT where SPCM_CD = wok.SPCM_CD)  as SPCM_NM
		     , to_char(c.RPRT_DT, 'yyyymmddhh24mi')   as RPRT_DT
		     , c.EXMN_CD as EXMN_CD
		     , ( select cmt.ORDR_NM from MDORDRCMT cmt where cmt.ORDR_CD = c.EXMN_CD)  as EXMN_NM
		     , c.MCDP_CD as MCDP_CD
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = c.MCDP_CD group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_2
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = c.MCDP_CD group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_2
		     , to_char(c.MDRP_YMD,'yyyymmdd')   as MDRP_YMD
		     , c.SCIN_SNO as SCIN_SNO
		     , c.SCIN_CD as SCIN_CD
		     , c.MCRR_RPTN_NO as MCRR_RPTN_NO
		     , c.MCRR_CD as MCRR_CD
		     , c.ANTB_CD as ANTB_CD
		     , c.PTNT_CLNC_DX_SNO as PTNT_CLNC_DX_SNO
		     , c.CHRC_TRAS_YN as CHRC_TRAS_YN
		     , to_char(c.CHRC_TRAS_DT , 'yyyymmddhh24mi')  as CHRC_TRAS_DT
		     , c.NOTC_TRAS_YN as NOTC_TRAS_YN
		     , to_char(c.NOTC_TRAS_DT , 'yyyymmddhh24mi')  as NOTC_TRAS_DT
		     , to_char(m.CUTN_STRT_YMD , 'yyyymmdd')   as CUTN_STRT_YMD
		     , decode(to_char(m.CUTN_RELE_YMD , 'yyyymmdd') , '29991231' , null , to_char(m.CUTN_RELE_YMD , 'yyyymmdd'))   as CUTN_RELE_YMD
		     , m.CUTN_INPT_PATH_CD as CUTN_INPT_PATH_CD
		     , ( select nvl(F_B.DETL_CD_NM, F_A.DETL_CD_NM)
		           from CCCMCDDMT F_A,CCCMCDDLT F_B
		          where F_A.COMN_GRP_CD = F_B.COMN_GRP_CD(+)
		            and F_A.COMN_DTLS_CD = F_B.COMN_DTLS_CD(+)
		            and F_A.COMN_GRP_CD = 'QDS_051'
		            and F_A.COMN_DTLS_CD =  m.CUTN_INPT_PATH_CD
		            and F_B.LNGG_CD(+) = nvl('', '*')
		       )   as DETL_CD_NM_2
		     , m.CUTN_RELE_DVSN_CD   as CUTN_RELE_DVSN_CD
		     , ( select nvl(F_B.DETL_CD_NM, F_A.DETL_CD_NM)
		           from CCCMCDDMT F_A,CCCMCDDLT F_B
		          where F_A.COMN_GRP_CD = F_B.COMN_GRP_CD(+)
		            and F_A.COMN_DTLS_CD = F_B.COMN_DTLS_CD(+)
		            and F_A.COMN_GRP_CD = 'QDS_052'
		            and F_A.COMN_DTLS_CD =  m.CUTN_RELE_DVSN_CD
		            and F_B.LNGG_CD(+) = nvl('', '*')
		       )   as DETL_CD_NM_3
		     , m.CUTN_RLSR_ID as CUTN_RLSR_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = m.CUTN_RLSR_ID )   as USER_NM_6
		     , m.CUTN_RELE_IP as CUTN_RELE_IP
		     , decode(to_char(m.CUTN_RELE_DT , 'yyyymmddhh24mi') , '299912310000'  , null , to_char(m.CUTN_RELE_YMD , 'yyyymmddhh24mi'))  as CUTN_RELE_DT
		     , m.CUTN_RERE_CTN as CUTN_RERE_CTN
		     , m.CUTN_RELE_CNRE_CTN as CUTN_RELE_CNRE_CTN
		     , m.CAUS_INFD_CD as CAUS_INFD_CD
		     , to_char(m.CAUS_CUTN_STRT_YMD , 'yyyymmdd')   as CAUS_CUTN_STRT_YMD
		     , m.MNGR_CMNT_CTN as MNGR_CMNT_CTN
		     , to_char(m.NOTC_DT, 'yyyymmdd') as NOTC_DT
		     , m.RGSR_DPRT_CD as RGSR_DPRT_CD
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = m.RGSR_DPRT_CD group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_3
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = m.RGSR_DPRT_CD group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_3
		     , m.RLSR_DPRT_CD as RLSR_DPRT_CD
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = m.RLSR_DPRT_CD group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_4
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = m.RLSR_DPRT_CD group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_4
		     , to_char(m.APST_YMD, 'yyyymmdd') as APST_YMD
		     , m.UNSB_CTN as UNSB_CTN
		     , ( select 'Y' from DUAL where c.PTNO = m.PTNO and c.INFD_CD = m.INFD_CD and c.CUTN_SGN_RGST_SNO = m.CUTN_SGN_RGST_SNO   )  as YN_1
		     , a.ACMP_APLY_CUTN_INFD_CD as ACMP_APLY_CUTN_INFD_CD
		     , a.CUTN_INFD_YN as CUTN_INFD_YN
		     , a.MDRO_YN as MDRO_YN
		     , a.ISRM_MNDT_YN as ISRM_MNDT_YN
		     , a.NPIR_USE_YN as NPIR_USE_YN
		     , a.CATN_CTN as CATN_CTN
		     , a.RMRK_CTN as RMRK_CTN
		     , a.FNSH_BASE_CTN as FNSH_BASE_CTN
		     , a.EDMR_FILE_ID as EDMR_FILE_ID
		     , a.GIDE_FILE_ID as GIDE_FILE_ID
		     , a.CUTN_RGST_SMSR_TRAS_YN as CUTN_RGST_SMSR_TRAS_YN
		     , a.CUTN_RGST_SMSR_PHRS_CTN as CUTN_RGST_SMSR_PHRS_CTN
		     , a.SSPC_YN as SSPC_YN
		     , a.LNKN_FNDG_INFD_CD as LNKN_FNDG_INFD_CD
		     , a.CUTN_RGST_NOTC_TRAS_YN as CUTN_RGST_NOTC_TRAS_YN
		     , a.CUTN_RGST_NOTC_ODDR_TRAS_YN as CUTN_RGST_NOTC_ODDR_TRAS_YN
		     , a.CUTN_RGST_NOTC_GNDR_TRAS_YN as CUTN_RGST_NOTC_GNDR_TRAS_YN
		     , a.CUTN_RGST_NOTC_WARD_NURS_TRAS_YN as CUTN_RGST_NOTC_WARD_NURS_TRAS_YN
		     , a.CUTN_RGST_NOTC_RCVR_ID1 as CUTN_RGST_NOTC_RCVR_ID_1
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = a.CUTN_RGST_NOTC_RCVR_ID1 )  as USER_NM_7
		     , ( select  F_A.clno
		           from CCUSERAMT F_A
		              , CCUSRDPHT F_B
		          where  F_A.LGIN_ID = F_B.LGIN_ID
		            and F_A.CLNO is not null
		            and F_B.APFN_YMD = ( select to_date(IFMN_CTRL_CHRC_VL1,'yyyymmdd') from QDCTRLMMT where IFMN_CTRL_CD = 'CONST_VL' and IFMN_DETL_CTRL_VL = 'UNKNOWNDATE')
		            and rownum = 1
		            and F_B.user_id = a.CUTN_RGST_NOTC_RCVR_ID1
		       )  as CLNO_4
		     , a.CUTN_RGST_NOTC_RCVR_ID2 as CUTN_RGST_NOTC_RCVR_ID_2
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = a.CUTN_RGST_NOTC_RCVR_ID2 )  as USER_NM_8
		     , ( select  F_A.clno
		           from CCUSERAMT F_A
		              , CCUSRDPHT F_B
		          where  F_A.LGIN_ID = F_B.LGIN_ID
		            and F_A.CLNO is not null
		            and F_B.APFN_YMD = ( select to_date(IFMN_CTRL_CHRC_VL1,'yyyymmdd') from QDCTRLMMT where IFMN_CTRL_CD = 'CONST_VL' and IFMN_DETL_CTRL_VL = 'UNKNOWNDATE')
		            and rownum = 1
		            and F_B.user_id = a.CUTN_RGST_NOTC_RCVR_ID2
		       )  as CLNO_5
		     , a.CUTN_RGST_NOTC_RCVR_ID3 as CUTN_RGST_NOTC_RCVR_ID_3
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = a.CUTN_RGST_NOTC_RCVR_ID3 )  as USER_NM_9
		     , ( select  F_A.clno
		           from CCUSERAMT F_A
		              , CCUSRDPHT F_B
		          where  F_A.LGIN_ID = F_B.LGIN_ID
		            and F_A.CLNO is not null
		            and F_B.APFN_YMD = ( select to_date(IFMN_CTRL_CHRC_VL1,'yyyymmdd') from QDCTRLMMT where IFMN_CTRL_CD = 'CONST_VL' and IFMN_DETL_CTRL_VL = 'UNKNOWNDATE')
		            and rownum = 1
		            and F_B.user_id = a.CUTN_RGST_NOTC_RCVR_ID3
		       )  as CLNO_6
		     , a.CUTN_RGST_NOTC_TRAS_PHRS_CTN as CUTN_RGST_NOTC_TRAS_PHRS_CTN
		     /*  CPE 일때에는 CRGNB의 검사결과가 보여야 함. CPE 인 경우, 관련 CRGNB 검사 결과를 추가 컬럼에 보여준다.? (원발검사 처방일자, 원발검사 검사명, 원발검사 검체명, 원발검사 검사결과) - (검사상병 테이블을 자기 참조함)*/
		     , to_char(ord_o.ORDR_YMD,'YYYYMMDD')  as ORDR_YMD_2 /*  원발검사처방일자 */
		     , ord_o.ORDR_SNO  as ORDR_SNO_2
		     , ord_o.ordr_cd  as EXMN_CD_2
		     , ( select cmt.ORDR_NM from MDORDRCMT cmt where cmt.ORDR_CD = ord_o.ordr_cd)  as EXMN_NM_2
		     , ( select z.SPCM_NO
		           from SZRESULMT z
		          where z.PTNO = ord_o.PTNO
		            and z.ORDR_YMD = ord_o.ordr_ymd
		            and z.ORDR_SNO = ord_o.ordr_SNO
		            and z.EXMN_CD = ord_o.ordr_cd
		            and z.EXMN_PRSS_CD = 'G'
		            and rownum = 1
		       )  as SPCM_NO_2
		     , ( select  a.SPCM_CD
		           from SFWWORKMT a
		              , MDEXMORDT b
		          where  1=1
		            and a.PTNO = ord_o.PTNO
		            and a.ORDR_YMD = ord_o.ORDR_YMD
		            and a.ORDR_SNO = ord_o.ORDR_SNO
		            and a.ptno = b.ptno
		            and a.ordr_ymd = b.ordr_ymd
		            and a.ordr_sno = b.ordr_sno
		            and a.SPCM_NO = ( select  x.SPCM_NO
		                                from SZRESULMT x
		                               where  x.PTNO = a.PTNO
		                                 and x.ORDR_YMD = a.ordr_ymd
		                                 and x.ORDR_SNO = a.ordr_SNO
		                                 and x.EXMN_CD = b.ordr_cd
		                                 and x.EXMN_PRSS_CD = 'G'
		                                 and rownum = 1
		                            )
		            and a.EXMN_CD = ord_o.ordr_cd
		       )  as SPCM_CD_2
		     , ( select  c.SPCM_NM
		           from SFWWORKMT a
		              , MDEXMORDT b
		              , SFCSPCMCT c
		          where  1=1
		            and a.PTNO = ord_o.PTNO
		            and a.ORDR_YMD = ord_o.ORDR_YMD
		            and a.ORDR_SNO = ord_o.ORDR_SNO
		            and a.ptno = b.ptno
		            and a.ordr_ymd = b.ordr_ymd
		            and a.ordr_sno = b.ordr_sno
		            and a.SPCM_NO = ( select  x.SPCM_NO
		                                from SZRESULMT x
		                               where  x.PTNO = a.PTNO
		                                 and x.ORDR_YMD = a.ordr_ymd
		                                 and x.ORDR_SNO = a.ordr_SNO
		                                 and x.EXMN_CD = b.ordr_cd
		                                 and x.EXMN_PRSS_CD = 'G'
		                                 and rownum = 1
		                            )
		            and a.EXMN_CD = ord_o.ordr_cd
		            and a.SPCM_CD = c.SPCM_CD
		       )   as SPCM_NM_2
		     , ( select EXRS_FRMT_CD
		           from SZRESULMT z
		          where z.PTNO = ord_o.PTNO
		            and z.ORDR_YMD = ord_o.ordr_ymd
		            and z.ORDR_SNO = ord_o.ordr_SNO
		            and z.EXMN_CD = ord_o.ordr_cd
		            and z.EXMN_PRSS_CD = 'G'
		            and rownum = 1
		       ) as EXRS_FRMT_CD_2   /* ---------------------------------------------------*/
		     , ( select EXRS_NCVL_VL
		           from SZRESULMT z
		          where z.PTNO = ord_o.PTNO
		            and z.ORDR_YMD = ord_o.ordr_ymd
		            and z.ORDR_SNO = ord_o.ordr_SNO
		            and z.EXMN_CD = ord_o.ordr_cd
		            and z.EXMN_PRSS_CD = 'G'
		            and rownum = 1
		       ) as EXRS_NCVL_VL_2  /* ------------------------------------------------------*/
		     , ( select to_char(z.RPRT_DT , 'yyyymmddhh24miss')
		           from SZRESULMT z
		          where z.PTNO = ord_o.PTNO
		            and z.ORDR_YMD = ord_o.ordr_ymd
		            and z.ORDR_SNO = ord_o.ordr_SNO
		            and z.EXMN_CD = ord_o.ordr_cd
		            and z.EXMN_PRSS_CD = 'G'
		            and rownum = 1
		       ) as RPRT_DT_2
		     /* /////////////////////// */
		     /*  20160416 추가분 */
		     , trtv.MCCN_CD as MCCN_CD
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = trtv.MCCN_CD group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_5
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = trtv.MCCN_CD group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_5
		     , ptnt.GEND_CD as GEND_CD
		     , trunc(( trunc(sysdate) - ptnt.btdt ) / 365 )  as AGE_VL
		     , to_char(wok.RPTN_DT , 'yyyymmddhh24mi')  as RPTN_DT
		     , ( select nvl(F_B.DETL_CD_NM, F_A.DETL_CD_NM)
		           from CCCMCDDMT F_A,CCCMCDDLT F_B
		          where F_A.COMN_GRP_CD = F_B.COMN_GRP_CD(+)
		            and F_A.COMN_DTLS_CD = F_B.COMN_DTLS_CD(+)
		            and F_A.COMN_GRP_CD = 'AP025'   /*  내원구분코드 */
		            and F_A.COMN_DTLS_CD =  c.codv_cd
		            and F_B.LNGG_CD(+) = nvl('', '*')
		       )   as DETL_CD_NM_4
		     , m.FRST_RGSR_ID as FRST_RGSR_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = m.FRST_RGSR_ID )  as USER_NM_10
		     , to_char( islt.ISLT_STRT_YMD , 'yyyymmdd')    as ISLT_STRT_YMD
		     , decode( to_char( islt.ISLT_RELE_YMD , 'yyyymmdd') , '29991231' , null , to_char( islt.ISLT_RELE_YMD , 'yyyymmdd') )    as ISLT_RELE_YMD
		     , ( select  to_char(RPTN_DT , 'yyyymmddhh24mi')
		           from SFWWORKMT a
		              , MDEXMORDT b
		          where  1=1
		            and a.PTNO = ord_o.PTNO
		            and a.ORDR_YMD = ord_o.ORDR_YMD
		            and a.ORDR_SNO = ord_o.ORDR_SNO
		            and a.ptno = b.ptno
		            and a.ordr_ymd = b.ordr_ymd
		            and a.ordr_sno = b.ordr_sno
		            and a.SPCM_NO = ( select  x.SPCM_NO
		                                from SZRESULMT x
		                               where  x.PTNO = a.PTNO
		                                 and x.ORDR_YMD = a.ordr_ymd
		                                 and x.ORDR_SNO = a.ordr_SNO
		                                 and x.EXMN_CD = b.ordr_cd
		                                 and x.EXMN_PRSS_CD = 'G'
		                                 and rownum = 1
		                            )
		            and a.EXMN_CD = ord_o.ordr_cd
		       )  as RPTN_DT_1
		     , ord_o.MCDP_CD  as MCDP_CD_1
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = ord_o.MCDP_CD group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_6
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = ord_o.MCDP_CD group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_6
		     , decode (trtv_o.CODV_CD,'O','', ord_o.WARD_CD)   as WARD_CD_1
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = ord_o.WARD_CD and trtv_o.CODV_CD <![CDATA[<>]]> 'O' group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_7
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = ord_o.WARD_CD and trtv_o.CODV_CD <![CDATA[<>]]> 'O' group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_7
		     , decode (trtv_o.CODV_CD,'O','', trtv_o.PTRM_NO)   as PTRM_NO_1
		     , decode (trtv_o.CODV_CD,'O','', trtv_o.SCKB_NO)   as SCKB_NO_1
		     , ord_o.MCCN_CD as MCCN_CD_1
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = ord_o.MCCN_CD and trtv_o.CODV_CD <![CDATA[<>]]> 'O' group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_8
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = ord_o.MCCN_CD and trtv_o.CODV_CD <![CDATA[<>]]> 'O' group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_8
		     , trtv_2.MCDP_CD  as MCDP_CD_2
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = trtv_2.MCDP_CD  group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_9
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = trtv_2.MCDP_CD  group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_9
		     , trtv_2.WARD_CD  as WARD_CD_2
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = trtv_2.WARD_CD  group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_10
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = trtv_2.WARD_CD  group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_10
		     , trtv_2.ptrm_no  as PTRM_NO_2
		     , trtv_2.sckb_no   as SCKB_NO_2
		     , trtv_2.MCCN_CD  as MCCN_CD_2
		     , ( select F_A.ABRV_DPRT_CD from HZDEPTMMT F_A where F_A.DPRT_CD = trtv_2.MCCN_CD  group by F_A.ABRV_DPRT_CD )  as ABRV_DPRT_CD_11
		     , ( select F_A.KORN_DPRT_NM from HZDEPTMMT F_A where F_A.DPRT_CD = trtv_2.MCCN_CD  group by F_A.KORN_DPRT_NM )  as KORN_DPRT_NM_11
		     , ( select decode(to_char(DSCH_DT, 'yyyymmddhh24mi'), '299912310000',null, to_char(DSCH_DT, 'yyyymmddhh24mi')) from APRCRPTNT where MDRP_NO = c.MDRP_NO) as DSCH_DT
		     /*  20160416 추가분 끝 */
		  from QDSINFMDT m
		     , QDSINFCDT c
		     , QDAINFDCT a
		     , SFWWORKMT wok
		     , MDEXMORDT ord
		     , QDRCDTRTV trtv
		     /*       CPE_-&gt; CRGNB  */
		     , MDEXMORDT ord_x   /*  CPE로 등록된 처방 */
		     , MDEXMORDT ord_O   /*  CPE검사처방에 연결된 원처방 */
		     , QDRCDTRTV trtv_O  /*  원발검사 전과전실정보        */
		     /*       CPE_-&gt; CRGNB  */
		     /*  20160416 추가분 */
		     , APPTPTNTT ptnt
		     , QDSISLTMT islt
		     , QDRCDTRTV trtv_2 /* caution등록/해제시의 전과전실정보  */
		     /*  20160416 추가분 끝 */
		 where  1=1
		   and m.PTNO       = c.PTNO(+)
		   and m.INFD_CD    = c.INFD_CD(+)
		   and m.CUTN_SGN_RGST_SNO = c.CUTN_SGN_RGST_SNO(+)
		   and m.INFD_CD = a.INFD_CD
		   and c.PTNO = wok.PTNO (+)
		   and c.ORDR_YMD = wok.ORDR_YMD (+)
		   and c.ORDR_SNO = wok.ORDR_SNO (+)
		   and c.SPCM_NO = wok.SPCM_NO (+)
		   and c.EXMN_CD = wok.EXMN_CD (+)
		   and c.PTNO = ord.PTNO (+)
		   and c.ORDR_YMD = ord.ORDR_YMD (+)
		   and c.ORDR_SNO = ord.ORDR_SNO (+)
		   and c.MDRP_NO = trtv.MDRP_NO(+)
		   and c.ORDR_YMD <![CDATA[<=]]> trtv.APFN_YMD (+)
		   and c.ORDR_YMD <![CDATA[>=]]> trtv.APST_YMD (+)
		   /*       CPE_-&gt; CRGNB  */
		   and c.PTNO         = ord_x.ptno(+)
		   and c.ordr_ymd     = ord_x.ORDR_YMD(+)
		   and c.ordr_sno     = ord_x.ORDR_SNO(+)
		   and ord_x.ptno     = ord_o.ptno(+)
		   and ord_x.orgl_ordr_ymd = ord_o.ordr_ymd(+)
		   and ord_x.orgl_ordr_sno = ord_o.ordr_sno(+)
		   and ord_o.MDRP_NO  = trtv_O.MDRP_NO(+)
		   and ord_o.ORDR_YMD <![CDATA[<=]]> trtv_O.APFN_YMD (+)
		   and ord_o.ORDR_YMD <![CDATA[>=]]> trtv_O.APST_YMD (+)
		   /*       CPE_-&gt; CRGNB  */
		   /*  20160416 추가분 */
		   and m.PTNO = ptnt.PTNO
		   and m.PTNO = islt.PTNO(+)
		   and m.INFD_CD = islt.INFD_CD (+)
		   and m.CUTN_STRT_YMD = islt.CAUS_CUTN_STRT_YMD(+)
		   and m.ptno = trtv_2.ptno(+)
		   and trtv_2.codv_cd(+) = 'I'
		   and decode(m.CUTN_RELE_YMD, to_date('29991231','yyyymmdd') , m.CUTN_STRT_YMD, m.CUTN_RELE_YMD) <![CDATA[<=]]> trtv_2.APFN_YMD (+)
		   and decode(m.CUTN_RELE_YMD, to_date('29991231','yyyymmdd') , m.CUTN_STRT_YMD, m.CUTN_RELE_YMD) <![CDATA[>=]]> trtv_2.APST_YMD (+)
		   and m.CUTN_STRT_YMD <![CDATA[<=]]> trtv_2.APFN_YMD (+)
		   and m.CUTN_RELE_YMD <![CDATA[>=]]> trtv_2.APST_YMD (+)
		   and nvl(#{evntTypCd},'X') =  nvl(#{evntTypCd},'X')
		   /*  20160416 추가분 끝 */
		   and m.PTNO = #{ptno}
		   and (m.INFD_CD = #{infdCd} or #{infdCd} is null)
		   and (upper(c.EXRS_CD_NM) like '%'||upper(#{exrsCdNm})||'%' or #{exrsCdNm} is null)
		   and (m.CUTN_RELE_YMD = to_date(#{cutnReleYmd}, 'yyyymmdd') or #{cutnReleYmd} is null)
		   and (m.CUTN_RELE_YMD <![CDATA[<>]]> to_date(#{inqrFnshYmd}, 'yyyymmdd') or #{inqrFnshYmd} is null)
	</select>




	<resultMap id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCondComn01-result" type="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO">
	
		<result property="infdCd" column="INFD_CD"/>
		<result property="yn" column="YN"/>
		<result property="cutnSgnInptPathCd" column="CUTN_SGN_INPT_PATH_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCondComn01 (Caution 등록 조건 조회) 
        Description :                                           Caution 등록 조건 조회
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
		resultMap : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCondComn01-result
    -->
	<select id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCondComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  resultMap="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCondComn01-result" useCache="true" flushCache="false">
		<![CDATA[
		select /*+ SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCond01  index(a QDCTRLMMT_PK)  */
		                       IFMN_CTRL_CHRC_VL6 as INFD_CD,               /* 감염병 코드                */
		                       IFMN_CTRL_CHRC_VL8 as YN ,                      /* 자동Caution등록여부        */
		                       IFMN_CTRL_CHRC_VL5 as CUTN_SGN_INPT_PATH_CD     /* 입력구분                   */
		                  from QDCTRLMMT a
		                 where a.IFMN_CTRL_CD       = 'RESUL_CAUTION'
		                   and a.IFMN_CTRL_CHRC_VL1 = #{exmnCd}         /* 검사코드 */
		                   and (
		                         ((a.IFMN_CTRL_CHRC_VL7 = '1') and         /*Equal */
		                          (a.IFMN_CTRL_CHRC_VL2 = UPPER(SUBSTR(#{exrsNcvlVl}, 1, TO_NUMBER(a.IFMN_CTRL_CHRC_VL3))))  /* 검사결과(수치) */
		                         )
		                         or
		                         ((a.IFMN_CTRL_CHRC_VL7 = '2') and         /* Non Equal */
		                          (a.IFMN_CTRL_CHRC_VL2 <> UPPER(SUBSTR(#{exrsNcvlVl}, 1, TO_NUMBER(a.IFMN_CTRL_CHRC_VL3))))  /* 검사결과(수치) */
		                         )
		                         or
		                         ((a.IFMN_CTRL_CHRC_VL7 = '3') and         /* Like */
		                          (#{exrsNcvlVl} like '%'||a.IFMN_CTRL_CHRC_VL2||'%')  /* 검사결과(수치) */
		                         )or
				                ((a.IFMN_CTRL_CHRC_VL7 = '4') and         /*like 부등호 조건*/
				                 (#{exrsNcvlVl} >=  a.IFMN_CTRL_CHRC_VL2 )  /* 검사결과(수치) */
				                  )
		                       )
		                   and a.IFMN_CTRL_CHRC_VL4 = #{exmnPrssCd}  /* 검사진행상태코드 */
		                   and nvl(#{exrsUpdtYn},'N') = 'N'          /* 최종검사결과(결과수정여부 N) */
		                   and rownum <= 1
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnCntComn01-result" type="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO">
	
		<result property="nmbrVl" column="NMBR_VL"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnCntComn01 (Cutn징후(검사상병) 데이터 유무 단독 조회) 
        Description :                                           Cutn징후(검사상병) 데이터 유무 단독 조회
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
		resultMap : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnCntComn01-result
    -->
	<select id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnCntComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  resultMap="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnCntComn01-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnCntComn01 */
		select /*+ index(a QDSINFCDT_I07) */
		                           count(*) as NMBR_VL
		                      from QDSINFCDT a
		                     where a.PTNO     = #{ptno}
		                       and a.ORDR_YMD = to_date(#{ordrYmd}, 'yyyymmdd')
		                       and a.ORDR_SNO = #{ordrSno}
		                       and a.SPCM_NO  = #{spcmNo}
		                       and a.EXMN_CD  = #{exmnCd}
		                       and a.EXRS_CD_NM = #{exrsNcvlVl}
	</select>




	<resultMap id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnRgstSnoComn01-result" type="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO">
	
		<result property="cutnSgnRgstSno" column="CUTN_SGN_RGST_SNO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnRgstSnoComn01 (Caution 징후 등록일련번호 채번) 
        Description :                                           Caution 징후 등록일련번호 채번
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
		resultMap : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnRgstSnoComn01-result
    -->
	<select id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnRgstSnoComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  resultMap="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnRgstSnoComn01-result" useCache="true" flushCache="false">
		select /*+ SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnSgnRgstSno01 index(a QDSINFCDT_PK)  */
		          nvl(max(a.CUTN_SGN_RGST_SNO),0)+1 as CUTN_SGN_RGST_SNO
		  from QDSINFCDT a
		 where a.PTNO    = #{ptno}
		    and a.INFD_CD = #{infdCd}
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-insertCutnSgnComn01 (Caution징후 (검사상병) 입력) 
        Description :                                           Caution징후 (검사상병) 입력
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
    -->	
	<insert id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-insertCutnSgnComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-insertCutnSgnComn01 */
		insert into QDSINFCDT
		                     (
		                        PTNO                     /* 환자번호                        */
		                     ,  INFD_CD                  /* 감염성질병코드(Caution)         */
		                     ,  CUTN_SGN_RGST_SNO        /* CAUTION징후등록일련번호         */
		                     ,  CUTN_SGN_RGST_DT         /* CAUTION징후등록일시             */
		                     ,  CUTN_SGN_INPT_PATH_CD    /* CAUTION징후입력경로코드         */
		                     ,  ORDR_YMD                 /* 처방일자                        */
		                     ,  ORDR_SNO                 /* 처방일련번호                    */
		                     ,  MDRP_NO                  /* 진료접수번호                    */
		                     ,  CODV_CD                  /* 내원구분코드                    */
		                     ,  WARD_CD                  /* 병동코드                        */
		                     ,  EXRS_CD_NM               /* 검사결과                        */
		                     ,  SPCM_NO                  /* 검체번호                        */
		                     ,  RPRT_DT                  /* 보고일시                        */
		                     ,  EXMN_CD                  /* 검사코드                        */
		                     ,  MCDP_CD                  /* 진료과코드                      */
		                     ,  FRST_RGSR_ID             /* 최초등록자ID                    */
		                     ,  FRST_RGST_IP             /* 최초등록IP                      */
		                     ,  FRST_RGST_DT             /* 최초등록일시                    */
		                     ,  FRST_RGST_CLNT_PRGM_ID        /* 최초등록SMC클라이언트프로그램ID */
		                     ,  FRST_RGST_SRVR_PRGM_ID        /* 최초등록SMC서버프로그램ID       */
		                     ,  LAST_UPDR_ID             /* 최종수정자ID                    */
		                     ,  LAST_UPDT_IP             /* 최종수정IP                      */
		                     ,  LAST_UPDT_DT             /* 최종수정일시                    */
		                     ,  LAST_UPDT_CLNT_PRGM_ID        /* 최종수정SMC클라이언트프로그램ID */
		                     ,  LAST_UPDT_SRVR_PRGM_ID        /* 최종수정SMC서버프로그램ID       */
		                     )
		                     values
		                     (
		                        #{ptno}                           /* 환자번호                        */
		                     ,  #{infdCd}                        /* 감염성질병코드(Caution)         */
		                     ,  #{cutnSgnRgstSno}              /* CAUTION징후등록일련번호         */
		                     ,  sysdate                             /* CAUTION징후등록일시             */
		                     ,  #{cutnSgnInptPathCd}          /* CAUTION징후입력경로코드         */
		                     ,  to_date(#{ordrYmd}, 'yyyymmdd')                       /* 처방일자                        */
		                     ,  #{ordrSno}                       /* 처방일련번호                    */
		                     ,  #{mdrpNo}                        /* 진료접수번호                    */
		                     ,  #{codvCd}                        /* 내원구분코드                    */
		                     ,  #{wardCd}                        /* 병동코드                        */
		                     ,  #{exrsNcvlVl}                   /* 검사결과                        */
		                     ,  #{spcmNo}                        /* 검체번호                        */
		                     ,  to_date(#{rprtDt}, 'yyyymmddhh24mi')                        /* 보고일시                        */
		                     ,  #{exmnCd}                        /* 검사코드                        */
		                     ,  #{mcdpCd}                        /* 진료과코드                      */
		                     ,  '000000'                            /* 최초등록자ID                    */
		                     ,  'TRIGGER'                           /* 최초등록IP                      */
		                     ,  sysdate                             /* 최초등록일시                    */
		                     ,  'TR_RESULMT'                        /* 최초등록SMC클라이언트프로그램ID */
		                     ,  'TR_RESULMT'                        /* 최초등록SMC서버프로그램ID       */
		                     ,  '000000'                            /* 최종수정자ID                    */
		                     ,  'TRIGGER'                           /* 최종수정IP                      */
		                     ,  sysdate                             /* 최종수정일시                    */
		                     ,  'TR_RESULMT'                        /* 최종수정SMC클라이언트프로그램ID */
		                     ,  'TR_RESULMT'                        /* 최종수정SMC서버프로그램ID       */
		                     )
	</insert>


	<resultMap id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCntComn01-result" type="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO">
	
		<result property="nmbrVl" column="NMBR_VL"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCntComn01 (Caution 등록 여부 단독조회) 
        Description :                                           Caution 등록 여부 단독조회
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
		resultMap : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCntComn01-result
    -->
	<select id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCntComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  resultMap="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCntComn01-result" useCache="true" flushCache="false">
		select /*+ SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCntComn01 index(a QDSINFMDT_PK) */
		           COUNT(*)  as NMBR_VL   /*기존자료있는지 확인*/
		  from QDSINFMDT a
		where PTNO    = #{ptno}
		    and INFD_CD = #{infdCd}
		    and (CUTN_STRT_YMD = TRUNC(SYSDATE) OR CUTN_RELE_YMD = TO_DATE('29991231','yyyymmdd'))
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-insertCutnComn01 (Caution 등록) 
        Description :                                           Caution 등록
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
    -->	
	<insert id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-insertCutnComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  >
		INSERT /*+ SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-insertCutnComn01 */
		    INTO QDSINFMDT 
		                    (
		                       PTNO                                /* 환자번호                        */
		                    ,  INFD_CD                             /* 감염성질병코드(Caution)         */
		                    ,  CUTN_STRT_YMD                       /* 경고시작일자                    */
		                    ,  CUTN_RELE_YMD                       /* 경고종료일자                    */
		                    ,  CUTN_SGN_RGST_SNO                   /* CAUTION징후등록일련번호         */
		                    ,  CUTN_INPT_PATH_CD                   /* CAUTION입력경로코드             */
		                    ,  MDRP_NO                             /* 진료접수번호                    */                    
		                    ,  FRST_RGSR_ID                        /* 최초등록자ID                    */
		                    ,  FRST_RGST_IP                        /* 최초등록IP                      */
		                    ,  FRST_RGST_DT                        /* 최초등록일시                    */
		                    ,  FRST_RGST_CLNT_PRGM_ID                   /* 최초등록SMC클라이언트프로그램ID */
		                    ,  FRST_RGST_SRVR_PRGM_ID                   /* 최초등록SMC서버프로그램ID       */
		                    ,  LAST_UPDR_ID                        /* 최종수정자ID                    */
		                    ,  LAST_UPDT_IP                        /* 최종수정IP                      */
		                    ,  LAST_UPDT_DT                        /* 최종수정일시                    */
		                    ,  LAST_UPDT_CLNT_PRGM_ID                   /* 최종수정SMC클라이언트프로그램ID */
		                    ,  LAST_UPDT_SRVR_PRGM_ID                   /* 최종수정SMC서버프로그램ID       */
		                    )
		                    VALUES 
		                    (
		                       #{ptno}                             /* 환자번호                        */
		                    ,  #{infdCd}                           /* 감염성질병코드(Caution)         */
		                    ,  TRUNC(SYSDATE)                      /* 경고시작일자                    */
		                    ,  to_date('29991231','yyyymmdd')      /* 경고종료일자                    */
		                    ,  #{cutnSgnRgstSno}                   /* CAUTION징후등록일련번호         */
		                    ,  #{cutnSgnInptPathCd}                /* CAUTION입력경로코드             */
		                    ,  #{mdrpNo}                           /* 진료접수번호                    */                    
		                    ,  '000000'                            /* 최초등록자ID                    */
		                    ,  'TRIGGER'                           /* 최초등록IP                      */
		                    ,  sysdate                             /* 최초등록일시                    */
		                    ,  'TR_RESULMT'                        /* 최초등록SMC클라이언트프로그램ID */
		                    ,  'TR_RESULMT'                        /* 최초등록SMC서버프로그램ID       */
		                    ,  '000000'                            /* 최종수정자ID                    */
		                    ,  'TRIGGER'                           /* 최종수정IP                      */
		                    ,  sysdate                             /* 최종수정일시                    */
		                    ,  'TR_RESULMT'                        /* 최종수정SMC클라이언트프로그램ID */
		                    ,  'TR_RESULMT'                        /* 최종수정SMC서버프로그램ID       */
		                    )
	</insert>


	<resultMap id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnReleCondComn01-result" type="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO">
	
		<result property="cutnReleDvsnCd" column="CUTN_RELE_DVSN_CD"/>
		<result property="infdCd" column="INFD_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnReleCondComn01 (Caution 해제 조건 단독 조회) 
        Description :                                           Caution 해제 조건 단독 조회
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
		resultMap : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnReleCondComn01-result
    -->
	<select id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnReleCondComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  resultMap="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnReleCondComn01-result" useCache="true" flushCache="false">
		<![CDATA[
		select /*+ SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnReleCondComn01 index(a QDCTRLMMT_PK)  */
		                       IFMN_CTRL_CHRC_VL5 as CUTN_RELE_DVSN_CD,        /* 해제구분                   */
		                       IFMN_CTRL_CHRC_VL6 as INFD_CD                   /* 해제감염병 코드            */                                     
		                  from
		                       QDCTRLMMT a
		                 where
		                       a.IFMN_CTRL_CD      = 'RESUL_CAUTION_NE'
		                   and a.IFMN_CTRL_CHRC_VL1 = #{exmnCd} /* 검사코드 */
		                   and a.IFMN_CTRL_CHRC_VL8 = '1'  /* 검사결과*/
		                   and (
		                         ((a.IFMN_CTRL_CHRC_VL7 = '1') and         /* Equal    */
		                          (a.IFMN_CTRL_CHRC_VL2  = UPPER(SUBSTR(#{exrsNcvlVl}, 1, TO_NUMBER(a.IFMN_CTRL_CHRC_VL3))))  /* 검사결과(수치) */
		                         )or
		                         ((a.IFMN_CTRL_CHRC_VL7 = '2') and         /* Non Equal*/
		                          (a.IFMN_CTRL_CHRC_VL2 <> UPPER(SUBSTR(#{exrsNcvlVl}, 1, TO_NUMBER(a.IFMN_CTRL_CHRC_VL3))))  /* 검사결과(수치) */
		                         )
		                       )
		                   and a.IFMN_CTRL_CHRC_VL4 = #{exmnPrssCd}  /* 검사진행상태코드 */
		                   and nvl(#{exrsUpdtYn},'N') = 'N'          /* 최종검사결과(결과수정여부 N) */    
		                   and rownum <= 1
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCeckBefrReleComn01-result" type="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO">
	
		<result property="nmbrVl" column="NMBR_VL"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCeckBefrReleComn01 (Caution 해제전 체크) 
        Description :                                           Caution 해제전 체크
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
		resultMap : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCeckBefrReleComn01-result
    -->
	<select id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCeckBefrReleComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  resultMap="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCeckBefrReleComn01-result" useCache="true" flushCache="false">
		SELECT /*+ SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-selectOneCutnCeckBefrReleComn01 index(a QDSINFMDT_PK)  */
		           COUNT(*) as NMBR_VL           
		      FROM QDSINFMDT a
		                 WHERE PTNO = #{ptno}
		                   AND INFD_CD = #{infdCd}
		                   AND CUTN_RELE_YMD =  TO_DATE('29991231','yyyymmdd')
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-updateCutnReleComn01 (Caution 자동해제) 
        Description :                                           Caution 자동해제
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
    -->	
	<update id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-updateCutnReleComn01"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  >
		UPDATE /*+ SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-updateCutnReleComn01 */
		         QDSINFMDT a
		   SET a.CUTN_RELE_YMD = TRUNC(SYSDATE),
		       a.CUTN_RELE_DVSN_CD = #{cutnReleDvsnCd},
		       a.CUTN_RLSR_ID = '000000',
		       a.CUTN_RELE_IP = 'TRIGGER',                             
		       a.CUTN_RELE_DT = SYSDATE,
		       a.LAST_UPDR_ID = '000000',         /* 최종수정자ID                    */
		       a.LAST_UPDT_IP = 'TRIGGER',        /* 최종수정IP                      */
		       a.LAST_UPDT_DT = SYSDATE,          /* 최종수정일시                    */
		       a.LAST_UPDT_CLNT_PRGM_ID = 'TR_RESULMT', /* 최종수정SMC클라이언트프로그램ID */
		       a.LAST_UPDT_SRVR_PRGM_ID = 'TR_RESULMT'  /* 최종수정SMC서버프로그램ID       */
		 WHERE a.PTNO = #{ptno}
		   AND a.INFD_CD = #{infdCd}
		   AND a.CUTN_RELE_YMD = TO_DATE('29991231','yyyymmdd')
	</update>


	<resultMap id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutn0002-result" type="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ptntNm" column="PTNT_NM"/>
		<result property="infdCd" column="INFD_CD"/>
		<result property="infdCdNm" column="INFD_CD_NM"/>
		<result property="srngOptnCtn" column="SRNG_OPTN_CTN"/>
		<result property="cutnStrtYmd" column="CUTN_STRT_YMD"/>
		<result property="frstRgsrId" column="FRST_RGSR_ID"/>
		<result property="userNm1" column="USER_NM_1"/>
		<result property="cutnReleYmd" column="CUTN_RELE_YMD"/>
		<result property="isrmMndtYn" column="ISRM_MNDT_YN"/>
		<result property="isltStrtYmd" column="ISLT_STRT_YMD"/>
		<result property="isltReleYmd" column="ISLT_RELE_YMD"/>
		<result property="exmnCd" column="EXMN_CD"/>
		<result property="exmnNm" column="EXMN_NM"/>
		<result property="spcmNo" column="SPCM_NO"/>
		<result property="spcmCd" column="SPCM_CD"/>
		<result property="spcmNm" column="SPCM_NM"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="edmrFileId" column="EDMR_FILE_ID"/>
		<result property="gideFileId" column="GIDE_FILE_ID"/>
		<result property="fnshBaseCtn" column="FNSH_BASE_CTN"/>
		<result property="catnCtn" column="CATN_CTN"/>
		<result property="mngrCmntCtn" column="MNGR_CMNT_CTN"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="cutnInptPathCd" column="CUTN_INPT_PATH_CD"/>
		<result property="detlCdNm1" column="DETL_CD_NM_1"/>
		<result property="cutnReleDvsnCd" column="CUTN_RELE_DVSN_CD"/>
		<result property="detlCdNm2" column="DETL_CD_NM_2"/>
		<result property="cutnRlsrId" column="CUTN_RLSR_ID"/>
		<result property="userNm2" column="USER_NM_2"/>
		<result property="cutnReleCnreCtn" column="CUTN_RELE_CNRE_CTN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutn0002 (CAUTION등록 화면 환자CAUTION 조회) 
        Description :                                           CAUTION등록 화면 환자CAUTION 조회
                                            
		parameterType : com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO
		resultMap : com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutn0002-result
    -->
	<select id="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutn0002"  parameterType="com.sds.healthcare.ehr.qim.qd.qdp.vo.QdpCutnComnDVO"  resultMap="com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutn0002-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnComnDAO-listCutn0002 */
		select /*+ SQL_ID: com-sds-healthcare-ehr-qim-qd-qdp-dao-QdpCutnDAO-listCutn0002  qdd_sinfmdt_l31$S01_CAUTION등록 화면 환자CAUTION 조회 dam */
		       m.PTNO as PTNO
		     , ( select ptnt.PTNT_NM from APPTPTNTT ptnt where ptnt.PTNO = m.PTNO)  as PTNT_NM
		     , m.INFD_CD as INFD_CD
		     , decode(m.INFD_CD, '00019', substr(a.INFD_CD_NM||' - '||m.UNSB_CTN,1, 50)  ,a.INFD_CD_NM)  as INFD_CD_NM
		     , ( select  decode( m.INFD_CD,'00019', '기타', substr(f_b.str,0,length(f_b.STR)-1) )
		          from (
		               select ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'A' and f_a.AIR_CATN_YN = 'Y')||
		                      ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'D' and f_a.DRPL_YN = 'Y')||
		                      ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'C' and f_a.CTCT_YN = 'Y')||
		                      ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'B' and f_a.BLOD_CATN_YN = 'Y')||
		                      ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'S' and f_a.BLOD_CATN_YN = 'Y')||
		                      ( select IFMN_DETL_CTRL_NM||'+' from QDCTRLMMT where IFMN_CTRL_CD = 'INFD_DV_CD' and IFMN_DETL_CTRL_VL = 'E' and f_a.INVR_ISLT_YN = 'Y') STR
		                    , f_a.INFD_CD
		                 from QDAINFDCT f_a
		               ) f_b
		         where 1=1
		           and f_b.INFD_CD = m.INFD_CD
		       )   as SRNG_OPTN_CTN
		     , to_char(m.CUTN_STRT_YMD , 'yyyymmdd')  as CUTN_STRT_YMD
		     , m.FRST_RGSR_ID as FRST_RGSR_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = m.FRST_RGSR_ID )  as USER_NM_1
		     , to_char(m.CUTN_RELE_YMD , 'yyyymmdd')  as CUTN_RELE_YMD
		     , A.ISRM_MNDT_YN as ISRM_MNDT_YN
		     , decode(#{evntTypCd} , '1' , decode(I.ISLT_RELE_YMD , to_date('29991231', 'yyyymmdd') , to_char(i.ISLT_STRT_YMD , 'yyyymmdd') , '' ) , '')  as ISLT_STRT_YMD
		     , decode( to_char(i.ISLT_RELE_YMD , 'yyyymmdd'), '29991231', null , to_char(i.ISLT_RELE_YMD , 'yyyymmdd')  )  as ISLT_RELE_YMD
		     , c.EXMN_CD as EXMN_CD
		     , ( select cmt.ORDR_NM from MDORDRCMT cmt where cmt.ORDR_CD = c.EXMN_CD)  as EXMN_NM
		     , c.SPCM_NO as SPCM_NO
		     , w.SPCM_CD as SPCM_CD
		     , ( select SPCM_NM from SFCSPCMCT where SPCM_CD = w.SPCM_CD)  as SPCM_NM
		     , to_char( c.ORDR_YMD , 'yyyymmdd')  as ORDR_YMD
		     , a.EDMR_FILE_ID as EDMR_FILE_ID
		     , a.GIDE_FILE_ID as GIDE_FILE_ID
		     , a.FNSH_BASE_CTN as FNSH_BASE_CTN
		     , a.CATN_CTN as CATN_CTN
		     , m.MNGR_CMNT_CTN as MNGR_CMNT_CTN
		     , c.MDRP_NO as MDRP_NO
		     , c.CODV_CD as CODV_CD
		     , m.CUTN_INPT_PATH_CD as CUTN_INPT_PATH_CD
		     , ( select nvl(F_B.DETL_CD_NM, F_A.DETL_CD_NM)
		           from CCCMCDDMT F_A,CCCMCDDLT F_B
		          where F_A.COMN_GRP_CD = F_B.COMN_GRP_CD(+)
		            and F_A.COMN_DTLS_CD = F_B.COMN_DTLS_CD(+)
		            and F_A.COMN_GRP_CD = 'QDS_051'
		            and F_A.COMN_DTLS_CD =  m.CUTN_INPT_PATH_CD
		            and F_B.LNGG_CD(+) = nvl('', '*')
		       )   as DETL_CD_NM_1
		     , m.CUTN_RELE_DVSN_CD   as CUTN_RELE_DVSN_CD
		     , ( select nvl(F_B.DETL_CD_NM, F_A.DETL_CD_NM)
		           from CCCMCDDMT F_A,CCCMCDDLT F_B
		          where F_A.COMN_GRP_CD = F_B.COMN_GRP_CD(+)
		            and F_A.COMN_DTLS_CD = F_B.COMN_DTLS_CD(+)
		            and F_A.COMN_GRP_CD = 'QDS_052'
		            and F_A.COMN_DTLS_CD =  m.CUTN_RELE_DVSN_CD
		            and F_B.LNGG_CD(+) = nvl('', '*')
		       )   as DETL_CD_NM_2
		     , m.CUTN_RLSR_ID as CUTN_RLSR_ID
		     , ( select F_A.USER_NM from CCUSRDPHT F_A where F_A.USER_ID = m.CUTN_RLSR_ID )   as USER_NM_2
		     , m.CUTN_RELE_CNRE_CTN as CUTN_RELE_CNRE_CTN
		  from QDSINFMDT m
		     , QDAINFDCT a
		     , ( select p.*
		           from QDSISLTMT p
		          where 1=1
		            and p.ptno = #{ptno}
		            and p.islt_rele_ymd = ( select max(islt_rele_ymd)
		                                      from QDSISLTMT
		                                     where ptno = #{ptno}
		                                       and infd_cd = p.infd_cd
		                                       and nvl(CAUS_CUTN_STRT_YMD,trunc(sysdate)) = nvl(p.CAUS_CUTN_STRT_YMD , trunc(sysdate))
		                                  )
		       ) i
		     , QDSINFCDT c
		     , SFWWORKMT w
		 where 1=1
		   and m.INFD_CD = a.INFD_CD(+)
		   and m.PTNO = i.PTNO(+)
		   and m.INFD_CD = i.INFD_CD (+)
		   and m.CUTN_STRT_YMD = I.CAUS_CUTN_STRT_YMD(+)
		   and m.PTNO = c.PTNO(+)
		   and m.INFD_CD    = c.INFD_CD(+)
		   and m.CUTN_SGN_RGST_SNO = c.CUTN_SGN_RGST_SNO(+)
		   and c.PTNO = w.PTNO (+)
		   and c.ORDR_YMD = w.ORDR_YMD (+)
		   and c.ORDR_SNO = w.ORDR_SNO (+)
		   and c.SPCM_NO = w.SPCM_NO (+)
		   and c.EXMN_CD = w.EXMN_CD (+)
		   and m.PTNO = #{ptno}
		   and (  ( #{evntTypCd} = '1' and m.CUTN_RELE_YMD =  to_date('29991231', 'yyyymmdd') )
		       or ( #{evntTypCd} = '2' and m.CUTN_RELE_YMD <![CDATA[<>]]> to_date('29991231', 'yyyymmdd') )
		       )
		 order
		    by  m.CUTN_STRT_YMD desc
	</select>



</mapper>