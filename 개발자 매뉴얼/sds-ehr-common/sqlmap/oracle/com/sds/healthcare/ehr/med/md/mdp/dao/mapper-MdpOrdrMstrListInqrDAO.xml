<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_MdpOrdrMstrListInqrDAO_sql.xml 
    Description : -->
<mapper namespace="MdpOrdrMstrListInqrDAO">


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNmListInqr-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO">
	
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="mdfeItdvCd" column="MDFE_ITDV_CD"/>
		<result property="ihohDvsnCd" column="IHOH_DVSN_CD"/>
		<result property="mdprClsfCd" column="MDPR_CLSF_CD"/>
		<result property="ingrNm" column="INGR_NM"/>
		<result property="invnPcunCd" column="INVN_PCUN_CD"/>
		<result property="icunCd" column="ICUN_CD"/>
		<result property="afiOrdrCltyNm" column="AFI_ORDR_CLTY_NM"/>
		<result property="setExmnYn" column="SET_EXMN_YN"/>
		<result property="slipNm" column="SLIP_NM"/>
		<result property="rstcCmpnNm" column="RSTC_CMPN_NM"/>
		<result property="tdmCdDvsnCd" column="TDM_CD_DVSN_CD"/>
		<result property="phrkExmnCd" column="PHRK_EXMN_CD"/>
		<result property="cnmdPrvnAntbTrgtYn" column="CNMD_PRVN_ANTB_TRGT_YN"/>
		<result property="antbYn" column="ANTB_YN"/>
		<result property="afiInslOrdvNm" column="AFI_INSL_ORDV_NM"/>
		<result property="comnItemChrcVl" column="COMN_ITEM_CHRC_VL"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="afiSortSqncStr" column="AFI_SORT_SQNC_STR"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNmListInqr () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNmListInqr-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNmListInqr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNmListInqr-result" useCache="true" flushCache="false">
		<![CDATA[
		   select /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNmListInqr */
		      ORDR_CD as ORDR_CD               /*  처방코드 */
		    , ORDR_NM as ORDR_NM               /*  처방명 */
		    , ORDR_CLTY_CD as ORDR_CLTY_CD     /*  처방분류유형코드 */
		    , SLIP_CD as SLIP_CD               /*  SLIP코드 */
		    , SORT_SQNC as SORT_SQNC           /*  나열순서 */
		    , MDFE_ITDV_CD as MDFE_ITDV_CD     /*  필수(수가)입력구분 */
		    , IHOH_DVSN_CD as IHOH_DVSN_CD     /*  원내/외구분(1,2,3) */
		    , MDPR_CLSF_CD as MDPR_CLSF_CD     /*  약품구분 */
		    , INGR_NM as INGR_NM               /*  약성분명 */
		    , INVN_PCUN_CD as INVN_PCUN_CD     /*  포장단위 */
		    , ICUN_CD as ICUN_CD               /*  함량단위 */
		    , AFI_ORDR_CLTY_NM as AFI_ORDR_CLTY_NM /*  처방구별명 */
		    , SET_EXMN_YN as SET_EXMN_YN       /*  SET검사여부 */
		    , SLIP_NM as SLIP_NM               /*  SLIP분류명 */
		    , RSTC_CMPN_NM as RSTC_CMPN_NM     /*  제약회사 */
		    , TDM_CD_DVSN_CD as TDM_CD_DVSN_CD /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		    , PHRK_EXMN_CD as PHRK_EXMN_CD     /*  약물동력학CODE(검사) */
		    , CNMD_PRVN_ANTB_TRGT_YN as CNMD_PRVN_ANTB_TRGT_YN /*  조영제 여부 */
		    , ANTB_YN as ANTB_YN               /*  항생제여부 */
		    , DETL_CD_NM as AFI_INSL_ORDV_NM
		    , COMN_ITEM_CHRC_VL as COMN_ITEM_CHRC_VL
		    , ORDR_PSBL_DVSN_CD as ORDR_PSBL_DVSN_CD /*  처방가능구분코드 */
		    , ORCL_CD as ORCL_CD              /*  처방분류코드 */
		    , AFI_SORT_SQNC_STR as AFI_SORT_SQNC_STR
		     from (
		           select  /*+ FULL(A) NO_EXPAND */
		                   a.ORDR_CD ORDR_CD                                           /*  처방코드 */
		                ,  a.ORDR_NM                              ORDR_NM              /*  처방명 */
		                ,  a.ORDR_CLTY_CD                         ORDR_CLTY_CD         /*  처방분류유형코드 */
		                ,  a.SLIP_CD                              SLIP_CD              /*  SLIP코드 */
		                ,  to_char(nvl(a.SORT_SQNC, 0))           SORT_SQNC            /*  나열순서 */
		                ,  b.MDFE_ITDV_CD                         MDFE_ITDV_CD         /*  필수(수가)입력구분 */
		                ,  a.IHOH_DVSN_CD                         IHOH_DVSN_CD         /*  원내/외구분(1,2,3) */
		                ,  a.MDPR_CLSF_CD                         MDPR_CLSF_CD         /*  약품구분           */
		                ,  a.INGR_NM                              INGR_NM              /*  약성분명           */
		                ,  a.INVN_PCUN_CD                         INVN_PCUN_CD         /*  포장단위           */
		                ,  a.ICUN_CD                              ICUN_CD              /*  함량단위           */
		                ,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'MM182' and COMN_DTLS_CD = a.ORDR_CLTY_CD and rownum = 1 ) AFI_ORDR_CLTY_NM /*  처방구별명 */
		                ,  a.SET_EXMN_YN                          SET_EXMN_YN          /*  SET검사여부        */
		                ,  c.SLIP_NM                              SLIP_NM              /*  SLIP분류명         */
		                ,  a.RSTC_CMPN_NM                         RSTC_CMPN_NM         /*  제약회사           */
		                ,  a.TDM_CD_DVSN_CD                       TDM_CD_DVSN_CD       /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		                ,  a.PHRK_EXMN_CD                         PHRK_EXMN_CD         /*  약물동력학CODE(검사) */
		                ,  a.CNMD_PRVN_ANTB_TRGT_YN               CNMD_PRVN_ANTB_TRGT_YN /*  조영제 여부      */
		                ,  a.ANTB_YN                              ANTB_YN              /*  항생제여부         */
		                ,  d.DETL_CD_NM
		                ,  d.COMN_ITEM_CHRC_VL
		                ,  a.ORDR_PSBL_DVSN_CD                                         /*  처방가능구분코드 */
		                ,  a.ORCL_CD                                                   /*  처방분류코드 */
		                ,  'Z' AFI_SORT_SQNC_STR                                        /*  인슐린정렬정보 */
		             from  MDORDRCMT a
		                ,  AIMFMDFET b
		                ,  MDBSLIPCT c
		                ,  ( select
		                             bb.DETL_CD_NM /*  DETL_CD_NM 값이 있을 경우 프로그램으로 검색그리드 처방명 ( ORDR_NM ) 맨 앞에 표시 [ DETL_CD_NM(INSULIN정보 예:속효성 ) || OPTION1(색표시 예:$0080FFFF) ] */
		                           , aa.PHRM_DTLS_CTRL_CD /*  색표시 값 추가 필요 ( 진료지원에서 넣어 줘야 함 ) */
		                           , cc.COMN_ITEM_CHRC_VL
		                       from  SDMCTRLMT aa
		                          ,  CCCMCDDMT bb
		                          ,  CCCMCDIDT cc
		                      where  aa.PHRM_CTRL_CD    = 'SD802'
		                        and  bb.COMN_GRP_CD(+)  = 'SD801'
		                        and  bb.COMN_DTLS_CD(+) = aa.PHRM_CTRL_CHRC_VL1
		                        and  cc.COMN_GRP_CD(+)  = bb.COMN_GRP_CD
		                        and  cc.COMN_DTLS_CD(+) = bb.COMN_DTLS_CD ) d
		           where (
		                  (( a.UPRC_ORDR_NM like '%'|| #{ordrNm1} ||'%' escape '#' and a.UPRC_ORDR_NM like '%'|| #{ordrNm2} ||'%' escape '#' and a.UPRC_ORDR_NM like '%'|| #{ordrNm3} ||'%' escape '#' )
		             and  ( a.UPRC_ORDR_NM like #{ordrNm01} ||'%' escape '#' and a.UPRC_ORDR_NM like '%'|| #{ordrNm02} ||'%' escape '#' and a.UPRC_ORDR_NM like '%'|| #{ordrNm03} ||'%' escape '#' ))
		                 or
		                   (( a.KORN_PDCT_NM like '%'|| #{ordrNm1} ||'%' escape '#' and a.KORN_PDCT_NM like '%'|| #{ordrNm2} ||'%' escape '#' and a.KORN_PDCT_NM like '%'|| #{ordrNm3} ||'%' escape '#' )
		             and  ( a.KORN_PDCT_NM like #{ordrNm01} ||'%' escape '#' and a.KORN_PDCT_NM like '%'|| #{ordrNm02} ||'%' escape '#' and a.KORN_PDCT_NM like '%'|| #{ordrNm03} ||'%' escape '#' ))
		                 )
		             and  a.ORDR_CLTY_CD like #{ordrCltyCd} ||'%'
		             and  UPPER ( nvl(a.INGR_NM,'X')) like '%' || #{ingrNm} ||'%' escape '#'
		             and  a.ORDR_PSBL_DVSN_CD like #{ordrPsblDvsnCd} || '%'
		             and  a.ORCL_CD like #{orclCd} || '%'
		             and  a.ORDR_CD = b.MDFE_CD
		             and  b.APST_YMD <= decode(to_date(#{ordrYmd}, 'YYYYMMDD'), null, trunc(sysdate), to_date(#{ordrYmd}, 'YYYYMMDD'))
		             and  b.APFN_YMD >= decode(to_date(#{ordrYmd}, 'YYYYMMDD'), null, trunc(sysdate), to_date(#{ordrYmd}, 'YYYYMMDD'))
		             and  b.ORDR_PSBL_YN like #{ordrPsblDvsnCd} || '%'
		             and  c.SLIP_CD(+) = a.SLIP_CD
		             and  nvl(a.SLIP_CD, 'X') != FN_CC_GET_CNST_VL('MDP_005', 'SLIP_CD_DT_01')
		             --and  a.ORDR_CD != 'C030019' /*  ▷▷EN 조성처방◁◁ 은 직접조회하지 않음 */
		             and  nvl(a.SCRN_INPT_DSLW_YN, 'N') <> 'Y'
		             and  a.ORDR_CLTY_CD != 'H1' /*  투석 스케줄 등록시 투석실시 테이블에 저장되는 처방. 처방화면에서 검색되면 안됨*/
		             and  d.PHRM_DTLS_CTRL_CD(+) = a.ORDR_CD
					 and  nvl(a.DGMT_RGST_TYPE_CD, 'X') <> '3' -- 검색에서 지참약 제외
		             and (
		                 (nvl(#{ordrNm},'X') != 'INSULIN' and nvl(#{ordrNm01},'X') != 'INSULIN')
		                 or
		                 (
		                   (nvl(#{ordrNm},'X') = 'INSULIN' or nvl(#{ordrNm01},'X') = 'INSULIN')
		                    and
		                   (not exists (select  'Y'
		                                  from  SDMCTRLMT
		                                 where  PHRM_CTRL_CD = 'SD802'
		                                   and  PHRM_DTLS_CTRL_CD = a.ORDR_CD
		                                   and  rownum < 2)
		                   )
		                 )
		                 )
		           union all
		           /*  검체검사 키워드 검색 */
		           select  /*+ LEADING(A D ) FULL(A) USE_HASH (D)  NO_EXPAND */
		                   a.ORDR_CD ORDR_CD                                           /*  처방코드     */
		                ,  a.ORDR_NM
		                ,  a.ORDR_CLTY_CD                         ORDR_CLTY_CD         /*  처방분류유형코드   */
		                ,  a.SLIP_CD                              SLIP_CD              /*  SLIP코드           */
		                ,  to_char(nvl(a.SORT_SQNC, 0))           SORT_SQNC            /*  나열순서           */
		                ,  b.MDFE_ITDV_CD                         MDFE_ITDV_CD         /*  필수(수가)입력구분 */
		                ,  null                                   IHOH_DVSN_CD         /*  원내/외구분(1,2,3) */
		                ,  null                                   MDPR_CLSF_CD         /*  약품구분           */
		                ,  null                                   INGR_NM              /*  약성분명           */
		                ,  null                                   INVN_PCUN_CD         /*  포장단위           */
		                ,  null                                   ICUN_CD              /*  함량단위           */
		                ,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'MM182' and COMN_DTLS_CD = a.ORDR_CLTY_CD and rownum = 1 ) AFI_ORDR_CLTY_NM /*  처방구별명 */
		                ,  a.SET_EXMN_YN                          SET_EXMN_YN          /*  SET검사여부        */
		                ,  c.SLIP_NM                              SLIP_NM              /*  SLIP분류명         */
		                ,  null                                   RSTC_CMPN_NM         /*  제약회사           */
		                ,  a.TDM_CD_DVSN_CD                       TDM_CD_DVSN_CD       /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		                ,  a.PHRK_EXMN_CD                         PHRK_EXMN_CD         /*  약물동력학CODE(검사) */
		                ,  null                                   CNMD_PRVN_ANTB_TRGT_YN /*  조영제 여부      */
		                ,  null                                   ANTB_YN              /*  항생제여부         */
		                ,  null
		                ,  null
		                ,  a.ORDR_PSBL_DVSN_CD                                         /*  처방가능구분코드 */
		                ,  a.ORCL_CD                                                   /*  처방분류코드 */
		                ,  'Z' AFI_SORT_SQNC_STR                                        /*  인슐린정렬정보 */
		             from  SFCORDRCT d
		                ,  MDORDRCMT a
		                ,  AIMFMDFET b
		                ,  MDBSLIPCT c
		            where  ( upper ( d.EXOR_SRCH_KYWR_CTN ) like '%'|| #{ordrNm1} ||'%' escape '#' and upper ( d.EXOR_SRCH_KYWR_CTN ) like '%'|| #{ordrNm2} ||'%' escape '#' and upper ( d.EXOR_SRCH_KYWR_CTN ) like '%'|| #{ordrNm3} ||'%' escape '#' )
		              and  ( upper ( d.EXOR_SRCH_KYWR_CTN ) like #{ordrNm01}||'%' escape '#' and upper ( d.EXOR_SRCH_KYWR_CTN ) like '%'|| #{ordrNm02} ||'%' escape '#' and upper ( d.EXOR_SRCH_KYWR_CTN ) like '%'|| #{ordrNm03} ||'%' escape '#' )
		              and  to_date ( #{ordrYmd} , 'YYYYMMDD' ) between d.APST_YMD and d.APFN_YMD
		              and  d.ORDR_CD = a.ORDR_CD
		              and  a.ORDR_CLTY_CD like #{ordrCltyCd} ||'%'
		              and  a.ORDR_PSBL_DVSN_CD like #{ordrPsblDvsnCd} || '%'
		              and  a.ORCL_CD like #{orclCd} || '%'
		              and  a.ORDR_CD = b.MDFE_CD
		              and  b.APST_YMD <= decode(to_date(#{ordrYmd}, 'YYYYMMDD'), null, trunc(sysdate), to_date(#{ordrYmd}, 'YYYYMMDD'))
		              and  b.APFN_YMD >= decode(to_date(#{ordrYmd}, 'YYYYMMDD'), null, trunc(sysdate), to_date(#{ordrYmd}, 'YYYYMMDD'))
		              and  b.ORDR_PSBL_YN like #{ordrPsblDvsnCd} || '%'
		              and  nvl(a.SCRN_INPT_DSLW_YN, 'N') <> 'Y'
		              and  c.SLIP_CD(+) = a.SLIP_CD
		        union all
		        /*  인슐린조회 */
		           select  /*+ FULL(A) NO_EXPAND */
		                   a.ORDR_CD ORDR_CD                                           /*  처방코드     */
		                ,  a.ORDR_NM
		                ,  a.ORDR_CLTY_CD                         ORDR_CLTY_CD         /*  처방분류유형코드   */
		                ,  a.SLIP_CD                              SLIP_CD              /*  SLIP코드           */
		                ,  to_char(nvl(a.SORT_SQNC, 0))           SORT_SQNC            /*  나열순서           */
		                ,  b.MDFE_ITDV_CD                         MDFE_ITDV_CD         /*  필수(수가)입력구분 */
		                ,  a.IHOH_DVSN_CD                         IHOH_DVSN_CD         /*  원내/외구분(1,2,3) */
		                ,  a.MDPR_CLSF_CD                         MDPR_CLSF_CD         /*  약품구분           */
		                ,  a.INGR_NM                              INGR_NM              /*  약성분명           */
		                ,  a.INVN_PCUN_CD                         INVN_PCUN_CD         /*  포장단위           */
		                ,  a.ICUN_CD                              ICUN_CD              /*  함량단위           */
		                ,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'MM182' and COMN_DTLS_CD = a.ORDR_CLTY_CD and rownum = 1 ) AFI_ORDR_CLTY_NM /*  처방구별명 */
		                ,  a.SET_EXMN_YN                          SET_EXMN_YN          /*  SET검사여부        */
		                ,  c.SLIP_NM                              SLIP_NM              /*  SLIP분류명         */
		                ,  a.RSTC_CMPN_NM                         RSTC_CMPN_NM         /*  제약회사           */
		                ,  a.TDM_CD_DVSN_CD                       TDM_CD_DVSN_CD       /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		                ,  a.PHRK_EXMN_CD                         PHRK_EXMN_CD         /*  약물동력학CODE(검사) */
		                ,  a.CNMD_PRVN_ANTB_TRGT_YN               CNMD_PRVN_ANTB_TRGT_YN /*  조영제 여부      */
		                ,  a.ANTB_YN                              ANTB_YN              /*  항생제여부         */
		                ,  d.DETL_CD_NM
		                ,  d.COMN_ITEM_CHRC_VL
		                ,  a.ORDR_PSBL_DVSN_CD                                         /*  처방가능구분코드 */
		                ,  a.ORCL_CD                                                   /*  처방분류코드 */
		                ,  d.PHRM_CTRL_CHRC_VL1 AFI_SORT_SQNC_STR
		             from  MDORDRCMT a
		                ,  AIMFMDFET b
		                ,  MDBSLIPCT c
		                ,  ( select  bb.DETL_CD_NM /*  DETL_CD_NM 값이 있을 경우 프로그램으로 검색그리드 처방명 ( ORDR_NM ) 맨 앞에 표시 [ DETL_CD_NM(INSULIN정보 예:속효성 ) || OPTION1(색표시 예:$0080FFFF) ] */
		                          ,  aa.PHRM_DTLS_CTRL_CD /*  색표시 값 추가 필요 ( 진료지원에서 넣어 줘야 함 ) */
		                          ,  cc.COMN_ITEM_CHRC_VL
		                          ,  aa.PHRM_CTRL_CHRC_VL1
		                       from  SDMCTRLMT aa
		                          ,  CCCMCDDMT bb
		                          ,  CCCMCDIDT cc
		                      where  aa.PHRM_CTRL_CD      = 'SD802'
		                        and  bb.COMN_GRP_CD       = 'SD801'
		                        and  bb.COMN_DTLS_CD      = aa.PHRM_CTRL_CHRC_VL1
		                        and  cc.COMN_GRP_CD       = bb.COMN_GRP_CD
		                        and  cc.COMN_DTLS_CD      = bb.COMN_DTLS_CD) d
		           where  ( upper(#{ordrNm}) = 'INSULIN' or upper(#{ordrNm01}) = 'INSULIN' )
		             and  a.ORDR_PSBL_DVSN_CD = 'Y'
		             and  a.ORDR_CD = b.MDFE_CD
		             and  b.APST_YMD <= decode(to_date(#{ordrYmd}, 'YYYYMMDD'), null, trunc(sysdate), to_date(#{ordrYmd}, 'YYYYMMDD'))
		             and  b.APFN_YMD >= decode(to_date(#{ordrYmd}, 'YYYYMMDD'), null, trunc(sysdate), to_date(#{ordrYmd}, 'YYYYMMDD'))
		             and  b.ORDR_PSBL_YN = 'Y'
		             and  nvl(a.SCRN_INPT_DSLW_YN, 'N') <> 'Y'
		             and  c.SLIP_CD(+) = a.SLIP_CD
		             and  d.PHRM_DTLS_CTRL_CD = a.ORDR_CD
					 and  nvl(a.DGMT_RGST_TYPE_CD, 'X') <> '3' -- 검색에서 지참약 제외
		           union all
		           select
		                   DIET_CD                                   /*  처방코드     */
		                ,  DIET_NM                                   /*  처방명       */
		                ,  'A1'                                      /*  처방구별     */
		                ,  ORDR_SCRN_LRCL_CD                         /*  SLIP코드     */
		                ,  to_char(nvl(SORT_SQNC,0))                 /*  나열순서     */
		                ,  ''                                        /*  필수(수가)입력구분 */
		                ,  ''                                        /*  원내/외구분(1,2,3) */
		                ,  ''                                        /*  약품구분     */
		                ,  ''                                        /*  약성분명     */
		                ,  ''                                        /*  포장단위     */
		                ,  ''                                        /*  함량단위     */
		                ,  '식사'
		                ,  ''                                        /*  SET검사여부  */
		                ,  ''                                        /*  SLIP분류명   */
		                ,  ''                                        /*  제약회사     */
		                ,  ''                                        /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		                ,  ''                                        /*  약물동력학CODE(검사) */
		                ,  ''                                        /*  조영제 여부  */
		                ,  ''
		                ,  ''
		                ,  ''
		                ,  'Y'                                       /*  처방가능구분코드 */
		                ,  ''                                        /*  처방분류코드 */
		                ,  'Z' AFI_SORT_SQNC_STR                      /*  인슐린정렬정보 */
		            from
		               (
		                 select
		                         DIET_CD DIET_CD
		                      ,  DIET_NM||ORDR_SCRN_SRWR_NM DIET_NM
		                      ,  ORDR_SCRN_LRCL_CD ORDR_SCRN_LRCL_CD
		                      ,  SORT_SQNC     SORT_SQNC
		                   from  SUDIECDCT
		                  where  APFN_YMD = to_date('29991231', 'yyyymmdd')
		                    and  upper(DIET_NM||ORDR_SCRN_SRWR_NM) like '%'|| #{ordrNm}||'%' escape '#'
		                    and  upper(DIET_NM||ORDR_SCRN_SRWR_NM) like #{ordrNm01} ||'%' escape '#'
		                    and  #{ordrCltyCd} is null
		                    and  ORDR_SCRN_LRCL_CD is not null
		               )
		   union all
		           /*  기본처방 */
		           select  /*+ FULL(A) NO_EXPAND */
		                   a.ORDR_CD                              /*  처방코드 */
		                ,  a.ORDR_NM                              /*  처방명   */
		                ,  a.ORDR_CLTY_CD                         /*  처방구별 */
		                ,  a.SLIP_CD                              /*  SLIP코드 */
		                ,  to_char(nvl(a.SORT_SQNC, 0))           /*  나열순서 */
		                ,  ''                                     /*  필수(수가)입력구분 */
		                ,  ''                                     /*  원내/외구분(1,2,3) */
		                ,  ''                                     /*  약품구분 */
		                ,  ''                                     /*  약성분명 */
		                ,  ''                                     /*  포장단위 */
		                ,  ''                                     /*  함량단위 */
		                ,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'MM182' and COMN_DTLS_CD = a.ORDR_CLTY_CD and rownum = 1 ) AFI_ORDR_CLTY_NM /*  처방구별명 */
		                ,  ''                                     /*  SET검사여부 */
		                ,  b.SLIP_NM                              /*  SLIP분류명 */
		                ,  ''                                     /*  제약회사 */
		                ,  ''                                     /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		                ,  ''                                     /*  약물동력학CODE(검사) */
		                ,  ''                                     /*  조영제 여부 */
		                ,  ''
		                ,  ''
		                ,  ''
		                ,  'Y'                                    /*  처방가능구분코드 */
		                ,  ''                                     /*  처방분류코드 */
		                ,  'Z' AFI_SORT_SQNC_STR                   /*  인슐린정렬정보 */
		             from   MDORDRCMT a
		                ,   MDBSLIPCT b
		            where   (a.UPRC_ORDR_NM like '%'|| #{ordrNm1} ||'%' escape '#' and a.UPRC_ORDR_NM like '%'|| #{ordrNm2} ||'%' escape '#' and a.UPRC_ORDR_NM like '%'|| #{ordrNm3} ||'%' escape '#')
		              and   (a.UPRC_ORDR_NM like #{ordrNm01} ||'%' escape '#' and a.UPRC_ORDR_NM like '%'|| #{ordrNm02} ||'%' escape '#' and a.UPRC_ORDR_NM like '%'|| #{ordrNm03} ||'%' escape '#')
		              and   a.ORDR_CLTY_CD LIKE 'A%'
		              and   a.ORDR_PSBL_DVSN_CD like #{ordrPsblDvsnCd} || '%'
		              and   a.ORDR_CLTY_CD like #{ordrCltyCd} ||'%' /* '/M' 등의 조건 검색의 영향이 있어 추가 */
		              and   nvl(a.SLIP_CD, 'X') != FN_CC_GET_CNST_VL('MDP_005', 'SLIP_CD_DT_01')
		              and   a.ORDR_CD != 'C030019' /*  ▷▷EN 조성처방◁◁ 은 직접조회하지 않음 */
		              and   nvl(a.SCRN_INPT_DSLW_YN, 'N') <> 'Y'
		              and   (a.UPRC_ORDR_NM != 'MESSAGE' or FN_CC_GET_CNST_VL('MDP_004', 'MESG_ORDR_USE_YN') = 'Y') /*  Message 처방은 직접조회하지 않음 */
		              and   a.SLIP_CD = b.SLIP_CD(+)
		              /*  기본처방은 진료과 별로 검색가능한 처방 관리 */
		              and  'TRUE' = case when MCDP_CD1 is null and MCDP_CD2 is null and MCDP_CD3 is null
		                                 then 'TRUE'
		                                 else case when MCDP_CD1 = #{mcdpCd} or MCDP_CD2 = #{mcdpCd} or MCDP_CD3 = #{mcdpCd}
		                                      then 'TRUE'
		                                      else 'FALSE'
		                                      end
		                                 end
		              )
		    order by decode(upper(#{ordrNm}),'INSULIN',AFI_SORT_SQNC_STR,3),3, 4, 2
		    ]]> 
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrCdList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO">
	
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="mdfeItdvCd" column="MDFE_ITDV_CD"/>
		<result property="ihohDvsnCd" column="IHOH_DVSN_CD"/>
		<result property="mdprClsfCd" column="MDPR_CLSF_CD"/>
		<result property="ingrNm" column="INGR_NM"/>
		<result property="invnPcunCd" column="INVN_PCUN_CD"/>
		<result property="icunCd" column="ICUN_CD"/>
		<result property="afiOrdrCltyNm" column="AFI_ORDR_CLTY_NM"/>
		<result property="setExmnYn" column="SET_EXMN_YN"/>
		<result property="slipNm" column="SLIP_NM"/>
		<result property="rstcCmpnNm" column="RSTC_CMPN_NM"/>
		<result property="tdmCdDvsnCd" column="TDM_CD_DVSN_CD"/>
		<result property="phrkExmnCd" column="PHRK_EXMN_CD"/>
		<result property="cnmdPrvnAntbTrgtYn" column="CNMD_PRVN_ANTB_TRGT_YN"/>
		<result property="antbYn" column="ANTB_YN"/>
		<result property="afiInslOrdvNm" column="AFI_INSL_ORDV_NM"/>
		<result property="comnItemChrcVl" column="COMN_ITEM_CHRC_VL"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="afiSortSqncStr" column="AFI_SORT_SQNC_STR"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrCdList () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrCdList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrCdList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrCdList-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrCdList */
		           a.ORDR_CD                              as ORDR_CD              /*  처방코드      */
		        ,  a.ORDR_NM                              as ORDR_NM              /*  처방명       */
		        ,  a.ORDR_CLTY_CD                         as ORDR_CLTY_CD         /*  처방분류유형코드 */
		        ,  a.SLIP_CD                              as SLIP_CD              /*  SLIP코드    */
		        ,  to_char(nvl(a.SORT_SQNC, 0))           as SORT_SQNC            /*  나열순서      */
		        ,  b.MDFE_ITDV_CD                         as MDFE_ITDV_CD         /*  필수(수가)입력구분 */
		        ,  a.IHOH_DVSN_CD                         as IHOH_DVSN_CD         /*  원내/외구분(1,2,3) */
		        ,  a.MDPR_CLSF_CD                         as MDPR_CLSF_CD         /*  약품구분          */
		        ,  a.INGR_NM                              as INGR_NM              /*  약성분명          */
		        ,  a.INVN_PCUN_CD                         as INVN_PCUN_CD         /*  포장단위          */
		        ,  a.ICUN_CD                              as ICUN_CD              /*  함량단위          */
		        ,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'MM182' and COMN_DTLS_CD = a.ORDR_CLTY_CD and rownum = 1 ) as AFI_ORDR_CLTY_NM  /*  처방구별명   */
		        ,  a.SET_EXMN_YN                          as SET_EXMN_YN          /*  SET검사여부        */
		        ,  c.SLIP_NM                              as SLIP_NM              /*  SLIP분류명         */
		        ,  a.RSTC_CMPN_NM                         as RSTC_CMPN_NM         /*  제약회사           */
		        ,  a.TDM_CD_DVSN_CD                       as TDM_CD_DVSN_CD       /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		        ,  a.PHRK_EXMN_CD                         as PHRK_EXMN_CD         /*  약물동력학CODE(검사) */
		        ,  a.CNMD_PRVN_ANTB_TRGT_YN               as CNMD_PRVN_ANTB_TRGT_YN /*  조영제 여부      */
		        ,  a.ANTB_YN                              as ANTB_YN              /*  항생제여부         */
		        ,  d.DETL_CD_NM                           as AFI_INSL_ORDV_NM
		        ,  d.COMN_ITEM_CHRC_VL                    as COMN_ITEM_CHRC_VL
		        ,  a.ORDR_PSBL_DVSN_CD                    as ORDR_PSBL_DVSN_CD                      /*  처방가능구분코드 */
		        ,  a.ORCL_CD                              as ORCL_CD                           /*  처방분류코드 */
		        , ''                                      as AFI_SORT_SQNC_STR
		   from  MDORDRCMT a
		      ,  AIMFMDFET b
		      ,  MDBSLIPCT c
		      ,  ( select  bb.DETL_CD_NM /*  DETL_CD_NM 값이 있을 경우 프로그램으로 검색그리드 처방명 ( ORDR_NM ) 맨 앞에 표시 [ DETL_CD_NM(INSULIN정보 예:속효성 ) || OPTION1(색표시 예:$0080FFFF) ] */
		                ,  aa.PHRM_DTLS_CTRL_CD /*  색표시 값 추가 필요 ( 진료지원에서 넣어 줘야 함 ) */
		                ,  cc.COMN_ITEM_CHRC_VL
		             from  SDMCTRLMT aa
		                ,  CCCMCDDMT bb
		                ,  CCCMCDIDT cc
		            where  aa.PHRM_CTRL_CD      = 'SD802'
		              and  bb.COMN_GRP_CD(+)    = 'SD801'
		              and  bb.COMN_DTLS_CD(+)   = aa.PHRM_CTRL_CHRC_VL1
		              and  cc.COMN_GRP_CD(+)    = bb.COMN_GRP_CD
		              and  cc.COMN_DTLS_CD(+)   = bb.COMN_DTLS_CD) d
		  where  a.ORDR_CD like #{ordrCd} || '%'
		    and  a.ORDR_PSBL_DVSN_CD like #{ordrPsblDvsnCd} || '%'
		    and  a.ORCL_CD like #{orclCd} || '%'
		    and  b.MDFE_CD = a.ORDR_CD
		    and  b.APST_YMD <= decode(to_date(#{ordrYmd}, 'YYYYMMDD'), null, trunc(sysdate), to_date(#{ordrYmd}, 'YYYYMMDD'))
		    and  b.APFN_YMD >= decode(to_date(#{ordrYmd}, 'YYYYMMDD'), null, trunc(sysdate), to_date(#{ordrYmd}, 'YYYYMMDD'))
		    /* and  b.ORDR_PSBL_YN = 'Y'*/
		    and  b.ORDR_PSBL_YN like #{ordrPsblDvsnCd} || '%'
		    and  c.SLIP_CD(+) = a.SLIP_CD
		    and  nvl(a.SLIP_CD, 'X') != FN_CC_GET_CNST_VL('MDP_005', 'SLIP_CD_DT_01')
		    and  a.ORDR_CD != 'C030019' /*  ▷▷EN 조성처방◁◁ 은 직접조회하지 않음 */
		    and  a.ORDR_CLTY_CD != 'H1' /*  투석 스케줄 등록시 투석실시 테이블에 저장되는 처방. 처방화면에서 검색되면 안됨*/
		    and  d.PHRM_DTLS_CTRL_CD(+) = a.ORDR_CD
		    and  nvl(a.SCRN_INPT_DSLW_YN, 'N') <> 'Y'
			and  nvl(a.DGMT_RGST_TYPE_CD, 'X') <> '3' --지참약은 제외 처리
		   union all
		   select  /*+ INDEX (a MDORDRCMT_PK) NO_EXPAND */
		           a.ORDR_CD                      /*  처방코드 */
		        ,  a.ORDR_NM                      /*  처방명 */
		        ,  a.ORDR_CLTY_CD                 /*  처방분류유형코드 */
		        ,  a.SLIP_CD                      /*  SLIP코드 */
		        ,  to_char(nvl(a.SORT_SQNC, 0))   /*  나열순서 */
		        ,  ''                             /*  필수(수가) 입력구분 */
		        ,  ''                             /*  원내/외구분(1,2,3) */
		        ,  ''                             /*  약품구분 */
		        ,  ''                             /*  약성분명 */
		        ,  ''                             /*  포장단위 */
		        ,  ''                             /*  함량단위 */
		        ,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'MM182' and COMN_DTLS_CD = a.ORDR_CLTY_CD and rownum = 1 ) AFI_ORDR_CLTY_NM  /*  처방구별명 */
		        ,  ''                             /*  SET검사여부 */
		        ,  b.SLIP_NM                      /*  SLIP분류명 */
		        ,  ''                             /*  제약회사 */
		        ,  ''                             /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		        ,  ''                             /*  약물동력학CODE(검사) */
		        ,  ''                             /*  조영제 여부 */
		        ,  ''                             /*  항생제여부 */
		        ,  ''
		        ,  ''
		        ,  ''                             /*  처방가능구분코드 */
		        ,  ''                             /*  처방분류코드 */
		        , '' AFI_SORT_SQNC_STR
		     from
		           MDORDRCMT a,
		           MDBSLIPCT b
		    where  a.ORDR_CD like #{ordrCd} ||'%'
		      and  a.ORDR_PSBL_DVSN_CD like #{ordrPsblDvsnCd} || '%'
		      and  nvl(a.SLIP_CD,'X') != FN_CC_GET_CNST_VL('MDP_005', 'SLIP_CD_DT_01')
		      and  a.ORDR_CD != 'C030019' /*  ▷▷EN 조성처방◁◁ 은 직접조회하지 않음.20101022KCY*/
		      and  a.ORDR_CLTY_CD like 'A%'
		      and  (a.ORDR_CD != 'C0000000' or FN_CC_GET_CNST_VL('MDP_004', 'MESG_ORDR_USE_YN') = 'Y') /*  Message 처방은 집적조회하지 않음 */
		      and  b.SLIP_CD(+) = a.SLIP_CD
		      and  nvl(a.SCRN_INPT_DSLW_YN, 'N') <> 'Y'   
		      /*  기본처방은 진료과 별로 검색가능한 처방 관리 */
		     and  'TRUE' = case when MCDP_CD1 is null and MCDP_CD2 is null and MCDP_CD3 is null
		                       then 'TRUE'
		                       else case when MCDP_CD1 = #{mcdpCd} or MCDP_CD2 = #{mcdpCd} or MCDP_CD3 = #{mcdpCd}
		                            then 'TRUE'
		                            else 'FALSE'
		                            end
		                       end
		   union all
		   select
		           DIET_CD                                   /*  처방코드     */
		        ,  DIET_NM                                   /*  처방명       */
		        ,  'A1'                                      /*  처방구별     */
		        ,  ORDR_SCRN_LRCL_CD                         /*  SLIP코드     */
		        ,  to_char(nvl(SORT_SQNC,0))                 /*  나열순서     */
		        ,  ''                                        /*  필수(수가)입력구분 */
		        ,  ''                                        /*  원내/외구분(1,2,3) */
		        ,  ''                                        /*  약품구분     */
		        ,  ''                                        /*  약성분명     */
		        ,  ''                                        /*  포장단위     */
		        ,  ''                                        /*  함량단위     */
		        ,  '식사'
		        ,  ''                                        /*  SET검사여부  */
		        ,  ''                                        /*  SLIP분류명   */
		        ,  ''                                        /*  제약회사     */
		        ,  ''                                        /*  TDM코드구분(약물검사:Y,TDM자문의뢰검사:T) */
		        ,  ''                                        /*  약물동력학CODE(검사) */
		        ,  ''                                        /*  조영제 여부  */
		        ,  ''
		        ,  ''
		        ,  ''
		        ,  'Y'                                       /*  처방가능구분코드 */
		        ,  ''                                        /*  처방분류코드 */
		        , '' AFI_SORT_SQNC_STR
		     from
		         (
		           select
		                   DIET_CD DIET_CD
		                ,  DIET_NM||ORDR_SCRN_SRWR_NM DIET_NM
		                ,  ORDR_SCRN_LRCL_CD ORDR_SCRN_LRCL_CD
		                ,  SORT_SQNC     SORT_SQNC
		             from  SUDIECDCT
		            where  APFN_YMD = to_date('29991231', 'yyyymmdd')
		              and  DIET_CD||ORDR_SCRN_SRWR_NM like #{ordrCd} || '%'
		              and  ORDR_SCRN_LRCL_CD is not null
		        )
		        order  by 3, 4, 1
		    ]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO">
	
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="slipNm" column="SLIP_NM"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="uprcOrdrNm" column="UPRC_ORDR_NM"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="kornPdctNm" column="KORN_PDCT_NM"/>
		<result property="ensnPdctNm" column="ENSN_PDCT_NM"/>
		<result property="ordrSpsbCtn" column="ORDR_SPSB_CTN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm (처방마스터검색 (코드, 명 like조건)) 
        Description :                                           처방마스터검색 (코드, 명 like조건)
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm */
		select  /*+ MdpOrdrMstrListInqrDAO-listOrdrMstrSrch01_처방마스터 검색(코드,명 like조건) */
		        a.ORDR_CD                               as ORDR_CD             /* 처방코드 */
		     ,  b.SLIP_NM                               as SLIP_NM             /* SLIP명 */
		     ,  to_char(a.APST_YMD, 'YYYYMMDD')         as APST_YMD            /* 적용시작일자 */
		     ,  to_char(a.APFN_YMD, 'YYYYMMDD')         as APFN_YMD            /* 적용종료일자 */
		     ,  a.ORDR_NM                               as ORDR_NM             /* 처방명 */
		     ,  a.UPRC_ORDR_NM                          as UPRC_ORDR_NM        /* 대문자처방명 */
		     ,  a.ORCL_CD                               as ORCL_CD             /* 처방분류코드 */
		     ,  a.ORDR_CLTY_CD                          as ORDR_CLTY_CD        /* 처방분류유형코드 */
		     ,  a.SLIP_CD                               as SLIP_CD             /* SLIP코드 */
		     ,  a.ORDR_PSBL_DVSN_CD                     as ORDR_PSBL_DVSN_CD   /* 처방가능구분코드 */
		     ,  a.KORN_PDCT_NM                          as KORN_PDCT_NM        /* 한글상품명 */
		     ,  a.ENSN_PDCT_NM                          as ENSN_PDCT_NM        /* 영문상품명 */
		     ,  a.ORDR_SPSB_CTN                         as ORDR_SPSB_CTN       /* 처방특기사항 */
		  from  MDORDRCMT a
		     ,  MDBSLIPCT b
		 where  trunc(sysdate) between a.APST_YMD and a.APFN_YMD
		 <if test='ordrCd != null and ordrCd != ""'>
		   and  a.ORDR_CD like '%' || #{ordrCd} || '%'
		 </if>
		 <if test='equlYn != null and equlYn == "Y"'>
		 <!-- #{equlYn} 처방코드 equal 조건으로 조회 시 -->
		   and  a.ORDR_CD   =   #{ordrCd}
		 </if>
		 <if test='uprcOrdrNm != null and uprcOrdrNm != ""'>
		   and  a.UPRC_ORDR_NM like '%' || upper(#{uprcOrdrNm}) || '%'
		 </if>
		 <if test='slipCd != null and slipCd != ""'>
		   and  a.SLIP_CD = #{slipCd}
		 </if>
		 <if test='ordrCltyCd != null and ordrCltyCd != ""'>
		   and  a.ORDR_CLTY_CD like #{ordrCltyCd}||'%'
		 </if>
		   and  case
		            when #{ordrPsblDvsnCd} = 'A'                           then 'TRUE'
		            when a.ORDR_PSBL_DVSN_CD = nvl(#{ordrPsblDvsnCd}, 'Y') then 'TRUE'
		            else 'FALSE'
		            end      =   'TRUE'
		   and  case
		            when nvl(#{wodvVl}, 'ALL')   =   'ALL'                   then 'TRUE'
		            when nvl(#{wodvVl}, 'ALL')   =   a.ORDR_CLTY_CD          then 'TRUE'
		            when #{wodvVl} = 'C_ALL' and a.ORDR_CLTY_CD like 'C%'    then 'TRUE'
		            else 'FALSE'
		            end     =   'TRUE'
		   and  b.SLIP_CD   (+) =   a.SLIP_CD
		 order
		    by  a.ORDR_CLTY_CD
		     ,  a.SORT_SQNC
		     ,  a.ORDR_NM
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-selectOneDummy-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO">
	
		<result property="equlYn" column="EQUL_YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-selectOneDummy (selectOneDummy) 
        Description :                                           selectOneDummy
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-selectOneDummy-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-selectOneDummy"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-selectOneDummy-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-selectOneDummy */
		select  'Y'         as EQUL_YN
		  from  dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNonSlip-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO">
	
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="slipNm" column="SLIP_NM"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="uprcOrdrNm" column="UPRC_ORDR_NM"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="kornPdctNm" column="KORN_PDCT_NM"/>
		<result property="ensnPdctNm" column="ENSN_PDCT_NM"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNonSlip () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNonSlip-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNonSlip"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNonSlip-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrNonSlip */
		select  /* 처방마스터 슬립미분류 조회 */
		        a.ORDR_CD                               as ORDR_CD             /* 처방코드 */
		     ,  ''                                      as SLIP_NM             /* SLIP명 */
		     ,  to_char(a.APST_YMD, 'YYYYMMDD')         as APST_YMD            /* 적용시작일자 */
		     ,  to_char(a.APFN_YMD, 'YYYYMMDD')         as APFN_YMD            /* 적용종료일자 */
		     ,  a.ORDR_NM                               as ORDR_NM             /* 처방명 */
		     ,  a.UPRC_ORDR_NM                          as UPRC_ORDR_NM        /* 대문자처방명 */
		     ,  a.ORCL_CD                               as ORCL_CD             /* 처방분류코드 */
		     ,  a.ORDR_CLTY_CD                          as ORDR_CLTY_CD        /* 처방분류유형코드 */
		     ,  a.SLIP_CD                               as SLIP_CD             /* SLIP코드 */
		     ,  a.ORDR_PSBL_DVSN_CD                     as ORDR_PSBL_DVSN_CD   /* 처방가능구분코드 */
		     ,  a.KORN_PDCT_NM                          as KORN_PDCT_NM        /* 한글상품명 */
		     ,  a.ENSN_PDCT_NM                          as ENSN_PDCT_NM        /* 영문상품명 */
		  from  MDORDRCMT a
		     ,  AIMFMDFET b
		<![CDATA[
		 where  trunc(sysdate) <= a.APFN_YMD
		]]>
		   and  a.SLIP_CD is null
		 <if test='ordrCd != null and ordrCd != ""'>
		   and  a.ORDR_CD like '%' || #{ordrCd} || '%'
		 </if>
		 <if test='equlYn != null and equlYn == "Y"'>
		 <!-- #{equlYn} 처방코드 equal 조건으로 조회 시 -->
		   and  a.ORDR_CD   =   #{ordrCd}
		 </if>
		 <if test='uprcOrdrNm != null and uprcOrdrNm != ""'>
		   and  a.UPRC_ORDR_NM like '%' || upper(#{uprcOrdrNm}) || '%'
		 </if>
		 <if test='ordrCltyCd != null and ordrCltyCd != ""'>
		   and  a.ORDR_CLTY_CD like #{ordrCltyCd}||'%'
		 </if>
		   and  a.ORDR_CD = b.MDFE_CD
		<![CDATA[
		   and  trunc(sysdate) <= b.APFN_YMD
		]]>
		 order
		    by  a.ORDR_CLTY_CD
		     ,  a.SORT_SQNC
		     ,  a.ORDR_NM
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm2-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO">
	
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="slipNm" column="SLIP_NM"/>
		<result property="apstYmd" column="APST_YMD"/>
		<result property="apfnYmd" column="APFN_YMD"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="uprcOrdrNm" column="UPRC_ORDR_NM"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="kornPdctNm" column="KORN_PDCT_NM"/>
		<result property="ensnPdctNm" column="ENSN_PDCT_NM"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm2 () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm2-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm2"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm2-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-listOrdrMstrSrchByCdNm */
		select  /*+ MdpOrdrMstrListInqrDAO-listOrdrMstrSrch01_처방마스터 검색(코드,명 like조건) */
		        a.ORDR_CD                               as ORDR_CD             /* 처방코드 */
		     ,  b.SLIP_NM                               as SLIP_NM             /* SLIP명 */
		     ,  to_char(a.APST_YMD, 'YYYYMMDD')         as APST_YMD            /* 적용시작일자 */
		     ,  to_char(a.APFN_YMD, 'YYYYMMDD')         as APFN_YMD            /* 적용종료일자 */
		     ,  a.ORDR_NM                               as ORDR_NM             /* 처방명 */
		     ,  a.UPRC_ORDR_NM                          as UPRC_ORDR_NM        /* 대문자처방명 */
		     ,  a.ORCL_CD                               as ORCL_CD             /* 처방분류코드 */
		     ,  a.ORDR_CLTY_CD                          as ORDR_CLTY_CD        /* 처방분류유형코드 */
		     ,  a.SLIP_CD                               as SLIP_CD             /* SLIP코드 */
		     ,  a.ORDR_PSBL_DVSN_CD                     as ORDR_PSBL_DVSN_CD   /* 처방가능구분코드 */
		     ,  a.KORN_PDCT_NM                          as KORN_PDCT_NM        /* 한글상품명 */
		     ,  a.ENSN_PDCT_NM                          as ENSN_PDCT_NM        /* 영문상품명 */
		  from  MDORDRCMT a
		     ,  MDBSLIPCT b
		<![CDATA[
		 where  trunc(sysdate) <= a.APFN_YMD
		]]>
		 <if test='ordrCd != null and ordrCd != ""'>
		   and  a.ORDR_CD like '%' || #{ordrCd} || '%'
		 </if>
		 <if test='equlYn != null and equlYn == "Y"'>
		 <!-- #{equlYn} 처방코드 equal 조건으로 조회 시 -->
		   and  a.ORDR_CD   =   #{ordrCd}
		 </if>
		 <if test='uprcOrdrNm != null and uprcOrdrNm != ""'>
		   and  a.UPRC_ORDR_NM like '%' || upper(#{uprcOrdrNm}) || '%'
		 </if>
		 <if test='slipCd != null and slipCd != ""'>
		   and  a.SLIP_CD = #{slipCd}
		 </if>
		 <if test='ordrCltyCd != null and ordrCltyCd != ""'>
		   and  a.ORDR_CLTY_CD like #{ordrCltyCd}||'%'
		 </if>
		   and  b.SLIP_CD   (+) =   a.SLIP_CD
		 order
		    by  a.ORDR_CLTY_CD
		     ,  a.SORT_SQNC
		     ,  a.ORDR_NM
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-updateOrdrMstrSpsbCtnByCdNm (처치에 대한 정보 저장 (코드, 명 like조건)) 
        Description :                                           처치에 대한 정보 저장 (코드, 명 like조건)
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-updateOrdrMstrSpsbCtnByCdNm"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrMstrListInqrDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrMstrListInqrDAO-updateOrdrMstrSpsbCtnByCdNm */
		update MDORDRCMT set ORDR_SPSB_CTN = #{ordrSpsbCtn}
		where  trunc(sysdate) between APST_YMD and APFN_YMD
		 <if test='ordrCd != null and ordrCd != ""'>
		   and  ORDR_CD like '%' || #{ordrCd} || '%'
		 </if>
		 <if test='equlYn != null and equlYn == "Y"'>
		 <!-- #{equlYn} 처방코드 equal 조건으로 조회 시 -->
		   and  ORDR_CD   =   #{ordrCd}
		 </if>
		 <if test='uprcOrdrNm != null and uprcOrdrNm != ""'>
		   and  UPRC_ORDR_NM like '%' || upper(#{uprcOrdrNm}) || '%'
		 </if>
		 <if test='slipCd != null and slipCd != ""'>
		   and  SLIP_CD = #{slipCd}
		 </if>
		 <if test='ordrCltyCd != null and ordrCltyCd != ""'>
		   and  ORDR_CLTY_CD like #{ordrCltyCd}||'%'
		 </if>
		   and  case
		            when #{ordrPsblDvsnCd} = 'A'                           then 'TRUE'
		            when ORDR_PSBL_DVSN_CD = nvl(#{ordrPsblDvsnCd}, 'Y') then 'TRUE'
		            else 'FALSE'
		            end      =   'TRUE'
		   and  case
		            when nvl(#{wodvVl}, 'ALL')   =   'ALL'                   then 'TRUE'
		            when nvl(#{wodvVl}, 'ALL')   =   ORDR_CLTY_CD          then 'TRUE'
		            when #{wodvVl} = 'C_ALL' and ORDR_CLTY_CD like 'C%'    then 'TRUE'
		            else 'FALSE'
		            end     =   'TRUE'
	</update>

</mapper>