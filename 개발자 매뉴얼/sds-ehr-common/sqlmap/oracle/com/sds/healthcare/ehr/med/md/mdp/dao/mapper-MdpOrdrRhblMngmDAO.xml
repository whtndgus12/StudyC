<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_MdpOrdrRhblMngmDAO_sql.xml 
    Description : -->
<mapper namespace="MdpOrdrRhblMngmDAO">


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneOrdrRhblMngmDual-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO">
	
		<result property="frnsDprtCd" column="FRNS_DPRT_CD"/>
		<result property="frstIpdvCd" column="FRST_IPDV_CD"/>
		<result property="afiCrtfOrdvVl" column="AFI_CRTF_ORDV_VL"/>
		<result property="afiRulIdVl" column="AFI_RUL_ID_VL"/>
		<result property="afiRulRspnVl" column="AFI_RUL_RSPN_VL"/>
		<result property="afiRdctInfmCnfrYn" column="AFI_RDCT_INFM_CNFR_YN"/>
		<result property="afiTmprOrdrSno" column="AFI_TMPR_ORDR_SNO"/>
		<result property="afiOrglOrdrDcDvsnCd" column="AFI_ORGL_ORDR_DC_DVSN_CD"/>
		<result property="orreExstYn" column="ORRE_EXST_YN"/>
		<result property="ordrInrfClotYn" column="ORDR_INRF_CLOT_YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneOrdrRhblMngmDual (DVO Parameter를 유지하기 위한 DUAL SELECT) 
        Description :                                           DVO Parameter 를 유지하기 위한 DUAL SELECT
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneOrdrRhblMngmDual-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneOrdrRhblMngmDual"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneOrdrRhblMngmDual-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneOrdrRhblMngmDual */ 
		       '' as FRNS_DPRT_CD
		     , '' as FRST_IPDV_CD
		     , '' as AFI_CRTF_ORDV_VL
		     , '' as AFI_RUL_ID_VL
		     , '' as AFI_RUL_RSPN_VL
		     , '' as AFI_RDCT_INFM_CNFR_YN
		     , 0  as AFI_TMPR_ORDR_SNO
		     , '' as AFI_ORGL_ORDR_DC_DVSN_CD
		     , '' as ORRE_EXST_YN	/* 처방사유존재여부 */
		     , '' as ORDR_INRF_CLOT_YN
		from dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneRhblOrdrSno-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO">
	
		<result property="ordrSno" column="ORDR_SNO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneRhblOrdrSno (재활처방 Sequence 조회) 
        Description :                                           재활처방 처방일련번호에 사용되는 sequence 를 조회한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneRhblOrdrSno-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneRhblOrdrSno"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneRhblOrdrSno-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneRhblOrdrSno */
		          MDREHORDTQ.nextval as ORDR_SNO
		 from  dual
	</select>




	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-listPtntRhblOrdrList-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO">
	
		<result property="saveDvsnCd" column="SAVE_DVSN_CD"/>
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="odkiDetlCd" column="ODKI_DETL_CD"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="rhblOrdrUnslCtn" column="RHBL_ORDR_UNSL_CTN"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="athnId" column="ATHN_ID"/>
		<result property="crtfIp" column="CRTF_IP"/>
		<result property="crtfDt" column="CRTF_DT"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="clrsPrjcDrId" column="CLRS_PRJC_DR_ID"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="cnntOrdrBndlNo" column="CNNT_ORDR_BNDL_NO"/>
		<result property="ordrValdStrtYmd" column="ORDR_VALD_STRT_YMD"/>
		<result property="ordrValdFnshYmd" column="ORDR_VALD_FNSH_YMD"/>
		<result property="implOrdrPblcNtm" column="IMPL_ORDR_PBLC_NTM"/>
		<result property="implOrdrPblcLmttNtm" column="IMPL_ORDR_PBLC_LMTT_NTM"/>
		<result property="orglOrdrYmd" column="ORGL_ORDR_YMD"/>
		<result property="orglOrdrSno" column="ORGL_ORDR_SNO"/>
		<result property="mdsiCd" column="MDSI_CD"/>
		<result property="mdsiNm" column="MDSI_NM"/>
		<result property="mdteLctnCd" column="MDTE_LCTN_CD"/>
		<result property="afiMdteLctnNm" column="AFI_MDTE_LCTN_NM"/>
		<result property="mdteFrqnCd" column="MDTE_FRQN_CD"/>
		<result property="afiMdteFrqnNm" column="AFI_MDTE_FRQN_NM"/>
		<result property="ondyMdteNtm" column="ONDY_MDTE_NTM"/>
		<result property="afiOndyMdteNtmStr" column="AFI_ONDY_MDTE_NTM_STR"/>
		<result property="mdteDdcn" column="MDTE_DDCN"/>
		<result property="rhmdStrtYmd" column="RHMD_STRT_YMD"/>
		<result property="rhmdFnshYmd" column="RHMD_FNSH_YMD"/>
		<result property="rhmdNeedYmd" column="RHMD_NEED_YMD"/>
		<result property="apntNtm" column="APNT_NTM"/>
		<result property="enfrNtm" column="ENFR_NTM"/>
		<result property="rhblOrdrPrssCd" column="RHBL_ORDR_PRSS_CD"/>
		<result property="acimNursId" column="ACIM_NURS_ID"/>
		<result property="actnDt" column="ACTN_DT"/>
		<result property="acimInptDt" column="ACIM_INPT_DT"/>
		<result property="acimUpdtDt" column="ACIM_UPDT_DT"/>
		<result property="acimSpabCtn" column="ACIM_SPAB_CTN"/>
		<result property="dissCd" column="DISS_CD"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="ordrCrtnLnknNo" column="ORDR_CRTN_LNKN_NO"/>
		<result property="sporBndlNm" column="SPOR_BNDL_NM"/>
		<result property="sporBndlNo" column="SPOR_BNDL_NO"/>
		<result property="frstRgsrId" column="FRST_RGSR_ID"/>
		<result property="frstRgstIp" column="FRST_RGST_IP"/>
		<result property="frstRgstDt" column="FRST_RGST_DT"/>
		<result property="lastUpdrId" column="LAST_UPDR_ID"/>
		<result property="lastUpdtIp" column="LAST_UPDT_IP"/>
		<result property="lastUpdtDt" column="LAST_UPDT_DT"/>
		<result property="ordrNm" column="ORDR_NM"/>
		<result property="ordrPsblDvsnCd" column="ORDR_PSBL_DVSN_CD"/>
		<result property="insrIpdvCd" column="INSR_IPDV_CD"/>
		<result property="prtcIpdvCd" column="PRTC_IPDV_CD"/>
		<result property="incsIpdvCd" column="INCS_IPDV_CD"/>
		<result property="tainIpdvCd" column="TAIN_IPDV_CD"/>
		<result property="insrEdiCd" column="INSR_EDI_CD"/>
		<result property="insrAcknBaseCeckYn" column="INSR_ACKN_BASE_CECK_YN"/>
		<result property="subTypeCd" column="SUB_TYPE_CD"/>
		<result property="scrgInpyOnbrRt" column="SCRG_INPY_ONBR_RT"/>
		<result property="excfCd" column="EXCF_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-listPtntRhblOrdrList () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-listPtntRhblOrdrList-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-listPtntRhblOrdrList"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-listPtntRhblOrdrList-result" useCache="true" flushCache="false">
		            <![CDATA[
				   SELECT  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-listPtntRhblOrdrList_재활 처방 조회 */
						   'S'  as SAVE_DVSN_CD
						,  a.PTNO as PTNO                                                /* 환자번호*/
					    ,  to_char ( a.ORDR_YMD, 'YYYYMMDD') as ORDR_YMD                    /* 처방일자*/
						,  a.ORDR_SNO as ORDR_SNO                                            /* 처방일련번호*/
						,  a.MDRP_NO as MDRP_NO                                             /* 진료접수번호*/
						,  a.ORDR_CD as ORDR_CD                                             /* 처방코드*/
						,  a.MCDP_CD as MCDP_CD                                             /* 진료과코드*/
						,  a.ODDR_ID as ODDR_ID                                             /* 처방의사ID*/
						,  a.CHDR_ID as CHDR_ID                                             /* 지정의사ID*/
						,  a.GNDR_ID as GNDR_ID                                             /* 주치의사ID*/
						,  a.CODV_CD as CODV_CD                                             /* 내원구분코드*/
						,  a.ORDR_CLTY_CD as ORDR_CLTY_CD                                        /* 처방분류유형코드*/
						,  a.ORCL_CD as ORCL_CD                                             /* 처방분류코드*/
						,  a.ODKI_CD as ODKI_CD                                             /* 처방종류코드*/
						,  a.ODKI_DETL_CD as ODKI_DETL_CD                                        /* 처방종류상세코드*/
						,  a.HSLC_DVSN_CD as HSLC_DVSN_CD                                        /* 위치구분코드*/
						,  a.MCCN_CD as MCCN_CD                                             /* 진료센터코드*/
						,  a.WARD_CD as WARD_CD                                             /* 병동코드*/
						,  a.OROC_DPRT_CD as OROC_DPRT_CD                                            /* 처방발생원코드*/
						 /*  ,  a.FRNS_DPRT_CD            /* 불출부서코드*/
						,  a.SLIP_CD as SLIP_CD                                             /* SLIP코드*/
						,  a.TMPR_ORDR_YN as TMPR_ORDR_YN                                        /* 임시처방여부*/
						,  a.DC_DVSN_CD as DC_DVSN_CD                                          /* DC구분코드*/
						,  a.DC_ODDR_ID as DC_ODDR_ID                                          /* DC처방의사ID*/
						,  to_char ( a.DC_ORDR_DT, 'YYYYMMDDhh24miss') as DC_ORDR_DT           /* DC처방일시*/
						,  a.SORT_SQNC as SORT_SQNC                                           /* 정렬순서*/
						,  a.RHBL_ORDR_UNSL_CTN as RHBL_ORDR_UNSL_CTN                                  /* 재활처방특이내용*/
						,  a.INPT_USER_DVSN_CD as INPT_USER_DVSN_CD                                   /* 입력사용자구분코드*/
						,  a.CRTF_DVSN_CD as CRTF_DVSN_CD                                        /* 인증구분코드*/
						,  a.ATHN_ID as ATHN_ID                                             /* 인증자ID*/
						,  a.CRTF_IP as CRTF_IP                                             /* 인증IP*/
						,  to_char ( a.CRTF_DT, 'YYYYMMDDhh24miss') as CRTF_DT              /* 인증일시*/
						,  a.CLRS_PRJC_CD as CLRS_PRJC_CD                                        /* 임상연구과제코드*/
						,  a.CLRS_PRJC_DR_ID as CLRS_PRJC_DR_ID                                     /* 임상연구과제의사ID*/
						,  a.ORDR_IPDV_CD as ORDR_IPDV_CD                                        /* 보험급여구분코드*/
						,  a.PTPT_CD as PTPT_CD                                             /* 환자가야할장소코드*/
						,  a.CNNT_ORDR_BNDL_NO as CNNT_ORDR_BNDL_NO                                   /* 동시처방묶음번호*/
						 ,  to_char ( a.ORDR_VALD_STRT_YMD, 'YYYYMMDD') as ORDR_VALD_STRT_YMD          /* 처방유효시작일자*/
						 ,  to_char ( a.ORDR_VALD_FNSH_YMD, 'YYYYMMDD') as ORDR_VALD_FNSH_YMD          /* 처방유효종료일자*/
						,  a.IMPL_ORDR_PBLC_NTM as IMPL_ORDR_PBLC_NTM                                  /* 실시처방발행횟수*/
						,  a.IMPL_ORDR_PBLC_LMTT_NTM as IMPL_ORDR_PBLC_LMTT_NTM                             /* 실시처방발행제한횟수*/
						 ,  to_char ( a.ORGL_ORDR_YMD, 'YYYYMMDD') as ORGL_ORDR_YMD               /* 원처방일자*/
						,  a.ORGL_ORDR_SNO as ORGL_ORDR_SNO                                       /* 원처방일련번호*/
						,  a.MDSI_CD as MDSI_CD                                             /* 치료부위코드*/
						,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'SH004' and COMN_DTLS_CD = a.MDSI_CD and rownum = 1 )  as MDSI_NM  /* (재활) 치료부위명 */
						,  a.MDTE_LCTN_CD as MDTE_LCTN_CD                                        /* 치료위치코드*/
						,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'MM191' and COMN_DTLS_CD = a.MDTE_LCTN_CD and rownum = 1 ) as AFI_MDTE_LCTN_NM  /* (재활) 치료부위명 */
						,  a.MDTE_FRQN_CD as MDTE_FRQN_CD                                        /* 치료빈도코드*/
						,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'SH005' and COMN_DTLS_CD = a.MDTE_FRQN_CD and rownum = 1 ) as AFI_MDTE_FRQN_NM  /* (재활) 치료빈도명 */
						,  a.ONDY_MDTE_NTM as ONDY_MDTE_NTM                                       /* 하루치료횟수*/
						,  ( select DETL_CD_NM from CCCMCDDMT where COMN_GRP_CD = 'SH006' and COMN_DTLS_CD = a.ONDY_MDTE_NTM and rownum = 1 ) as AFI_ONDY_MDTE_NTM_STR /* (재활) 치료횟수(1일)명  */
						,  a.MDTE_DDCN as MDTE_DDCN                                           /* 치료일수*/
						 ,  to_char ( a.RHMD_STRT_YMD, 'YYYYMMDD') as RHMD_STRT_YMD               /* 재활치료시작일자*/
						 ,  to_char ( a.RHMD_FNSH_YMD, 'YYYYMMDD') as RHMD_FNSH_YMD               /* 재활치료종료일자*/
						 ,  to_char ( a.RHMD_NEED_YMD, 'YYYYMMDD') as RHMD_NEED_YMD               /* 재활치료필요일자*/
						,  a.APNT_NTM as APNT_NTM                                            /* 예약횟수*/
						,  a.ENFR_NTM as ENFR_NTM                                            /* 시행횟수*/
						,  a.RHBL_ORDR_PRSS_CD as RHBL_ORDR_PRSS_CD                                   /* 재활처방진행상태코드*/
						,  a.ACIM_NURS_ID as ACIM_NURS_ID                                        /* 액팅실시간호사ID*/
						,  to_char ( a.ACTN_DT, 'YYYYMMDDhh24miss') as ACTN_DT              /* 액팅일시*/
						,  to_char ( a.ACIM_INPT_DT, 'YYYYMMDDhh24miss') as ACIM_INPT_DT         /* 액팅실시입력일시*/
						,  to_char ( a.ACIM_UPDT_DT, 'YYYYMMDDhh24miss') as ACIM_UPDT_DT         /* 액팅실시수정일시*/
						,  a.ACIM_SPAB_CTN as ACIM_SPAB_CTN                                       /* 액팅실시특기내용*/
						,  a.DISS_CD as DISS_CD                                             /* 질환코드*/
						,  a.ORDR_CRTN_DVSN_CD as ORDR_CRTN_DVSN_CD                                   /* 처방생성구분코드*/
						,  a.ORDR_CRTN_LNKN_NO as ORDR_CRTN_LNKN_NO                                   /* 처방생성연결번호*/
		                ,  a.SPOR_BNDL_NM                                     /* 스페셜처방묶음명 */
		                ,  a.SPOR_BNDL_NO                                     /* 스페셜처방묶음번호*/                
						,  a.FRST_RGSR_ID as FRST_RGSR_ID                                        /* 최초등록자ID*/
						,  a.FRST_RGST_IP as FRST_RGST_IP                                        /* 최초등록IP*/
						,  to_char ( a.FRST_RGST_DT, 'YYYYMMDDhh24miss') as FRST_RGST_DT         /* 최초등록일시*/
						,  a.LAST_UPDR_ID as LAST_UPDR_ID                                        /* 최종수정자ID*/
						,  a.LAST_UPDT_IP as LAST_UPDT_IP                                        /* 최종수정IP*/
						,  to_char ( a.LAST_UPDT_DT, 'YYYYMMDDhh24miss') as LAST_UPDT_DT         /* 최종수정일시*/
						,  b.ORDR_NM as ORDR_NM                                             /* 처방명*/
						,  b.ORDR_PSBL_DVSN_CD as ORDR_PSBL_DVSN_CD                                   /* 처방가능구분코드*/
						,  c.INSR_IPDV_CD as INSR_IPDV_CD                                        /* 보험급여구분(AI041)*/
						,  c.PRTC_IPDV_CD as PRTC_IPDV_CD                                        /* 보호급여구분(AI041)*/
						,  c.INCS_IPDV_CD as INCS_IPDV_CD                                        /* 산재급여구분(AI041)*/
						,  c.TAIN_IPDV_CD as TAIN_IPDV_CD                                        /* 자보급여구분(AI041)*/
						,  c.INSR_EDI_CD  as INSR_EDI_CD 										 /* 보험EDI코드 */
		                ,  b.INSR_ACKN_BASE_CECK_YN as INSR_ACKN_BASE_CECK_YN /* 보험인정기준체크여부 */
		                ,  a.SUB_TYPE_CD as SUB_TYPE_CD /* 부유형코드 */
		                ,  a.SCRG_INPY_ONBR_RT as SCRG_INPY_ONBR_RT /* 선별급여본인부담율 */
		                ,  a.EXCF_CD      as EXCF_CD
					 from  MDREHORDT a
						,  MDORDRCMT b
						,  AIMFMDFET c
		                ,  APRCRPTNT rcr
					where  a.PTNO = #{ptno}
					  and  a.ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )
					  and  a.CODV_CD  = #{codvCd}
		 		  ]]>			  
			      <if test='orocDprtCd != null and orocDprtCd != ""'>
		              and  a.OROC_DPRT_CD = #{orocDprtCd}
				  </if>  
				  <if test='odkiCd != null and odkiCd != ""'>
		              and  a.ODKI_CD = #{odkiCd}              
				  </if>  
		          <if test='codvCd == "O" and chdrId != null and chdrId != ""'>
		              and a.CHDR_ID = #{chdrId}
		          </if>  
		          <if test='codvCd == "O"'>
		              and rcr.CNCL_DT is null
		          </if>
		          <choose>
		            <when test='dcDvsnCd=="T"'>
		              and  a.DC_DVSN_CD = #{dcDvsnCd}
		            </when>
		            <otherwise>
		              and  a.DC_DVSN_CD not in ( 'X' , 'F' , 'E', 'T' ) /*  취소, 실처방 전환, 임시처방 취소, 외래당일입원가처방은 조회 제외 */				  
		              /*  DC_DVSN_CD 가 'N' 이거나 NULL 인 경우 전체조회 */
					  /*  DC_DVSN_CD 임시처방인 경우는 DC_DVSN_CD 'Y' 것도 같이 조회 */
					  and  'TRUE' = case when #{dcDvsnCd} = 'N' or #{dcDvsnCd} is null then 'TRUE'
										 else case when a.DC_DVSN_CD = #{dcDvsnCd} then 'TRUE'
												   when a.DC_DVSN_CD = 'Y' then 'TRUE'
												   end
										 end
		            </otherwise>
		          </choose>       
				  <![CDATA[
					  /*  Client logic 이동 외래일때 같은 진료과만 처리 */
					  and  'TRUE' = case when a.CODV_CD = 'O'
										 then case when a.MCDP_CD like #{mcdpCd} ||'%' /* 단독 처방 조회 기능이 있어서 like 로 처리*/
											  then 'TRUE'
											  else 'FALSE' end
										 else 'TRUE'
										 end
					  and  'TRUE' = case when a.CODV_CD <> 'O'
										 then case when a.MDRP_NO = #{mdrpNo}
											  then 'TRUE'
											  else 'FALSE'
											  end
										 else 'TRUE'
										 end
					  /*  단독 처방 조회 */
					  and   'TRUE' = case when #{ordrSno} > 0
										  then case when a.ORDR_SNO = #{ordrSno}
													then 'TRUE'
													else 'FALSE'
													end
										  else 'TRUE'
										  end
					  and  a.ORDR_CD = b.ORDR_CD(+)
					  and  a.ORDR_CD = c.MDFE_CD(+)
					  and  to_date ( #{ordrYmd} , 'YYYYMMDD' ) between c.APST_YMD(+) and c.APFN_YMD (+)
		              and  a.MDRP_NO = rcr.MDRP_NO
		      order
					by    decode(a.ODKI_DETL_CD, 'Z', a.SPOR_BNDL_NO, 0)
		                ,  a.FRST_RGST_DT
						,  a.SORT_SQNC
		                ,  a.ORDR_SNO
		 			]]>
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-updateRhblOrdr (재활 처방 Update) 
        Description :                                           처방 내림한 재활 처방을 수정한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-updateRhblOrdr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO"  >
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-updateRhblOrdr */
		             MDREHORDT a
		       set
		             MCDP_CD = #{mcdpCd}                                                  /*  진료과코드 */
		          ,  WARD_CD = #{wardCd}                                                   /*  병동코드 */
		          ,  ORCL_CD = #{orclCd}                                                      /*  처방분류코드 */
		          ,  ODKI_CD = #{odkiCd}                                                      /*  처방종류코드 */
		          ,  ODKI_DETL_CD = #{odkiDetlCd}                                        /*  처방종류상세코드(신규) */
		          ,  ORDR_CLTY_CD = #{ordrCltyCd}                                        /*  처방분류유형코드 */
		          ,  SLIP_CD = #{slipCd}                                                        /*  SLIP 코드 */
		          ,  CHDR_ID = #{chdrId}                                                      /*  지정의사ID */
		          ,  GNDR_ID = #{gndrId}                                                      /*  주치의사ID */
		          ,  MDSI_CD = #{mdsiCd}                                                    /*  치료부위코드 */
		          ,  MDTE_LCTN_CD = #{mdteLctnCd}                                     /*  치료위치코드 */
		          ,  MDTE_FRQN_CD = #{mdteFrqnCd}                                    /*  치료빈도코드 */
		          ,  ONDY_MDTE_NTM = #{ondyMdteNtm}                              /*  하루치료횟수 */
		          ,  MDTE_DDCN = #{mdteDdcn}                                           /*  치료일수 */
		          ,  PTPT_CD = #{ptptCd}                                                      /*  환자가야할장소코드 */
		          ,  RHBL_ORDR_UNSL_CTN = #{rhblOrdrUnslCtn}                     /*  재활처방특이내용 */
		          ,  ORDR_IPDV_CD = #{ordrIpdvCd}                                       /*  처방급여구분코드 */
		          ,  CLRS_PRJC_CD = #{clrsPrjcCd}                                          /*  임상연구과제코드 */
		          ,  CLRS_PRJC_DR_ID = #{clrsPrjcDrId}                                    /*  임상연구과제의사ID */
		          ,  ATHN_ID = #{athnId}                                                      /*  인증자ID */
		          ,  CRTF_IP = #{crtfIp}                                                         /*  인증IP */
		          ,  CRTF_DT = to_date ( #{crtfDt}, 'YYYYMMDDhh24miss' )       /*  인증일시 */
		          ,  RHMD_NEED_YMD = to_date ( #{rhmdNeedYmd}, 'YYYYMMDD' )
		          ,  SPOR_BNDL_NM = #{sporBndlNm}                                    /* 스페셜처방묶음명 */
		          ,  SPOR_BNDL_NO = #{sporBndlNo}                                    /* 스페셜처방묶음번호*/                            
		          ,  LAST_UPDR_ID = #{gvUserId}                                           /*  최종수정자ID */
		          ,  LAST_UPDT_IP = #{gvUserIp}                                           /*  최종수정IP */
		          ,  LAST_UPDT_DT = sysdate                                              /*  최종수정일시 */
		          ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}                 /*  최종수정SMC클라이언트프로그램ID */
		          ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}                 /*  최종수정SMC서버프로그램ID      */
		          ,  ORDR_UPDT_DT = sysdate                                            /*  처방수정일시*/
		          ,  ORDR_UPDR_ID  = #{gvUserId}                                       /*  처방수정자ID*/
		          ,  APNT_NTM = #{apntNtm}
		          ,  ENFR_NTM = #{enfrNtm}
		          ,  RHBL_ORDR_PRSS_CD = #{rhblOrdrPrssCd}
		          ,  DISS_CD = #{dissCd}
		          ,  RHMD_FNSH_YMD = to_date (#{rhmdFnshYmd}, 'YYYYMMDD' )
		          ,  RHMD_STRT_YMD =  to_date (#{rhmdStrtYmd}, 'YYYYMMDD' )
		          ,  SUB_TYPE_CD = #{subTypeCd}
		          ,  SCRG_INPY_ONBR_RT = #{scrgInpyOnbrRt}
		          ,  EXCF_CD = nvl(#{excfCd}, (select EXCF_CD from MDORDRCMT where ORDR_CD = a.ORDR_CD))
		 where  PTNO = #{ptno}                                                            /*  환자번호 */
		    and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )           /*  처방일자 */
		    and  ORDR_SNO = #{ordrSno}                                                /*  처방SEQ */
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-updateRhblOrdrDc (재활처방 DC 및 취소) 
        Description :                                           처방 내림한 재활처방을 DC 및 취소 처리한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-updateRhblOrdrDc"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO"  >
		 update  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-updateRhblOrdrDc */
		             MDREHORDT
		       set  DC_DVSN_CD = #{dcDvsnCd}
		           ,  DC_ODDR_ID = #{dcOddrId}
		           ,  DC_ORDR_DT = to_date ( #{dcOrdrDt}, 'YYYYMMDDhh24miss' )
		           ,  LAST_UPDR_ID = #{gvUserId}                                                   /*  최종수정자ID                  */
		           ,  LAST_UPDT_IP = #{gvUserIp}                                                   /*  최종수정IP                    */
		           ,  LAST_UPDT_DT = to_date ( #{dcOrdrDt}, 'YYYYMMDDhh24miss' )                   /*  최종수정일시                     */
		           ,  LAST_UPDT_CLNT_PRGM_ID = #{gvClntPrgmId}                                     /*  최종수정SMC클라이언트프로그램ID */
		           ,  LAST_UPDT_SRVR_PRGM_ID = #{gvSrvrPrgmId}                                     /*  최종수정SMC서버프로그램ID      */
		   where  PTNO = #{ptno}
		       and  ORDR_YMD = to_date ( #{ordrYmd}, 'YYYYMMDD' )                                /* 처방일자 */
		       and  ORDR_SNO = #{ordrSno}                                                        /* 처방일련번호 */
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-insertRhblOrdr (재활 처방 저장) 
        Description :                                           환자 치료를 위한 처방 내림 중 재활 처방을 저장한다.
                                            
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO
    -->	
	<insert id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-insertRhblOrdr"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO"  >
		<![CDATA[		  
		           insert  /*+ SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-insertRhblOrdr */
				   into  MDREHORDT
				   (
						   PTNO                       /* 환자번호*/
						   ,  ORDR_YMD                /* 처방일자*/
						   ,  ORDR_SNO                /* 처방일련번호*/
						   ,  MDRP_NO                 /* 진료접수번호*/
						   ,  ORDR_CD                 /* 처방코드*/
						   ,  MCDP_CD                 /* 진료과코드*/
						   ,  ODDR_ID                 /* 처방의사ID*/
						   ,  CHDR_ID                 /* 지정의사ID*/
						   ,  GNDR_ID                 /* 주치의사ID*/
						   ,  CODV_CD                 /* 내원구분코드*/
						   ,  ORDR_CLTY_CD            /* 처방분류유형코드*/
						   ,  ORCL_CD                 /* 처방분류코드*/
						   ,  ODKI_CD                 /* 처방종류코드*/
						   ,  ODKI_DETL_CD            /* 처방종류상세코드*/
						   ,  HSLC_DVSN_CD            /* 위치구분코드*/
						   ,  MCCN_CD                 /* 진료센터코드*/
						   ,  WARD_CD                 /* 병동코드*/
						   ,  OROC_DPRT_CD            /* 처방발생원코드*/	   
						   ,  SLIP_CD                 /* SLIP코드*/
						   ,  TMPR_ORDR_YN            /* 임시처방여부*/
						   ,  DC_DVSN_CD              /* DC구분코드*/
						   ,  DC_ODDR_ID              /* DC처방의사ID*/
						   ,  DC_ORDR_DT              /* DC처방일시*/
						   ,  SORT_SQNC               /* 정렬순서*/
						   ,  RHBL_ORDR_UNSL_CTN      /* 재활처방특이내용*/
						   ,  INPT_USER_DVSN_CD       /* 입력사용자구분코드*/
						   ,  CRTF_DVSN_CD            /* 인증구분코드*/
						   ,  ATHN_ID                 /* 인증자ID*/
						   ,  CRTF_IP                 /* 인증IP*/
						   ,  CRTF_DT                 /* 인증일시*/
						   ,  CLRS_PRJC_CD            /* 임상연구과제코드*/
						   ,  CLRS_PRJC_DR_ID         /* 임상연구과제의사ID*/
						   ,  ORDR_IPDV_CD            /* 보험급여구분코드*/
						   ,  PTPT_CD                 /* 환자가야할장소코드*/
						   ,  CNNT_ORDR_BNDL_NO       /* 동시처방묶음번호*/
						   ,  ORDR_VALD_STRT_YMD      /* 처방유효시작일자*/
						   ,  ORDR_VALD_FNSH_YMD      /* 처방유효종료일자*/
						   ,  IMPL_ORDR_PBLC_NTM      /* 실시처방발행횟수*/
						   ,  IMPL_ORDR_PBLC_LMTT_NTM /* 실시처방발행제한횟수*/
						   ,  ORGL_ORDR_YMD           /* 원처방일자*/
						   ,  ORGL_ORDR_SNO           /* 원처방일련번호*/
						   ,  MDSI_CD                 /* 치료부위코드*/
						   ,  MDTE_LCTN_CD            /* 치료위치코드*/
						   ,  MDTE_FRQN_CD            /* 치료빈도코드*/
						   ,  ONDY_MDTE_NTM           /* 하루치료횟수*/
						   ,  MDTE_DDCN               /* 치료일수*/
						   ,  RHMD_STRT_YMD           /* 재활치료시작일자*/
						   ,  RHMD_FNSH_YMD           /* 재활치료종료일자*/
						   ,  RHMD_NEED_YMD           /* 재활치료필요일자*/
						   ,  APNT_NTM                /* 예약횟수*/
						   ,  ENFR_NTM                /* 시행횟수*/
						   ,  RHBL_ORDR_PRSS_CD       /* 재활처방진행상태코드*/
						   ,  ACIM_NURS_ID            /* 액팅실시간호사ID*/
						   ,  ACTN_DT                 /* 액팅일시*/
						   ,  ACIM_INPT_DT            /* 액팅실시입력일시*/
						   ,  ACIM_UPDT_DT            /* 액팅실시수정일시*/
						   ,  ACIM_SPAB_CTN           /* 액팅실시특기내용*/
						   ,  DISS_CD                 /* 질환코드*/
						   ,  ORDR_CRTN_DVSN_CD       /* 처방생성구분코드*/
						   ,  ORDR_CRTN_LNKN_NO       /* 처방생성연결번호*/
		                   ,  SPOR_BNDL_NM             /* 스페셜처방묶음명 */
		                   ,  SPOR_BNDL_NO             /* 스페셜처방묶음번호*/                             
						   ,  FRST_RGSR_ID            /* 최초등록자ID*/
						   ,  FRST_RGST_IP            /* 최초등록IP*/
						   ,  FRST_RGST_DT            /* 최초등록일시*/
						   ,  FRST_RGST_CLNT_PRGM_ID  /* 최초등록SMC클라이언트프로그램ID*/
						   ,  FRST_RGST_SRVR_PRGM_ID  /* 최초등록SMC서버프로그램ID*/
						   ,  LAST_UPDR_ID            /* 최종수정자ID*/
						   ,  LAST_UPDT_IP            /* 최종수정IP*/
						   ,  LAST_UPDT_DT            /* 최종수정일시*/
						   ,  LAST_UPDT_CLNT_PRGM_ID  /* 최종수정SMC클라이언트프로그램ID*/
						   ,  LAST_UPDT_SRVR_PRGM_ID  /* 최종수정SMC서버프로그램ID*/
						   ,  ORDR_UPDT_DT            /* 처방수정일시*/
						   ,  ORDR_UPDR_ID            /* 처방수정자ID*/
		                   ,  SUB_TYPE_CD				/* 부유형코드 */
		                   ,  SCRG_INPY_ONBR_RT		/* 선별급여본인부담율 */
		                   ,  EXCF_CD
				   )
				   values  (
							   #{ptno}                            /* 환자번호*/
							,  to_date ( #{ordrYmd}, 'YYYYMMDD' ) /* 처방일자*/
							,  #{ordrSno}                         /* 처방일련번호*/
							,  #{mdrpNo}                          /* 진료접수번호*/
							,  #{ordrCd}                          /* 처방코드*/
							,  #{mcdpCd}                          /* 진료과코드*/
							,  #{oddrId}                          /* 처방의사id*/
							,  #{chdrId}                          /* 지정의사id*/
							,  #{gndrId}                          /* 주치의사id*/
							,  #{codvCd}                          /* 내원구분코드 [d: dsc, e:응급, g: 건진, h:가정간호, i:입원, o:외래 - asis(ap025)]*/
							,  #{ordrCltyCd}                      /* 처방분류유형코드 [주사약, 외용약, 검체검사, 환자검사 인지를 구별하는 코드로 처방 분류(ai048)의 상위개념으로 볼 수 있다. *. 수가 테이블에 있는 정보를 가져옴. asis(mm182)]*/
							,  #{orclCd}                          /* 처방분류코드*/
							,  #{odkiCd}                          /* 처방종류코드*/
							,  #{odkiDetlCd}                      /* 처방종류상세코드*/
							,  #{hslcDvsnCd}                      /* 위치구분코드*/
							,  nvl(#{mccnCd},'-')                 /* 진료센터코드*/
							,  #{wardCd}                          /* 병동코드*/
							,  #{orocDprtCd}                          /* 처방발생원코드*/
							,  #{slipCd}                          /* slip코드*/
							,  #{tmprOrdrYn}                      /* 임시처방여부*/
							,  #{dcDvsnCd}                        /* dc구분코드*/
							,  #{dcOddrId}                        /* dc처방의사id*/
							,  to_date ( #{dcOrdrDt}, 'YYYYMMDDhh24miss') /* dc처방일시*/
							,  #{sortSqnc}                        /* 정렬순서*/
							,  #{rhblOrdrUnslCtn}                 /* 재활처방특이내용*/
							,  #{inptUserDvsnCd}                  /* 입력사용자구분코드*/
							,  case when #{crtfDvsnCd} is null then '0' else #{crtfDvsnCd} end  /* 인증구분코드*/
							,  #{athnId}                          /* 인증자id*/
							,  #{crtfIp}                          /* 인증ip*/
							,  to_date ( #{crtfDt}, 'YYYYMMDDhh24miss') /* 인증일시*/
							,  #{clrsPrjcCd}                      /* 임상연구과제코드*/
							,  #{clrsPrjcDrId}                    /* 임상연구과제의사id*/
							,  #{ordrIpdvCd}                      /* 보험급여구분코드*/
							,  #{ptptCd}                          /* 환자가야할장소코드*/
							,  #{cnntOrdrBndlNo}                  /* 동시처방묶음번호*/
							,  #{ordrValdStrtYmd}                 /* 처방유효시작일자*/
							,  #{ordrValdFnshYmd}                 /* 처방유효종료일자*/
							,  #{implOrdrPblcNtm}                 /* 실시처방발행횟수*/
							,  #{implOrdrPblcLmttNtm}             /* 실시처방발행제한횟수*/
							,  #{orglOrdrYmd}                     /* 원처방일자*/
							,  #{orglOrdrSno}                     /* 원처방일련번호*/
							,  #{mdsiCd}                          /* 치료부위코드*/
							,  #{mdteLctnCd}                      /* 치료위치코드*/
							,  #{mdteFrqnCd}                      /* 치료빈도코드*/
							,  #{ondyMdteNtm}                     /* 하루치료횟수*/
							,  #{mdteDdcn}                        /* 치료일수*/
							,  to_date ( #{rhmdStrtYmd}, 'YYYYMMDD' ) /* 재활치료시작일자*/
							,  to_date ( #{rhmdFnshYmd}, 'YYYYMMDD' ) /* 재활치료종료일자*/
							,  to_date ( #{rhmdNeedYmd}, 'YYYYMMDD' )                    /* 재활치료필요일자*/
							,  #{apntNtm}                         /* 예약횟수*/
							,  #{enfrNtm}                         /* 시행횟수*/
							,  #{rhblOrdrPrssCd}                  /* 재활처방진행상태코드*/
							,  #{acimNursId}                      /* 액팅실시간호사id*/
							,  to_date ( #{actnDt}, 'YYYYMMDDhh24miss')     /* 액팅일시*/
							,  to_date ( #{acimInptDt}, 'YYYYMMDDhh24miss') /* 액팅실시입력일시*/
							,  to_date ( #{acimUpdtDt}, 'YYYYMMDDhh24miss') /* 액팅실시수정일시*/
							,  #{acimSpabCtn}                    /* 액팅실시특기내용*/
							,  #{dissCd}                         /* 질환코드*/
							,  #{ordrCrtnDvsnCd}                 /* 처방생성구분코드*/
							,  #{ordrCrtnLnknNo}                 /* 처방생성연결번호*/
		                    ,  #{sporBndlNm}                     /* 스페셜처방묶음명 */
		                    ,  #{sporBndlNo}                     /* 스페셜처방묶음번호 */                           
							,  #{gvUserId}                       /* 최초등록자ID*/
							,  #{gvUserIp}                       /* 최초등록IP*/
							,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss')/* 최초등록일시*/
							,  #{gvClntPrgmId}                   /* 최초등록SMC클라이언트프로그램ID*/
							,  #{gvSrvrPrgmId}                   /* 최초등록SMC서버프로그램ID*/
							,  #{gvUserId}                       /* 최종수정자ID*/
							,  #{gvUserIp}                       /* 최종수정IP*/
							,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss')/* 최종수정일시*/
							,  #{gvClntPrgmId}                   /* 최종수정SMC클라이언트프로그램ID*/
							,  #{gvSrvrPrgmId}                   /* 최종수정SMC서버프로그램ID*/
							,  to_date ( #{frstRgstDt}, 'YYYYMMDDhh24miss') /* 처방수정일시*/
							,  #{gvUserId}                       /* 처방수정자ID*/
		                    ,  #{subTypeCd}
		                    ,  #{scrgInpyOnbrRt}
		                    ,  nvl(#{excfCd}, (select EXCF_CD from MDORDRCMT where ORDR_CD = #{ordrCd}))
				   )
					]]>
	</insert>


	<resultMap id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneMdrehordt-result" type="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO">
	
		<result property="ptno" column="PTNO"/>
		<result property="ordrYmd" column="ORDR_YMD"/>
		<result property="ordrSno" column="ORDR_SNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="ordrCd" column="ORDR_CD"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="oddrId" column="ODDR_ID"/>
		<result property="chdrId" column="CHDR_ID"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="ordrCltyCd" column="ORDR_CLTY_CD"/>
		<result property="orclCd" column="ORCL_CD"/>
		<result property="odkiCd" column="ODKI_CD"/>
		<result property="odkiDetlCd" column="ODKI_DETL_CD"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="orocCdOld" column="OROC_CD_OLD"/>
		<result property="slipCd" column="SLIP_CD"/>
		<result property="tmprOrdrYn" column="TMPR_ORDR_YN"/>
		<result property="dcDvsnCd" column="DC_DVSN_CD"/>
		<result property="dcOddrId" column="DC_ODDR_ID"/>
		<result property="dcOrdrDt" column="DC_ORDR_DT"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
		<result property="rhblOrdrUnslCtn" column="RHBL_ORDR_UNSL_CTN"/>
		<result property="inptUserDvsnCd" column="INPT_USER_DVSN_CD"/>
		<result property="crtfDvsnCd" column="CRTF_DVSN_CD"/>
		<result property="athnId" column="ATHN_ID"/>
		<result property="crtfIp" column="CRTF_IP"/>
		<result property="crtfDt" column="CRTF_DT"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="clrsPrjcDrId" column="CLRS_PRJC_DR_ID"/>
		<result property="ordrIpdvCd" column="ORDR_IPDV_CD"/>
		<result property="ptptCd" column="PTPT_CD"/>
		<result property="cnntOrdrBndlNo" column="CNNT_ORDR_BNDL_NO"/>
		<result property="ordrValdStrtYmd" column="ORDR_VALD_STRT_YMD"/>
		<result property="ordrValdFnshYmd" column="ORDR_VALD_FNSH_YMD"/>
		<result property="implOrdrPblcNtm" column="IMPL_ORDR_PBLC_NTM"/>
		<result property="implOrdrPblcLmttNtm" column="IMPL_ORDR_PBLC_LMTT_NTM"/>
		<result property="orglOrdrYmd" column="ORGL_ORDR_YMD"/>
		<result property="orglOrdrSno" column="ORGL_ORDR_SNO"/>
		<result property="mdsiCd" column="MDSI_CD"/>
		<result property="mdteLctnCd" column="MDTE_LCTN_CD"/>
		<result property="mdteFrqnCd" column="MDTE_FRQN_CD"/>
		<result property="ondyMdteNtm" column="ONDY_MDTE_NTM"/>
		<result property="mdteDdcn" column="MDTE_DDCN"/>
		<result property="rhmdStrtYmd" column="RHMD_STRT_YMD"/>
		<result property="rhmdFnshYmd" column="RHMD_FNSH_YMD"/>
		<result property="rhmdNeedYmd" column="RHMD_NEED_YMD"/>
		<result property="apntNtm" column="APNT_NTM"/>
		<result property="enfrNtm" column="ENFR_NTM"/>
		<result property="rhblOrdrPrssCd" column="RHBL_ORDR_PRSS_CD"/>
		<result property="acimNursId" column="ACIM_NURS_ID"/>
		<result property="actnDt" column="ACTN_DT"/>
		<result property="acimInptDt" column="ACIM_INPT_DT"/>
		<result property="acimUpdtDt" column="ACIM_UPDT_DT"/>
		<result property="acimSpabCtn" column="ACIM_SPAB_CTN"/>
		<result property="dissCd" column="DISS_CD"/>
		<result property="ordrCrtnDvsnCd" column="ORDR_CRTN_DVSN_CD"/>
		<result property="ordrCrtnLnknNo" column="ORDR_CRTN_LNKN_NO"/>
		<result property="ordrUpdtDt" column="ORDR_UPDT_DT"/>
		<result property="ordrUpdrId" column="ORDR_UPDR_ID"/>
		<result property="orocDprtCd" column="OROC_DPRT_CD"/>
		<result property="sporBndlNm" column="SPOR_BNDL_NM"/>
		<result property="sporBndlNo" column="SPOR_BNDL_NO"/>
		<result property="subTypeCd" column="SUB_TYPE_CD"/>
		<result property="scrgInpyOnbrRt" column="SCRG_INPY_ONBR_RT"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneMdrehordt () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO
		resultMap : com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneMdrehordt-result
    -->
	<select id="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneMdrehordt"  parameterType="com.sds.healthcare.ehr.med.md.mdp.vo.MdpOrdrRhblMngmDVO"  resultMap="com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneMdrehordt-result" useCache="true" flushCache="false">
		select  /*SQL_ID: com-sds-healthcare-ehr-med-md-mdp-dao-MdpOrdrRhblMngmDAO-selectOneMdrehordt */
		        PTNO                    as PTNO                      
		     ,  to_char(ORDR_YMD,'YYYYMMDD') as ORDR_YMD               
		     ,  ORDR_SNO                as ORDR_SNO               
		     ,  MDRP_NO                 as MDRP_NO                
		     ,  ORDR_CD                 as ORDR_CD                
		     ,  MCDP_CD                 as MCDP_CD                
		     ,  ODDR_ID                 as ODDR_ID                
		     ,  CHDR_ID                 as CHDR_ID                
		     ,  GNDR_ID                 as GNDR_ID                
		     ,  CODV_CD                 as CODV_CD                
		     ,  ORDR_CLTY_CD            as ORDR_CLTY_CD           
		     ,  ORCL_CD                 as ORCL_CD                
		     ,  ODKI_CD                 as ODKI_CD                
		     ,  ODKI_DETL_CD            as ODKI_DETL_CD           
		     ,  HSLC_DVSN_CD            as HSLC_DVSN_CD           
		     ,  MCCN_CD                 as MCCN_CD                
		     ,  WARD_CD                 as WARD_CD                
		     ,  OROC_CD_OLD             as OROC_CD_OLD            
		     ,  SLIP_CD                 as SLIP_CD                
		     ,  TMPR_ORDR_YN            as TMPR_ORDR_YN           
		     ,  DC_DVSN_CD              as DC_DVSN_CD             
		     ,  DC_ODDR_ID              as DC_ODDR_ID             
		     ,  DC_ORDR_DT              as DC_ORDR_DT             
		     ,  SORT_SQNC               as SORT_SQNC              
		     ,  RHBL_ORDR_UNSL_CTN      as RHBL_ORDR_UNSL_CTN     
		     ,  INPT_USER_DVSN_CD       as INPT_USER_DVSN_CD      
		     ,  CRTF_DVSN_CD            as CRTF_DVSN_CD           
		     ,  ATHN_ID                 as ATHN_ID                
		     ,  CRTF_IP                     as CRTF_IP                
		     ,  to_char (CRTF_DT, 'YYYYMMDDhh24miss') as CRTF_DT                
		     ,  CLRS_PRJC_CD            as CLRS_PRJC_CD           
		     ,  CLRS_PRJC_DR_ID         as CLRS_PRJC_DR_ID        
		     ,  ORDR_IPDV_CD            as ORDR_IPDV_CD           
		     ,  PTPT_CD                 as PTPT_CD                
		     ,  CNNT_ORDR_BNDL_NO       as CNNT_ORDR_BNDL_NO      
		     ,  to_char(ORDR_VALD_STRT_YMD,'YYYYMMDD') as ORDR_VALD_STRT_YMD     
		     ,  to_char(ORDR_VALD_FNSH_YMD,'YYYYMMDD') as ORDR_VALD_FNSH_YMD     
		     ,  IMPL_ORDR_PBLC_NTM      as IMPL_ORDR_PBLC_NTM     
		     ,  IMPL_ORDR_PBLC_LMTT_NTM as IMPL_ORDR_PBLC_LMTT_NTM
		     ,  to_char(ORGL_ORDR_YMD,'YYYYMMDD') as ORGL_ORDR_YMD          
		     ,  ORGL_ORDR_SNO           as ORGL_ORDR_SNO          
		     ,  MDSI_CD                 as MDSI_CD                
		     ,  MDTE_LCTN_CD            as MDTE_LCTN_CD           
		     ,  MDTE_FRQN_CD            as MDTE_FRQN_CD           
		     ,  ONDY_MDTE_NTM           as ONDY_MDTE_NTM          
		     ,  MDTE_DDCN               as MDTE_DDCN              
		     ,  to_char(RHMD_STRT_YMD,'YYYYMMDD') as RHMD_STRT_YMD          
		     ,  to_char(RHMD_FNSH_YMD,'YYYYMMDD') as RHMD_FNSH_YMD          
		     ,  to_char(RHMD_NEED_YMD,'YYYYMMDD') as RHMD_NEED_YMD          
		     ,  APNT_NTM                as APNT_NTM               
		     ,  ENFR_NTM                as ENFR_NTM               
		     ,  RHBL_ORDR_PRSS_CD       as RHBL_ORDR_PRSS_CD      
		     ,  ACIM_NURS_ID            as ACIM_NURS_ID           
		     ,  to_char (ACTN_DT, 'YYYYMMDDhh24miss') as ACTN_DT                
		     ,  to_char (ACIM_INPT_DT, 'YYYYMMDDhh24miss') as ACIM_INPT_DT           
		     ,  to_char (ACIM_UPDT_DT, 'YYYYMMDDhh24miss') as ACIM_UPDT_DT           
		     ,  ACIM_SPAB_CTN           as ACIM_SPAB_CTN          
		     ,  DISS_CD                 as DISS_CD                
		     ,  ORDR_CRTN_DVSN_CD       as ORDR_CRTN_DVSN_CD      
		     ,  ORDR_CRTN_LNKN_NO       as ORDR_CRTN_LNKN_NO      
		     ,  to_char (ORDR_UPDT_DT, 'YYYYMMDDhh24miss') as ORDR_UPDT_DT           
		     ,  ORDR_UPDR_ID            as ORDR_UPDR_ID           
		     ,  OROC_DPRT_CD            as OROC_DPRT_CD          
		     ,  SPOR_BNDL_NM           as SPOR_BNDL_NM
		     ,  SPOR_BNDL_NO           as SPOR_BNDL_NO
		     ,  SUB_TYPE_CD               as SUB_TYPE_CD
		     ,  SCRG_INPY_ONBR_RT    as SCRG_INPY_ONBR_RT
		  from  MDREHORDT
		 where  PTNO = #{ptno}
		   and  ORDR_YMD = to_date (#{ordrYmd},'YYYYMMDD')
		   and  ORDR_SNO = #{ordrSno}  
	</select>



</mapper>