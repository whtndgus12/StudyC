<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_MnrCareActtDAO_sql.xml 
    Description : MnrCareActtDAO 클래스 
-->
    
<mapper namespace="MnrCareActtDAO">
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-insertCareActtCopiedItem () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
    -->	
	<insert id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-insertCareActtCopiedItem"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  >
		<![CDATA[
		insert  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-insertCareActtCopiedItem_[간호활동] 항목 복사 */
		   into  MNWRCPNIT
			 (
				 PTNO                                     /*  환자번호 */
			  ,  WARD_CD                                  /*  병동코드 */
			  ,  RGCA_GRP_CD                              /*  정규간호활동그룹코드 */
			  ,  RGCA_ITEM_CD                             /*  정규간호활동항목코드 */
			  ,  RGCA_ITEM_SNO                            /*  정규간호활동항목일련번호 */
			  ,  CODV_CD                                  /*  내원구분코드 */
			  ,  MDRP_NO                                  /*  진료접수번호 */
			  ,  RGCA_STTS_CD                             /*  정규간호활동상태코드 */
			  ,  STRT_DT
			  ,  FNSH_DT
			  ,  DLTN_YN
			  ,  DLPR_ID
			  ,  DLTN_DT
			  ,  FRST_RGSR_ID                             /*  최초등록자ID */
			  ,  FRST_RGST_IP                             /*  최초등록IP */
			  ,  FRST_RGST_DT                             /*  최초등록일시 */
			  ,  FRST_RGST_CLNT_PRGM_ID                        /*  최초등록SMC클라이언트프로그램ID */
			  ,  FRST_RGST_SRVR_PRGM_ID                        /*  최초등록SMC서버프로그램ID */
			  ,  LAST_UPDR_ID                             /*  최종수정자ID */
			  ,  LAST_UPDT_IP                             /*  최종수정IP */
			  ,  LAST_UPDT_DT                             /*  최종수정일시 */
			  ,  LAST_UPDT_CLNT_PRGM_ID                        /*  최종수정SMC클라이언트프로그램ID */
			  ,  LAST_UPDT_SRVR_PRGM_ID                        /*  최종수정SMC서버프로그램ID */
				 )
			 select
				 PTNO                                     /*  환자번호 */
			  ,  #{wardCd}                                  /*  병동코드 */
			  ,  RGCA_GRP_CD                              /*  정규간호활동그룹코드 */
			  ,  RGCA_ITEM_CD                             /*  정규간호활동항목코드 */
			  ,  #{rgcaItemSno1}                           /*  정규간호활동항목일련번호 */
			  ,  #{codvCd}                                  /*  내원구분코드 */
			  ,  MDRP_NO                                  /*  진료접수번호 */
			  ,  RGCA_STTS_CD                             /*  정규간호활동상태코드 */
			  ,  STRT_DT
			  ,  FNSH_DT
			  ,  DLTN_YN
			  ,  DLPR_ID
			  ,  DLTN_DT
			  ,  #{gvUserId}    
			  ,  #{gvUserIp}    
			  ,  sysdate        
			  ,  #{gvClntPrgmId}
			  ,  #{gvSrvrPrgmId}
			  ,  #{gvUserId}    
			  ,  #{gvUserIp}    
			  ,  sysdate        
			  ,  #{gvClntPrgmId}
			  ,  #{gvSrvrPrgmId}
			  from
				  MNWRCPNIT
			  where 1=1
				  and PTNO             = #{ptno}
				  and RGCA_GRP_CD      = #{rgcaGrpCd}
				  and RGCA_ITEM_CD     = #{rgcaItemCd}
				  and RGCA_ITEM_SNO    = #{rgcaItemSno}
				  and MDRP_NO          = #{mdrpNo}
		]]>
			
	</insert>


    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-insertCareActtItem0001 () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
    -->	
	<insert id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-insertCareActtItem0001"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  >
		<![CDATA[
		   insert  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-insertCareActtItem0001_환자정규간호활동항목_기본저장 */
			 into  MNWRCPNIT
				   (
				   PTNO                                     /*  환자번호 */
				,  WARD_CD                                  /*  병동코드 */
				,  RGCA_GRP_CD                              /*  정규간호활동그룹코드 */
				,  RGCA_ITEM_CD                             /*  정규간호활동항목코드 */
				,  RGCA_ITEM_SNO                            /*  정규간호활동항목일련번호 */
				,  CODV_CD                                  /*  내원구분코드 */
				,  MDRP_NO                                  /*  진료접수번호 */
				,  RGCA_STTS_CD                             /*  정규간호활동상태코드 */
				,  DLTN_YN
				,  FRST_RGSR_ID                             /*  최초등록자ID */
				,  FRST_RGST_IP                             /*  최초등록IP */
				,  FRST_RGST_DT                             /*  최초등록일시 */
				,  FRST_RGST_CLNT_PRGM_ID                        /*  최초등록SMC클라이언트프로그램ID */
				,  FRST_RGST_SRVR_PRGM_ID                        /*  최초등록SMC서버프로그램ID */
				,  LAST_UPDR_ID                             /*  최종수정자ID */
				,  LAST_UPDT_IP                             /*  최종수정IP */
				,  LAST_UPDT_DT                             /*  최종수정일시 */
				,  LAST_UPDT_CLNT_PRGM_ID                        /*  최종수정SMC클라이언트프로그램ID */
				,  LAST_UPDT_SRVR_PRGM_ID                        /*  최종수정SMC서버프로그램ID */
				   )
		   values
				   (
				   #{ptno}
				,  #{wardCd}
				,  #{rgcaGrpCd}
				,  #{rgcaItemCd}
				,  #{rgcaItemSno}
				,  #{codvCd}
				,  #{mdrpNo}
				,  #{rgcaSttsCd}
				,  'N'
				,  #{gvUserId}    
				,  #{gvUserIp}    
				,  sysdate        
				,  #{gvClntPrgmId}
				,  #{gvSrvrPrgmId}
				,  #{gvUserId}    
				,  #{gvUserIp}    
				,  sysdate        
				,  #{gvClntPrgmId}
				,  #{gvSrvrPrgmId}
				   )
			]]>
			
	</insert>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCnalDcvnRcrd-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="ptno" column="PTNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="rgcaGrpCd" column="RGCA_GRP_CD"/>
		<result property="rgcaGrpNm" column="RGCA_GRP_NM"/>
		<result property="rgcaItemCd" column="RGCA_ITEM_CD"/>
		<result property="rgcaItemNm" column="RGCA_ITEM_NM"/>
		<result property="rgcaItemSno" column="RGCA_ITEM_SNO"/>
		<result property="rgcaOptnValeVl" column="RGCA_OPTN_VALE_VL"/>
		<result property="rgcaBswrCd" column="RGCA_BSWR_CD"/>
		<result property="rgcaBswrNm" column="RGCA_BSWR_NM"/>
		<result property="rgcaBswrSno" column="RGCA_BSWR_SNO"/>
		<result property="rgcaSttsCd" column="RGCA_STTS_CD"/>
		<result property="wrknDvsnCd" column="WRKN_DVSN_CD"/>
		<result property="lineTrnvCyclDdcn" column="LINE_TRNV_CYCL_DDCN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCnalDcvnRcrd () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCnalDcvnRcrd-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCnalDcvnRcrd"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCnalDcvnRcrd-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCnalDcvnRcrd_간호기록 중심정맥기록 조회 */
			   		pi.PTNO as PTNO                       /*  환자번호 */
			   	 ,  pi.MDRP_NO as MDRP_NO
			   	 ,  pi.WARD_CD as WARD_CD                    /*  병동코드 */
			   	 ,  pi.RGCA_GRP_CD as RGCA_GRP_CD                /*  정규간호활동그룹코드 */
			   	 ,  mg.RGCA_GRP_NM as RGCA_GRP_NM
			   	 ,  pi.RGCA_ITEM_CD as RGCA_ITEM_CD               /*  정규간호활동항목코드 */
			   	 ,  (select mi.RGCA_ITEM_NM
			   		   from MNWRCITMT mi
			   		  where mi.RGCA_GRP_CD  = pi.RGCA_GRP_CD
			   			and mi.RGCA_ITEM_CD = pi.RGCA_ITEM_CD
			   		) as RGCA_ITEM_NM
			   	 ,  pi.RGCA_ITEM_SNO   as RGCA_ITEM_SNO            /*  정규간호활동항목일련번호 */
			   		/*  기본 옵션 값 */
			   	 ,  pov2.RGCA_OPTN_VALE_VL as RGCA_OPTN_VALE_VL
			   	 ,  pb.RGCA_BSWR_CD as RGCA_BSWR_CD                                        /*  정규간호활동업무코드 */
			   	 ,  (select mb.RGCA_BSWR_NM
			   		   from MNWRCACMT mb
			   		  where mb.RGCA_BSWR_CD = pb.RGCA_BSWR_CD
			   		) as RGCA_BSWR_NM
			   	 ,  pb.RGCA_BSWR_SNO as RGCA_BSWR_SNO                                       /*  정규간호활동업무일련번호 */
			   	 ,  pb.RGCA_STTS_CD as RGCA_STTS_CD                                           /*  정규간호활동상태코드 */
			   	 ,  pb.WRKN_DVSN_CD as WRKN_DVSN_CD                                           /*  근무구분코드 */
			   	 ,  LINE_TRNV_CYCL_DDCN as LINE_TRNV_CYCL_DDCN
			  from  MNWRCPNIT pi  /*  환자정규간호활동항목 */
			   	 ,  MNWRCGRPT mg  /*  정규간호활동그룹 */
			   	 ,  (select  RGCA_GRP_CD
			   			  ,  RGCA_ITEM_CD
			   			  ,  RGCA_ITEM_SNO
			   			  ,  RGCA_BSWR_CD
			   			  ,  RGCA_BSWR_SNO
			   			  ,  RGCA_STTS_CD
			   			  ,  RGCA_PLAN_YMD
			   			  ,  LINE_TRNV_CYCL_DDCN
			   			  ,  RCRD_OPTN_DVSN_CD
			   			  ,  ENFR_NTM
			   			  ,  WRKN_DVSN_CD
			   			  ,  SORT_SQNC
			   		   from  MNWRCPNAT pb   /*  환자정규간호활동업무 */
			   		  where  pb.PTNO              = #{ptno}
			   			and  pb.MDRP_NO           = #{mdrpNo}
			   			and  pb.WARD_CD           = #{wardCd}
			   			and  nvl(pb.DLTN_YN, 'N') = 'N'
			   			and  pb.RGCA_PLAN_YMD     = to_date(#{inqrYmd}, 'yyyymmdd')
			   		) pb
			   	 ,  MNWRCPOVT pov2  /*  환자정규간호활동옵션내용 */
			   	where  1 = 1
				   	and  pi.PTNO              = #{ptno}
				   	and  pi.MDRP_NO           = #{mdrpNo}
				   	and  pi.WARD_CD           = #{wardCd}
				   	and  pi.RGCA_STTS_CD      = 'A'             /*  제거 되지 않은 건 */
				   	and  nvl(pi.DLTN_YN, 'N') = 'N'             /*  삭제 되지 않은 건 */
				   	and  mg.RGCA_GRP_CD       =  '2'            /*  정규간호활동그룹코드 */
				   	and  mg.RGCA_GRP_CD       = pi.RGCA_GRP_CD
				   	and  pb.RGCA_GRP_CD    (+)= pi.RGCA_GRP_CD
				   	and  pb.RGCA_ITEM_CD   (+)= pi.RGCA_ITEM_CD
				   	and  pb.RGCA_ITEM_SNO  (+)= pi.RGCA_ITEM_SNO
				   	and  pov2.PTNO               (+)= pi.PTNO
				   	and  pov2.MDRP_NO            (+)= pi.MDRP_NO
				   	and  pov2.WARD_CD            (+)= pi.WARD_CD
				   	and  pov2.RGCA_GRP_CD        (+)= pi.RGCA_GRP_CD
				   	and  pov2.RGCA_ITEM_CD       (+)= pi.RGCA_ITEM_CD
				   	and  pov2.RGCA_ITEM_SNO      (+)= pi.RGCA_ITEM_SNO
				   	and  pov2.RGCA_OPTN_CD       (+)= '5'   /*  삽입일시 */
				   	and  pov2.RGCA_OPTN_VALE_SNO (+)= 1
			]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listPtntTxKind-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="rgcaGrpCd" column="RGCA_GRP_CD"/>
		<result property="rgcaGrpNm" column="RGCA_GRP_NM"/>
		<result property="rgcaItemCd" column="RGCA_ITEM_CD"/>
		<result property="rgcaItemNm" column="RGCA_ITEM_NM"/>
		<result property="rgcaBswrNm" column="RGCA_BSWR_NM"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="ptrmNo" column="PTRM_NO"/>
		<result property="ptno" column="PTNO"/>
		<result property="ptntNm" column="PTNT_NM"/>
		<result property="txMterNtm" column="TX_MTER_NTM"/>
		<result property="rmrkCtn" column="RMRK_CTN"/>
		<result property="careTeamCd" column="CARE_TEAM_CD"/>
		<result property="afiInrnSiteNm" column="AFI_INRN_SITE_NM"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listPtntTxKind () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listPtntTxKind-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listPtntTxKind"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listPtntTxKind-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listPtntTxKind_처치종류별 환자관리 상세조회 */
				   x.RGCA_GRP_CD    as RGCA_GRP_CD
				,  x.RGCA_GRP_NM    as RGCA_GRP_NM
				,  x.RGCA_ITEM_CD   as RGCA_ITEM_CD
				,  x.RGCA_ITEM_NM   as RGCA_ITEM_NM
				,  x.RGCA_BSWR_NM   as RGCA_BSWR_NM
				,  x.WARD_CD        as WARD_CD
				,  x.PTRM_NO        as PTRM_NO
				,  x.PTNO           as PTNO
				,  x.PTNT_NM        as PTNT_NM
				,  x.TX_MTER_NTM    as TX_MTER_NTM
				,  x.RMRK_CTN       as RMRK_CTN
			 from  (select  a.RGCA_GRP_CD  RGCA_GRP_CD
						 ,  (select RGCA_GRP_NM from MNWRCGRPT where RGCA_GRP_CD = a.RGCA_GRP_CD) RGCA_GRP_NM
						 ,  a.RGCA_ITEM_CD RGCA_ITEM_CD
						 ,  (select RGCA_ITEM_NM from MNWRCITMT where RGCA_ITEM_CD = a.RGCA_GRP_CD) RGCA_ITEM_NM
						 ,  (select RGCA_BSWR_NM from MNWRCACMT where RGCA_BSWR_CD = a.RGCA_BSWR_CD) RGCA_BSWR_NM
						 ,  a.WARD_CD WARD_CD
						 ,  b.PTRM_NO PTRM_NO
						 ,  a.PTNO PTNO
						 ,  (select PTNT_NM from APPTPTNTT where PTNO = a.PTNO)  PTNT_NM
						 ,  (select count(*) from MNWRCPNET
							  where PTNO = a.PTNO
								and MDRP_NO = MDRP_NO
								and WARD_CD = WARD_CD
								and RGCA_PLAN_YMD = RGCA_PLAN_YMD
								and RGCA_GRP_CD = RGCA_GRP_CD
								and RGCA_ITEM_CD = RGCA_ITEM_CD
								and RGCA_ITEM_SNO = RGCA_ITEM_SNO
								and RGCA_BSWR_CD = RGCA_BSWR_CD
								and RGCA_BSWR_SNO = RGCA_BSWR_SNO
							) TX_MTER_NTM
						 ,  '' RMRK_CTN
					  from  MNWRCPNAT a, APRCRPTNT b,  MNWBTEAMT c
					 where  b.CARE_WARD_CD = c.WARD_CD
					   and  b.CARE_PTRM_NO = c.PTRM_NO
					   and  b.CARE_SCKB_NO = c.SCKB_NO
					   and  c.DAY_SCKB_TEAM_CD = nvl(#{careTeamCd}, c.DAY_SCKB_TEAM_CD)
					   and  a.WARD_CD = #{wardCd}
					   and  a.RGCA_PLAN_YMD = to_date(#{inqrYmd1}, 'YYYYMMDD')
					   and  a.PTNO = b.PTNO
					   and  a.MDRP_NO = b.MDRP_NO
					 union
					select  'A'  RGCA_GRP_CD
						 ,  '기본처방' RGCA_GRP_NM
						 , (case when a.ORDR_CD = 'C0300001' or a.ORDR_CD = 'C0300002' then 'I' else 'B' end) RGCA_ITEM_CD
						 , (case when a.ORDR_CD = 'C0300001' or a.ORDR_CD = 'C0300002' then 'Check I/O' else 'Check BST' end) RGCA_ITEM_NM
						 ,  a.ORDR_NM RGCA_BSWR_NM
						 ,  a.WARD_CD WARD_CD
						 ,  b.PTRM_NO PTRM_NO
						 ,  a.PTNO PTNO
						 ,  (select PTNT_NM from APPTPTNTT where PTNO = a.PTNO)  PTNT_NM
						 ,  (select count(*) from MNWADACNT
							  where PTNO = a.PTNO
								and ORDR_YMD = a.ORDR_YMD
								and ORDR_SNO = a.ORDR_SNO
								and ORDV_CD = 'COD'
							) TX_MTER_NTM
						 ,  '' RMRK_CTN
					 from  MDBASORDT a
						,  APRCRPTNT b
						,  MNWBTEAMT c
					where  b.CARE_WARD_CD = c.WARD_CD
					  and  b.CARE_PTRM_NO = c.PTRM_NO
					  and  b.CARE_SCKB_NO = c.SCKB_NO
					  and  c.DAY_SCKB_TEAM_CD = nvl(#{careTeamCd}, c.DAY_SCKB_TEAM_CD)
					  and  a.WARD_CD = #{wardCd}
					  and  a.ORDR_YMD = to_date(#{inqrYmd1}, 'YYYYMMDD')
					  and  a.ORDR_CD in ('C0300001', 'C0300002', 'C0500001', 'C0500002', 'C0500003', 'C0500004')
			   /*                and  a.DC_DVSN_CD <> 'Y' */
			   /*                and  a.DC_DVSN_CD <> 'X' */
					  and  a.DC_DVSN_CD = 'N'
					  and  a.MDRP_NO = b.MDRP_NO
					  and  a.PTNO = b.PTNO
				) x
			order
			   by x.RGCA_ITEM_CD
			]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0001-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="ptno" column="PTNO"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="rgcaGrpCd" column="RGCA_GRP_CD"/>
		<result property="rgcaGrpNm" column="RGCA_GRP_NM"/>
		<result property="rmvlSttsPpupYn" column="RMVL_STTS_PPUP_YN"/>
		<result property="rgcaItemCd" column="RGCA_ITEM_CD"/>
		<result property="rgcaItemNm" column="RGCA_ITEM_NM"/>
		<result property="rgcaItemSno" column="RGCA_ITEM_SNO"/>
		<result property="afiDdcnStr1" column="AFI_DDCN_STR_1"/>
		<result property="rgcaOptnValeVl1" column="RGCA_OPTN_VALE_VL_1"/>
		<result property="rgcaOptnValeVl2" column="RGCA_OPTN_VALE_VL_2"/>
		<result property="rgcaOptnValeVl3" column="RGCA_OPTN_VALE_VL_3"/>
		<result property="rgcaOptnValeVl4" column="RGCA_OPTN_VALE_VL_4"/>
		<result property="rgcaOptnValeVl5" column="RGCA_OPTN_VALE_VL_5"/>
		<result property="rgcaOptnValeVl6" column="RGCA_OPTN_VALE_VL_6"/>
		<result property="afiOptnExstYn" column="AFI_OPTN_EXST_YN"/>
		<result property="rgcaBswrCd" column="RGCA_BSWR_CD"/>
		<result property="rgcaBswrNm" column="RGCA_BSWR_NM"/>
		<result property="rgcaBswrSno" column="RGCA_BSWR_SNO"/>
		<result property="afiDdcnStr2" column="AFI_DDCN_STR_2"/>
		<result property="rgcaSttsCd" column="RGCA_STTS_CD"/>
		<result property="lineTrnvCyclDdcn" column="LINE_TRNV_CYCL_DDCN"/>
		<result property="rcrdOptnDvsnCd" column="RCRD_OPTN_DVSN_CD"/>
		<result property="enfrNtm" column="ENFR_NTM"/>
		<result property="wrknDvsnCd" column="WRKN_DVSN_CD"/>
		<result property="acttGrpDvsnCd" column="ACTT_GRP_DVSN_CD"/>
		<result property="rgcaOptnValeVl8" column="RGCA_OPTN_VALE_VL_8"/>
		<result property="sortSqnc1" column="SORT_SQNC_1"/>
		<result property="sortSqnc2" column="SORT_SQNC_2"/>
		<result property="sortSqnc3" column="SORT_SQNC_3"/>
		<result property="rgcaOptnValeVl7" column="RGCA_OPTN_VALE_VL_7"/>
		<result property="rgcaOptnValeVl9" column="RGCA_OPTN_VALE_VL_9"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0001 () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0001-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0001"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0001-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0001_환자정규간호활동 기본 */
				   pi.PTNO as PTNO                       /*  환자번호 */
				,  '' as MDCR_DT           /*  진료일시 */
				,  pi.MDRP_NO as MDRP_NO
				,  pi.WARD_CD as WARD_CD                    /*  병동코드 */
				,  pi.RGCA_GRP_CD as RGCA_GRP_CD                /*  정규간호활동그룹코드 */
				,  mg.RGCA_GRP_NM as RGCA_GRP_NM
				,  mg.RMVL_STTS_PPUP_YN as RMVL_STTS_PPUP_YN
				,  pi.RGCA_ITEM_CD as RGCA_ITEM_CD               /*  정규간호활동항목코드 */
				,  (select mi.RGCA_ITEM_NM
					  from MNWRCITMT mi
					 where mi.RGCA_GRP_CD  = pi.RGCA_GRP_CD
					   and mi.RGCA_ITEM_CD = pi.RGCA_ITEM_CD
				   ) as RGCA_ITEM_NM
				,  pi.RGCA_ITEM_SNO  as RGCA_ITEM_SNO            /*  정규간호활동항목일련번호 */
				   /*  기본 옵션 값 */
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							case when pov.RGCA_OPTN_VALE_VL is null  then ''
											 when length(pov.RGCA_OPTN_VALE_VL) = 14 then to_char(trunc(sysdate) - trunc(to_date(pov.RGCA_OPTN_VALE_VL, 'YYYYMMDDHH24MISS')))
											 when length(pov.RGCA_OPTN_VALE_VL) = 12 then to_char(trunc(sysdate) - trunc(to_date(pov.RGCA_OPTN_VALE_VL, 'YYYYMMDDHH24MI')))
											 when length(pov.RGCA_OPTN_VALE_VL) = 8  then to_char(trunc(sysdate) - trunc(to_date(pov.RGCA_OPTN_VALE_VL, 'YYYYMMDD')))
											 else ''
							end
					  from  MNWRCPOVT pov
					 where  1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = (case when pi.RGCA_GRP_CD =  '15' then '4'
																				   else '5'
																		 end)         /* 욕창인 경우 발생일시, 나머지 삽입일시 */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as AFI_DDCN_STR_1
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where 1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = (case when pi.RGCA_GRP_CD =  '15' then '4'
																			   else '5'
																		 end)   /* 욕창인 경우 발생일시, 나머지 삽입일시 */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_1
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where 1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
			   /*                 and  pov.WARD_CD            = pi.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = decode(RGCA_GRP_CD||RGCA_ITEM_CD, '1517', '18', '22')   /* 욕창인 경우 발생위치(상세), 나머지 삽입위치 */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_2
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where 1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
			   /*                 and  pov.WARD_CD            = pi.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = decode(RGCA_GRP_CD||RGCA_ITEM_CD, '1517', '19', '25')  /* 욕창인 경우 발생위치(기타), 나머지 삽입위치(상세) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'               /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_3
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where  1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
			   /*                 and  pov.WARD_CD            = pi.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '27'            /*  삽입위치(기타) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_4
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where  1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
			   /*                 and  pov.WARD_CD            = pi.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '28'            /*  고정길이(Cm) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_5
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where 1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
			   /*                 and  pov.WARD_CD            = pi.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '16'            /*  교환주기 */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_6
				,  (select  decode(count(1),0,'N','Y')
					  from  MNWRCGOPT mo
					 where  1 = 1
					   and  mo.RGCA_GRP_CD  = pi.RGCA_GRP_CD
					   and  mo.RGCA_ITEM_CD = pi.RGCA_ITEM_CD
					   and  rownum = 1
				   ) as AFI_OPTN_EXST_YN     /*  AFI옵션존재여부 */
				,  pb.RGCA_BSWR_CD as RGCA_BSWR_CD                                        /*  정규간호활동업무코드 */
				,  (select mb.RGCA_BSWR_NM
					  from MNWRCACMT mb
					 where mb.RGCA_BSWR_CD = pb.RGCA_BSWR_CD
				   ) as RGCA_BSWR_NM
				,  pb.RGCA_BSWR_SNO as RGCA_BSWR_SNO                                       /*  정규간호활동업무일련번호 */
				, to_char(trunc(sysdate)
						  - nvl((select
										 trunc(max(s.RGCA_ENFR_DT))
								   from  MNWRCPNET s
								  where  s.PTNO               = pi.PTNO
									and  s.MDRP_NO            = pi.MDRP_NO
			   /*                              and  s.WARD_CD            = pi.WARD_CD */
									and  s.RGCA_GRP_CD        = pb.RGCA_GRP_CD
									and  s.RGCA_ITEM_CD       = pb.RGCA_ITEM_CD
									and  s.RGCA_ITEM_SNO      = pb.RGCA_ITEM_SNO
									and  s.RGCA_BSWR_CD       = pb.RGCA_BSWR_CD
									and  s.RGCA_BSWR_SNO      = pb.RGCA_BSWR_SNO
									/* and  s.RGCA_ENFR_STTS_CD in ('A', 'O', 'S') */
									and  s.RGCA_ENFR_STTS_CD = 'A' /* Acting만 가져가기로 결정(1980) */
								), pb.RGCA_PLAN_YMD)) as AFI_DDCN_STR_2
				,  pb.RGCA_STTS_CD as RGCA_STTS_CD                                           /*  정규간호활동상태코드 */
				,  pb.LINE_TRNV_CYCL_DDCN as LINE_TRNV_CYCL_DDCN                                    /*  라인교체주기일수 */
				,  pb.RCRD_OPTN_DVSN_CD as RCRD_OPTN_DVSN_CD                                      /*  기록옵션구분코드 */
				,  pb.ENFR_NTM as ENFR_NTM                                               /*  시행횟수 */
				,  pb.WRKN_DVSN_CD as WRKN_DVSN_CD                                           /*  근무구분코드 */
				,  mg.ACTT_GRP_DVSN_CD as ACTT_GRP_DVSN_CD
				,  substrb(hint.hint, 1, 1500) as RGCA_OPTN_VALE_VL_8
				,  mg.SORT_SQNC as SORT_SQNC_1
				,  (select mi.SORT_SQNC
						from MNWRCITMT mi
					   where mi.RGCA_GRP_CD  = pi.RGCA_GRP_CD
						 and mi.RGCA_ITEM_CD = pi.RGCA_ITEM_CD
					 ) as SORT_SQNC_2
				,  pb.SORT_SQNC as SORT_SQNC_3
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where 1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
			   /*                 and  pov.WARD_CD            = pi.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '32'            /*  중심정맥관 사용용도 */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_7
				,  (select  /*+ index_desc(pov MNWRCPOVT_PK)  */
							pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where 1=1
					   and  pov.MDRP_NO            = pi.MDRP_NO
			   /*                 and  pov.WARD_CD            = pi.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '17'            /*  사이즈(Fr) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_9				   
			 from  MNWRCPNIT pi
				,  MNWRCGRPT mg
				,  (select  RGCA_GRP_CD
						 ,  RGCA_ITEM_CD
						 ,  RGCA_ITEM_SNO
						 ,  RGCA_BSWR_CD
						 ,  RGCA_BSWR_SNO
						 ,  RGCA_STTS_CD
						 ,  RGCA_PLAN_YMD
						 ,  LINE_TRNV_CYCL_DDCN
						 ,  RCRD_OPTN_DVSN_CD
						 ,  ENFR_NTM
						 ,  WRKN_DVSN_CD
						 ,  SORT_SQNC
			   /*                   ,  WARD_CD */
					  from  MNWRCPNAT pb
					 where  1=1
					   and  pb.MDRP_NO           = #{mdrpNo}
					   and  RGCA_STTS_CD <> 'I'     /* MIG 데이터 때문에 추가 */
					   and  nvl(pb.DLTN_YN, 'N') = 'N'
				   ) pb
				, (select RGCA_GRP_CD
							, RGCA_ITEM_CD
							, RGCA_ITEM_SNO
			   /*                      , WARD_CD */
							, listagg(hint, ', ') within group (order by SORT_SQNC)    as hint
						from (
								select
										 RGCA_GRP_CD
									   , RGCA_ITEM_CD
									   , RGCA_ITEM_SNO
			   /*                                 , pov.WARD_CD */
									   , pov.RGCA_OPTN_CD
									   , pom.RGCA_OPTN_NM || ' : ' || substr(pov.RGCA_OPTN_VALE_VL, 1, 1000) as hint
									   , pom.SORT_SQNC
									 from  MNWRCPOVT pov
											, MNWRCOPTT pom
									where  1=1
									  and  pov.MDRP_NO            = #{mdrpNo}
									  and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
									  and  pov.RGCA_OPTN_VALE_VL is not null
									  and  pov.RGCA_OPTN_CD = pom.RGCA_OPTN_CD
									  and  pom.DSPL_YN = 'Y'
						)
						group by RGCA_GRP_CD, RGCA_ITEM_CD, RGCA_ITEM_SNO
					) hint
			where  1 = 1
			   /*        and  pi.PTNO              = :mns_wrcpnit_056[0].ptno */
			  and  pi.MDRP_NO           = #{mdrpNo}
			   /*        and  pi.WARD_CD           = :mns_wrcpnit_056[0].ward_cd */
			  and  pi.RGCA_STTS_CD      = 'A'             /*  제거 되지 않은 건 */
			  and  nvl(pi.DLTN_YN, 'N') = 'N'             /*  삭제 되지 않은 건 */
			  and  mg.RGCA_GRP_CD       = pi.RGCA_GRP_CD
			  and  pb.RGCA_GRP_CD    (+)= pi.RGCA_GRP_CD
			  and  pb.RGCA_ITEM_CD   (+)= pi.RGCA_ITEM_CD
			  and  pb.RGCA_ITEM_SNO  (+)= pi.RGCA_ITEM_SNO
			   /*        and  pb.WARD_CD        (+)= pi.WARD_CD */
			  and  hint.RGCA_GRP_CD        (+)= pi.RGCA_GRP_CD
			  and  hint.RGCA_ITEM_CD       (+)= pi.RGCA_ITEM_CD
			  and  hint.RGCA_ITEM_SNO      (+)= pi.RGCA_ITEM_SNO
			   /*        and  hint.WARD_CD            (+)= pi.WARD_CD */
			]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRmvl0001-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="ptno" column="PTNO"/>
		<result property="mdcrDt" column="MDCR_DT"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="rgcaGrpCd" column="RGCA_GRP_CD"/>
		<result property="rgcaGrpNm" column="RGCA_GRP_NM"/>
		<result property="rgcaItemCd" column="RGCA_ITEM_CD"/>
		<result property="rgcaItemNm" column="RGCA_ITEM_NM"/>
		<result property="rgcaItemSno" column="RGCA_ITEM_SNO"/>
		<result property="rgcaItemRmvlSno" column="RGCA_ITEM_RMVL_SNO"/>
		<result property="rmvlDt" column="RMVL_DT"/>
		<result property="rmvlDrId" column="RMVL_DR_ID"/>
		<result property="rmvlDrNm" column="RMVL_DR_NM"/>
		<result property="rmvlSttsCd" column="RMVL_STTS_CD"/>
		<result property="rmvlSiteObsrCd" column="RMVL_SITE_OBSR_CD"/>
		<result property="rmvlResnCtn" column="RMVL_RESN_CTN"/>
		<result property="rgcaOptnValeVl1" column="RGCA_OPTN_VALE_VL_1"/>
		<result property="rgcaOptnValeVl2" column="RGCA_OPTN_VALE_VL_2"/>
		<result property="rgcaOptnValeVl3" column="RGCA_OPTN_VALE_VL_3"/>
		<result property="rgcaOptnValeVl4" column="RGCA_OPTN_VALE_VL_4"/>
		<result property="rgcaOptnValeVl5" column="RGCA_OPTN_VALE_VL_5"/>
		<result property="rgcaOptnValeVl6" column="RGCA_OPTN_VALE_VL_6"/>
		<result property="rgcaOptnValeVl7" column="RGCA_OPTN_VALE_VL_7"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRmvl0001 () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRmvl0001-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRmvl0001"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRmvl0001-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRmvl0001_환자정규간호활동 항목 제거목록 */
				   pr.PTNO as PTNO                       /*  환자번호 */
				,  '' as MDCR_DT           /*  진료일시 */
				,  pr.MDRP_NO as MDRP_NO
				,  pr.WARD_CD as WARD_CD                    /*  병동코드 */
				,  pr.RGCA_GRP_CD as RGCA_GRP_CD                /*  정규간호활동그룹코드 */
				,  mg.RGCA_GRP_NM as RGCA_GRP_NM
				,  pr.RGCA_ITEM_CD as RGCA_ITEM_CD               /*  정규간호활동항목코드 */
				,  (select mi.RGCA_ITEM_NM
					  from MNWRCITMT mi
					 where mi.RGCA_GRP_CD  = pr.RGCA_GRP_CD
					   and mi.RGCA_ITEM_CD = pr.RGCA_ITEM_CD
				   ) as RGCA_ITEM_NM
				,  pr.RGCA_ITEM_SNO as RGCA_ITEM_SNO              /*  정규간호활동항목일련번호 */
				,  pr.RGCA_ITEM_RMVL_SNO as RGCA_ITEM_RMVL_SNO
				,  to_char(pr.RMVL_DT, 'YYYYMMDDHH24MI') as RMVL_DT
				,  pr.RMVL_DR_ID as RMVL_DR_ID
				,  pr.RMVL_DR_NM as RMVL_DR_NM
				,  pr.RMVL_STTS_CD as RMVL_STTS_CD
				,  pr.RMVL_SITE_OBSR_CD as RMVL_SITE_OBSR_CD
				,  pr.RMVL_RESN_CTN as RMVL_RESN_CTN
				,  (select  pov.RGCA_OPTN_VALE_VL
						from  MNWRCPOVT pov
					   where  pov.PTNO               = pr.PTNO
						 and  pov.MDRP_NO            = pr.MDRP_NO
						 and  pov.RGCA_GRP_CD        = pr.RGCA_GRP_CD
						 and  pov.RGCA_ITEM_CD       = pr.RGCA_ITEM_CD
						 and  pov.RGCA_ITEM_SNO      = pr.RGCA_ITEM_SNO
						 and  pov.RGCA_OPTN_CD       = '5'                 /*  삽입일시 */
						 and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
						 and  rownum = 1
					 ) as RGCA_OPTN_VALE_VL_1
				,  (select  pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where  pov.PTNO               = pr.PTNO
					   and  pov.MDRP_NO            = pr.MDRP_NO
			   /*                 and  pov.WARD_CD            = pr.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pr.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pr.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pr.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '22'                 /*  삽입위치 */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_2
				,  (select  pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where  pov.PTNO               = pr.PTNO
					   and  pov.MDRP_NO            = pr.MDRP_NO
			   /*                 and  pov.WARD_CD            = pr.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pr.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pr.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pr.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '25'                 /*  삽입위치(상세) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_3
				,  (select  pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where  pov.PTNO               = pr.PTNO
					   and  pov.MDRP_NO            = pr.MDRP_NO
			   /*                 and  pov.WARD_CD            = pr.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pr.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pr.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pr.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '27'                  /*  삽입위치(기타) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_4
				,  (select  pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where  pov.PTNO               = pr.PTNO
					   and  pov.MDRP_NO            = pr.MDRP_NO
			   /*                 and  pov.WARD_CD            = pr.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pr.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pr.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pr.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '17'                  /*  사이즈(Fr/G/cc) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_5
				,  (select  pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where  pov.PTNO               = pr.PTNO
					   and  pov.MDRP_NO            = pr.MDRP_NO
			   /*                 and  pov.WARD_CD            = pr.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pr.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pr.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pr.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '28'                  /*  고정길이(Cm) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_6
				,  (select  pov.RGCA_OPTN_VALE_VL
					  from  MNWRCPOVT pov
					 where  pov.PTNO               = pr.PTNO
					   and  pov.MDRP_NO            = pr.MDRP_NO
			   /*                 and  pov.WARD_CD            = pr.WARD_CD */
					   and  pov.RGCA_GRP_CD        = pr.RGCA_GRP_CD
					   and  pov.RGCA_ITEM_CD       = pr.RGCA_ITEM_CD
					   and  pov.RGCA_ITEM_SNO      = pr.RGCA_ITEM_SNO
					   and  pov.RGCA_OPTN_CD       = '21'                  /*  ID(mm) */
					   and  nvl(pov.DLTN_YN, 'N')  = 'N'             /*  삭제 되지 않은 건 */
					   and  rownum = 1
				   ) as RGCA_OPTN_VALE_VL_7
			 from MNWRCPNRT pr
				 , MNWRCGRPT mg
				 , MNWRCPNIT pi
			where  1 = 1
			  and  pr.PTNO           = #{ptno}
			  and  pr.MDRP_NO        = #{mdrpNo}
			  and  pr.RMVL_DT       >= to_date(#{inqrStrtYmd}, 'YYYYMMDD')
			  and  pr.RMVL_DT        < to_date(#{inqrFnshYmd}, 'YYYYMMDD') + 1
			  and  nvl(pr.DLTN_YN, 'N') = 'N'
			  and  mg.RGCA_GRP_CD       = pr.RGCA_GRP_CD
			  and  mg.RMVL_STTS_PPUP_YN = 'Y'
			  and  pi.PTNO(+)           = pr.PTNO
			  and  pi.MDRP_NO(+)        = pr.MDRP_NO
			  and  pi.RGCA_GRP_CD(+)    = pr.RGCA_GRP_CD
			  and  pi.RGCA_ITEM_CD(+)   = pr.RGCA_ITEM_CD
			  and  pi.RGCA_ITEM_SNO(+)  = pr.RGCA_ITEM_SNO
			  and  nvl(pi.DLTN_YN(+), 'N') = 'N'
			]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0002-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="rgcaGrpCd" column="RGCA_GRP_CD"/>
		<result property="rgcaItemCd" column="RGCA_ITEM_CD"/>
		<result property="rgcaItemSno" column="RGCA_ITEM_SNO"/>
		<result property="rgcaBswrCd" column="RGCA_BSWR_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0002 () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0002-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0002"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0002-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActt0002_정규간호활동 환자별 기본 항목 */
				   pi.RGCA_GRP_CD as RGCA_GRP_CD
				,  pi.RGCA_ITEM_CD as RGCA_ITEM_CD
				,  pi.RGCA_ITEM_SNO as RGCA_ITEM_SNO
				,  pb.RGCA_BSWR_CD as RGCA_BSWR_CD
			 from  MNWRCPNIT pi
				 , MNWRCPNAT pb
			where  1 = 1
			  and  pi.PTNO              = #{ptno}
			  and  pi.MDRP_NO           = #{mdrpNo}
			   /*        and  pi.WARD_CD           = :mns_wrcpnit_056[0].ward_cd */
			  and  nvl(pi.DLTN_YN, 'N') = 'N'  /*  삭제 되지 않은 건 */
			  and  pi.RGCA_STTS_CD      = 'A'  /*  제거 되지 않은 건 */
			  and  pb.PTNO (+) = pi.PTNO
			  and  pb.MDRP_NO (+)  =   pi.MDRP_NO
			  and  pb.RGCA_GRP_CD    (+)= pi.RGCA_GRP_CD
			  and  pb.RGCA_ITEM_CD   (+)= pi.RGCA_ITEM_CD
			  and  pb.RGCA_ITEM_SNO  (+)= pi.RGCA_ITEM_SNO
			  and  nvl(pb.DLTN_YN(+), 'N') = 'N'  /*  삭제 되지 않은 건 */
			]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listOverView0001-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="ptno" column="PTNO"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="rgcaGrpCd" column="RGCA_GRP_CD"/>
		<result property="rgcaGrpNm" column="RGCA_GRP_NM"/>
		<result property="rgcaItemCd" column="RGCA_ITEM_CD"/>
		<result property="rgcaItemNm" column="RGCA_ITEM_NM"/>
		<result property="rgcaItemSno" column="RGCA_ITEM_SNO"/>
		<result property="drtbYn" column="DRTB_YN"/>
		<result property="istbYn" column="ISTB_YN"/>
		<result property="bdsrYn" column="BDSR_YN"/>
		<result property="inrnDt" column="INRN_DT"/>
		<result property="lineTrnvCyclDdcn" column="LINE_TRNV_CYCL_DDCN"/>
		<result property="rmvlDt" column="RMVL_DT"/>
		<result property="dtlsLctnCd" column="DTLS_LCTN_CD"/>
		<result property="rgcaSttsCd" column="RGCA_STTS_CD"/>
		<result property="inrsPathInthYmd" column="INRS_PATH_INTH_YMD"/>
		<result property="ocrnYmd" column="OCRN_YMD"/>
		<result property="dtlsLctnCtn" column="DTLS_LCTN_CTN"/>
		<result property="dtlsLctnCtn1" column="DTLS_LCTN_CTN_1"/>
		<result property="stepNm" column="STEP_NM"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listOverView0001 () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listOverView0001-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listOverView0001"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listOverView0001-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listOverView0001_[간호활동] 환자 오버뷰 표시항목 조회*/
				   pi.PTNO as PTNO                       /*  환자번호 */
				,  pi.MDRP_NO as MDRP_NO
				,  pi.WARD_CD as WARD_CD                    /*  병동코드 */
				,  pi.RGCA_GRP_CD as RGCA_GRP_CD                /*  정규간호활동그룹코드 */
				,  mg.RGCA_GRP_NM as RGCA_GRP_NM
				,  pi.RGCA_ITEM_CD as RGCA_ITEM_CD               /*  정규간호활동항목코드 */
				,  mi.RGCA_ITEM_NM as RGCA_ITEM_NM
				,  pi.RGCA_ITEM_SNO as RGCA_ITEM_SNO              /*  정규간호활동항목일련번호 */
				,  mg.DRTB_YN as DRTB_YN
				,  mg.ISTB_YN as ISTB_YN
				,  decode(pi.RGCA_GRP_CD, '15', 'Y', 'N') as BDSR_YN  /* 욕창여부*/
				,  pov2.INRN_DT as INRN_DT
				,  case when pi.RGCA_GRP_CD = '1' then nvl(pov2.LINE_TRNV_CYCL_DDCN, 3)
						else pov2.LINE_TRNV_CYCL_DDCN end as LINE_TRNV_CYCL_DDCN
				,  decode(pi.RGCA_STTS_CD, 'I', (
					 select
						decode(his2.RMVL_STTS_CD, 'A', decode(his2.RMVL_SITE_OBSR_CD, 'C', to_char(his2.RMVL_DT, 'YYYY-MM-DD'), ''), '')
					 from  MNWRCPNRT his2
					where his2.MDRP_NO            = pi.MDRP_NO
			   /*                and  his2.WARD_CD            = pi.WARD_CD */
					  and  his2.RGCA_GRP_CD        = pi.RGCA_GRP_CD
					  and  his2.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
					  and  his2.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
					  and  his2.RGCA_ITEM_RMVL_SNO = his.RGCA_ITEM_RMVL_SNO
					  and  rownum = 1  /* 없어도 되지만 혹시 몰라서 */
					), '') as RMVL_DT
				,  po.LCTN_CD as DTLS_LCTN_CD   /* 포인트 위치 가져오는거*/
				,  pi.RGCA_STTS_CD as RGCA_STTS_CD
				,  case when (pb.RGCA_PLAN_YMD IS NOT NULL) AND (pb.RGCA_PLAN_YMD < to_date(pov2.INRN_DT,'YYYYMMDD')) then
						case when pi.RGCA_GRP_CD = '1' then
								 decode(pi.RGCA_STTS_CD, 'A',  to_char(pb.RGCA_PLAN_YMD + nvl(pov2.LINE_TRNV_CYCL_DDCN, 3), 'YYYYMMDD'), null)
							else
								decode(pov2.LINE_TRNV_CYCL_DDCN, null, null,
										decode(pi.RGCA_STTS_CD, 'A',  to_char(pb.RGCA_PLAN_YMD + pov2.LINE_TRNV_CYCL_DDCN, 'YYYYMMDD'), null))
						end
					else 
						case when pi.RGCA_GRP_CD = '1' then
								 decode(pi.RGCA_STTS_CD, 'A',  to_char(to_date(pov2.INRN_DT, 'YYYYMMDD') + nvl(pov2.LINE_TRNV_CYCL_DDCN, 3), 'YYYYMMDD'), null)
							else
								decode(pov2.LINE_TRNV_CYCL_DDCN, null, null,
										decode(pi.RGCA_STTS_CD, 'A',  to_char(to_date(pov2.INRN_DT, 'YYYYMMDD') + pov2.LINE_TRNV_CYCL_DDCN, 'YYYYMMDD'), null))
						end
					end as INRS_PATH_INTH_YMD
				,  pov2.OCRN_YMD as OCRN_YMD
				,  pov2.DTLS_LCTN_CTN as DTLS_LCTN_CTN
				,  pov2.DTLS_LCTN_CTN_1 as DTLS_LCTN_CTN_1
				,  pov2.STEP_NM as STEP_NM
			 from  MNWRCPNIT pi
				,  MNWRCGRPT mg
				,  MNWRCITMT mi
				,  MNWRCPNAT pb
				,  (select  pio.RGCA_GRP_CD
						 ,  pio.RGCA_ITEM_CD
						 ,  pio.RGCA_ITEM_SNO
						 ,  listagg(po.RGCA_OPTN_CD||'_'||po.RGCA_VALE_ID, '_') within group (order by po.RGCA_OPTN_CD) as LCTN_CD
					  from  MNWRCPNOT pio
					  ,  MNWRCPOVT po
					 where  pio.MDRP_NO           = #{mdrpNo}
			   /*                 and  pio.WARD_CD           = :mns_wrcpnit_061[0].ward_cd */
					   and  nvl(pio.DLTN_YN, 'N') = 'N'
					   and  pio.RGCA_OPTN_CD     in ('22', '25', '18')  /* 삽입위치, 삽입위치(상세), Sore발생위치(상세) */
					   and  po.RGCA_GRP_CD       = pio.RGCA_GRP_CD
					   and  po.RGCA_ITEM_CD      = pio.RGCA_ITEM_CD
					   and  po.RGCA_ITEM_SNO     = pio.RGCA_ITEM_SNO
					   and  po.RGCA_OPTN_CD      = pio.RGCA_OPTN_CD
			   /*                 and  po.PTNO              = pio.PTNO */
					   and  po.MDRP_NO           = pio.MDRP_NO
			   /*                 and  po.WARD_CD           = pio.WARD_CD */
					   and  nvl(po.DLTN_YN, 'N') = 'N'
					   group by pio.RGCA_GRP_CD, pio.RGCA_ITEM_CD, pio.RGCA_ITEM_SNO
				   ) po
				,  (select  RGCA_GRP_CD
						   , RGCA_ITEM_CD
						   , RGCA_ITEM_SNO
						   , max(RGCA_ITEM_RMVL_SNO)   RGCA_ITEM_RMVL_SNO
					from MNWRCPNRT
				   where MDRP_NO           = #{mdrpNo}
			   /*                 and  WARD_CD           = :mns_wrcpnit_061[0].ward_cd */
					   group by RGCA_GRP_CD, RGCA_ITEM_CD, RGCA_ITEM_SNO
					) his
				,  (select
						 a.RGCA_GRP_CD
					   , a.RGCA_ITEM_CD
					   , a.RGCA_ITEM_SNO
					   , substr(max(decode(a.RGCA_OPTN_CD, '5', a.RGCA_OPTN_VALE_VL)), 0, 8) as INRN_DT
					   , max(decode(a.RGCA_OPTN_CD, '16', a.RGCA_OPTN_VALE_VL)) as LINE_TRNV_CYCL_DDCN
					   , substr(max(decode(a.RGCA_OPTN_CD, '4', a.RGCA_OPTN_VALE_VL)), 0, 8) as OCRN_YMD
					   , max(decode(a.RGCA_OPTN_CD, '18', a.RGCA_OPTN_VALE_VL)) as DTLS_LCTN_CTN
					   , max(decode(a.RGCA_OPTN_CD, '19', a.RGCA_OPTN_VALE_VL)) as DTLS_LCTN_CTN_1
					   , max(decode(a.RGCA_OPTN_CD, '26', a.RGCA_OPTN_VALE_VL)) as STEP_NM
						from (
							select  /*+ index_desc(pov MNWRCPOVT_PK)  */
										   RGCA_GRP_CD
										 , RGCA_ITEM_CD
										 , RGCA_ITEM_SNO
										 , RGCA_OPTN_CD
										 , RGCA_OPTN_VALE_VL
								   from  MNWRCPOVT
								  where MDRP_NO            = #{mdrpNo}
			   /*                              and  WARD_CD            = :mns_wrcpnit_061[0].ward_cd */
									and  RGCA_OPTN_CD       in ('5', '16', '4', '18', '19', '26')     /*  삽입일시, 교환주기, 발생일시, 발생위치(상세), 발생위치(기타), 단계 */
									and  nvl(DLTN_YN, 'N')  = 'N'                  /*  삭제 되지 않은 건 */
						) a
						group by a.RGCA_GRP_CD, a.RGCA_ITEM_CD, a.RGCA_ITEM_SNO
				) pov2
			where  1 = 1
			   /*        and  pi.PTNO              = :mns_wrcpnit_061[0].ptno */
			  and  pi.MDRP_NO           = #{mdrpNo}
			   /*        and  pi.WARD_CD           = :mns_wrcpnit_061[0].ward_cd */
			  and  pi.RGCA_STTS_CD      in ('A' , 'I')            /*  삭제되지 않은 건 */
			  and  nvl(pi.DLTN_YN, 'N') = 'N'             /*  삭제 되지 않은 건 */
			  and  mg.RGCA_GRP_CD       = pi.RGCA_GRP_CD
			  and  (mg.DRTB_YN = 'Y' or mg.ISTB_YN = 'Y' or (pi.RGCA_GRP_CD = '15' and pi.RGCA_ITEM_CD = '17')) /* 삽입관, 배액관, 욕창인 경우 */
			  and  mi.RGCA_GRP_CD       = pi.RGCA_GRP_CD
			  and  mi.RGCA_ITEM_CD      = pi.RGCA_ITEM_CD
			  and  po.RGCA_GRP_CD      = pi.RGCA_GRP_CD
			  and  po.RGCA_ITEM_CD     = pi.RGCA_ITEM_CD
			  and  po.RGCA_ITEM_SNO    = pi.RGCA_ITEM_SNO
			  and  pov2.RGCA_GRP_CD        (+)= pi.RGCA_GRP_CD
			  and  pov2.RGCA_ITEM_CD       (+)= pi.RGCA_ITEM_CD
			  and  pov2.RGCA_ITEM_SNO      (+)= pi.RGCA_ITEM_SNO
			  and  his.RGCA_GRP_CD        (+)= pi.RGCA_GRP_CD
			  and  his.RGCA_ITEM_CD       (+)= pi.RGCA_ITEM_CD
			  and  his.RGCA_ITEM_SNO      (+)= pi.RGCA_ITEM_SNO
			  and  pb.PTNO (+) = pi.PTNO
			  and  pb.MDRP_NO (+)  =   pi.MDRP_NO
			  and  pb.RGCA_GRP_CD    (+)= pi.RGCA_GRP_CD
			  and  pb.RGCA_ITEM_CD   (+)= pi.RGCA_ITEM_CD
			  and  pb.RGCA_ITEM_SNO  (+)= pi.RGCA_ITEM_SNO
			  and  nvl(pb.DLTN_YN(+), 'N') = 'N'  /*  삭제 되지 않은 건 */ 			  
		   order by INRS_PATH_INTH_YMD asc
			]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0001-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="kornCdNm" column="KORN_CD_NM"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0001 () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0001-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0001"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0001-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0001_환자정규간호활동 항목조회 */
			   /*               max(t.RGCA_GRP_NM) */
			   /*             ||' / ' */
				   '▣ '
				   ||max(t.RGCA_ITEM_NM)
				   ||decode(max(t.COL1 ),'','',' / '||max(t.COL1 ))
				   ||decode(max(t.COL2 ),'','',' / '||max(t.COL2 ))
				   ||decode(max(t.COL3 ),'','',' / '||max(t.COL3 ))
				   ||decode(max(t.COL4 ),'','',' / '||max(t.COL4 ))
				   ||decode(max(t.COL5 ),'','',' / '||max(t.COL5 ))
				   ||decode(max(t.COL6 ),'','',' / '||max(t.COL6 ))
				   ||decode(max(t.COL7 ),'','',' / '||max(t.COL7 ))
				   ||decode(max(t.COL8 ),'','',' / '||max(t.COL8 ))
				   ||decode(max(t.COL9 ),'','',' / '||max(t.COL9 ))
				   ||decode(max(t.COL10),'','',' / '||max(t.COL10))
				   ||decode(max(t.COL11),'','',' / '||max(t.COL11))
				   ||decode(max(t.COL12),'','',' / '||max(t.COL12))
				   ||decode(max(t.COL13),'','',' / '||max(t.COL13))
				   ||decode(max(t.COL14),'','',' / '||max(t.COL14))
				   ||decode(max(t.COL15),'','',' / '||max(t.COL15))
				   ||decode(max(t.COL16),'','',' / '||max(t.COL16))
				   ||decode(max(t.COL17),'','',' / '||max(t.COL17))
				   ||decode(max(t.COL18),'','',' / '||max(t.COL18))
				   ||decode(max(t.COL19),'','',' / '||max(t.COL19))
				   ||decode(max(t.COL20),'','',' / '||max(t.COL20))
				   ||decode(max(t.COL21),'','',' / '||max(t.COL21))
				   ||decode(max(t.COL22),'','',' / '||max(t.COL22))
				   ||decode(max(t.COL23),'','',' / '||max(t.COL23))
				   ||decode(max(t.COL24),'','',' / '||max(t.COL24))
				   ||decode(max(t.COL25),'','',' / '||max(t.COL25))
				   ||decode(max(t.COL26),'','',' / '||max(t.COL26))
				   ||decode(max(t.COL27),'','',' / '||max(t.COL27))
				   ||decode(max(t.COL28),'','',' / '||max(t.COL28))
				   ||decode(max(t.COL29),'','',' / '||max(t.COL29))
				   ||decode(max(t.COL30),'','',' / '||max(t.COL30))
				   ||decode(max(t.COL31),'','',' / '||max(t.COL31))
				   ||decode(max(t.COL32),'','',' / '||max(t.COL32))
				   ||decode(max(t.COL33),'','',' / '||max(t.COL33))
				   ||decode(max(t.COL34),'','',' / '||max(t.COL34))
				   ||decode(max(t.COL35),'','',' / '||max(t.COL35))
				   ||decode(max(t.COL36),'','',' / '||max(t.COL36))
				   ||decode(max(t.COL37),'','',' / '||max(t.COL37))
				   ||decode(max(t.COL38),'','',' / '||max(t.COL38))
				   ||decode(max(t.COL39),'','',' / '||max(t.COL39))
				   ||decode(max(t.COL40),'','',' / '||max(t.COL40))
				   ||decode(max(t.COL41),'','',' / '||max(t.COL41))
				   ||decode(max(t.COL42),'','',' / '||max(t.COL42))
				   ||decode(max(t.COL43),'','',' / '||max(t.COL43))
				   ||decode(max(t.COL44),'','',' / '||max(t.COL44))
				   ||decode(max(t.COL45),'','',' / '||max(t.COL45))
				   ||decode(max(t.COL46),'','',' / '||max(t.COL46))
				   ||decode(max(t.COL47),'','',' / '||max(t.COL47))
				   ||decode(max(t.COL48),'','',' / '||max(t.COL48))
				   ||decode(max(t.COL49),'','',' / '||max(t.COL49))
				   ||decode(max(t.COL50),'','',' / '||max(t.COL50))
				   ||decode(max(t.COL51),'','',' / '||max(t.COL51)) as KORN_CD_NM
			 from
				   (
				   select  /*+LEADING(a)*/
						   a.RGCA_GRP_CD                /*  정규간호활동그룹코드 */
						,  b.RGCA_GRP_NM
						,  a.RGCA_ITEM_CD               /*  정규간호활동항목코드 */
						,  (select mi.RGCA_ITEM_NM
							  from MNWRCITMT mi
							 where mi.RGCA_GRP_CD  = a.RGCA_GRP_CD
							   and mi.RGCA_ITEM_CD = a.RGCA_ITEM_CD
						   )                              as RGCA_ITEM_NM
						,  a.RGCA_ITEM_SNO
						/* MDCR_CTRL_CHRC_VL1 = 'Y'인 경우 옵션명 표시 N인 경우 옵션명 표시하지 않고 값만 표시*/
						,  decode(e.CTRL_SORT_SQNC, 1 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL1
						,  decode(e.CTRL_SORT_SQNC, 2 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL2
						,  decode(e.CTRL_SORT_SQNC, 3 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL3
						,  decode(e.CTRL_SORT_SQNC, 4 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL4
						,  decode(e.CTRL_SORT_SQNC, 5 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL5
						,  decode(e.CTRL_SORT_SQNC, 6 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL6
						,  decode(e.CTRL_SORT_SQNC, 7 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL7
						,  decode(e.CTRL_SORT_SQNC, 8 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL8
						,  decode(e.CTRL_SORT_SQNC, 9 , decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL9
						,  decode(e.CTRL_SORT_SQNC, 10, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL10
						,  decode(e.CTRL_SORT_SQNC, 11, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL11
						,  decode(e.CTRL_SORT_SQNC, 12, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL12
						,  decode(e.CTRL_SORT_SQNC, 13, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL13
						,  decode(e.CTRL_SORT_SQNC, 14, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL14
						,  decode(e.CTRL_SORT_SQNC, 15, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL15
						,  decode(e.CTRL_SORT_SQNC, 16, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL16
						,  decode(e.CTRL_SORT_SQNC, 17, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL17
						,  decode(e.CTRL_SORT_SQNC, 18, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL18
						,  decode(e.CTRL_SORT_SQNC, 19, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL19
						,  decode(e.CTRL_SORT_SQNC, 20, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL20
						,  decode(e.CTRL_SORT_SQNC, 21, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL21
						,  decode(e.CTRL_SORT_SQNC, 22, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL22
			   /*                  ,  decode(e.CTRL_SORT_SQNC, 23, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| to_char(to_date(substr(c.RGCA_OPTN_VALE_VL, 0, 12), 'YYYY-MM-DD HH24:MI'),  'YYYY-MM-DD HH24:MI'))  as COL23  -- 수술일시 */
			   /*                  ,  decode(e.CTRL_SORT_SQNC, 24, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| to_char(to_date(substr(c.RGCA_OPTN_VALE_VL, 0, 12), 'YYYY-MM-DD HH24:MI'),  'YYYY-MM-DD HH24:MI'))  as COL24  -- 발생일시 */
			   /*                  ,  decode(e.CTRL_SORT_SQNC, 25, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| to_char(to_date(substr(c.RGCA_OPTN_VALE_VL, 0, 12), 'YYYY-MM-DD HH24:MI'),  'YYYY-MM-DD HH24:MI'))  as COL25  -- 삽입일시 */
			   /*                  ,  decode(e.CTRL_SORT_SQNC, 26, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| to_char(to_date(substr(c.RGCA_OPTN_VALE_VL, 0, 12), 'YYYY-MM-DD HH24:MI'),  'YYYY-MM-DD HH24:MI'))  as COL26  -- 시작일시 */
						,  decode(e.CTRL_SORT_SQNC, 23, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| to_char(to_date(substr(c.RGCA_OPTN_VALE_VL, 0, 8), 'YYYY-MM-DD'),  'YYYY-MM-DD'))  as COL23  /*  수술일시 */
						,  decode(e.CTRL_SORT_SQNC, 24, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| to_char(to_date(substr(c.RGCA_OPTN_VALE_VL, 0, 8), 'YYYY-MM-DD'),  'YYYY-MM-DD'))  as COL24  /*  발생일시 */
						,  decode(e.CTRL_SORT_SQNC, 25, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| to_char(to_date(substr(c.RGCA_OPTN_VALE_VL, 0, 8), 'YYYY-MM-DD'),  'YYYY-MM-DD'))  as COL25  /*  삽입일시 */
						,  decode(e.CTRL_SORT_SQNC, 26, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| to_char(to_date(substr(c.RGCA_OPTN_VALE_VL, 0, 8), 'YYYY-MM-DD'),  'YYYY-MM-DD'))  as COL26  /*  시작일시 */
						,  decode(e.CTRL_SORT_SQNC, 27, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL27
						,  decode(e.CTRL_SORT_SQNC, 28, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL28
						,  decode(e.CTRL_SORT_SQNC, 29, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL29
						,  decode(e.CTRL_SORT_SQNC, 30, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL30
						,  decode(e.CTRL_SORT_SQNC, 31, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL31
						,  decode(e.CTRL_SORT_SQNC, 32, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL32
						,  decode(e.CTRL_SORT_SQNC, 33, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL33
						,  decode(e.CTRL_SORT_SQNC, 34, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL34
						,  decode(e.CTRL_SORT_SQNC, 35, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL35
						,  decode(e.CTRL_SORT_SQNC, 36, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL36
						,  decode(e.CTRL_SORT_SQNC, 37, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL37
						,  decode(e.CTRL_SORT_SQNC, 38, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL38
						,  decode(e.CTRL_SORT_SQNC, 39, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL39
						,  decode(e.CTRL_SORT_SQNC, 40, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL40
						,  decode(e.CTRL_SORT_SQNC, 41, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL41
						,  decode(e.CTRL_SORT_SQNC, 42, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL42
						,  decode(e.CTRL_SORT_SQNC, 43, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL43
						,  decode(e.CTRL_SORT_SQNC, 44, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL44
						,  decode(e.CTRL_SORT_SQNC, 45, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL45
						,  decode(e.CTRL_SORT_SQNC, 46, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL46
						,  decode(e.CTRL_SORT_SQNC, 47, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL47
						,  decode(e.CTRL_SORT_SQNC, 48, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL48
						,  decode(e.CTRL_SORT_SQNC, 49, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL49
						,  decode(e.CTRL_SORT_SQNC, 50, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL50
						,  decode(e.CTRL_SORT_SQNC, 51, decode(e.MDCR_CTRL_CHRC_VL1, 'Y', d.RGCA_OPTN_NM ||' : ', null)|| c.RGCA_OPTN_VALE_VL)  as COL51
					 from  MNWRCPNIT a
						,  MNWRCGRPT b
						,  MNWRCPOVT c
						,  MNWRCOPTT d
						,  MZCTRLMMT e
					where  a.MDRP_NO           = #{mdrpNo}
					  and  a.RGCA_STTS_CD      = 'A'             /*  제거 되지 않은 건 */
					  and  nvl(a.DLTN_YN, 'N') = 'N'             /*  삭제 되지 않은 건 */
					  and  b.RGCA_GRP_CD       = a.RGCA_GRP_CD
					  and  c.PTNO               (+)= a.PTNO
					  and  c.MDRP_NO            (+)= a.MDRP_NO
					  and  c.WARD_CD            (+)= a.WARD_CD
					  and  c.RGCA_GRP_CD        (+)= a.RGCA_GRP_CD
					  and  c.RGCA_ITEM_CD       (+)= a.RGCA_ITEM_CD
					  and  c.RGCA_ITEM_SNO      (+)= a.RGCA_ITEM_SNO
					  and  c.RGCA_OPTN_VALE_SNO (+)= 1
					  and  d.RGCA_OPTN_CD      = c.RGCA_OPTN_CD
					  and  e.MDCR_CTRL_CD      = 'MNR003'
					  and  e.MDCR_DTLS_CTRL_CD = c.RGCA_OPTN_CD
					  and  sysdate between e.APST_YMD and e.APFN_YMD
				   ) t
		   group by
				   t.RGCA_GRP_CD
				,  t.RGCA_ITEM_CD
				,  t.RGCA_ITEM_SNO
			]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0002-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="rsltEtcCtn" column="RSLT_ETC_CTN"/>
		<result property="sortSqnc1" column="SORT_SQNC_1"/>
		<result property="sortSqnc2" column="SORT_SQNC_2"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0002 () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0002-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0002"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0002-result" useCache="true" flushCache="false">
		<![CDATA[
		select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-listCareActtRcrdCtn0002_간호사업무일지 간호활동 조회 */
			 distinct RGCA_BSWR_NM || ' (' || RGCA_ITEM_NM  || decode(POS, null, null, '/' || POS) || ')' as RSLT_ETC_CTN
		   , SORT_SQNC_1 as SORT_SQNC_1
		   , SORT_SQNC_2 as SORT_SQNC_2
		   from
		   (
			   select
					   mb.RGCA_BSWR_NM
					,  mi.RGCA_ITEM_NM
					,  (select  listagg(pov.RGCA_OPTN_VALE_VL, '-') within group (order by RGCA_OPTN_CD)
						  from  MNWRCPOVT pov
						 where  pov.PTNO               = pi.PTNO
						   and  pov.MDRP_NO            = pi.MDRP_NO
						   and  pov.WARD_CD            = pi.WARD_CD
						   and  pov.RGCA_GRP_CD        = pi.RGCA_GRP_CD
						   and  pov.RGCA_ITEM_CD       = pi.RGCA_ITEM_CD
						   and  pov.RGCA_ITEM_SNO      = pi.RGCA_ITEM_SNO
						   and  pov.RGCA_OPTN_CD       in ('22', '25', '27')                 /*  삽입위치-삽입위치(상세)-삽입위치(기타) */
						   and  nvl(pov.DLTN_YN, 'N')  = 'N'
						   and  rownum = 1
					   ) as POS
					,  mi.SORT_SQNC as SORT_SQNC_1
					,  mb.SORT_SQNC as SORT_SQNC_2
				 from  MNWRCPNIT pi
					,  MNWRCITMT mi
					,  MNWRCACMT mb
					,  MNWRCPNAT pb
					,  MNWRCPNET pd
				where  1 = 1
					   /*        and  pi.PTNO          = :mns_exmordt_077[0].ptno                                 /*  환자번호 */
				  and  pi.MDRP_NO       = #{mdrpNo}
				  and  nvl(pi.DLTN_YN, 'N') = 'N'             /*  삭제 되지 않은 건 */
				  and  mi.RGCA_GRP_CD = pi.RGCA_GRP_CD
				  and  mi.RGCA_ITEM_CD  = pi.RGCA_ITEM_CD
				  and  pb.PTNO          = pi.PTNO
				  and  pb.MDRP_NO       = pi.MDRP_NO
				  and  pb.WARD_CD       = pi.WARD_CD
				  and  pb.RGCA_GRP_CD   = pi.RGCA_GRP_CD
				  and  pb.RGCA_ITEM_CD  = pi.RGCA_ITEM_CD
				  and  pb.RGCA_ITEM_SNO = pi.RGCA_ITEM_SNO
				  and  nvl(pb.DLTN_YN, 'N') = 'N'             /*  삭제 되지 않은 건 */
				  and  mb.RGCA_BSWR_CD = pb.RGCA_BSWR_CD
				  and  pd.PTNO          = pb.PTNO
				  and  pd.MDRP_NO       = pb.MDRP_NO
				  and  pd.WARD_CD       = pb.WARD_CD
				  and  pd.RGCA_GRP_CD   = pb.RGCA_GRP_CD
				  and  pd.RGCA_ITEM_CD  = pb.RGCA_ITEM_CD
				  and  pd.RGCA_ITEM_SNO = pb.RGCA_ITEM_SNO
				  and  pd.RGCA_BSWR_CD  = pb.RGCA_BSWR_CD
				  and  pd.RGCA_BSWR_SNO = pb.RGCA_BSWR_SNO
				  and  trunc(pd.RGCA_ENFR_PRRN_DT) = to_date(#{ordrYmd}, 'YYYYMMDD')
				  and  nvl(pd.DLTN_YN, 'N') = 'N'             /*  삭제 되지 않은 건 */
				  /* and  pd.RGCA_ENFR_DT is null 시행한것도 나와야 된거 하셔서 주석처리함, 2016-07-21 */
			  )
		   order by SORT_SQNC_1, SORT_SQNC_2
		]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtStts0001-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="rgcaSttsCd" column="RGCA_STTS_CD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtStts0001 () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtStts0001-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtStts0001"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtStts0001-result" useCache="true" flushCache="false">
		<![CDATA[
	   	select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtStts0001_[간호활동] 환자 간호활동항목 상태 조회*/
		   RGCA_STTS_CD as RGCA_STTS_CD
				   from
		   MNWRCPNIT
				   where 1=1
		 and PTNO          = #{ptno}
		 and MDRP_NO       = #{mdrpNo}
		 and RGCA_GRP_CD   = #{rgcaGrpCd}
		 and RGCA_ITEM_CD  = #{rgcaItemCd}
		 and RGCA_ITEM_SNO = #{rgcaItemSno}
		 and WARD_CD       = #{wardCd}
		]]>
			
	</select>


	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtNo0001-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="rgcaItemSno" column="RGCA_ITEM_SNO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtNo0001 () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtNo0001-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtNo0001"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtNo0001-result" useCache="true" flushCache="false">
		<![CDATA[
		   select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneCareActtNo0001_환자정규간호 항목일련번호 채번 */
				(nvl(max(RGCA_ITEM_SNO),0) + 1) as RGCA_ITEM_SNO
			 from  MNWRCPNIT a
			where  PTNO          = #{ptno}
			  and  MDRP_NO       = #{mdrpNo}
			   /*        and  WARD_CD       = :mns_wrcpnit_053[0].ward_cd */
			  and  RGCA_GRP_CD   = #{rgcaGrpCd}
			  and  RGCA_ITEM_CD  = #{rgcaItemCd}
			]]>
			
	</select>


    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-updateCareActtStts0001 () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-updateCareActtStts0001"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  >
		<![CDATA[
		   update  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-updateCareActtStts0001_환자정규간호 항목 제거 관리 */
				   MNWRCPNIT
			  set  RGCA_STTS_CD         = #{rgcaSttsCd}
			     , LAST_UPDR_ID       = #{gvUserId}    
			     , LAST_UPDT_IP       = #{gvUserIp}    
			     , LAST_UPDT_DT       = sysdate        
			     , LAST_UPDT_CLNT_PRGM_ID  = #{gvClntPrgmId}
			     , LAST_UPDT_SRVR_PRGM_ID  = #{gvSrvrPrgmId}
			where  1 = 1
			  and  PTNO          = #{ptno}
			  and  MDRP_NO       = #{mdrpNo}
			   /*        and  WARD_CD       = :mns_wrcpnit_070[0].ward_cd */
			  and  RGCA_GRP_CD   = #{rgcaGrpCd}
			  and  RGCA_ITEM_CD  = #{rgcaItemCd}
			  and  RGCA_ITEM_SNO = #{rgcaItemSno}
			]]>
			
	</update>


    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-updateCareActtSttsToDel () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
    -->	
	<update id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-updateCareActtSttsToDel"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  >
		<![CDATA[
		   update  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-updateCareActtSttsToDel_환자정규간호 항목 삭제 */
				   MNWRCPNIT
			  set  RGCA_STTS_CD      = 'D'
				,  DLTN_YN           = 'Y'
				,  DLPR_ID           = #{gvUserId}
				,  DLTN_DT           = sysdate
                ,  LAST_UPDR_ID       = #{gvUserId}    
                ,  LAST_UPDT_IP       = #{gvUserIp}    
                ,  LAST_UPDT_DT       = sysdate        
                ,  LAST_UPDT_CLNT_PRGM_ID  = #{gvClntPrgmId}
                ,  LAST_UPDT_SRVR_PRGM_ID  = #{gvSrvrPrgmId}
			where  1 = 1
			  and  PTNO          = #{ptno}
			  and  MDRP_NO       = #{mdrpNo}
			   /*        and  WARD_CD       = :mns_wrcpnit_070[0].ward_cd */
			  and  RGCA_GRP_CD   = #{rgcaGrpCd}
			  and  RGCA_ITEM_CD  = #{rgcaItemCd}
			  and  RGCA_ITEM_SNO = #{rgcaItemSno}
			]]>
	</update>
	
	
	<resultMap id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneFldwBdsrPain-result" type="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO">
		<result property="fldwRiskEn" column="FLDW_RISK_EN"/>
		<result property="bdsrYn" column="BDSR_YN"/>
		<result property="painYn" column="PAIN_YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneFldwBdsrPain () 
		parameterType : com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO
		resultMap : com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneFldwBdsrPain-result
    -->
	<select id="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneFldwBdsrPain"  parameterType="com.sds.healthcare.ehr.med.mn.mnr.vo.MnrCareActtDVO"  resultMap="com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneFldwBdsrPain-result" useCache="true" flushCache="false">
		<![CDATA[
  		select  /*+ com-sds-healthcare-ehr-med-mn-mnr-dao-MnrCareActtDAO-selectOneFldwBdsrPain_[간호활동] 낙상욕창통증 정보 조회 */
		   /* 
		   FALLA 성인낙상고위험사정도구
		   FALLB 소아낙상고위험사정도구
		   SORE 욕창 고위험 사정 도구
		   SNR 욕창간호사 판단 위험요인
		   FNR 간호사 판단 낙상 위험요인
		   SYN 욕창호발부위 피부상태항목
		   PAIN 통증점수
		   */
		   max(substr(FALLYN,1,1))  as FLDW_RISK_EN
		,  max(substr(SOREYN,1,1)) as BDSR_YN
			/* 통증은 (통증여부 유 and 통증사정 4점이상) or (통증완화중재가 있는 경우 ) Y로 표시
			 * 데이터가 row로 쌓이므로 통증여부 1, 통증사정1, 통증완화중재 2를 매긴 후 더한값이 2 이상이면 Y로 리턴*/
		,  case when sum(PAIN_YN) >=2 then 'Y'
				else 'N'
				end  as PAIN_YN
	    from  (
		   select  IRMT.*
				   /* 낙상고위험 -성인낙상 45점이상 또는 간호사판단위험요인 기록존재할경우
								-소아낙상 2이상 또는 간호사판단위험요인 기록존재할경우*/
				,  case when (CNOS_RCRD_ITEM_SYNN_NM = 'FALLA'
							  and IRMT.CNOS_VALE_SCR >= IRMT.CNOS_NRML_MXMM_VL )
						  or (CNOS_RCRD_ITEM_SYNN_NM = 'FNR'
							  and IRMT.CNOS_ITEM_RCRD_VL is not null)
						then 'Y'||IRMT.CNOS_ITEM_NM
						when (CNOS_RCRD_ITEM_SYNN_NM = 'FALLB'
							  and IRMT.CNOS_VALE_SCR >= IRMT.CNOS_NRML_MXMM_VL  )
						  or (CNOS_RCRD_ITEM_SYNN_NM = 'FNR'
							  and IRMT.CNOS_ITEM_RCRD_VL is not null)
						then 'Y'||IRMT.CNOS_ITEM_NM
						/* 소아인 경우
						   FNR은 간호사판단위험요인, 필요없을 경우 제거 */
  						 when (CNOS_RCRD_ITEM_SYNN_NM = 'FALLB_12'
  							   and IRMT.CNOS_VALE_SCR >= IRMT.CNOS_NRML_MXMM_VL  )
  							or (CNOS_RCRD_ITEM_SYNN_NM = 'FNR'
  							   and IRMT.CNOS_ITEM_RCRD_VL is not null)
						then 'Y'||IRMT.CNOS_ITEM_NM
						else 'N' end  FALLYN
				   /* 욕창고위험 -욕창 고위험 사정 도구항목 16점 이하
								또는 간호사판단위험요인 기록존재할경우 */
				,  case when (CNOS_RCRD_ITEM_SYNN_NM = 'SORE'
							  and IRMT.CNOS_VALE_SCR <= IRMT.CNOS_NRML_MNMM_VL )
						  or (CNOS_RCRD_ITEM_SYNN_NM = 'SNR'
							  and IRMT.CNOS_ITEM_RCRD_VL is not null)
						then 'Y'||IRMT.CNOS_ITEM_NM
				   else 'N' end  SOREYN
				   /* 낙상고위험 -성인낙상 45점이상 또는 간호사판단위험요인 기록존재할경우
								-소아낙상 2이상 또는 간호사판단위험요인 기록존재할경우*/
				,  case when (CNOS_RCRD_ITEM_SYNN_NM = 'FALLA'
							  and IRMT.CNOS_VALE_SCR >= IRMT.CNOS_NRML_MXMM_VL  )
						  or (CNOS_RCRD_ITEM_SYNN_NM = 'FNR'
							  and IRMT.CNOS_ITEM_RCRD_VL is not null)
						then IRMT.CNOS_ITEM_RCRD_VL
						when (CNOS_RCRD_ITEM_SYNN_NM = 'FALLB'
							  and IRMT.CNOS_VALE_SCR >= IRMT.CNOS_NRML_MXMM_VL  )
						  or (CNOS_RCRD_ITEM_SYNN_NM = 'FNR'
							  and IRMT.CNOS_ITEM_RCRD_VL is not null)
						then IRMT.CNOS_ITEM_RCRD_VL
						/* 소아인 경우
						FNR은 간호사판단위험요인, 필요없을 경우 제거 */
						when (CNOS_RCRD_ITEM_SYNN_NM = 'FALLB_12'
  							   and IRMT.CNOS_VALE_SCR >= IRMT.CNOS_NRML_MXMM_VL  )
  							or (CNOS_RCRD_ITEM_SYNN_NM = 'FNR'
  							   and IRMT.CNOS_ITEM_RCRD_VL is not null)
						then IRMT.CNOS_ITEM_RCRD_VL
						else '' end  FALLYN_VL
				   /* 욕창고위험 -욕창 고위험 사정 도구항목 16점 이하
								또는 간호사판단위험요인 기록존재할경우 */
				,  case when (CNOS_RCRD_ITEM_SYNN_NM = 'SORE'
							  and IRMT.CNOS_VALE_SCR <= IRMT.CNOS_NRML_MNMM_VL)
						  or (CNOS_RCRD_ITEM_SYNN_NM = 'SNR'
							  and IRMT.CNOS_ITEM_RCRD_VL is not null)
						then IRMT.CNOS_ITEM_RCRD_VL
						else '' end  SOREYN_VL
				,  case when CNOS_RCRD_ITEM_SYNN_NM = 'SYN' then 'Y'||IRMT.CNOS_ITEM_NM else 'N' end BDSR_YN
				,  case when CNOS_RCRD_ITEM_SYNN_NM = 'SYN' then IRMT.CNOS_ITEM_RCRD_VL else '' end BDSR_YN_VL
				/* 
				,  case when (CNOS_RCRD_ITEM_SYNN_NM = 'PAIN'
						and nvl(trim(translate(CNOS_ITEM_RCRD_VL, '.0123456789' ,'           ')) , '-') = '-'
						and to_number(CNOS_ITEM_RCRD_VL) >= 4)
						or (CNOS_RCRD_ITEM_SYNN_NM = 'PAINY'
							and IRMT.CNOS_ITEM_RCRD_VL = '유')
					   then 'Y'||CNOS_ITEM_RCRD_DT||IRMT.CNOS_ITEM_NM
					   else 'N'
					   end PAIN_YN
				*/
			   /* 통증 여부가 유이거나  통증 점수 4점 이상인 경우 1
				 * 통증완화중재가 있는 경우 2*/
				,  case when (CNOS_RCRD_ITEM_SYNN_NM = 'PAIN'
						and nvl(trim(translate(CNOS_ITEM_RCRD_VL, '.0123456789' ,'           ')) , '-') = '-'    /* 기록값이 숫자인지 판단*/
						and to_number(CNOS_ITEM_RCRD_VL) >= 4)
						or (CNOS_RCRD_ITEM_SYNN_NM = 'PAINY'
								and IRMT.CNOS_ITEM_RCRD_VL = '유')
					   then 1
					   when (CNOS_RCRD_ITEM_SYNN_NM = 'PAINR'
							   and IRMT.CNOS_ITEM_RCRD_VL is not null)
					   then 2
					   else 0
					   end PAIN_YN
				,  case when CNOS_RCRD_ITEM_SYNN_NM = 'PAIN' then IRMT.CNOS_ITEM_RCRD_VL else '' end PAIN_YN_VL
			from  (select/*+ LEADING(PTNT, DOMT, DAMT, ITMT, IRMT) USE_NL(DOMT, DAMT, IRMT, ITMT, PTNT) INDEX(DOMT, MECFSDOMT_I02) INDEX(DAMT, MECFSDAMT_I01) INDEX(IRMT, MECFSIRMT_I04) */
						   DOMT.PTNO
						,  IRMT.CNOS_ITEM_RCRD_DT
						,  IRMT.CNOS_ITEM_RCRD_VL
						,  IRMT.CNOS_VALE_SCR
						,  IRMT.CNOS_ITEM_RCRD_SNO
						,  IRMT.CNOS_RCRD_NO
						,  IRMT.CNOS_ITEM_GRP_SNO
						,  IRMT.CNOS_ITEM_SNO
						,  ITMT.CNOS_ITEM_NM
						,  DAMT.CNOS_RCRD_ITEM_SYNN_NM
						,  DAMT.CNOS_ITEM_NM CNOS_ITEM_NM_GROUP
						,  IRMT.WARD_CD
						/* ,  PTNT.PTRM_NO*/
						,  ITMT.CNOS_NRML_MXMM_VL
						,  ITMT.CNOS_NRML_MNMM_VL
						/* ,  row_number() over(partition by DOMT.PTNO,
														  DAMT.CNOS_ITEM_NM
														  order by IRMT.CNOS_ITEM_RCRD_DT desc,IRMT.CNOS_ITEM_RCRD_SNO desc ) ranking*/
						,  rank() over(partition by DOMT.PTNO,
														 case when DAMT.CNOS_RCRD_ITEM_SYNN_NM like 'PAIN%' then 'PAIN'
                                                                else DAMT.CNOS_ITEM_NM end
														 order by IRMT.CNOS_ITEM_RCRD_DT desc,IRMT.CNOS_ITEM_RCRD_SNO desc ) ranking
					 from  MECFSDOMT DOMT
						,  MECFSDAMT DAMT
						,  MECFSIRMT IRMT
						,  MECFSITMT ITMT
						,  APRCRPTNT PTNT
						/* ,  MNWBTEAMT TEAM*/
					where  1=1
					  /* 
					  and  PTNT.DSCH_DT = to_date('29991231', 'YYYYMMDD')
					  and  PTNT.CARE_WARD_CD is not null
					  and  PTNT.CARE_WARD_CD = TEAM.WARD_CD
					  and  PTNT.CARE_PTRM_NO = TEAM.PTRM_NO
					  and  PTNT.CARE_SCKB_NO = TEAM.SCKB_NO
					  */
					  and  DOMT.MDRP_NO = PTNT.MDRP_NO
					  and  DOMT.CODV_CD = PTNT.CODV_CD
					  and  DOMT.PTNO = PTNT.PTNO
					  /* and  DOMT.PTNO=  :mns_cfsdomt_016[0].ptno*/
					  and  IRMT.CNOS_TAB_CD = '04'
					  and  DOMT.CNOS_RCRD_NO    = IRMT.CNOS_RCRD_NO
					  and  IRMT.CNOS_ITEM_GRP_SNO = DAMT.CNOS_ITEM_GRP_SNO
					  and  IRMT.CNOS_ITEM_SNO   = DAMT.CNOS_ITEM_SNO
					  and  nvl(IRMT.DLTN_YN, 'N') = 'N'
					  and  DAMT.SMSP_ID         = 'MNW_CFSIRMT_L01'
					  and  DAMT.CNOS_ITEM_SNO   =  ITMT.CNOS_ITEM_SNO
					  and  nvl(ITMT.DLTN_YN, 'N') = 'N'
					  /* 
					  and  PTNT.PTNO=  :mns_cfsdomt_016[0].ptno
					  */
					  and  PTNT.MDRP_NO=  #{mdrpNo}
					) IRMT
			   where  ranking=1
		 ) Z
	    group by  PTNO
	]]>		 
	</select>	

</mapper>