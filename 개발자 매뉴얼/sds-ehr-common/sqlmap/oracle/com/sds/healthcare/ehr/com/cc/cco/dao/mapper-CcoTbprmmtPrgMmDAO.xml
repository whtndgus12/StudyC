<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_CcoTbprmmtPrgMmDAO_sql.xml 
    Description : -->
<mapper namespace="CcoTbprmmtPrgMmDAO">




    <!--
        SQL Name : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-insertPrgMm (cod_tbprmmt_i01$I01_to-be 프로그램 목록 등록) 
        Description :                                           cod_tbprmmt_i01$I01_to-be 프로그램 목록 등록
                                            
		parameterType : com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO
    -->	
	<insert id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-insertPrgMm"  parameterType="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-insertPrgMm */
		    insert  /*+ cod_tbprmmt_i01$I01_to-be 프로그램 목록 등록 */ 
		    into COTBPRMMT( PRGM_ID
		                         , PRGM_NM
		                         , PRGM_DETL_DSCR_CTN
		                         , PRGM_TYP_CD
		                         , BSDV_CD
		                         , PROR_BASE_CD
		                         , WG_CD
		                         , DEVP_ASGN_ID
		                         , MNGM_ASGN_ID
		                         , ACWR_ASGN_ID
		                         , PRNC_YN
		                         , OFFR_DVSN_CD
		                         , SGSN_OFFR_DVSN_CD
		                         , PRJT_TISS_CD
		                         , PLAN_STRT_YMD
		                         , PLAN_FNSH_YMD
		                         , DLTN_YN
		                         , DLTN_DT
		                         , DLPR_ID
		                         , MNGR_REVW_FINS_DD
		                         , QLAS_ASGN_ID
		                         , RTRC_CTN
		                         , RTRC_MNGN_CTN
		                         , QLAS_FINS_DD
		                         , RTRC_YMD
		                         , MNGN_YMD
		                         , QLAS_REVW_TRGT_YN
		                 , FRST_RGSR_ID                              -- 최초등록자ID
		                 , FRST_RGST_IP                              -- 최초등록IP
		                 , FRST_RGST_DT                              -- 최초등록일시
		                 , FRST_RGST_CLNT_PRGM_ID                    -- 최초등록클라이언트프로그램ID
		                 , FRST_RGST_SRVR_PRGM_ID                    -- 최초등록서버프로그램ID
		                 , LAST_UPDR_ID                              -- 최종수정자ID
		                 , LAST_UPDT_IP                              -- 최종수정IP
		                 , LAST_UPDT_DT                              -- 최종수정일시
		                 , LAST_UPDT_CLNT_PRGM_ID                    -- 최종수정클라이언트프로그램ID
		                 , LAST_UPDT_SRVR_PRGM_ID                    -- 최종수정서버프로그램ID
		                         )
		                   values(  #{prgmId} 
		                         ,  #{prgmNm} 
		                         ,  #{prgmDetlDscrCtn} 
		                         ,  #{prgmTypCd} 
		                         ,  #{bsdvCd} 
		                         ,  #{prorBaseCd} 
		                         ,  #{wgCd} 
		                         ,  #{devpAsgnId} 
		                         ,  #{mngmAsgnId} 
		                         ,  #{acwrAsgnId} 
		                         ,  #{prncYn} 
		                         ,  #{offrDvsnCd} 
		                         ,  #{sgsnOffrDvsnCd} 
		                         ,  #{prjtTissCd} 
		                         , to_date( #{planStrtYmd} , 'YYYYMMDD')
		                         , to_date( #{planFnshYmd} , 'YYYYMMDD')
		                         ,  #{dltnYn} 
		                         , decode( #{dltnYn} , 'Y', sysdate, null)
		                         , decode( #{dltnYn} , 'Y',  #{gvUserId} , null)
		                         , to_date( #{mngrRevwFinsDd} , 'YYYYMMDD')
		                         ,  #{qlasAsgnId} 
		                         ,  #{rtrcCtn} 
		                         ,  #{rtrcMngnCtn} 
		                         , to_date( #{qlasFinsDd} , 'YYYYMMDD')
		                         , to_date( #{rtrcYmd} , 'YYYYMMDD')
		                         , to_date( #{mngnYmd} , 'YYYYMMDD')
		                         ,  #{qlasRevwTrgtYn} 
		                 , #{gvUserId}                               -- 최초등록자ID
		                 , #{gvUserIp}                               -- 최초등록IP
		                 , sysdate                                   -- 최초등록일시
		                 , #{gvClntPrgmId}                           -- 최초등록클라이언트프로그램ID
		                 , #{gvSrvrPrgmId}                           -- 최초등록서버프로그램ID
		                 , #{gvUserId}                               -- 최종수정자ID
		                 , #{gvUserIp}                               -- 최종수정IP
		                 , sysdate                                   -- 최종수정일시
		                 , #{gvClntPrgmId}                           -- 최종수정클라이언트프로그램ID
		                 , #{gvSrvrPrgmId}                           -- 최종수정서버프로그램ID          
		                         )
	</insert>




    <!--
        SQL Name : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-updatePrgMm (cod_tbprmmt_u01$I01_to-be 프로그램 수정) 
        Description :                                           cod_tbprmmt_u01$I01_to-be 프로그램 수정
                                            
		parameterType : com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO
    -->	
	<update id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-updatePrgMm"  parameterType="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-updatePrgMm */
		    update  /*+ cod_tbprmmt_u01$I01_to-be 프로그램 수정 */
		            COTBPRMMT
		    set
		            PRGM_NM            =  #{prgmNm} 
		          , PRGM_DETL_DSCR_CTN =  #{prgmDetlDscrCtn} 
		          , PRGM_TYP_CD        =  #{prgmTypCd} 
		          , BSDV_CD            =  #{bsdvCd} 
		          , PROR_BASE_CD       =  #{prorBaseCd} 
		          , WG_CD              =  #{wgCd} 
		          , DEVP_ASGN_ID       =  #{devpAsgnId} 
		          , MNGM_ASGN_ID       =  #{mngmAsgnId} 
		          , ACWR_ASGN_ID       =  #{acwrAsgnId} 
		          , OFFR_DVSN_CD       =  #{offrDvsnCd} 
		          , SGSN_OFFR_DVSN_CD  =  #{sgsnOffrDvsnCd} 
		          , PRJT_TISS_CD       =  #{prjtTissCd} 
		          , PLAN_STRT_YMD      = to_date( #{planStrtYmd} , 'YYYYMMDD')
		          , PLAN_FNSH_YMD      = to_date( #{planFnshYmd} , 'YYYYMMDD')
		          , DLTN_YN            =  #{dltnYn} 
		          , DLTN_DT            = decode( #{dltnYn} , 'Y', sysdate, null)
		          , DLPR_ID            = decode( #{dltnYn} , 'Y',  #{gvUserId} , null)
		          , MNGR_REVW_FINS_DD  = to_date( #{mngrRevwFinsDd} , 'YYYYMMDD')
		          , QLAS_ASGN_ID       =  #{qlasAsgnId} 
		          , RTRC_CTN           =  #{rtrcCtn} 
		          , RTRC_MNGN_CTN      =  #{rtrcMngnCtn} 
		          , QLAS_FINS_DD       = to_date( #{qlasFinsDd} , 'YYYYMMDD')
		          , RTRC_YMD           = to_date( #{rtrcYmd} , 'YYYYMMDD')
		          , MNGN_YMD           = to_date( #{mngnYmd} , 'YYYYMMDD')
		          , QLAS_REVW_TRGT_YN  =  #{qlasRevwTrgtYn} 
		                 , LAST_UPDR_ID          = #{gvUserId}                            -- 최종수정자ID
		                 , LAST_UPDT_IP          = #{gvUserIp}                            -- 최종수정IP
		                 , LAST_UPDT_DT          = sysdate                                -- 최종수정일시
		                 , LAST_UPDT_CLNT_PRGM_ID                    = #{gvClntPrgmId}                        -- 최종수정클라이언트프로그램ID
		                 , LAST_UPDT_SRVR_PRGM_ID                    = #{gvSrvrPrgmId}                        -- 최종수정서버프로그램ID      
		    where   upper(PRGM_ID)     = upper( #{prgmId} )
	</update>




    <!--
        SQL Name : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-deletePrgMmDetail (cod_tbprmmt_u02$I01_to-be 프로그램 목록 및 정보 관리 삭제) 
        Description :                                           cod_tbprmmt_u02$I01_to-be 프로그램 목록 및 정보 관리 삭제
                                            
		parameterType : com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO
    -->	
	<delete id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-deletePrgMmDetail"  parameterType="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-deletePrgMmDetail */
		    update  /*+ cod_tbprmmt_u02$I01_to-be 프로그램 목록 및 정보 관리 삭제 */
		            COTBPRMMT
		    set
		            DLTN_YN            = 'Y'
		          , DLTN_DT            = sysdate
		          , DLPR_ID            =  #{gvUserId} 
		                 , LAST_UPDR_ID          = #{gvUserId}                            -- 최종수정자ID
		                 , LAST_UPDT_IP          = #{gvUserIp}                            -- 최종수정IP
		                 , LAST_UPDT_DT          = sysdate                                -- 최종수정일시
		                 , LAST_UPDT_CLNT_PRGM_ID                    = #{gvClntPrgmId}                        -- 최종수정클라이언트프로그램ID
		                 , LAST_UPDT_SRVR_PRGM_ID                    = #{gvSrvrPrgmId}                        -- 최종수정서버프로그램ID                 
		    where   PRGM_ID            =  #{prgmId} 
	</delete>


	<resultMap id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listPrgMm-result" type="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO">
	
		<result property="comnDtlsCd1" column="COMN_DTLS_CD_1"/>
		<result property="detlCdNm1" column="DETL_CD_NM_1"/>
		<result property="comnDtlsCd2" column="COMN_DTLS_CD_2"/>
		<result property="detlCdNm2" column="DETL_CD_NM_2"/>
		<result property="prgmId" column="PRGM_ID"/>
		<result property="prgmNm" column="PRGM_NM"/>
		<result property="prgmTypCd" column="PRGM_TYP_CD"/>
		<result property="detlCdNm3" column="DETL_CD_NM_3"/>
		<result property="prncYn" column="PRNC_YN"/>
		<result property="afiSrchCndtCtn1" column="AFI_SRCH_CNDT_CTN_1"/>
		<result property="afiSrchCndtCtn2" column="AFI_SRCH_CNDT_CTN_2"/>
		<result property="afiSrchCndtCtn3" column="AFI_SRCH_CNDT_CTN_3"/>
		<result property="devpAsgnId" column="DEVP_ASGN_ID"/>
		<result property="userNm" column="USER_NM"/>
		<result property="mngmAsgnId" column="MNGM_ASGN_ID"/>
		<result property="userNm1" column="USER_NM_1"/>
		<result property="acwrAsgnId" column="ACWR_ASGN_ID"/>
		<result property="userNm2" column="USER_NM_2"/>
		<result property="offrDvsnCd" column="OFFR_DVSN_CD"/>
		<result property="detlCdNm6" column="DETL_CD_NM_6"/>
		<result property="sgsnOffrDvsnCd" column="SGSN_OFFR_DVSN_CD"/>
		<result property="detlCdNm7" column="DETL_CD_NM_7"/>
		<result property="prgmDetlDscrCtn" column="PRGM_DETL_DSCR_CTN"/>
		<result property="bsdvCd" column="BSDV_CD"/>
		<result property="detlCdNm5" column="DETL_CD_NM_5"/>
		<result property="prorBaseCd" column="PROR_BASE_CD"/>
		<result property="detlCdNm8" column="DETL_CD_NM_8"/>
		<result property="wgCd" column="WG_CD"/>
		<result property="detlCdNm4" column="DETL_CD_NM_4"/>
		<result property="prjtTissCd" column="PRJT_TISS_CD"/>
		<result property="planStrtYmd" column="PLAN_STRT_YMD"/>
		<result property="planFnshYmd" column="PLAN_FNSH_YMD"/>
		<result property="antpMnshVl" column="ANTP_MNSH_VL"/>
		<result property="dltnYn" column="DLTN_YN"/>
		<result property="mngrRevwFinsDd" column="MNGR_REVW_FINS_DD"/>
		<result property="qlasAsgnId" column="QLAS_ASGN_ID"/>
		<result property="userNm3" column="USER_NM_3"/>
		<result property="rtrcCtn" column="RTRC_CTN"/>
		<result property="rtrcMngnCtn" column="RTRC_MNGN_CTN"/>
		<result property="qlasFinsDd" column="QLAS_FINS_DD"/>
		<result property="rtrcYmd" column="RTRC_YMD"/>
		<result property="mngnYmd" column="MNGN_YMD"/>
		<result property="qlasRevwTrgtYn" column="QLAS_REVW_TRGT_YN"/>
		<result property="dfntCqy" column="DFNT_CQY"/>
		<result property="afiTrgtCot" column="AFI_TRGT_COT"/>
		<result property="afiTrgtCot2" column="AFI_TRGT_COT_2"/>
		<result property="afiRsltAnncCtn" column="AFI_RSLT_ANNC_CTN"/>
		<result property="afiRturVl" column="AFI_RTUR_VL"/>
		<result property="dvlrCnfrYn" column="DVLR_CNFR_YN"/>
		<result property="useCqy01" column="USE_CQY_01"/>
		<result property="useCqy02" column="USE_CQY_02"/>
		<result property="useCqy03" column="USE_CQY_03"/>
		<result property="acrlStrtYmd" column="ACRL_STRT_YMD"/>
		<result property="acrlFnshYmd" column="ACRL_FNSH_YMD"/>
		<result property="dvlrTestPlanYmd" column="DVLR_TEST_PLAN_YMD"/>
		<result property="dvlrTestFnshYmd" column="DVLR_TEST_FNSH_YMD"/>
		<result property="afiSrchNm" column="AFI_SRCH_NM"/>
		<result property="useCqy04" column="USE_CQY_04"/>
		<result property="useCqy05" column="USE_CQY_05"/>
		<result property="useCqy06" column="USE_CQY_06"/>
		<result property="useCqy07" column="USE_CQY_07"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listPrgMm (cod_tbprmmt_l01$S01_to-be 프로그램 조회) 
        Description :                                           cod_tbprmmt_l01$S01_to-be 프로그램 조회
                                            
		parameterType : com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO
		resultMap : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listPrgMm-result
    -->
	<select id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listPrgMm"  parameterType="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO"  resultMap="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listPrgMm-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listPrgMm */
		<![CDATA[
		    select  /*+ cod_tbprmmt_l01$S01_to-be 프로그램 조회 */ 
		            ta.COMN_DTLS_CD_1
		          , ta.DETL_CD_NM_1
		          , ta.COMN_DTLS_CD_2
		          , ta.DETL_CD_NM_2
		          , ta.PRGM_ID
		          , ta.PRGM_NM
		          , ta.PRGM_TYP_CD
		          , ta.DETL_CD_NM_3
		          , ta.PRNC_YN
		          , ta.FUNC_COUNT as AFI_SRCH_CNDT_CTN_1
		          , ta.FIANL_COUNT as AFI_SRCH_CNDT_CTN_2
		          , ta.FUNC_COUNT - ta.FIANL_COUNT as AFI_SRCH_CNDT_CTN_3
		          , ta.DEVP_ASGN_ID
		          , ta.USER_NM
		          , ta.MNGM_ASGN_ID
		          , ta.USER_NM_1
		          , ta.ACWR_ASGN_ID
		          , ta.USER_NM_2
		          , ta.OFFR_DVSN_CD
		          , ta.DETL_CD_NM_6
		          , ta.SGSN_OFFR_DVSN_CD
		          , ta.DETL_CD_NM_7
		          , ta.PRGM_DETL_DSCR_CTN
		          , ta.BSDV_CD
		          , ta.DETL_CD_NM_5
		          , ta.PROR_BASE_CD
		          , ta.DETL_CD_NM_8
		          , ta.WG_CD
		          , ta.DETL_CD_NM_4
		          , ta.PRJT_TISS_CD
		          , ta.PLAN_STRT_YMD
		          , ta.PLAN_FNSH_YMD
		          , nvl(ta.ANTP_MNSH_VL, 0) as ANTP_MNSH_VL
		          , ta.DLTN_YN
		          , ta.MNGR_REVW_FINS_DD
		          , ta.QLAS_ASGN_ID
		          , ta.USER_NM_3
		          , ta.RTRC_CTN
		          , ta.RTRC_MNGN_CTN
		          , ta.QLAS_FINS_DD
		          , ta.RTRC_YMD
		          , ta.MNGN_YMD
		          , ta.QLAS_REVW_TRGT_YN
		          , nvl(( select  count(*)
		                  from    COTBPRMDT xa
		                  where   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                    and   nvl(xa.MDFC_YN, 'N') = 'Y'
		                    and   xa.PRGM_ID           = ta.PRGM_ID
		                ), 0) as DFNT_CQY
		          , nvl(( select  count(*)
		                  from    COPJTISDT xa
		                        , COPJTISMT xb
		                  where   xa.ISS_NO            = xb.ISS_NO
		                    and   xa.PRGM_ID           = ta.PRGM_ID
		                    and   xb.RFLC_YN_CD in ('R1', 'R3')
		                    and   nvl(xb.DLTN_YN, 'N') <> 'Y'
		                    and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                ), 0) as AFI_TRGT_COT
		          , nvl(( select  count(*)
		                  from    COSCFNAMT a
		                  where   a.PRGM_ID = ta.PRGM_ID
		                    and   a.ATCH_DVSN_CD = 'A3'
		                 ), 0) as AFI_TRGT_COT_2
		          , ( select  max(a.FILE_PATH_NM || a.FILE_ID || '+=' || a.FILE_NM)
		              from    COSCFNADT a
		              where   a.PRGM_ID = ta.PRGM_ID
		                and   a.ATCH_DVSN_CD = 'A1'
		            ) as AFI_RSLT_ANNC_CTN
		          , ( select  case  when ((nvl(xa.STTS_CD2, 0) + nvl(xa.STTS_CD3, 0) + nvl(xa.STTS_CD4, 0) + nvl(xa.STTS_CD5, 0) + nvl(xa.STTS_CD6, 0)) = 0) and
		                                 (nvl(xa.STTS_CD1, 0) > 0)
		                            then '개발전'
		                            when (nvl(xa.STTS_CD1, 0) = 0) and (nvl(xa.STTS_CD2, 0) > 0)
		                            then '코딩중'
		                            when ((nvl(xa.STTS_CD1, 0) + nvl(xa.STTS_CD2, 0)) = 0) and (nvl(xa.STTS_CD3, 0) > 0)
		                            then '코딩완료'
		                            when ((nvl(xa.STTS_CD1, 0) + nvl(xa.STTS_CD2, 0) + nvl(xa.STTS_CD3, 0)) = 0) and
		                                  (nvl(xa.STTS_CD4, 0) > 0) and ((nvl(xa.STTS_CD1, 0) + nvl(xa.STTS_CD2, 0) + nvl(xa.STTS_CD3, 0) + nvl(xa.STTS_CD4, 0) + nvl(xa.STTS_CD5, 0) + nvl(xa.STTS_CD6, 0)) <> 0)
		                            then 'AL테스트대상'
		                            when ((nvl(xa.STTS_CD1, 0) + nvl(xa.STTS_CD2, 0) + nvl(xa.STTS_CD3, 0) + nvl(xa.STTS_CD4, 0)) = 0) and
		                                  (nvl(xa.STTS_CD5, 0) > 0) and ((nvl(xa.STTS_CD1, 0) + nvl(xa.STTS_CD2, 0) + nvl(xa.STTS_CD3, 0) + nvl(xa.STTS_CD4, 0) + nvl(xa.STTS_CD5, 0) + nvl(xa.STTS_CD6, 0)) <> 0)
		                            then '현업테스트대상'
		                            when ((nvl(xa.STTS_CD1, 0) + nvl(xa.STTS_CD2, 0) + nvl(xa.STTS_CD3, 0) + nvl(xa.STTS_CD4, 0) + nvl(xa.STTS_CD5, 0)) = 0) and
		                                  ((nvl(xa.STTS_CD1, 0) + nvl(xa.STTS_CD2, 0) + nvl(xa.STTS_CD3, 0) + nvl(xa.STTS_CD4, 0) + nvl(xa.STTS_CD5, 0) + nvl(xa.STTS_CD6, 0)) <> 0)
		                            then '완료'
		                      else '코딩중'
		                      end
		              from    ( select  PRGM_ID
		                              , sum(decode(CRNT_STTS_CD, '1', 1, 0)) as STTS_CD1
		                              , sum(decode(CRNT_STTS_CD, '2', 1, 0)) as STTS_CD2
		                              , sum(decode(CRNT_STTS_CD, '3', 1, 0)) as STTS_CD3
		                              , sum(decode(CRNT_STTS_CD, '4', 1, 0)) as STTS_CD4
		                              , sum(decode(CRNT_STTS_CD, '5', 1, 0)) as STTS_CD5
		                              , sum(decode(CRNT_STTS_CD, '6', 1, 0)) as STTS_CD6
		                        from    COTBPRMDT
		                        where   nvl(DLTN_YN, 'N') <> 'Y'
		                        group by PRGM_ID
		                      ) xa
		              where   xa.PRGM_ID(+) = ta.PRGM_ID
		            ) as AFI_RTUR_VL
		           , ta.DVLR_CNFR_YN
		           , ta.FUNC_COUNT as USE_CQY_01
		           , ta.FIANL_COUNT as USE_CQY_02
		           , ta.FUNC_COUNT - ta.FIANL_COUNT as USE_CQY_03
		           , ( select  to_char(min(xa.PLAN_STRT_YMD), 'yyyymmdd')
		               from    COTBPRMDT xa
		               where   xa.PRGM_ID = ta.PRGM_ID
		                 and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                 and   xa.CRNT_STTS_CD in ('1', '2')
		             ) as ACRL_STRT_YMD
		           , ( select  to_char(max(xa.PLAN_FNSH_YMD), 'yyyymmdd')
		               from    COTBPRMDT xa
		               where   xa.PRGM_ID = ta.PRGM_ID
		                 and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                 and   xa.CRNT_STTS_CD in ('1', '2')
		             ) as ACRL_FNSH_YMD
		           , decode(ta.DVLR_TEST_PLAN_YMD, '29991231', '', ta.DVLR_TEST_PLAN_YMD) as DVLR_TEST_PLAN_YMD
		           , decode(ta.DVLR_TEST_FNSH_YMD, '29991231', '', ta.DVLR_TEST_FNSH_YMD) as DVLR_TEST_FNSH_YMD
		           , ( select substr(tta.TEST_STEP_NM, 2, length(tta.TEST_STEP_NM) -1) as TEST_STEP_NM
		               from   ( select  ta.PRGM_ID
		                              , decode(ta.TEST_STEP_NM_1, null, '', '/' || ta.TEST_STEP_NM_1) ||
		                                decode(ta.TEST_STEP_NM_2, null, '', '/' || ta.TEST_STEP_NM_2) ||
		                                decode(ta.TEST_STEP_NM_3, null, '', '/' || ta.TEST_STEP_NM_3) ||
		                                decode(ta.TEST_STEP_NM_4, null, '', '/' || ta.TEST_STEP_NM_4) ||
		                                decode(ta.TEST_STEP_NM_5, null, '', '/' || ta.TEST_STEP_NM_5) as TEST_STEP_NM
		                        from    ( select  xb.PRGM_ID
		                                        , max(decode(xb.RNUM, 1, xb.TEST_STEP_NM, '')) as TEST_STEP_NM_1
		                                        , max(decode(xb.RNUM, 2, xb.TEST_STEP_NM, '')) as TEST_STEP_NM_2
		                                        , max(decode(xb.RNUM, 3, xb.TEST_STEP_NM, '')) as TEST_STEP_NM_3
		                                        , max(decode(xb.RNUM, 4, xb.TEST_STEP_NM, '')) as TEST_STEP_NM_4
		                                        , max(decode(xb.RNUM, 5, xb.TEST_STEP_NM, '')) as TEST_STEP_NM_5
		                                  from    ( select  xa.PRGM_ID
		                                                  , xa.TEST_STEP_NM
		                                                  , RANK() OVER (PARTITION BY xa.PRGM_ID ORDER BY xa.TEST_STEP_NM) as RNUM
		                                            from    ( select  a.PRGM_ID
		                                                            , substr(b.DETL_CD_NM, 1, 2) as TEST_STEP_NM
		                                                      from    COMTESTMT a
		                                                            , CCCMCDDMT b
		                                                      where   nvl(a.DLTN_YN, 'N') <> 'Y'
		                                                        and   b.COMN_GRP_CD(+) = 'COR_009'
		                                                        and   a.TEST_STEP_CD   = b.COMN_DTLS_CD(+)
		                                                    ) xa
		                                          ) xb
		                                  group by xb.PRGM_ID
		                                ) ta
		                      ) tta
		               where  tta.PRGM_ID = ta.PRGM_ID
		             ) as AFI_SRCH_NM
		           , ( select   count(*)
		               from     COTSTERDT a
		                      , COTSTERMT b
		                      , COMTESTDT c
		                      , COMTESTMT d
		               where    nvl(a.DLTN_YN, 'N') <> 'Y'
		                 and    nvl(b.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = b.PRGM_ID
		                 and    a.TEST_STEP_CD  = b.TEST_STEP_CD
		                 and    a.TEST_ASGN_ID  = b.TEST_ASGN_ID
		                 and    a.TEST_ID       = b.TEST_ID
		                 and    nvl(c.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = c.PRGM_ID
		                 and    a.TEST_STEP_CD  = c.TEST_STEP_CD
		                 and    a.TEST_ASGN_ID  = c.TEST_ASGN_ID
		                 and    nvl(d.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = d.PRGM_ID
		                 and    a.TEST_STEP_CD  = d.TEST_STEP_CD
		                 and    (
		                         (b.TEST_RSLT_CD = 'T2')  and ( (nvl(a.FULT_CRNT_STTS_CD, 'X') = 'A9') or (a.FULT_PRSG_STTS_CD = '7'))
		                        )
		                 and    a.PRGM_ID = ta.PRGM_ID
		             ) as USE_CQY_04
		           , ( select   count(*)
		               from     COTSTERDT a
		                      , COTSTERMT b
		                      , COMTESTDT c
		                      , COMTESTMT d
		               where    nvl(a.DLTN_YN, 'N') <> 'Y'
		                 and    nvl(b.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = b.PRGM_ID
		                 and    a.TEST_STEP_CD  = b.TEST_STEP_CD
		                 and    a.TEST_ASGN_ID  = b.TEST_ASGN_ID
		                 and    a.TEST_ID       = b.TEST_ID
		                 and    nvl(c.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = c.PRGM_ID
		                 and    a.TEST_STEP_CD  = c.TEST_STEP_CD
		                 and    a.TEST_ASGN_ID  = c.TEST_ASGN_ID
		                 and    nvl(d.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = d.PRGM_ID
		                 and    a.TEST_STEP_CD  = d.TEST_STEP_CD
		                 and    ((a.FULT_CRNT_STTS_CD is null) or (a.FULT_PRSG_STTS_CD = '6'))
		                 and    a.PRGM_ID = ta.PRGM_ID
		             ) as USE_CQY_05
		           , ( select   count(*)
		               from     COTSTERDT a
		                      , COTSTERMT b
		                      , COMTESTDT c
		                      , COMTESTMT d
		               where    nvl(a.DLTN_YN, 'N') <> 'Y'
		                 and    nvl(b.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = b.PRGM_ID
		                 and    a.TEST_STEP_CD  = b.TEST_STEP_CD
		                 and    a.TEST_ASGN_ID  = b.TEST_ASGN_ID
		                 and    a.TEST_ID       = b.TEST_ID
		                 and    nvl(c.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = c.PRGM_ID
		                 and    a.TEST_STEP_CD  = c.TEST_STEP_CD
		                 and    a.TEST_ASGN_ID  = c.TEST_ASGN_ID
		                 and    nvl(d.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = d.PRGM_ID
		                 and    a.TEST_STEP_CD  = d.TEST_STEP_CD
		                 and    a.FULT_PRSG_STTS_CD in ('1', '2')
		                 and    a.PRGM_ID = ta.PRGM_ID
		             ) as USE_CQY_06
		           , ( select   count(*)
		               from     COTSTERDT a
		                      , COTSTERMT b
		                      , COMTESTDT c
		                      , COMTESTMT d
		               where    nvl(a.DLTN_YN, 'N') <> 'Y'
		                 and    nvl(b.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = b.PRGM_ID
		                 and    a.TEST_STEP_CD  = b.TEST_STEP_CD
		                 and    a.TEST_ASGN_ID  = b.TEST_ASGN_ID
		                 and    a.TEST_ID       = b.TEST_ID
		                 and    nvl(c.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = c.PRGM_ID
		                 and    a.TEST_STEP_CD  = c.TEST_STEP_CD
		                 and    a.TEST_ASGN_ID  = c.TEST_ASGN_ID
		                 and    nvl(d.DLTN_YN, 'N') <> 'Y'
		                 and    a.PRGM_ID       = d.PRGM_ID
		                 and    a.TEST_STEP_CD  = d.TEST_STEP_CD
		                 and    a.FULT_PRSG_STTS_CD in ('3', '4')
		                 and    a.PRGM_ID = ta.PRGM_ID
		             ) as USE_CQY_07
		    from    ( select  c.COMN_DTLS_CD as COMN_DTLS_CD_1
		                    , c.DETL_CD_NM as DETL_CD_NM_1
		                    , c.SCRN_DSPL_SQNC
		                    , b.COMN_DTLS_CD as COMN_DTLS_CD_2
		                    , b.DETL_CD_NM as DETL_CD_NM_2
		                    , b.SCRN_DSPL_SQNC as SCRN_DSPL_SQNC_1
		                    , a.PRGM_ID
		                    , a.PRGM_NM
		                    , a.PRGM_TYP_CD
		                    , d.DETL_CD_NM as DETL_CD_NM_3
		                    , a.PRNC_YN
		                    , ( select  count(*)
		                        from    COTBPRMDT xa
		                        where   xa.PRGM_ID = a.PRGM_ID
		                          and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                      ) as FUNC_COUNT
		                    , ( select  count(*)
		                        from    COTBPRMDT xa
		                        where   xa.PRGM_ID = a.PRGM_ID
		                          and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                        --  and   xa.CRNT_STTS_CD in ('4', '5', '6')
		                          and   trunc(nvl(xa.DVLR_TEST_FNSH_YMD, to_date('29991231', 'yyyymmdd'))) <= trunc(sysdate)
		                      ) as FIANL_COUNT
		                    , a.DEVP_ASGN_ID
		                    , e.USER_NM
		                    , a.MNGM_ASGN_ID
		                    , f.USER_NM as USER_NM_1
		                    , a.ACWR_ASGN_ID
		                    , g.USER_NM as USER_NM_2
		                    , a.OFFR_DVSN_CD
		                    , j.DETL_CD_NM as DETL_CD_NM_6
		                    , a.SGSN_OFFR_DVSN_CD
		                    , k.DETL_CD_NM as DETL_CD_NM_7
		                    , a.PRGM_DETL_DSCR_CTN
		                    , a.BSDV_CD
		                    , i.DETL_CD_NM as DETL_CD_NM_5
		                    , a.PROR_BASE_CD
		                    , l.DETL_CD_NM as DETL_CD_NM_8
		                    , a.WG_CD
		                    , h.DETL_CD_NM as DETL_CD_NM_4
		                    , a.PRJT_TISS_CD
		                    , to_char(a.PLAN_STRT_YMD , 'yyyymmdd') as PLAN_STRT_YMD
		                    , to_char(a.PLAN_FNSH_YMD , 'yyyymmdd') as PLAN_FNSH_YMD
		                    , ( select sum(nvl(xa.ANTP_MNSH_VL, 0))
		                        from   COTBPRMDT xa
		                        where  xa.PRGM_ID = a.PRGM_ID
		                          and  nvl(xa.DLTN_YN, 'N') <> 'Y'
		                          and  xa.CRNT_STTS_CD in ('1', '2', '3')
		                      ) as ANTP_MNSH_VL
		                    ,  a.DLTN_YN
		                    , to_char(a.MNGR_REVW_FINS_DD , 'yyyymmdd') as MNGR_REVW_FINS_DD
		                    , a.QLAS_ASGN_ID
		                    , m.USER_NM as USER_NM_3
		                    , a.RTRC_CTN
		                    , a.RTRC_MNGN_CTN
		                    , to_char(a.QLAS_FINS_DD , 'yyyymmdd') as QLAS_FINS_DD
		                    , to_char(a.RTRC_YMD , 'yyyymmdd') as RTRC_YMD
		                    , to_char(a.MNGN_YMD , 'yyyymmdd') as MNGN_YMD
		                    , nvl(a.QLAS_REVW_TRGT_YN, 'N') as QLAS_REVW_TRGT_YN
		                    , a.DVLR_CNFR_YN
		                    , ( select  to_char(max(nvl(xa.DVLR_TEST_PLAN_YMD, to_date('29991231', 'yyyymmdd'))), 'yyyymmdd')
		                        from    COTBPRMDT xa
		                        where   xa.PRGM_ID = a.PRGM_ID
		                          and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                       ) as DVLR_TEST_PLAN_YMD
		                    , ( select  to_char(max(nvl(xa.DVLR_TEST_FNSH_YMD,to_date('29991231', 'yyyymmdd'))), 'yyyymmdd')
		                        from    COTBPRMDT xa
		                        where   xa.PRGM_ID = a.PRGM_ID
		                          and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                      ) as DVLR_TEST_FNSH_YMD
		              from    COTBPRMMT a
		                    , CCCMCDDMT b
		                    , CCCMCDDMT c
		                    , CCCMCDDMT d
		                    , CCUSRDPHT e
		                    , CCUSRDPHT f
		                    , CCUSRDPHT g
		                    , CCCMCDDMT h
		                    , CCCMCDDMT i
		                    , CCCMCDDMT j
		                    , CCCMCDDMT k
		                    , CCCMCDDMT l
		                    , CCUSRDPHT m
		              where   b.COMN_GRP_CD(+) = 'COR_025'
		                and   a.PRJT_TISS_CD   = b.COMN_DTLS_CD(+)
		                and   c.COMN_GRP_CD(+) = 'COR_025'
		                and   substr(a.PRJT_TISS_CD, 1, 1) = c.COMN_DTLS_CD(+)
		                and   d.COMN_GRP_CD(+) = 'COR_001'
		                and   a.PRGM_TYP_CD = d.COMN_DTLS_CD(+)
		                and   a.DEVP_ASGN_ID = e.USER_ID(+)
		                and   a.MNGM_ASGN_ID = f.USER_ID(+)
		                and   a.ACWR_ASGN_ID = g.USER_ID(+)
		                and   h.COMN_GRP_CD(+) = 'COR_014'
		                and   a.WG_CD          = h.COMN_DTLS_CD(+)
		                and   i.COMN_GRP_CD(+) in ('CCC_005', 'CCC_006', 'CCC_007')
		                and   a.BSDV_CD        = i.COMN_DTLS_CD(+)
		                and   j.COMN_GRP_CD(+) = 'COR_003'
		                and   a.OFFR_DVSN_CD   = j.COMN_DTLS_CD(+)
		                and   k.COMN_GRP_CD(+) = 'COR_003'
		                and   a.SGSN_OFFR_DVSN_CD   = k.COMN_DTLS_CD(+)
		                and   l.COMN_GRP_CD(+) = 'COR_002'
		                and   a.PROR_BASE_CD   = l.COMN_DTLS_CD(+)
		                and   a.QLAS_ASGN_ID   = m.USER_ID(+)
		                and   ((nvl( #{afiInqrCndtNm} , '*') = '*') or ( #{afiInqrCndtNm}  like '%' || a.PRJT_TISS_CD || '%'))
		                and   ((nvl( #{prgmId} , '*') = '*') or (upper(a.PRGM_ID) like upper( #{prgmId} ) || '%') or
		                       (upper(a.PRGM_NM) like '%' || upper(#{prgmId}) || '%'))
		                and   ((nvl( #{prgmTypCd} , '*') = '*') or (a.PRGM_TYP_CD =  #{prgmTypCd} ))
		                and   ((nvl( #{prncYn} , '*') = '*') or (a.PRNC_YN =  #{prncYn} ))
		                and   ((nvl( #{wgCd} , '*') = '*') or (a.WG_CD =  #{wgCd} ))
		                and   ((nvl( #{devpAsgnId} , '*') = '*') or (a.DEVP_ASGN_ID =  #{devpAsgnId} ))
		                and   ((nvl( #{mngmAsgnId} , '*') = '*') or (a.MNGM_ASGN_ID =  #{mngmAsgnId} ))
		                and   ((nvl( #{acwrAsgnId} , '*') = '*') or (a.ACWR_ASGN_ID =  #{acwrAsgnId} ))
		                      /* 삭제여부 ALL 0, N   1, Y   2 */
		                and   (( #{dltnYn}  = '0') or (( #{dltnYn}  = '1') and (nvl(a.DLTN_YN, 'N') <> 'Y')) or
		                       (( #{dltnYn}  = '2') and (nvl(a.DLTN_YN, 'N') = 'Y')))
		                and   ((nvl( #{qlasRevwTrgtYn} , '*') = '*') or (( #{qlasRevwTrgtYn}  = 'Y') and (nvl(a.QLAS_REVW_TRGT_YN, 'N') = 'Y')) )
		                      /* 유형 */
		                and   ((nvl( #{chrcCdVl} ,'*') = '*') or ( #{chrcCdVl}  like '%' || a.PRGM_TYP_CD || '%'))
		            ) ta
		    where   (( #{afiInqrDvsnNm}  = '0') or
		             (( #{afiInqrDvsnNm}  = '1') and (ta.FUNC_COUNT = ta.FIANL_COUNT)) or
		             (( #{afiInqrDvsnNm}  = '2') and (ta.FUNC_COUNT <> ta.FIANL_COUNT)))
		      and   ((nvl( #{fromInqrYmd} , '*') = '*') or
		             (ta.PRGM_ID in ( select  xa.PRGM_ID
		                              from    COTBPRMDT xa
		                              where   xa.PRGM_ID = ta.PRGM_ID
		                                and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                                and   trunc(xa.PLAN_STRT_YMD) >= to_date( #{fromInqrYmd} , 'YYYYMMDD')
		                                and   trunc(xa.PLAN_STRT_YMD) <= to_date( #{toInqrYmd} , 'YYYYMMDD')
		                            )
		             )
		            )
		      and   ((nvl( #{fromInqrYmd1} , '*') = '*') or
		             (ta.PRGM_ID in ( select  xa.PRGM_ID
		                              from    COTBPRMDT xa
		                              where   xa.PRGM_ID = ta.PRGM_ID
		                                and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                                and   trunc(xa.PLAN_FNSH_YMD) >= to_date( #{fromInqrYmd1} , 'YYYYMMDD')
		                                and   trunc(xa.PLAN_FNSH_YMD) <= to_date( #{toInqrYmd1} , 'YYYYMMDD')
		                            )
		             )
		            )
		      and   ((nvl( #{afiSrchDvsnVl} , '*') = '*') or
		             (ta.PRGM_ID in ( select  xa.PRGM_ID
		                              from    COTBPRMDT xa
		                              where   xa.PRGM_ID = ta.PRGM_ID
		                                and   xa.CRNT_STTS_CD in ('1', '2', '3')
		                                and   nvl(xa.DLTN_YN, 'N') <> 'Y'
		                                and   (((nvl(xa.PLAN_STRT_YMD, sysdate + 1) <= trunc(sysdate)) and (ACRL_FNSH_YMD is null)) or
		                                       ((nvl(xa.DVLR_TEST_PLAN_YMD, sysdate + 1) <= trunc(sysdate)) and (DVLR_TEST_FNSH_YMD is null)))
		                        )
		             )
		            )
		    order by ta.SCRN_DSPL_SQNC, ta.SCRN_DSPL_SQNC_1, ta.USER_NM, ta.PRGM_ID
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-selectOnePrgMm-result" type="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO">
	
		<result property="cnt" column="CNT"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-selectOnePrgMm (cod_tbprmmt_s02$S01_to-be 프로그램의 기능 목록 및 정보 관리 조회) 
        Description :                                           cod_tbprmmt_s02$S01_to-be 프로그램의 기능 목록 및 정보 관리 조회
                                            
		parameterType : com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO
		resultMap : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-selectOnePrgMm-result
    -->
	<select id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-selectOnePrgMm"  parameterType="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO"  resultMap="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-selectOnePrgMm-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-selectOnePrgMm */
		<![CDATA[
		    select  /*+ cod_tbprmmt_s02$S01_to-be 프로그램의 기능 목록 및 정보 관리 조회 */ 
		             to_char(nvl(count(*), 0)) as  CNT
		    from     COTBPRMDT
		    where    PRGM_ID =  #{prgmId} 
		      and    nvl(DLTN_YN, 'N') <> 'Y'
		]]>
	</select>




	<resultMap id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listProjectGroupCode-result" type="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO">
	
		<result property="comnDtlsCd" column="COMN_DTLS_CD"/>
		<result property="detlCdNm" column="DETL_CD_NM"/>
		<result property="comnItemCd" column="COMN_ITEM_CD"/>
		<result property="comnItemChrcVl" column="COMN_ITEM_CHRC_VL"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listProjectGroupCode (cod_tbprmmt_l03$S01_프로젝트조직코드 조회) 
        Description :                                           cod_tbprmmt_l03$S01_프로젝트조직코드 조회
                                            
		parameterType : com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO
		resultMap : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listProjectGroupCode-result
    -->
	<select id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listProjectGroupCode"  parameterType="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO"  resultMap="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listProjectGroupCode-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listProjectGroupCode */
		    select  /*+ cod_tbprmmt_l03$S01_프로젝트조직코드 조회 */ 
		            a.COMN_DTLS_CD
		          , a.DETL_CD_NM
		          , b.COMN_ITEM_CD
		          , b.COMN_ITEM_CHRC_VL
		    from    CCCMCDDMT a
		            , CCCMCDIDT b
		    where   a.COMN_GRP_CD  =  #{comnGrpCd} 
		      and   a.COMN_GRP_CD  = b.COMN_GRP_CD
		      and   a.COMN_DTLS_CD = b.COMN_DTLS_CD
		      and   b.COMN_ITEM_CD =  #{comnItemCd} 
		    order by a.SCRN_DSPL_SQNC
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-updatePrgMmAll (cod_tbprmmt_u03$I01_프로그램 일괄수정) 
        Description :                                           cod_tbprmmt_u03$I01_프로그램 일괄수정
                                            
		parameterType : com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO
    -->	
	<update id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-updatePrgMmAll"  parameterType="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-updatePrgMmAll */
		        update  /*+ cod_tbprmmt_u03$I01_프로그램 일괄수정 */
		                COTBPRMMT
		        set
		                PLAN_STRT_YMD      = to_date( #{planStrtYmd} , 'YYYYMMDD')
		              , PLAN_FNSH_YMD      = to_date( #{planFnshYmd} , 'YYYYMMDD')
		              , MNGR_REVW_FINS_DD  = to_date( #{mngrRevwFinsDd} , 'YYYYMMDD')
		              , QLAS_ASGN_ID       =  #{qlasAsgnId} 
		              , RTRC_CTN           =  #{rtrcCtn} 
		              , RTRC_MNGN_CTN      =  #{rtrcMngnCtn} 
		              , QLAS_FINS_DD       = to_date( #{qlasFinsDd} , 'YYYYMMDD')
		              , RTRC_YMD           = to_date( #{rtrcYmd} , 'YYYYMMDD')
		              , MNGN_YMD           = to_date( #{mngnYmd} , 'YYYYMMDD')
		              , QLAS_REVW_TRGT_YN  =  #{qlasRevwTrgtYn} 
		              , PROR_BASE_CD       = nvl( #{prorBaseCd} , PROR_BASE_CD)
		                 , LAST_UPDR_ID          = #{gvUserId}                            -- 최종수정자ID
		                 , LAST_UPDT_IP          = #{gvUserIp}                            -- 최종수정IP
		                 , LAST_UPDT_DT          = sysdate                                -- 최종수정일시
		                 , LAST_UPDT_CLNT_PRGM_ID                    = #{gvClntPrgmId}                        -- 최종수정클라이언트프로그램ID
		                 , LAST_UPDT_SRVR_PRGM_ID                    = #{gvSrvrPrgmId}                        -- 최종수정서버프로그램ID                 
		        where   PRGM_ID            =  #{prgmId} 
	</update>


	<resultMap id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listServerDevPresentcon-result" type="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO">
	
		<result property="detlCdNm" column="DETL_CD_NM"/>
		<result property="detlCdNm1" column="DETL_CD_NM_1"/>
		<result property="svc" column="SVC"/>
		<result property="bam" column="BAM"/>
		<result property="dam" column="DAM"/>
		<result property="sbd" column="SBD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listServerDevPresentcon (cod_afcpmmt_l01$S01_서버부문 개발현황) 
        Description :                                           cod_afcpmmt_l01$S01_서버부문 개발현황
                                            
		parameterType : com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO
		resultMap : com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listServerDevPresentcon-result
    -->
	<select id="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listServerDevPresentcon"  parameterType="com.sds.healthcare.ehr.com.cc.cco.vo.CcoTbprmmtPrgMmDVO"  resultMap="com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listServerDevPresentcon-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-com-cc-cco-dao-CcoTbprmmtPrgMmDAO-listServerDevPresentcon */
		<![CDATA[
		    select  /*+ cod_afcpmmt_l01$S01_서버부문 개발현황 */ 
		            a.DETL_CD_NM
		          , a.DETL_CD_NM_1
		          , nvl(b.SVC, 0) as SVC
		          , nvl(b.BAM, 0) as BAM
		          , nvl(b.DAM, 0) as DAM
		          , nvl(b.SVC, 0) + nvl(b.BAM, 0) + nvl(b.DAM, 0) as SBD
		    from    ( select  a.COMN_DTLS_CD
		                    , a.DETL_CD_NM
		                    , a.SCRN_DSPL_SQNC
		                    , b.COMN_DTLS_CD as COMN_DTLS_CD_1
		                    , b.DETL_CD_NM   as DETL_CD_NM_1
		                    , b.SCRN_DSPL_SQNC  as SCRN_DSPL_SQNC_1
		              from    CCCMCDDMT a
		                    , CCCMCDDMT b
		              where   a.COMN_GRP_CD  = 'COR_025'
		                and   Length(a.COMN_DTLS_CD) = 1
		                and   b.COMN_GRP_CD  = 'COR_025'
		                and   Length(b.COMN_DTLS_CD) = 2
		                and   a.COMN_DTLS_CD = substr(b.COMN_DTLS_CD, 1, 1)
		              union
		              select  COMN_DTLS_CD
		                    , DETL_CD_NM
		                    , SCRN_DSPL_SQNC
		                    , COMN_DTLS_CD as COMN_DTLS_CD_1
		                    , '소계' as DETL_CD_NM_1
		                    , 99 as SCRN_DSPL_SQNC_1
		              from    CCCMCDDMT
		              where   COMN_GRP_CD  = 'COR_025'
		                and   Length(COMN_DTLS_CD) = 1
		              union
		              select  '9'
		                    , '미매핑'
		                    , 999
		                    , '99'
		                    , ''
		                    , 999
		              from    dual
		            ) a
		          , ( select  xa.PRJT_TISS_CD
		                    , sum(xa.SVC) as SVC
		                    , sum(xa.BAM) as BAM
		                    , sum(xa.DAM) as DAM
		              from   ( select  nvl(PRJT_TISS_CD, '99') as PRJT_TISS_CD
		                             , decode(SMSP_TYP_CD, 'SVC', 1, 0) as SVC
		                             , decode(SMSP_TYP_CD, 'BAM', 1, 0) as BAM
		                             , decode(SMSP_TYP_CD, 'DAM', 1, 0) as DAM
		                       from    COAFCPMMT
		                       where   USE_YN = 'Y'
		                         and   nvl(PRJT_TISS_CD, '99') <> 'XX'
		                         and   SMSP_TYP_CD in ('BAM', 'SVC', 'DAM')
		                       union all
		                       select  substr(PRJT_TISS_CD, 1, 1) as PRJT_TISS_CD
		                             , decode(SMSP_TYP_CD, 'SVC', 1, 0) as SVC
		                             , decode(SMSP_TYP_CD, 'BAM', 1, 0) as BAM
		                             , decode(SMSP_TYP_CD, 'DAM', 1, 0) as DAM
		                       from    COAFCPMMT
		                       where   USE_YN = 'Y'
		                         and   nvl(PRJT_TISS_CD, 'XX') <> 'XX'
		                         and   SMSP_TYP_CD in ('BAM', 'SVC', 'DAM')
		                     ) xa
		              group by xa.PRJT_TISS_CD
		            ) b
		    where a.COMN_DTLS_CD_1 = b.PRJT_TISS_CD(+)
		    order by a.SCRN_DSPL_SQNC, a.SCRN_DSPL_SQNC_1
		]]>
	</select>



</mapper>