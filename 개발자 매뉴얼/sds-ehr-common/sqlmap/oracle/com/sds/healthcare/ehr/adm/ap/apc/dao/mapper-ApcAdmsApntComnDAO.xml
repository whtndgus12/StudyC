<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : mapper_ApcAdmsApntComnDAO_sql.xml 
    Description : -->
<mapper namespace="ApcAdmsApntComnDAO">


	<resultMap id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApnt-result" type="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO">
	
		<result property="admsApntNo" column="ADMS_APNT_NO"/>
		<result property="ptno" column="PTNO"/>
		<result property="codvCd" column="CODV_CD"/>
		<result property="admsPrrnYmd" column="ADMS_PRRN_YMD"/>
		<result property="mdrpNo" column="MDRP_NO"/>
		<result property="frstAdmsPrrnYmd" column="FRST_ADMS_PRRN_YMD"/>
		<result property="frstAdmsPrrnYmdRgsrId" column="FRST_ADMS_PRRN_YMD_RGSR_ID"/>
		<result property="frstAdmsPrrnYmdRgstDt" column="FRST_ADMS_PRRN_YMD_RGST_DT"/>
		<result property="admsDt" column="ADMS_DT"/>
		<result property="oprtPrrnYmd" column="OPRT_PRRN_YMD"/>
		<result property="admsIdctYmd" column="ADMS_IDCT_YMD"/>
		<result property="admsAplcDt" column="ADMS_APLC_DT"/>
		<result property="admsFrmlPrrnDt" column="ADMS_FRML_PRRN_DT"/>
		<result property="antpSthsDdcn" column="ANTP_STHS_DDCN"/>
		<result property="ptrmAsgmDt" column="PTRM_ASGM_DT"/>
		<result property="admsItdrId" column="ADMS_ITDR_ID"/>
		<result property="gndrId" column="GNDR_ID"/>
		<result property="inptDrId" column="INPT_DR_ID"/>
		<result property="smcrYn" column="SMCR_YN"/>
		<result property="wkndAdmsPsblYn" column="WKND_ADMS_PSBL_YN"/>
		<result property="refeYn" column="REFE_YN"/>
		<result property="cagPtntYn" column="CAG_PTNT_YN"/>
		<result property="apntMdfcYn" column="APNT_MDFC_YN"/>
		<result property="moblTrnmYn" column="MOBL_TRNM_YN"/>
		<result property="srilStdcYn" column="SRIL_STDC_YN"/>
		<result property="dyofAdmsPsblYn" column="DYOF_ADMS_PSBL_YN"/>
		<result property="b6rmSngnAplcYn" column="B6RM_SNGN_APLC_YN"/>
		<result property="mcdpCd" column="MCDP_CD"/>
		<result property="istyCd" column="ISTY_CD"/>
		<result property="istyAsstCd" column="ISTY_ASST_CD"/>
		<result property="fatrCd" column="FATR_CD"/>
		<result property="fatrPtntSno" column="FATR_PTNT_SNO"/>
		<result property="scinCd" column="SCIN_CD"/>
		<result property="clncDxCd" column="CLNC_DX_CD"/>
		<result property="drSpsbCtn" column="DR_SPSB_CTN"/>
		<result property="amdvCd" column="AMDV_CD"/>
		<result property="ipdvCd" column="IPDV_CD"/>
		<result property="admsSqncNm" column="ADMS_SQNC_NM"/>
		<result property="ampaCd" column="AMPA_CD"/>
		<result property="itntApntCnfrCd" column="ITNT_APNT_CNFR_CD"/>
		<result property="hslcDvsnCd" column="HSLC_DVSN_CD"/>
		<result property="mccnCd" column="MCCN_CD"/>
		<result property="ptcnYn" column="PTCN_YN"/>
		<result property="admsIdctDvsnCd" column="ADMS_IDCT_DVSN_CD"/>
		<result property="unsbCtn" column="UNSB_CTN"/>
		<result property="ampmDvsnCd" column="AMPM_DVSN_CD"/>
		<result property="ahedDsgnCd" column="AHED_DSGN_CD"/>
		<result property="apntRcpsId" column="APNT_RCPS_ID"/>
		<result property="didvCd" column="DIDV_CD"/>
		<result property="dietCd" column="DIET_CD"/>
		<result property="mesgPtrmGradCd" column="MESG_PTRM_GRAD_CD"/>
		<result property="mesgCnfrYn" column="MESG_CNFR_YN"/>
		<result property="mdcrPtrmDvsnCd" column="MDCR_PTRM_DVSN_CD"/>
		<result property="wntdPtrmGradCd" column="WNTD_PTRM_GRAD_CD"/>
		<result property="wardCd" column="WARD_CD"/>
		<result property="ptrmNo" column="PTRM_NO"/>
		<result property="ptrmInfmCd" column="PTRM_INFM_CD"/>
		<result property="admsPsblWardNm" column="ADMS_PSBL_WARD_NM"/>
		<result property="otrsWardAsgmCd" column="OTRS_WARD_ASGM_CD"/>
		<result property="acsFinsDvsnCd" column="ACS_FINS_DVSN_CD"/>
		<result property="acsRmrkCtn" column="ACS_RMRK_CTN"/>
		<result property="erGradCd" column="ER_GRAD_CD"/>
		<result property="pbdrId" column="PBDR_ID"/>
		<result property="errmAdmsDcsnYmd" column="ERRM_ADMS_DCSN_YMD"/>
		<result property="errmAdmsPblcDt" column="ERRM_ADMS_PBLC_DT"/>
		<result property="errmAdmsPrrtSqncCd" column="ERRM_ADMS_PRRT_SQNC_CD"/>
		<result property="cpRgstYn" column="CP_RGST_YN"/>
		<result property="cpCd" column="CP_CD"/>
		<result property="cpDprtCd" column="CP_DPRT_CD"/>
		<result property="cpInfmInqrDt" column="CP_INFM_INQR_DT"/>
		<result property="admsWaitResnCd" column="ADMS_WAIT_RESN_CD"/>
		<result property="admsWaitMngmMemoCtn" column="ADMS_WAIT_MNGM_MEMO_CTN"/>
		<result property="drDrgNo" column="DR_DRG_NO"/>
		<result property="drgNo" column="DRG_NO"/>
		<result property="cnclDt" column="CNCL_DT"/>
		<result property="admsApntCnreCd" column="ADMS_APNT_CNRE_CD"/>
		<result property="admsStdcInftYn" column="ADMS_STDC_INFT_YN"/>
		<result property="clncDxNm" column="CLNC_DX_NM"/>
		<result property="enrmPsblDt" column="ENRM_PSBL_DT"/>
		<result property="extgAsgmMdrpNo" column="EXTG_ASGM_MDRP_NO"/>
		<result property="chrcTrasSttsCd" column="CHRC_TRAS_STTS_CD"/>
		<result property="ptrmAsgmSttsCd" column="PTRM_ASGM_STTS_CD"/>
		<result property="inftWaitDt" column="INFT_WAIT_DT"/>
		<result property="clrsPrjcCd" column="CLRS_PRJC_CD"/>
		<result property="spcySckbDvsnCd" column="SPCY_SCKB_DVSN_CD"/>
		<result property="spcySckbMxmmUsePsblHh" column="SPCY_SCKB_MXMM_USE_PSBL_HH"/>
		<result property="hiraCmdsInfmCtn" column="HIRA_CMDS_INFM_CTN"/>
		<result property="idcrInftYn" column="IDCR_INFT_YN"/>
		<result property="hgrmPsbltInftYn" column="HGRM_PSBLT_INFT_YN"/>
		<result property="vstrLmttInftYn" column="VSTR_LMTT_INFT_YN"/>
		<result property="inftCnfmRltnCtn" column="INFT_CNFM_RLTN_CTN"/>
		<result property="hiraCmdsInfmCnfrDt" column="HIRA_CMDS_INFM_CNFR_DT"/>
		<result property="isltPtrmAcptDvsnCd" column="ISLT_PTRM_ACPT_DVSN_CD"/>
		<result property="cncmsYn" column="CNCMS_YN"/>
		<result property="pydpAmdvCd" column="PYDP_AMDV_CD"/>
		<result property="scinCpMeaAplyResnCd" column="SCIN_CP_MEA_APLY_RESN_CD"/>
		<result property="scinCpMeaAplyReetCtn" column="SCIN_CP_MEA_APLY_REET_CTN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApnt (입원예약생성) 
        Description :                       
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
		resultMap : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApnt-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApnt"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  resultMap="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApnt-result" useCache="true" flushCache="false">
		SELECT	/*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApnt */
		    ADMS_APNT_NO		/*  */
			,PTNO		/*  */
			,CODV_CD		/*  */
			,to_char(ADMS_PRRN_YMD, 'yyyymmdd')	 as ADMS_PRRN_YMD	/*  */
			,MDRP_NO		/*  */
			,to_char(FRST_ADMS_PRRN_YMD, 'yyyymmdd') as FRST_ADMS_PRRN_YMD
			,FRST_ADMS_PRRN_YMD_RGSR_ID
			,to_char(FRST_ADMS_PRRN_YMD_RGST_DT, 'yyyymmddhh24miss')	as FRST_ADMS_PRRN_YMD_RGST_DT	/*  */
			,to_char(ADMS_DT, 'yyyymmddhh24miss') as ADMS_DT
			,to_char(OPRT_PRRN_YMD, 'yyyymmdd')	as OPRT_PRRN_YMD	/*  */
			,to_char(ADMS_IDCT_YMD, 'yyyymmdd')	as ADMS_IDCT_YMD	/*  */
			,to_char(ADMS_APLC_DT, 'yyyymmddhh24miss') as ADMS_APLC_DT
			,to_char(ADMS_FRML_PRRN_DT, 'yyyymmddhh24miss') as ADMS_FRML_PRRN_DT
			,ANTP_STHS_DDCN		/*  */
			,PTRM_ASGM_DT		/*  */
			,ADMS_ITDR_ID		/*  */
			,GNDR_ID		/*  */
			,INPT_DR_ID		/*  */
			,SMCR_YN		/*  */
			,WKND_ADMS_PSBL_YN		/*  */
			,REFE_YN		/*  */
			,CAG_PTNT_YN		/*  */		
			,APNT_MDFC_YN		/*  */		
			,MOBL_TRNM_YN		/*  */
			,SRIL_STDC_YN		/*  */
			,DYOF_ADMS_PSBL_YN		/*  */
			,B6RM_SNGN_APLC_YN		/*  */
			,MCDP_CD		/*  */
			,ISTY_CD		/*  */
			,ISTY_ASST_CD		/*  */
			,FATR_CD		/*  */
			,FATR_PTNT_SNO		/*  */
			,SCIN_CD		/*  */
			,CLNC_DX_CD		/*  */
			,DR_SPSB_CTN		/*  */
			,AMDV_CD		/*  */
			,IPDV_CD		/*  */
			,ADMS_SQNC_NM		/*  */	
			,AMPA_CD		/*  */
			,ITNT_APNT_CNFR_CD		/*  */
			,HSLC_DVSN_CD		/*  */
			,MCCN_CD		/*  */
			,PTCN_YN		/*  */
			,ADMS_IDCT_DVSN_CD		/*  */
			,UNSB_CTN		/*  */
			,AMPM_DVSN_CD		/*  */
			,AHED_DSGN_CD		/*  */	
			,APNT_RCPS_ID		/*  */
			,DIDV_CD		/*  */
			,DIET_CD		/*  */
			,MESG_PTRM_GRAD_CD		/*  */
			,MESG_CNFR_YN		/*  */
			,MDCR_PTRM_DVSN_CD		/*  */
			,WNTD_PTRM_GRAD_CD		/*  */
			,WARD_CD		/*  */
			,PTRM_NO		/*  */
			,PTRM_INFM_CD		/*  */
			,ADMS_PSBL_WARD_NM		/*  */
			,OTRS_WARD_ASGM_CD		/*  */		
			,ACS_FINS_DVSN_CD		/*  */
			,ACS_RMRK_CTN		/*  */
			,ER_GRAD_CD		/*  */
			,PBDR_ID		/*  */
			,ERRM_ADMS_DCSN_YMD		/*  */
			,to_char(ERRM_ADMS_PBLC_DT, 'yyyymmddhh24miss') as ERRM_ADMS_PBLC_DT
			,ERRM_ADMS_PRRT_SQNC_CD		/*  */
			,CP_RGST_YN		/*  */
			,CP_CD		/*  */
			,CP_DPRT_CD		/*  */
			,to_char(CP_INFM_INQR_DT, 'yyyymmddhh24miss') as CP_INFM_INQR_DT			
			,ADMS_WAIT_RESN_CD		/*  */
			,ADMS_WAIT_MNGM_MEMO_CTN		/*  */
			,DR_DRG_NO		/*  */
			,DRG_NO		/*  */
			,CNCL_DT		/*  */
			,ADMS_APNT_CNRE_CD		/*  */		
			,ADMS_STDC_INFT_YN		/*  */			
			,CLNC_DX_NM		/*  */
			, to_char(ENRM_PSBL_DT, 'yyyymmddhh24miss') as ENRM_PSBL_DT
			,EXTG_ASGM_MDRP_NO		/*  */
			,CHRC_TRAS_STTS_CD		/*  */
			,PTRM_ASGM_STTS_CD		/*  */
			,to_char(INFT_WAIT_DT, 'yyyymmddhh24miss') as INFT_WAIT_DT
			,CLRS_PRJC_CD		/*  */
			,SPCY_SCKB_DVSN_CD		/*  */
			,SPCY_SCKB_MXMM_USE_PSBL_HH		/*  */
			,HIRA_CMDS_INFM_CTN		/*  */
			,IDCR_INFT_YN		/*  */
			,HGRM_PSBLT_INFT_YN		/*  */
			,VSTR_LMTT_INFT_YN		/*  */
			,INFT_CNFM_RLTN_CTN		/*  */
			,to_char(HIRA_CMDS_INFM_CNFR_DT, 'yyyymmddhh24miss') as HIRA_CMDS_INFM_CNFR_DT
			,ISLT_PTRM_ACPT_DVSN_CD      /*격리병실수용구분코드(APC_042) */
			,CNCMS_YN                    /*간호간병통합서비스여부  */
			,PYDP_AMDV_CD                /*정신과입원구분코드(APC_043) */
		    , SCIN_CP_MEA_APLY_RESN_CD   /*상병CP미적용사유코드(공통코드:MM610) */
		    , SCIN_CP_MEA_APLY_REET_CTN  /*상병CP미적용사유기타내용   */
		 FROM	APRCAMAPT
		where ADMS_APNT_NO = #{admsApntNo}
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsPrrnTrgtPtntYn-result" type="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO">
	
		<result property="admsPrrnTrgtPtntYn" column="ADMS_PRRN_TRGT_PTNT_YN"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsPrrnTrgtPtntYn (입원예정대상환자 여부 확인) 
        Description :                                           mdd_aprcama_s17
                                            
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
		resultMap : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsPrrnTrgtPtntYn-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsPrrnTrgtPtntYn"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  resultMap="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsPrrnTrgtPtntYn-result" useCache="true" flushCache="false">
		select /*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsPrrnTrgtPtntYn */
			    'Y'  as ADMS_PRRN_TRGT_PTNT_YN
		  from  APRCAMAPT 
		 where  1=1
		   and  PTNO           = #{ptno}
		   and  ADMS_PRRN_YMD  = to_date(#{admsPrrnYmd}, 'yyyymmdd')
		   and  CNCL_DT is null
		   and  rownum = 1
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-insertAdmsApnt (입원예약생성) 
        Description :                                           apd_mdrcama_i01
                                            
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
    -->	
	<insert id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-insertAdmsApnt"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  >
		insert  /*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-insertAdmsApnt */
		 into  APRCAMAPT                /*  입원예약  */
			   (
			   ADMS_APNT_NO                                           /*  입원예약번호 */
			,  PTNO                                                   /*  환자번호 */
			,  CODV_CD                                                /*  내원구분 */
			,  ADMS_PRRN_YMD                                          /*  입원예정일자 */
		    ,  FRST_ADMS_PRRN_YMD       /* 11 최초원무수속일  최초입원수속일자 */
			,  FRST_ADMS_PRRN_YMD_RGSR_ID /* 최초입원예정일자등록자ID */
			,  FRST_ADMS_PRRN_YMD_RGST_DT /* 최초입원예정일자등록일시 */
			,  MCDP_CD                                                /*  진료과 */	
			,  OPRT_PRRN_YMD                                          /*  수술예정일자 */
			,  ADMS_IDCT_YMD                                          /*  입원지시일자 */
			,  ADMS_APLC_DT                                           /*  입원신청일자 */	
			,  ANTP_STHS_DDCN                                         /*  예상재원일수 */
			,  ADMS_ITDR_ID                                           /*  입원지시의사id(지정의) */
			,  GNDR_ID                                                /*  주치의 */
			,  INPT_DR_ID                                             /*  입력의사(진료) */
			,  SMCR_YN                                                /*  선택의사여부(Y/N) */
			,  WKND_ADMS_PSBL_YN                                      /*  주말입원가능여부 */
			,  REFE_YN                                                /*  REFER여부 */
			,  CAG_PTNT_YN              /* 21 CAG환자구분  CAG환자여부 */	
			,  SRIL_STDC_YN                                           /*  중증약정서여부(Stroke여부) */
			,  DYOF_ADMS_PSBL_YN                                      /*  휴진입원가능여부 */
			,  ISTY_CD                                                /*  보험유형 */
			,  ISTY_ASST_CD                                           /*  보험유형보조코드 */
			,  FATR_CD                                                /*  FastTrack코드 */
			,  FATR_PTNT_SNO                                          /*  FastTrack환자일련번호 */
			,  SCIN_CD                                                /*  상병코드(MRDIAGCT) */
			,  CLNC_DX_CD                                             /*  임상진단코드 */
			,  DR_SPSB_CTN                                            /*  특기사항 */
			,  AMDV_CD                                                /*  입원구분(AP042) */
			,  IPDV_CD                                                /*  급여구분(AI042) */	
			,  AMPA_CD                                                /*  입원경로(AP007) */
			,  HSLC_DVSN_CD                                           /*  위치구분 */
			,  MCCN_CD                                                /*  진료센터 */
			,  ADMS_IDCT_DVSN_CD                                      /*  입원지시구분 */
			,  UNSB_CTN                 						      /* 45 특이사항코드 */		 
			,  AMPM_DVSN_CD                                           /*  02C 오전/오후 구분 */	 	
			,  AHED_DSGN_CD             							  /* 48 선배정코드    선지정코드 */		 
			,  APNT_RCPS_ID             							  /* 50 입원예약 등록자  */		
			,  DIDV_CD                                                /*  식사구분(진료) */
			,  DIET_CD                                                /*  식이코드(SUDIECDT) */
			,  MDCR_PTRM_DVSN_CD                                      /*  병실구분(진료) */
			,  WNTD_PTRM_GRAD_CD                                      /*  희망병실등급 */
			,  ADMS_PSBL_WARD_NM        /* 60 입원가능병동 */	 
			,  ERRM_ADMS_DCSN_YMD       /* 68 ER입원결정일     응급실입원결정일자 */
			,  ER_GRAD_CD                                             /*  응급등급 */
			,  PBDR_ID                                                /*  발행의사Id   RegDr      D08050004878 */	
			,  ERRM_ADMS_PBLC_DT                                      /*  응급실입원발행일시 */
			,  ERRM_ADMS_PRRT_SQNC_CD                                 /*  응급실입원우선순위 */
			,  CP_RGST_YN                                             /*  CP여부 */
			,  CP_CD                                                  /*  CP 코드 */
			,  CP_DPRT_CD                                             /*  CP 부서 */
			,  DR_DRG_NO                                              /*  의사DRG번호 */
			,  B6RM_SNGN_APLC_YN        /* 81 6인실단독신청여부(6인실만예약) */	
			,  ADMS_STDC_INFT_YN                                      /*  입원약정서안내여부 */
			,  IDCR_INFT_YN             /* 86 신분증안내여부 */
			,  HGRM_PSBLT_INFT_YN       /* 87 상급병실가능성안내여부 */
			,  VSTR_LMTT_INFT_YN        /* 88 방문자제한안내여부 */
			,  INFT_CNFM_RLTN_CTN       /* 89 안내확인자관계내용 */	
			,  CLNC_DX_NM                                             /*  임상진단명(추가) */
			,  CLRS_PRJC_CD                                           /*  임상연구과제코드 */
			,  WARD_ASGM_MTHD_CD /*병동입원방법코드*/
			,  AMRE_CD  /*입원사유코드 */
			,  ISLT_PTRM_ACPT_DVSN_CD   /* 격리병실수용구분코드(APC_042) */
			,  CNCMS_YN                       /* 간호간병통합서비스여부 */
			,  PYDP_AMDV_CD                /* 정신과입원구분코드(APC_043) */
		    ,  SCIN_CP_MEA_APLY_RESN_CD      /* 상병CP미적용사유코드(공통코드:MM610) */
		    ,  SCIN_CP_MEA_APLY_REET_CTN     /* 상병CP미적용사유기타내용  */
		    ,  SCIN_CP_MEA_APLY_RGSR_ID
		    ,  SCIN_CP_MEA_APLY_RGSR_DT
			,  FRST_RGSR_ID
			,  FRST_RGST_IP
			,  FRST_RGST_DT
			,  FRST_RGST_CLNT_PRGM_ID
			,  FRST_RGST_SRVR_PRGM_ID
			,  LAST_UPDR_ID
			,  LAST_UPDT_IP
			,  LAST_UPDT_DT
			,  LAST_UPDT_CLNT_PRGM_ID
			,  LAST_UPDT_SRVR_PRGM_ID
			   )
		values
			   (
			   #{admsApntNo}                                 /*  입원예약번호@@ */
			,  #{ptno}                                        /*  환자번호 */
			,  #{codvCd}                                     /*  내원구분@@ */
			,  to_date(#{admsPrrnYmd}, 'yyyymmdd')          /*  입원예정일자 */
		    ,  to_date(#{frstAdmsPrrnYmd}, 'yyyymmdd')          /*  입원예정일자 */	
			,  #{frstAdmsPrrnYmdRgsrId}         /*  입원예정일자 */
			,  to_date(#{frstAdmsPrrnYmdRgstDt}, 'yyyymmddhh24miss')          /*  입원예정일자 */	    
			,  #{mcdpCd}                                     /*  진료과 */
			,  to_date(#{oprtPrrnYmd}, 'yyyymmdd')          /*  수술예정일자 */
			,  to_date(#{admsIdctYmd}, 'yyyymmdd')          /*  입원지시일자 */
			,  sysdate                                      /*  입원신청일자 */
			,  #{antpSthsDdcn}                              /*  예상재원일수 */
			,  #{admsItdrId}                                /*  입원지시의사id(지정의) */
			,  #{mddrId}                                     /*  주치의 */
			,  #{inptDrId}                                  /*  입력의사(진료) */
			,  #{smcrYn}                                     /*  선택의사여부(Y/N) */
			,  #{wkndAdmsPsblYn}                           /*  주말입원가능여부 */
			,  #{refeYn}                                     /*  REFER여부 */
			,  #{cagPtntYn}                          /* 25. CAG환자구분  CAG환자여부                 */
			,  #{srilStdcYn}                                /*  중증약정서여부(Stroke여부) */
			,  #{dyofAdmsPsblYn}                           /*  휴진입원가능여부@@ */
			,  #{istyCd}                                     /*  환자유형(AI003) */
			,  #{istyAsstCd}                                /*  유형보조(AI004) */
			,  #{fatrCd}                                     /*  FastTrack코드 */
			,  #{fatrPtntSno}                               /*  FastTrack환자일련번호 */
			,  #{scinCd}                                     /*  상병코드 */
			,  #{clncDxCd}                                  /*  임상진단코드 */
			,  #{drSpsbCtn}                                 /*  의사특기사항 */
			,  nvl(#{amdvCd}, 'N')                                     /*  입원구분 */
			,  #{ipdvCd}                                     /*  급여구분(AI042) */		
			,  #{ampaCd}                                     /*  입원경로(AP007) */
			,  #{hslcDvsnCd}                      /*  위치구분 */
			,  #{mccnCd}                      /*  진료센터  /*  201387  M   본원 */
			,  #{admsIdctDvsnCd}                                                             /*  입원지시구분 진료='2' */
			,  #{unsbCtn}                                       /* 10. 특이사항코드                             */		
			,  #{ampmDvsnCd}                                /*  02C 오전/오후 구분 */
			,  #{ahedDsgnCd}                                   /* 33  선배정코드    선지정코드                 */		
			,  #{apntRcpsId}                                /* 37  입원예약 등록자                          50*/			
			,  #{didvCd}                                     /*  식사구분(진료) */
			,  #{dietCd}                                     /*  식이코드(SUDIECDT) */
			,  #{mdcrPtrmDvsnCd}                           /*  병실구분(진료) */
			,  #{wntdPtrmGradCd}                           /*  희망병실등급 */
			,  #{admsPsblWardNm}                               /* 35  입원가능병동                             60*/	
			,  to_date(#{errmAdmsDcsnYmd}, 'yyyymmdd')            /* 28. ER입원결정일     응급실입원결정일자      */	
			,  #{erGradCd}                                  /*  응급등급 */
			,  #{pbdrId}                                     /*  발행의사Id   RegDr      D08050004878 */
			,  to_date(#{errmAdmsPblcDt}, 'yyyymmddhh24miss')         /*  응급실 입원발행일시        D08050004878 */
			,  #{errmAdmsPrrtSqncCd}                      /*  응급실경유입원우선순위 */
			,  #{cpRgstYn}                                  /*  CP여부 */
			,  #{cpCd}                                       /*  CP 코드 */
			,  #{cpDprtCd}                                  /*  CP 부서 */
			,  #{drDrgNo}                                   /*  의사DRG번호 */
			,  #{b6rmSngnAplcYn}      /* 6인실단독신청여부(6인실만예약) */
			,  #{admsStdcInftYn}	
			,  #{idcrInftYn}           /* 신분증안내여부 */
			,  #{hgrmPsbltInftYn}     /* 상급병실가능성안내여부 */
			,  #{vstrLmttInftYn}      /* 방문자제한안내여부 */
			,  #{inftCnfmRltnCtn}     /* 안내확인자관계내용 */			
			,  #{clncDxNm}                                  /*  임상진단명 */
			,  #{clrsPrjcCd}                                /*  임상연구과제코드 */	   
			,  #{wardAsgmMthdCd}
			,  #{amreCd}
			,  #{isltPtrmAcptDvsnCd}   /* 격리병실수용구분코드(APC_042) */
			,  #{cncmsYn}                       /* 간호간병통합서비스여부 */
			,  #{pydpAmdvCd}                /* 정신과입원구분코드(APC_043) */
		    ,  #{scinCpMeaAplyResnCd}       /* 상병CP미적용사유코드(공통코드:MM610) */
		    ,  #{scinCpMeaAplyReetCtn}      /* 상병CP미적용사유기타내용  */
			,  case when #{scinCpMeaAplyResnCd} is null then '' else #{gvUserId} end
		    ,  case when #{scinCpMeaAplyResnCd} is null then '' else sysdate end
			,  #{gvUserId}
			,  #{gvUserIp}
			,  sysdate
			,  #{gvClntPrgmId}
			,  #{gvSrvrPrgmId}
			,  #{gvUserId}
			,  #{gvUserIp}
			,  sysdate
			,  #{gvClntPrgmId}
			,  #{gvSrvrPrgmId}
			)
	</insert>




    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-updateAdmsApnt (입원예약테이블 수정) 
        Description :                                           apd_mdrcama_u01
                                            
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
    -->	
	<update id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-updateAdmsApnt"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  >
		update /*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-updateAdmsApnt */
		      APRCAMAPT                -- 입원예약
		 set
		     LAST_UPDR_ID         = #{gvUserId}
		   , LAST_UPDT_IP         = #{gvUserIp}
		   , LAST_UPDT_DT         = sysdate
		   , LAST_UPDT_CLNT_PRGM_ID   = #{gvClntPrgmId}
		   , LAST_UPDT_SRVR_PRGM_ID   = #{gvSrvrPrgmId}
		   <if test="admsPrrnYmd != null">
		   , ADMS_PRRN_YMD             = to_date(#{admsPrrnYmd}, 'yyyymmdd')          -- 입원예정일자
		   </if>
		   <if test="frstAdmsPrrnYmd != null">
		   , FRST_ADMS_PRRN_YMD             = to_date(#{frstAdmsPrrnYmd}, 'yyyymmdd')          -- 입원예정일자
		   </if>   
		   <if test="frstAdmsPrrnYmd != null">
		   , FRST_ADMS_PRRN_YMD_RGSR_ID     = #{frstAdmsPrrnYmdrRsrId}          -- 입원예정일자
		   </if>   
		   <if test="frstAdmsPrrnYmd != null">
		   , FRST_ADMS_PRRN_YMD_RGST_DT             = to_date(#{frstAdmsPrrnYmdRgstDt}, 'yyyymmddhh24miss')          -- 입원예정일자
		   </if>   
		   <if test="mcdpCd != null">
		   ,  MCDP_CD                   = #{mcdpCd}                                    -- 진료과
		   </if>   
		   <if test="oprtPrrnYmd != null">
		   ,  OPRT_PRRN_YMD             = to_date(#{oprtPrrnYmd}, 'yyyymmdd')          -- 수술예정일자
		   </if>
		   <if test="admsIdctYmd != null">
		   ,  ADMS_IDCT_YMD             = to_date(#{admsIdctYmd}, 'yyyymmdd')          -- 입원지시일자
		   </if>
		   <if test="antpSthsDdcn != null">
		   ,  ANTP_STHS_DDCN            = #{antpSthsDdcn}                              -- 예상재원일수
		   </if>
		   <if test="admsItdrId != null">
		   ,  ADMS_ITDR_ID              = #{admsItdrId}                                -- 입원지시의사id(지정의)
		   </if>
		   <if test="mddrId != null">
		   ,  GNDR_ID                   = #{mddrId}                                     -- 주치의
		   </if>
		   <if test="inptDrId != null">
		   ,  INPT_DR_ID                = #{inptDrId}                                  -- 입력의사(진료)
		   </if>
		   <if test="smcrYn != null">
		   ,  SMCR_YN                   = #{smcrYn}                                    -- 선택의사여부(Y/N)
		   </if>
		   <if test="wkndAdmsPsblYn != null">
		   ,  WKND_ADMS_PSBL_YN         = #{wkndAdmsPsblYn}                           -- 주말입원가능여부
		   </if>
		   <if test="refeYn != null">
		   ,  REFE_YN                   = #{refeYn}                                     -- REFER여부
		   </if>
		   <if test="vatTrgtCd != null">
		   ,  VAT_TRGT_CD               = #{vatTrgtCd}                                 -- 부가세대상코드
		   </if>
		   <if test="srilStdcYn != null">
		   ,  SRIL_STDC_YN              = #{srilStdcYn}                                -- 중증약정서여부(Stroke여부)
		   </if>
		   <if test="dyofAdmsPsblYn != null">
		   ,  DYOF_ADMS_PSBL_YN         = #{dyofAdmsPsblYn}                           -- 휴진입원가능여부@@
		   </if>
		   <if test="istyCd != null">
		   ,  ISTY_CD                   = #{istyCd}                                     -- 환자유형(AI003)
		   </if>
		   <if test="istyAsstCd != null">
		   ,  ISTY_ASST_CD              = #{istyAsstCd}                                -- 유형보조(AI004)
		   </if>
		   <if test="fatrCd != null">
		   ,  FATR_CD                   = #{fatrCd}                                     -- FastTrack코드
		   </if>
		   <if test="fatrPtntSno != null">
		   ,  FATR_PTNT_SNO             = #{fatrPtntSno}                               -- FastTrack환자일련번호
		   </if>
		   <if test="scinCd != null">
		   ,  SCIN_CD                   = #{scinCd}                                     -- 상병코드
		   </if>
		   <if test="clncDxCd != null">
		   ,  CLNC_DX_CD                = #{clncDxCd}                                  -- 임상진단코드
		   </if>
		   <if test="clncDxNm != null">
		   ,  CLNC_DX_NM                = #{clncDxNm}                                  -- 임상진단명
		   </if>
		   <if test="drSpsbCtn != null">
		   ,  DR_SPSB_CTN               = #{drSpsbCtn}                                 -- 의사특기사항
		   </if>
		   <if test="amdvCd != null">
		   ,  AMDV_CD                   = #{amdvCd}                                     -- 입원구분
		   </if>
		   <if test="ipdvCd != null">
		   ,  IPDV_CD                   = #{ipdvCd}                                     -- 급여구분(AI042)
		   </if>   
		   <if test="ampaCd != null">
		   ,  AMPA_CD                   = #{ampaCd}                                     -- 입원경로(AP007)
		   </if>
		   <if test="hslcDvsnCd != null">
		   ,  HSLC_DVSN_CD              = #{hslcDvsnCd}                     -- 위치구분
		   </if>
		   <if test="mccnCd != null">
		   ,  MCCN_CD                   = #{mccnCd}                      -- 진료센터  -- 201387  M   본원
		   </if>   
		   <if test="ampmDvsnCd != null">
		   ,  AMPM_DVSN_CD              = #{ampmDvsnCd}                                -- 02C 오전/오후 구분
		   </if>   
		   <if test="didvCd != null">
		   ,  DIDV_CD                   = #{didvCd}                                     -- 식사구분(진료)
		   </if>
		   <if test="dietCd != null">
		   ,  DIET_CD                   = #{dietCd}                                     -- 식이코드(SUDIECDT)
		   </if>
		   <if test="mdcrPtrmDvsnCd != null">
		   ,  MDCR_PTRM_DVSN_CD         = #{mdcrPtrmDvsnCd}                           -- 병실구분(진료)
		   </if>
		   <if test="wntdPtrmGradCd != null">
		   ,  WNTD_PTRM_GRAD_CD         = #{wntdPtrmGradCd}                           -- 희망병실등급
		   </if>
		   <if test="erGradcd != null">
		   ,  ER_GRAD_CD                = #{erGradcd}                                  -- 응급등급
		   </if>
		   <if test="pbdrId != null">
		   ,  PBDR_ID                   = #{pbdrId}                                     -- 발행의사Id   RegDr      D08050004878
		   </if>
		   <if test="errmAdmsPrrtSqncCd != null">
		   ,  ERRM_ADMS_PRRT_SQNC_CD    = #{errmAdmsPrrtSqncCd}                      -- 응급실경유입원우선순위
		   </if>
		   <if test="cpRgstYn != null">
		   ,  CP_RGST_YN                = #{cpRgstYn}                                  -- CP여부
		   </if>
		   <if test="cpCd != null">
		   ,  CP_CD                     = #{cpCd}                                       -- CP 코드
		   </if>
		   <if test="cpDprtCd != null">
		   ,  CP_DPRT_CD                = #{cpDprtCd}                                  -- CP 부서
		   </if>
		   <if test="drDrgNo != null">
		   ,  DR_DRG_NO                 = #{drDrgNo}                                  -- 의사DRG번호
		   </if>
		   <if test="clrsPrjcCd != null">
		   ,  CLRS_PRJC_CD              = #{clrsPrjcCd}                                -- 임상연구과제코드
		   </if>   
		   <if test="admsWaitResnCd != null">
		   ,  ADMS_WAIT_RESN_CD       = #{admsWaitResnCd} /*  입원대기사유 */
		   </if>
		   <if test="admsWaitMngmMemoCtn != null">   
		   ,  ADMS_WAIT_MNGM_MEMO_CTN = #{admsWaitMngmMemoCtn} /*  입원대기사유메모 */
		   </if>
		   <if test="admsApntCnreCd != null">   
		   ,  ADMS_APNT_CNRE_CD = #{admsApntCnreCd} 
		   </if>
		   <if test="cnclDt != null">   
		   ,  CNCL_DT = to_date(#{cnclDt}, 'yyyymmddhh24miss') 
		   </if>      
		   <if test="mdrpNo != null">   
		   ,  MDRP_NO = #{mdrpNo} /*진료접수번호 */
		   </if> 
		   <if test="admsDt != null">   
		   ,  ADMS_DT = to_date(#{admsDt}, 'yyyymmddhh24miss') /*진료접수번호 */
		   </if> 
		   <if test="unsbCtn != null">   
		   ,  UNSB_CTN = #{unsbCtn} /*진료접수번호 */
		   </if>   
		   <if test="admsSqncNm != null">   
		   ,  ADMS_SQNC_NM = #{admsSqncNm} /*진료접수번호 */
		   </if>     
		   <if test="cagPtntYn != null">   
		   ,  CAG_PTNT_YN = #{cagPtntYn} /*진료접수번호 */
		   </if>    
		   <if test="errmAdmsDcsnYmd != null">   
		   ,  ERRM_ADMS_DCSN_YMD = to_date(#{errmAdmsDcsnYmd}, 'yyyymmdd') 
		   </if>    
		   <if test="errmAdmsPblcDt != null">   
		   ,  ERRM_ADMS_PBLC_DT = to_date(#{errmAdmsPblcDt}, 'yyyymmddhh24miss') 
		   </if>       
		   <if test="ahedDsgnCd != null">   
		   ,  AHED_DSGN_CD = #{ahedDsgnCd} 
		   </if> 
		   <if test="admsPsblWardNm != null">   
		   ,  ADMS_PSBL_WARD_NM = #{admsPsblWardNm} 
		   </if> 
		   <if test="ptrmAsgmDt != null">   
		   ,  PTRM_ASGM_DT = to_date(#{ptrmAsgmDt}, 'yyyymmddhh24miss') 
		   </if> 
		   <if test="b6rmSngnAplcYn != null">   
		   ,  B6RM_SNGN_APLC_YN = #{b6rmSngnAplcYn}
		   </if>       
		   <if test="admsStdcInftYn != null">   
		   ,  ADMS_STDC_INFT_YN = #{admsStdcInftYn}
		   </if>       
		   <if test="idcrInftYn != null">   
		   ,  IDCR_INFT_YN = #{idcrInftYn}
		   </if>       
		   <if test="hgrmPsbltInftYn != null">   
		   ,  HGRM_PSBLT_INFT_YN = #{hgrmPsbltInftYn}
		   </if>       
		   <if test="vstrLmttInftYn != null">   
		   ,  VSTR_LMTT_INFT_YN = #{vstrLmttInftYn}
		   </if>          
		   <if test="inftCnfmRltnCtn != null">   
		   ,  INFT_CNFM_RLTN_CTN = #{inftCnfmRltnCtn}
		   </if>             
		   <if test="ptrmNo != null">   
		   ,  WARD_CD = #{wardCd}
		   </if>   
		   <if test="ptrmNo != null">   
		   ,  PTRM_NO = #{ptrmNo}
		   </if>
		   <if test="admsFrmlPrrnDt != null">   
		   ,  ADMS_FRML_PRRN_DT = to_date(#{admsFrmlPrrnDt}, 'yyyymmddhh24miss')
		   </if>
		   <if test="mesgPtrmGradCd != null">   
		   ,  MESG_PTRM_GRAD_CD = #{mesgPtrmGradCd}
		   </if>  
		   <if test="ptrmInfmCd != null">   
		   ,  PTRM_INFM_CD = #{ptrmInfmCd}
		   </if>
		   <if test="otrsWardAsgmCd != null">   
		   ,  OTRS_WARD_ASGM_CD = #{otrsWardAsgmCd}
		   </if> 
		   <if test="ptrmAsgmSttsCd != null">   
		   ,  PTRM_ASGM_STTS_CD = #{ptrmAsgmSttsCd}
		   </if> 
		   <if test="inftWaitDt != null">   
		   ,  INFT_WAIT_DT = #{inftWaitDt}
		   </if> 
		   <if test="spcySckbDvsnCd != null">   
		   ,  SPCY_SCKB_DVSN_CD = #{spcySckbDvsnCd}
		   </if>  
		   <if test="spcySckbMxmmUsepsblHh != null">   
		   ,  SPCY_SCKB_MXMM_USE_PSBL_HH = #{spcySckbMxmmUsepsblHh}
		   </if> 
		   <if test="extgAsgmMdrpNo != null">   
		   ,  EXTG_ASGM_MDRP_NO = #{extgAsgmMdrpNo}
		   </if> 
		   <if test="enrmPsblDt != null">   
		   ,  ENRM_PSBL_DT = to_date(#{enrmPsblDt}, 'yyyymmddhh24miss')
		   </if> 
		   <if test="wardAsgmMthdCd != null">   
		   ,  WARD_ASGM_MTHD_CD = #{wardAsgmMthdCd}
		   </if> 
		   <if test="amreCd != null">   
		   ,  AMRE_CD = #{amreCd}
		   </if>   
		   <if test="isltPtrmAcptDvsnCd != null">   
		   ,  ISLT_PTRM_ACPT_DVSN_CD = #{isltPtrmAcptDvsnCd} --격리병실수용구분코드(APC_042)
		   </if> 
		   <if test="cncmsYn != null">   
		   ,  CNCMS_YN = #{cncmsYn}                        --간호간병통합서비스여부
		   </if> 
		   <if test="pydpAmdvCd != null">   
		   ,  PYDP_AMDV_CD = #{pydpAmdvCd}                 --정신과입원구분코드(APC_043)
		   </if> 
		   <if test="scinCpMeaAplyResnCd != null"> 
		    ,  SCIN_CP_MEA_APLY_RESN_CD = #{scinCpMeaAplyResnCd}       /* 상병CP미적용사유코드(공통코드:MM610) */
		   </if>
		   <if test="scinCpMeaAplyReetCtn != null"> 
		    ,  SCIN_CP_MEA_APLY_REET_CTN = #{scinCpMeaAplyReetCtn}      /* 상병CP미적용사유기타내용  */
		   </if>
		   <if test="scinCpMeaAplyResnCd != null"> 
		    ,  SCIN_CP_MEA_APLY_RGSR_ID = DECODE(#{scinCpMeaAplyResnCd}, '', '', #{gvUserId})
		   </if>
		   <if test="scinCpMeaAplyResnCd != null"> 
		    ,  SCIN_CP_MEA_APLY_RGSR_DT = DECODE(#{scinCpMeaAplyResnCd}, '', '', sysdate)
		   </if> 
		where
		      ADMS_APNT_NO = #{admsApntNo}
	</update>


	<resultMap id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneFrstAdmsPrrnYmd-result" type="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO">
	
		<result property="frstAdmsPrrnYmd" column="FRST_ADMS_PRRN_YMD"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneFrstAdmsPrrnYmd () 
        Description :                       
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
		resultMap : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneFrstAdmsPrrnYmd-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneFrstAdmsPrrnYmd"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  resultMap="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneFrstAdmsPrrnYmd-result" useCache="true" flushCache="false">
		  select  /*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneFrstAdmsPrrnYmd */
		   		    to_char(nvl(a.FRST_ADMS_PRRN_YMD, a.ADMS_PRRN_YMD), 'yyyymmdd') as FRST_ADMS_PRRN_YMD
			from  APRCAMAPT a
		 where  a.PTNO      = #{ptno}
		    and  a.MCDP_CD   = #{mcdpCd}
		    and  a.CNCL_DT   is null
			and  a.ADMS_DT   = to_date(#{admsDt}, 'yyyymmddhh24miss')
			 and  rownum = 1
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-listClncDxCd-result" type="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO">
	
		<result property="clncDxCd" column="CLNC_DX_CD"/>
		<result property="clncDxNm" column="CLNC_DX_NM"/>
		<result property="scinCd" column="SCIN_CD"/>
		<result property="scinEnsnNm" column="SCIN_ENSN_NM"/>
		<result property="mainScinYn" column="MAIN_SCIN_YN"/>
		<result property="sortSqnc" column="SORT_SQNC"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-listClncDxCd (진료상병정보 조회) 
        Description :                       
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
		resultMap : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-listClncDxCd-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-listClncDxCd"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  resultMap="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-listClncDxCd-result" useCache="true" flushCache="false">
		select /*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-listClncDxCd */
		         x.CLNC_DX_CD as CLNC_DX_CD      /*  임상진단코드 */
		       , x.CLNC_DX_NM as CLNC_DX_NM      /*  임상진단명 */     
		       , x.SCIN_CD as SCIN_CD         /*  상병코드 */
		       , x.SCIN_ENSN_NM as SCIN_ENSN_NM    /*  상병영문명 */
		       , x.MAIN_SCIN_YN as MAIN_SCIN_YN    /*  주상병여부 */    
		       , x.SORT_SQNC    as SORT_SQNC 
		     from (select
		               a.CLNC_DX_CD           /*  임상진단코드 */
		             , b1.TRMN_NM as CLNC_DX_NM /*  임상진단명 */
		             , b.SCIN_CD              /*  상병코드 */
		             , c.SCIN_ENSN_NM         /*  상병영문명 */
		             , decode(nvl(b.SORT_SQNC,1),1,'Y','N') as MAIN_SCIN_YN    /*  주상병여부 */           
		             , b.SORT_SQNC as SORT_SQNC
		           from
		               APRCAMAPT a     /*  입원예약 */
		             , MRBSCLSCT b     /*  임상코드상병 */
		             , METRDCTMT b1    /*  용어사전 */
		             , MRBSSCINT c     /*  상병코드 */
		          where 1=1
		            and a.ADMS_APNT_NO                = #{admsApntNo}
		            and nvl(a.CLNC_DX_CD,'D9999999') != 'D9999999'
		            and b1.TRMN_ID                    = a.CLNC_DX_CD
		            and b.TRMN_ID                     = b1.TRMN_ID
		            and a.ADMS_PRRN_YMD between b.TRMN_MPNG_STRT_YMD and nvl(b.TRMN_MPNG_FNSH_YMD, sysdate) + 0.99999
		            and c.SCIN_CD                     = b.SCIN_CD
		            and c.SCIN_CD_VRSN_STRT_YMD       = b.SCIN_CD_VRSN_STRT_YMD
		            and a.ADMS_PRRN_YMD between c.APLY_YMD and nvl(c.FNSH_YMD, sysdate) + 0.99999
		            and c.MDCR_USE_YN                 = 'Y'
		            and b1.MDCR_USE_YN                = 'Y'
		          union all
		          select
		                'D9999999' as CLNC_DX_CD          /*  임상진단코드 */
		              , b.SCIN_ENSN_NM as CLNC_DX_NM          /*  임상진단명 */            
		              , b.SCIN_CD             /*  상병코드 */
		              , b.SCIN_ENSN_NM        /*  상병영문명 */
		              , 'Y' as MAIN_SCIN_YN   /*  주상병여부 */            
		              , 9 as SORT_SQNC
		            from
		                APRCAMAPT a    /*  입원예약 */
		              , MRBSSCINT b    /*  상병코드 */
		           where 1=1
		             and a.ADMS_APNT_NO               = #{admsApntNo}
		             and nvl(a.CLNC_DX_CD,'D9999999') = 'D9999999'
		             and b.SCIN_CD                    = a.SCIN_CD
		             and a.ADMS_PRRN_YMD between b.APLY_YMD and nvl(b.FNSH_YMD, sysdate) + 0.99999
		             and b.MDCR_USE_YN                = 'Y'
		         ) x
		   order by SORT_SQNC
	</select>




	<resultMap id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApntByMdrpNo-result" type="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO">
	
		<result property="admsApntNo" column="ADMS_APNT_NO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApntByMdrpNo (접수번호를 이용한 입원예약정보 조회) 
        Description :                       
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
		resultMap : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApntByMdrpNo-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApntByMdrpNo"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  resultMap="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApntByMdrpNo-result" useCache="true" flushCache="false">
		/*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneAdmsApntByMdrpNo */
		select  
		          ADMS_APNT_NO
		  from APRCAMAPT
		where MDRP_NO = #{mdrpNo}
		  and  rownum  = 1
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-deleteAdmsApnt (입원예약정보 삭제) 
        Description :                       
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
    -->	
	<delete id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-deleteAdmsApnt"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  >
		 delete  /*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-deleteAdmsApnt */
		   from  APRCAMAPT                -- 입원예약
		 where  ADMS_APNT_NO = #{admsApntNo}
	</delete>


	<resultMap id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneNextAdmsApntNo-result" type="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO">
	
		<result property="admsApntNo" column="ADMS_APNT_NO"/>
	</resultMap>
	
    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneNextAdmsApntNo (다음입원예약원번호조회) 
        Description :                       
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
		resultMap : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneNextAdmsApntNo-result
    -->
	<select id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneNextAdmsApntNo"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  resultMap="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneNextAdmsApntNo-result" useCache="true" flushCache="false">
		select /*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-selectOneNextAdmsApntNo */
		          APRCAMAPTQ.nextval as ADMS_APNT_NO 
		  from dual
	</select>






    <!--
        SQL Name : com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-updateCancelAdmsPtrmAsgm (입원예정 배정정보 업데이트) 
        Description :                                           입원예정 배정정보 업데이트
                                            
		parameterType : com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO
    -->	
	<update id="com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-updateCancelAdmsPtrmAsgm"  parameterType="com.sds.healthcare.ehr.adm.ap.apc.vo.ApcAdmsApntComnDVO"  >
		/*SQL_ID: com-sds-healthcare-ehr-adm-ap-apc-dao-ApcAdmsApntComnDAO-updateCancelAdmsPtrmAsgm */
		update  APRCAMAPT
		   set  LAST_UPDR_ID         = #{gvUserId}
		     ,  LAST_UPDT_IP         = #{gvUserIp}
		     ,  LAST_UPDT_DT         = sysdate
		     ,  LAST_UPDT_CLNT_PRGM_ID   = #{gvClntPrgmId}
		     ,  LAST_UPDT_SRVR_PRGM_ID   = #{gvSrvrPrgmId}
		     ,  MDRP_NO = 0
		     ,  ADMS_DT = null
		     ,  WARD_CD = (case when PTRM_ASGM_DT is null then '' else WARD_CD end)
		     ,  PTRM_NO = (case when PTRM_ASGM_DT is null then '' else PTRM_NO end)
		     ,  SCKB_NO = (case when PTRM_ASGM_DT is null then '' else SCKB_NO end)
		 where  1=1
		   and  ADMS_APNT_NO = #{admsApntNo}  
	</update>

</mapper>